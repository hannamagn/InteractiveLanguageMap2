var UC=Object.defineProperty;var ZC=(t,n,a)=>n in t?UC(t,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[n]=a;var Hh=(t,n,a)=>ZC(t,typeof n!="symbol"?n+"":n,a);function GC(t,n){for(var a=0;a<n.length;a++){const p=n[a];if(typeof p!="string"&&!Array.isArray(p)){for(const m in p)if(m!=="default"&&!(m in t)){const b=Object.getOwnPropertyDescriptor(p,m);b&&Object.defineProperty(t,m,b.get?b:{enumerable:!0,get:()=>p[m]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const m of document.querySelectorAll('link[rel="modulepreload"]'))p(m);new MutationObserver(m=>{for(const b of m)if(b.type==="childList")for(const x of b.addedNodes)x.tagName==="LINK"&&x.rel==="modulepreload"&&p(x)}).observe(document,{childList:!0,subtree:!0});function a(m){const b={};return m.integrity&&(b.integrity=m.integrity),m.referrerPolicy&&(b.referrerPolicy=m.referrerPolicy),m.crossOrigin==="use-credentials"?b.credentials="include":m.crossOrigin==="anonymous"?b.credentials="omit":b.credentials="same-origin",b}function p(m){if(m.ep)return;m.ep=!0;const b=a(m);fetch(m.href,b)}})();var qC=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Rw(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Lw={exports:{}},Fm={},Dw={exports:{}},jt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gd=Symbol.for("react.element"),WC=Symbol.for("react.portal"),HC=Symbol.for("react.fragment"),XC=Symbol.for("react.strict_mode"),KC=Symbol.for("react.profiler"),YC=Symbol.for("react.provider"),QC=Symbol.for("react.context"),JC=Symbol.for("react.forward_ref"),eE=Symbol.for("react.suspense"),tE=Symbol.for("react.memo"),rE=Symbol.for("react.lazy"),$1=Symbol.iterator;function nE(t){return t===null||typeof t!="object"?null:(t=$1&&t[$1]||t["@@iterator"],typeof t=="function"?t:null)}var Fw={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Bw=Object.assign,Ow={};function wu(t,n,a){this.props=t,this.context=n,this.refs=Ow,this.updater=a||Fw}wu.prototype.isReactComponent={};wu.prototype.setState=function(t,n){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,n,"setState")};wu.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function jw(){}jw.prototype=wu.prototype;function L0(t,n,a){this.props=t,this.context=n,this.refs=Ow,this.updater=a||Fw}var D0=L0.prototype=new jw;D0.constructor=L0;Bw(D0,wu.prototype);D0.isPureReactComponent=!0;var V1=Array.isArray,Nw=Object.prototype.hasOwnProperty,F0={current:null},$w={key:!0,ref:!0,__self:!0,__source:!0};function Vw(t,n,a){var p,m={},b=null,x=null;if(n!=null)for(p in n.ref!==void 0&&(x=n.ref),n.key!==void 0&&(b=""+n.key),n)Nw.call(n,p)&&!$w.hasOwnProperty(p)&&(m[p]=n[p]);var c=arguments.length-2;if(c===1)m.children=a;else if(1<c){for(var A=Array(c),j=0;j<c;j++)A[j]=arguments[j+2];m.children=A}if(t&&t.defaultProps)for(p in c=t.defaultProps,c)m[p]===void 0&&(m[p]=c[p]);return{$$typeof:Gd,type:t,key:b,ref:x,props:m,_owner:F0.current}}function iE(t,n){return{$$typeof:Gd,type:t.type,key:n,ref:t.ref,props:t.props,_owner:t._owner}}function B0(t){return typeof t=="object"&&t!==null&&t.$$typeof===Gd}function oE(t){var n={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(a){return n[a]})}var U1=/\/+/g;function X_(t,n){return typeof t=="object"&&t!==null&&t.key!=null?oE(""+t.key):n.toString(36)}function Of(t,n,a,p,m){var b=typeof t;(b==="undefined"||b==="boolean")&&(t=null);var x=!1;if(t===null)x=!0;else switch(b){case"string":case"number":x=!0;break;case"object":switch(t.$$typeof){case Gd:case WC:x=!0}}if(x)return x=t,m=m(x),t=p===""?"."+X_(x,0):p,V1(m)?(a="",t!=null&&(a=t.replace(U1,"$&/")+"/"),Of(m,n,a,"",function(j){return j})):m!=null&&(B0(m)&&(m=iE(m,a+(!m.key||x&&x.key===m.key?"":(""+m.key).replace(U1,"$&/")+"/")+t)),n.push(m)),1;if(x=0,p=p===""?".":p+":",V1(t))for(var c=0;c<t.length;c++){b=t[c];var A=p+X_(b,c);x+=Of(b,n,a,A,m)}else if(A=nE(t),typeof A=="function")for(t=A.call(t),c=0;!(b=t.next()).done;)b=b.value,A=p+X_(b,c++),x+=Of(b,n,a,A,m);else if(b==="object")throw n=String(t),Error("Objects are not valid as a React child (found: "+(n==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":n)+"). If you meant to render a collection of children, use an array instead.");return x}function gf(t,n,a){if(t==null)return t;var p=[],m=0;return Of(t,p,"","",function(b){return n.call(a,b,m++)}),p}function sE(t){if(t._status===-1){var n=t._result;n=n(),n.then(function(a){(t._status===0||t._status===-1)&&(t._status=1,t._result=a)},function(a){(t._status===0||t._status===-1)&&(t._status=2,t._result=a)}),t._status===-1&&(t._status=0,t._result=n)}if(t._status===1)return t._result.default;throw t._result}var ri={current:null},jf={transition:null},aE={ReactCurrentDispatcher:ri,ReactCurrentBatchConfig:jf,ReactCurrentOwner:F0};function Uw(){throw Error("act(...) is not supported in production builds of React.")}jt.Children={map:gf,forEach:function(t,n,a){gf(t,function(){n.apply(this,arguments)},a)},count:function(t){var n=0;return gf(t,function(){n++}),n},toArray:function(t){return gf(t,function(n){return n})||[]},only:function(t){if(!B0(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};jt.Component=wu;jt.Fragment=HC;jt.Profiler=KC;jt.PureComponent=L0;jt.StrictMode=XC;jt.Suspense=eE;jt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=aE;jt.act=Uw;jt.cloneElement=function(t,n,a){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var p=Bw({},t.props),m=t.key,b=t.ref,x=t._owner;if(n!=null){if(n.ref!==void 0&&(b=n.ref,x=F0.current),n.key!==void 0&&(m=""+n.key),t.type&&t.type.defaultProps)var c=t.type.defaultProps;for(A in n)Nw.call(n,A)&&!$w.hasOwnProperty(A)&&(p[A]=n[A]===void 0&&c!==void 0?c[A]:n[A])}var A=arguments.length-2;if(A===1)p.children=a;else if(1<A){c=Array(A);for(var j=0;j<A;j++)c[j]=arguments[j+2];p.children=c}return{$$typeof:Gd,type:t.type,key:m,ref:b,props:p,_owner:x}};jt.createContext=function(t){return t={$$typeof:QC,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:YC,_context:t},t.Consumer=t};jt.createElement=Vw;jt.createFactory=function(t){var n=Vw.bind(null,t);return n.type=t,n};jt.createRef=function(){return{current:null}};jt.forwardRef=function(t){return{$$typeof:JC,render:t}};jt.isValidElement=B0;jt.lazy=function(t){return{$$typeof:rE,_payload:{_status:-1,_result:t},_init:sE}};jt.memo=function(t,n){return{$$typeof:tE,type:t,compare:n===void 0?null:n}};jt.startTransition=function(t){var n=jf.transition;jf.transition={};try{t()}finally{jf.transition=n}};jt.unstable_act=Uw;jt.useCallback=function(t,n){return ri.current.useCallback(t,n)};jt.useContext=function(t){return ri.current.useContext(t)};jt.useDebugValue=function(){};jt.useDeferredValue=function(t){return ri.current.useDeferredValue(t)};jt.useEffect=function(t,n){return ri.current.useEffect(t,n)};jt.useId=function(){return ri.current.useId()};jt.useImperativeHandle=function(t,n,a){return ri.current.useImperativeHandle(t,n,a)};jt.useInsertionEffect=function(t,n){return ri.current.useInsertionEffect(t,n)};jt.useLayoutEffect=function(t,n){return ri.current.useLayoutEffect(t,n)};jt.useMemo=function(t,n){return ri.current.useMemo(t,n)};jt.useReducer=function(t,n,a){return ri.current.useReducer(t,n,a)};jt.useRef=function(t){return ri.current.useRef(t)};jt.useState=function(t){return ri.current.useState(t)};jt.useSyncExternalStore=function(t,n,a){return ri.current.useSyncExternalStore(t,n,a)};jt.useTransition=function(){return ri.current.useTransition()};jt.version="18.3.1";Dw.exports=jt;var we=Dw.exports;const Gc=Rw(we),Ey=GC({__proto__:null,default:Gc},[we]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lE=we,cE=Symbol.for("react.element"),uE=Symbol.for("react.fragment"),hE=Object.prototype.hasOwnProperty,dE=lE.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,pE={key:!0,ref:!0,__self:!0,__source:!0};function Zw(t,n,a){var p,m={},b=null,x=null;a!==void 0&&(b=""+a),n.key!==void 0&&(b=""+n.key),n.ref!==void 0&&(x=n.ref);for(p in n)hE.call(n,p)&&!pE.hasOwnProperty(p)&&(m[p]=n[p]);if(t&&t.defaultProps)for(p in n=t.defaultProps,n)m[p]===void 0&&(m[p]=n[p]);return{$$typeof:cE,type:t,key:b,ref:x,props:m,_owner:dE.current}}Fm.Fragment=uE;Fm.jsx=Zw;Fm.jsxs=Zw;Lw.exports=Fm;var tt=Lw.exports,Gw={exports:{}},ji={},qw={exports:{}},Ww={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function n(rt,ut){var Tt=rt.length;rt.push(ut);e:for(;0<Tt;){var Lt=Tt-1>>>1,Nt=rt[Lt];if(0<m(Nt,ut))rt[Lt]=ut,rt[Tt]=Nt,Tt=Lt;else break e}}function a(rt){return rt.length===0?null:rt[0]}function p(rt){if(rt.length===0)return null;var ut=rt[0],Tt=rt.pop();if(Tt!==ut){rt[0]=Tt;e:for(var Lt=0,Nt=rt.length,Xr=Nt>>>1;Lt<Xr;){var wr=2*(Lt+1)-1,fr=rt[wr],ln=wr+1,zn=rt[ln];if(0>m(fr,Tt))ln<Nt&&0>m(zn,fr)?(rt[Lt]=zn,rt[ln]=Tt,Lt=ln):(rt[Lt]=fr,rt[wr]=Tt,Lt=wr);else if(ln<Nt&&0>m(zn,Tt))rt[Lt]=zn,rt[ln]=Tt,Lt=ln;else break e}}return ut}function m(rt,ut){var Tt=rt.sortIndex-ut.sortIndex;return Tt!==0?Tt:rt.id-ut.id}if(typeof performance=="object"&&typeof performance.now=="function"){var b=performance;t.unstable_now=function(){return b.now()}}else{var x=Date,c=x.now();t.unstable_now=function(){return x.now()-c}}var A=[],j=[],Y=1,Q=null,H=3,G=!1,le=!1,ve=!1,Ae=typeof setTimeout=="function"?setTimeout:null,ee=typeof clearTimeout=="function"?clearTimeout:null,re=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function se(rt){for(var ut=a(j);ut!==null;){if(ut.callback===null)p(j);else if(ut.startTime<=rt)p(j),ut.sortIndex=ut.expirationTime,n(A,ut);else break;ut=a(j)}}function _e(rt){if(ve=!1,se(rt),!le)if(a(A)!==null)le=!0,St(De);else{var ut=a(j);ut!==null&&br(_e,ut.startTime-rt)}}function De(rt,ut){le=!1,ve&&(ve=!1,ee(We),We=-1),G=!0;var Tt=H;try{for(se(ut),Q=a(A);Q!==null&&(!(Q.expirationTime>ut)||rt&&!Ye());){var Lt=Q.callback;if(typeof Lt=="function"){Q.callback=null,H=Q.priorityLevel;var Nt=Lt(Q.expirationTime<=ut);ut=t.unstable_now(),typeof Nt=="function"?Q.callback=Nt:Q===a(A)&&p(A),se(ut)}else p(A);Q=a(A)}if(Q!==null)var Xr=!0;else{var wr=a(j);wr!==null&&br(_e,wr.startTime-ut),Xr=!1}return Xr}finally{Q=null,H=Tt,G=!1}}var Fe=!1,ze=null,We=-1,gt=5,X=-1;function Ye(){return!(t.unstable_now()-X<gt)}function at(){if(ze!==null){var rt=t.unstable_now();X=rt;var ut=!0;try{ut=ze(!0,rt)}finally{ut?ht():(Fe=!1,ze=null)}}else Fe=!1}var ht;if(typeof re=="function")ht=function(){re(at)};else if(typeof MessageChannel<"u"){var Ct=new MessageChannel,tr=Ct.port2;Ct.port1.onmessage=at,ht=function(){tr.postMessage(null)}}else ht=function(){Ae(at,0)};function St(rt){ze=rt,Fe||(Fe=!0,ht())}function br(rt,ut){We=Ae(function(){rt(t.unstable_now())},ut)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(rt){rt.callback=null},t.unstable_continueExecution=function(){le||G||(le=!0,St(De))},t.unstable_forceFrameRate=function(rt){0>rt||125<rt?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):gt=0<rt?Math.floor(1e3/rt):5},t.unstable_getCurrentPriorityLevel=function(){return H},t.unstable_getFirstCallbackNode=function(){return a(A)},t.unstable_next=function(rt){switch(H){case 1:case 2:case 3:var ut=3;break;default:ut=H}var Tt=H;H=ut;try{return rt()}finally{H=Tt}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(rt,ut){switch(rt){case 1:case 2:case 3:case 4:case 5:break;default:rt=3}var Tt=H;H=rt;try{return ut()}finally{H=Tt}},t.unstable_scheduleCallback=function(rt,ut,Tt){var Lt=t.unstable_now();switch(typeof Tt=="object"&&Tt!==null?(Tt=Tt.delay,Tt=typeof Tt=="number"&&0<Tt?Lt+Tt:Lt):Tt=Lt,rt){case 1:var Nt=-1;break;case 2:Nt=250;break;case 5:Nt=1073741823;break;case 4:Nt=1e4;break;default:Nt=5e3}return Nt=Tt+Nt,rt={id:Y++,callback:ut,priorityLevel:rt,startTime:Tt,expirationTime:Nt,sortIndex:-1},Tt>Lt?(rt.sortIndex=Tt,n(j,rt),a(A)===null&&rt===a(j)&&(ve?(ee(We),We=-1):ve=!0,br(_e,Tt-Lt))):(rt.sortIndex=Nt,n(A,rt),le||G||(le=!0,St(De))),rt},t.unstable_shouldYield=Ye,t.unstable_wrapCallback=function(rt){var ut=H;return function(){var Tt=H;H=ut;try{return rt.apply(this,arguments)}finally{H=Tt}}}})(Ww);qw.exports=Ww;var fE=qw.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mE=we,Bi=fE;function Je(t){for(var n="https://reactjs.org/docs/error-decoder.html?invariant="+t,a=1;a<arguments.length;a++)n+="&args[]="+encodeURIComponent(arguments[a]);return"Minified React error #"+t+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Hw=new Set,Sd={};function El(t,n){du(t,n),du(t+"Capture",n)}function du(t,n){for(Sd[t]=n,t=0;t<n.length;t++)Hw.add(n[t])}var Ls=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),My=Object.prototype.hasOwnProperty,gE=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Z1={},G1={};function _E(t){return My.call(G1,t)?!0:My.call(Z1,t)?!1:gE.test(t)?G1[t]=!0:(Z1[t]=!0,!1)}function yE(t,n,a,p){if(a!==null&&a.type===0)return!1;switch(typeof n){case"function":case"symbol":return!0;case"boolean":return p?!1:a!==null?!a.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function vE(t,n,a,p){if(n===null||typeof n>"u"||yE(t,n,a,p))return!0;if(p)return!1;if(a!==null)switch(a.type){case 3:return!n;case 4:return n===!1;case 5:return isNaN(n);case 6:return isNaN(n)||1>n}return!1}function ni(t,n,a,p,m,b,x){this.acceptsBooleans=n===2||n===3||n===4,this.attributeName=p,this.attributeNamespace=m,this.mustUseProperty=a,this.propertyName=t,this.type=n,this.sanitizeURL=b,this.removeEmptyString=x}var An={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){An[t]=new ni(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var n=t[0];An[n]=new ni(n,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){An[t]=new ni(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){An[t]=new ni(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){An[t]=new ni(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){An[t]=new ni(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){An[t]=new ni(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){An[t]=new ni(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){An[t]=new ni(t,5,!1,t.toLowerCase(),null,!1,!1)});var O0=/[\-:]([a-z])/g;function j0(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var n=t.replace(O0,j0);An[n]=new ni(n,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var n=t.replace(O0,j0);An[n]=new ni(n,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var n=t.replace(O0,j0);An[n]=new ni(n,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){An[t]=new ni(t,1,!1,t.toLowerCase(),null,!1,!1)});An.xlinkHref=new ni("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){An[t]=new ni(t,1,!1,t.toLowerCase(),null,!0,!0)});function N0(t,n,a,p){var m=An.hasOwnProperty(n)?An[n]:null;(m!==null?m.type!==0:p||!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(vE(n,a,m,p)&&(a=null),p||m===null?_E(n)&&(a===null?t.removeAttribute(n):t.setAttribute(n,""+a)):m.mustUseProperty?t[m.propertyName]=a===null?m.type===3?!1:"":a:(n=m.attributeName,p=m.attributeNamespace,a===null?t.removeAttribute(n):(m=m.type,a=m===3||m===4&&a===!0?"":""+a,p?t.setAttributeNS(p,n,a):t.setAttribute(n,a))))}var Ns=mE.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,_f=Symbol.for("react.element"),qc=Symbol.for("react.portal"),Wc=Symbol.for("react.fragment"),$0=Symbol.for("react.strict_mode"),Iy=Symbol.for("react.profiler"),Xw=Symbol.for("react.provider"),Kw=Symbol.for("react.context"),V0=Symbol.for("react.forward_ref"),ky=Symbol.for("react.suspense"),Ay=Symbol.for("react.suspense_list"),U0=Symbol.for("react.memo"),_a=Symbol.for("react.lazy"),Yw=Symbol.for("react.offscreen"),q1=Symbol.iterator;function Xh(t){return t===null||typeof t!="object"?null:(t=q1&&t[q1]||t["@@iterator"],typeof t=="function"?t:null)}var Rr=Object.assign,K_;function sd(t){if(K_===void 0)try{throw Error()}catch(a){var n=a.stack.trim().match(/\n( *(at )?)/);K_=n&&n[1]||""}return`
`+K_+t}var Y_=!1;function Q_(t,n){if(!t||Y_)return"";Y_=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(n)if(n=function(){throw Error()},Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(n,[])}catch(j){var p=j}Reflect.construct(t,[],n)}else{try{n.call()}catch(j){p=j}t.call(n.prototype)}else{try{throw Error()}catch(j){p=j}t()}}catch(j){if(j&&p&&typeof j.stack=="string"){for(var m=j.stack.split(`
`),b=p.stack.split(`
`),x=m.length-1,c=b.length-1;1<=x&&0<=c&&m[x]!==b[c];)c--;for(;1<=x&&0<=c;x--,c--)if(m[x]!==b[c]){if(x!==1||c!==1)do if(x--,c--,0>c||m[x]!==b[c]){var A=`
`+m[x].replace(" at new "," at ");return t.displayName&&A.includes("<anonymous>")&&(A=A.replace("<anonymous>",t.displayName)),A}while(1<=x&&0<=c);break}}}finally{Y_=!1,Error.prepareStackTrace=a}return(t=t?t.displayName||t.name:"")?sd(t):""}function xE(t){switch(t.tag){case 5:return sd(t.type);case 16:return sd("Lazy");case 13:return sd("Suspense");case 19:return sd("SuspenseList");case 0:case 2:case 15:return t=Q_(t.type,!1),t;case 11:return t=Q_(t.type.render,!1),t;case 1:return t=Q_(t.type,!0),t;default:return""}}function zy(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Wc:return"Fragment";case qc:return"Portal";case Iy:return"Profiler";case $0:return"StrictMode";case ky:return"Suspense";case Ay:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Kw:return(t.displayName||"Context")+".Consumer";case Xw:return(t._context.displayName||"Context")+".Provider";case V0:var n=t.render;return t=t.displayName,t||(t=n.displayName||n.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case U0:return n=t.displayName||null,n!==null?n:zy(t.type)||"Memo";case _a:n=t._payload,t=t._init;try{return zy(t(n))}catch{}}return null}function bE(t){var n=t.type;switch(t.tag){case 24:return"Cache";case 9:return(n.displayName||"Context")+".Consumer";case 10:return(n._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=n.render,t=t.displayName||t.name||"",n.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return n;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return zy(n);case 8:return n===$0?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n}return null}function za(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Qw(t){var n=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function wE(t){var n=Qw(t)?"checked":"value",a=Object.getOwnPropertyDescriptor(t.constructor.prototype,n),p=""+t[n];if(!t.hasOwnProperty(n)&&typeof a<"u"&&typeof a.get=="function"&&typeof a.set=="function"){var m=a.get,b=a.set;return Object.defineProperty(t,n,{configurable:!0,get:function(){return m.call(this)},set:function(x){p=""+x,b.call(this,x)}}),Object.defineProperty(t,n,{enumerable:a.enumerable}),{getValue:function(){return p},setValue:function(x){p=""+x},stopTracking:function(){t._valueTracker=null,delete t[n]}}}}function yf(t){t._valueTracker||(t._valueTracker=wE(t))}function Jw(t){if(!t)return!1;var n=t._valueTracker;if(!n)return!0;var a=n.getValue(),p="";return t&&(p=Qw(t)?t.checked?"true":"false":t.value),t=p,t!==a?(n.setValue(t),!0):!1}function im(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Ry(t,n){var a=n.checked;return Rr({},n,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:a??t._wrapperState.initialChecked})}function W1(t,n){var a=n.defaultValue==null?"":n.defaultValue,p=n.checked!=null?n.checked:n.defaultChecked;a=za(n.value!=null?n.value:a),t._wrapperState={initialChecked:p,initialValue:a,controlled:n.type==="checkbox"||n.type==="radio"?n.checked!=null:n.value!=null}}function e2(t,n){n=n.checked,n!=null&&N0(t,"checked",n,!1)}function Ly(t,n){e2(t,n);var a=za(n.value),p=n.type;if(a!=null)p==="number"?(a===0&&t.value===""||t.value!=a)&&(t.value=""+a):t.value!==""+a&&(t.value=""+a);else if(p==="submit"||p==="reset"){t.removeAttribute("value");return}n.hasOwnProperty("value")?Dy(t,n.type,a):n.hasOwnProperty("defaultValue")&&Dy(t,n.type,za(n.defaultValue)),n.checked==null&&n.defaultChecked!=null&&(t.defaultChecked=!!n.defaultChecked)}function H1(t,n,a){if(n.hasOwnProperty("value")||n.hasOwnProperty("defaultValue")){var p=n.type;if(!(p!=="submit"&&p!=="reset"||n.value!==void 0&&n.value!==null))return;n=""+t._wrapperState.initialValue,a||n===t.value||(t.value=n),t.defaultValue=n}a=t.name,a!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,a!==""&&(t.name=a)}function Dy(t,n,a){(n!=="number"||im(t.ownerDocument)!==t)&&(a==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+a&&(t.defaultValue=""+a))}var ad=Array.isArray;function iu(t,n,a,p){if(t=t.options,n){n={};for(var m=0;m<a.length;m++)n["$"+a[m]]=!0;for(a=0;a<t.length;a++)m=n.hasOwnProperty("$"+t[a].value),t[a].selected!==m&&(t[a].selected=m),m&&p&&(t[a].defaultSelected=!0)}else{for(a=""+za(a),n=null,m=0;m<t.length;m++){if(t[m].value===a){t[m].selected=!0,p&&(t[m].defaultSelected=!0);return}n!==null||t[m].disabled||(n=t[m])}n!==null&&(n.selected=!0)}}function Fy(t,n){if(n.dangerouslySetInnerHTML!=null)throw Error(Je(91));return Rr({},n,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function X1(t,n){var a=n.value;if(a==null){if(a=n.children,n=n.defaultValue,a!=null){if(n!=null)throw Error(Je(92));if(ad(a)){if(1<a.length)throw Error(Je(93));a=a[0]}n=a}n==null&&(n=""),a=n}t._wrapperState={initialValue:za(a)}}function t2(t,n){var a=za(n.value),p=za(n.defaultValue);a!=null&&(a=""+a,a!==t.value&&(t.value=a),n.defaultValue==null&&t.defaultValue!==a&&(t.defaultValue=a)),p!=null&&(t.defaultValue=""+p)}function K1(t){var n=t.textContent;n===t._wrapperState.initialValue&&n!==""&&n!==null&&(t.value=n)}function r2(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function By(t,n){return t==null||t==="http://www.w3.org/1999/xhtml"?r2(n):t==="http://www.w3.org/2000/svg"&&n==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var vf,n2=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(n,a,p,m){MSApp.execUnsafeLocalFunction(function(){return t(n,a,p,m)})}:t}(function(t,n){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=n;else{for(vf=vf||document.createElement("div"),vf.innerHTML="<svg>"+n.valueOf().toString()+"</svg>",n=vf.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;n.firstChild;)t.appendChild(n.firstChild)}});function Td(t,n){if(n){var a=t.firstChild;if(a&&a===t.lastChild&&a.nodeType===3){a.nodeValue=n;return}}t.textContent=n}var pd={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},SE=["Webkit","ms","Moz","O"];Object.keys(pd).forEach(function(t){SE.forEach(function(n){n=n+t.charAt(0).toUpperCase()+t.substring(1),pd[n]=pd[t]})});function i2(t,n,a){return n==null||typeof n=="boolean"||n===""?"":a||typeof n!="number"||n===0||pd.hasOwnProperty(t)&&pd[t]?(""+n).trim():n+"px"}function o2(t,n){t=t.style;for(var a in n)if(n.hasOwnProperty(a)){var p=a.indexOf("--")===0,m=i2(a,n[a],p);a==="float"&&(a="cssFloat"),p?t.setProperty(a,m):t[a]=m}}var TE=Rr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Oy(t,n){if(n){if(TE[t]&&(n.children!=null||n.dangerouslySetInnerHTML!=null))throw Error(Je(137,t));if(n.dangerouslySetInnerHTML!=null){if(n.children!=null)throw Error(Je(60));if(typeof n.dangerouslySetInnerHTML!="object"||!("__html"in n.dangerouslySetInnerHTML))throw Error(Je(61))}if(n.style!=null&&typeof n.style!="object")throw Error(Je(62))}}function jy(t,n){if(t.indexOf("-")===-1)return typeof n.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ny=null;function Z0(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var $y=null,ou=null,su=null;function Y1(t){if(t=Hd(t)){if(typeof $y!="function")throw Error(Je(280));var n=t.stateNode;n&&(n=$m(n),$y(t.stateNode,t.type,n))}}function s2(t){ou?su?su.push(t):su=[t]:ou=t}function a2(){if(ou){var t=ou,n=su;if(su=ou=null,Y1(t),n)for(t=0;t<n.length;t++)Y1(n[t])}}function l2(t,n){return t(n)}function c2(){}var J_=!1;function u2(t,n,a){if(J_)return t(n,a);J_=!0;try{return l2(t,n,a)}finally{J_=!1,(ou!==null||su!==null)&&(c2(),a2())}}function Pd(t,n){var a=t.stateNode;if(a===null)return null;var p=$m(a);if(p===null)return null;a=p[n];e:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(t=t.type,p=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!p;break e;default:t=!1}if(t)return null;if(a&&typeof a!="function")throw Error(Je(231,n,typeof a));return a}var Vy=!1;if(Ls)try{var Kh={};Object.defineProperty(Kh,"passive",{get:function(){Vy=!0}}),window.addEventListener("test",Kh,Kh),window.removeEventListener("test",Kh,Kh)}catch{Vy=!1}function PE(t,n,a,p,m,b,x,c,A){var j=Array.prototype.slice.call(arguments,3);try{n.apply(a,j)}catch(Y){this.onError(Y)}}var fd=!1,om=null,sm=!1,Uy=null,CE={onError:function(t){fd=!0,om=t}};function EE(t,n,a,p,m,b,x,c,A){fd=!1,om=null,PE.apply(CE,arguments)}function ME(t,n,a,p,m,b,x,c,A){if(EE.apply(this,arguments),fd){if(fd){var j=om;fd=!1,om=null}else throw Error(Je(198));sm||(sm=!0,Uy=j)}}function Ml(t){var n=t,a=t;if(t.alternate)for(;n.return;)n=n.return;else{t=n;do n=t,n.flags&4098&&(a=n.return),t=n.return;while(t)}return n.tag===3?a:null}function h2(t){if(t.tag===13){var n=t.memoizedState;if(n===null&&(t=t.alternate,t!==null&&(n=t.memoizedState)),n!==null)return n.dehydrated}return null}function Q1(t){if(Ml(t)!==t)throw Error(Je(188))}function IE(t){var n=t.alternate;if(!n){if(n=Ml(t),n===null)throw Error(Je(188));return n!==t?null:t}for(var a=t,p=n;;){var m=a.return;if(m===null)break;var b=m.alternate;if(b===null){if(p=m.return,p!==null){a=p;continue}break}if(m.child===b.child){for(b=m.child;b;){if(b===a)return Q1(m),t;if(b===p)return Q1(m),n;b=b.sibling}throw Error(Je(188))}if(a.return!==p.return)a=m,p=b;else{for(var x=!1,c=m.child;c;){if(c===a){x=!0,a=m,p=b;break}if(c===p){x=!0,p=m,a=b;break}c=c.sibling}if(!x){for(c=b.child;c;){if(c===a){x=!0,a=b,p=m;break}if(c===p){x=!0,p=b,a=m;break}c=c.sibling}if(!x)throw Error(Je(189))}}if(a.alternate!==p)throw Error(Je(190))}if(a.tag!==3)throw Error(Je(188));return a.stateNode.current===a?t:n}function d2(t){return t=IE(t),t!==null?p2(t):null}function p2(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var n=p2(t);if(n!==null)return n;t=t.sibling}return null}var f2=Bi.unstable_scheduleCallback,J1=Bi.unstable_cancelCallback,kE=Bi.unstable_shouldYield,AE=Bi.unstable_requestPaint,Wr=Bi.unstable_now,zE=Bi.unstable_getCurrentPriorityLevel,G0=Bi.unstable_ImmediatePriority,m2=Bi.unstable_UserBlockingPriority,am=Bi.unstable_NormalPriority,RE=Bi.unstable_LowPriority,g2=Bi.unstable_IdlePriority,Bm=null,Wo=null;function LE(t){if(Wo&&typeof Wo.onCommitFiberRoot=="function")try{Wo.onCommitFiberRoot(Bm,t,void 0,(t.current.flags&128)===128)}catch{}}var To=Math.clz32?Math.clz32:BE,DE=Math.log,FE=Math.LN2;function BE(t){return t>>>=0,t===0?32:31-(DE(t)/FE|0)|0}var xf=64,bf=4194304;function ld(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function lm(t,n){var a=t.pendingLanes;if(a===0)return 0;var p=0,m=t.suspendedLanes,b=t.pingedLanes,x=a&268435455;if(x!==0){var c=x&~m;c!==0?p=ld(c):(b&=x,b!==0&&(p=ld(b)))}else x=a&~m,x!==0?p=ld(x):b!==0&&(p=ld(b));if(p===0)return 0;if(n!==0&&n!==p&&!(n&m)&&(m=p&-p,b=n&-n,m>=b||m===16&&(b&4194240)!==0))return n;if(p&4&&(p|=a&16),n=t.entangledLanes,n!==0)for(t=t.entanglements,n&=p;0<n;)a=31-To(n),m=1<<a,p|=t[a],n&=~m;return p}function OE(t,n){switch(t){case 1:case 2:case 4:return n+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function jE(t,n){for(var a=t.suspendedLanes,p=t.pingedLanes,m=t.expirationTimes,b=t.pendingLanes;0<b;){var x=31-To(b),c=1<<x,A=m[x];A===-1?(!(c&a)||c&p)&&(m[x]=OE(c,n)):A<=n&&(t.expiredLanes|=c),b&=~c}}function Zy(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function _2(){var t=xf;return xf<<=1,!(xf&4194240)&&(xf=64),t}function ey(t){for(var n=[],a=0;31>a;a++)n.push(t);return n}function qd(t,n,a){t.pendingLanes|=n,n!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,n=31-To(n),t[n]=a}function NE(t,n){var a=t.pendingLanes&~n;t.pendingLanes=n,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=n,t.mutableReadLanes&=n,t.entangledLanes&=n,n=t.entanglements;var p=t.eventTimes;for(t=t.expirationTimes;0<a;){var m=31-To(a),b=1<<m;n[m]=0,p[m]=-1,t[m]=-1,a&=~b}}function q0(t,n){var a=t.entangledLanes|=n;for(t=t.entanglements;a;){var p=31-To(a),m=1<<p;m&n|t[p]&n&&(t[p]|=n),a&=~m}}var Jt=0;function y2(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var v2,W0,x2,b2,w2,Gy=!1,wf=[],Ta=null,Pa=null,Ca=null,Cd=new Map,Ed=new Map,va=[],$E="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function eb(t,n){switch(t){case"focusin":case"focusout":Ta=null;break;case"dragenter":case"dragleave":Pa=null;break;case"mouseover":case"mouseout":Ca=null;break;case"pointerover":case"pointerout":Cd.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ed.delete(n.pointerId)}}function Yh(t,n,a,p,m,b){return t===null||t.nativeEvent!==b?(t={blockedOn:n,domEventName:a,eventSystemFlags:p,nativeEvent:b,targetContainers:[m]},n!==null&&(n=Hd(n),n!==null&&W0(n)),t):(t.eventSystemFlags|=p,n=t.targetContainers,m!==null&&n.indexOf(m)===-1&&n.push(m),t)}function VE(t,n,a,p,m){switch(n){case"focusin":return Ta=Yh(Ta,t,n,a,p,m),!0;case"dragenter":return Pa=Yh(Pa,t,n,a,p,m),!0;case"mouseover":return Ca=Yh(Ca,t,n,a,p,m),!0;case"pointerover":var b=m.pointerId;return Cd.set(b,Yh(Cd.get(b)||null,t,n,a,p,m)),!0;case"gotpointercapture":return b=m.pointerId,Ed.set(b,Yh(Ed.get(b)||null,t,n,a,p,m)),!0}return!1}function S2(t){var n=ml(t.target);if(n!==null){var a=Ml(n);if(a!==null){if(n=a.tag,n===13){if(n=h2(a),n!==null){t.blockedOn=n,w2(t.priority,function(){x2(a)});return}}else if(n===3&&a.stateNode.current.memoizedState.isDehydrated){t.blockedOn=a.tag===3?a.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Nf(t){if(t.blockedOn!==null)return!1;for(var n=t.targetContainers;0<n.length;){var a=qy(t.domEventName,t.eventSystemFlags,n[0],t.nativeEvent);if(a===null){a=t.nativeEvent;var p=new a.constructor(a.type,a);Ny=p,a.target.dispatchEvent(p),Ny=null}else return n=Hd(a),n!==null&&W0(n),t.blockedOn=a,!1;n.shift()}return!0}function tb(t,n,a){Nf(t)&&a.delete(n)}function UE(){Gy=!1,Ta!==null&&Nf(Ta)&&(Ta=null),Pa!==null&&Nf(Pa)&&(Pa=null),Ca!==null&&Nf(Ca)&&(Ca=null),Cd.forEach(tb),Ed.forEach(tb)}function Qh(t,n){t.blockedOn===n&&(t.blockedOn=null,Gy||(Gy=!0,Bi.unstable_scheduleCallback(Bi.unstable_NormalPriority,UE)))}function Md(t){function n(m){return Qh(m,t)}if(0<wf.length){Qh(wf[0],t);for(var a=1;a<wf.length;a++){var p=wf[a];p.blockedOn===t&&(p.blockedOn=null)}}for(Ta!==null&&Qh(Ta,t),Pa!==null&&Qh(Pa,t),Ca!==null&&Qh(Ca,t),Cd.forEach(n),Ed.forEach(n),a=0;a<va.length;a++)p=va[a],p.blockedOn===t&&(p.blockedOn=null);for(;0<va.length&&(a=va[0],a.blockedOn===null);)S2(a),a.blockedOn===null&&va.shift()}var au=Ns.ReactCurrentBatchConfig,cm=!0;function ZE(t,n,a,p){var m=Jt,b=au.transition;au.transition=null;try{Jt=1,H0(t,n,a,p)}finally{Jt=m,au.transition=b}}function GE(t,n,a,p){var m=Jt,b=au.transition;au.transition=null;try{Jt=4,H0(t,n,a,p)}finally{Jt=m,au.transition=b}}function H0(t,n,a,p){if(cm){var m=qy(t,n,a,p);if(m===null)uy(t,n,p,um,a),eb(t,p);else if(VE(m,t,n,a,p))p.stopPropagation();else if(eb(t,p),n&4&&-1<$E.indexOf(t)){for(;m!==null;){var b=Hd(m);if(b!==null&&v2(b),b=qy(t,n,a,p),b===null&&uy(t,n,p,um,a),b===m)break;m=b}m!==null&&p.stopPropagation()}else uy(t,n,p,null,a)}}var um=null;function qy(t,n,a,p){if(um=null,t=Z0(p),t=ml(t),t!==null)if(n=Ml(t),n===null)t=null;else if(a=n.tag,a===13){if(t=h2(n),t!==null)return t;t=null}else if(a===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;t=null}else n!==t&&(t=null);return um=t,null}function T2(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(zE()){case G0:return 1;case m2:return 4;case am:case RE:return 16;case g2:return 536870912;default:return 16}default:return 16}}var ba=null,X0=null,$f=null;function P2(){if($f)return $f;var t,n=X0,a=n.length,p,m="value"in ba?ba.value:ba.textContent,b=m.length;for(t=0;t<a&&n[t]===m[t];t++);var x=a-t;for(p=1;p<=x&&n[a-p]===m[b-p];p++);return $f=m.slice(t,1<p?1-p:void 0)}function Vf(t){var n=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&n===13&&(t=13)):t=n,t===10&&(t=13),32<=t||t===13?t:0}function Sf(){return!0}function rb(){return!1}function Ni(t){function n(a,p,m,b,x){this._reactName=a,this._targetInst=m,this.type=p,this.nativeEvent=b,this.target=x,this.currentTarget=null;for(var c in t)t.hasOwnProperty(c)&&(a=t[c],this[c]=a?a(b):b[c]);return this.isDefaultPrevented=(b.defaultPrevented!=null?b.defaultPrevented:b.returnValue===!1)?Sf:rb,this.isPropagationStopped=rb,this}return Rr(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():typeof a.returnValue!="unknown"&&(a.returnValue=!1),this.isDefaultPrevented=Sf)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():typeof a.cancelBubble!="unknown"&&(a.cancelBubble=!0),this.isPropagationStopped=Sf)},persist:function(){},isPersistent:Sf}),n}var Su={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},K0=Ni(Su),Wd=Rr({},Su,{view:0,detail:0}),qE=Ni(Wd),ty,ry,Jh,Om=Rr({},Wd,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Y0,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Jh&&(Jh&&t.type==="mousemove"?(ty=t.screenX-Jh.screenX,ry=t.screenY-Jh.screenY):ry=ty=0,Jh=t),ty)},movementY:function(t){return"movementY"in t?t.movementY:ry}}),nb=Ni(Om),WE=Rr({},Om,{dataTransfer:0}),HE=Ni(WE),XE=Rr({},Wd,{relatedTarget:0}),ny=Ni(XE),KE=Rr({},Su,{animationName:0,elapsedTime:0,pseudoElement:0}),YE=Ni(KE),QE=Rr({},Su,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),JE=Ni(QE),eM=Rr({},Su,{data:0}),ib=Ni(eM),tM={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},rM={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},nM={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function iM(t){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(t):(t=nM[t])?!!n[t]:!1}function Y0(){return iM}var oM=Rr({},Wd,{key:function(t){if(t.key){var n=tM[t.key]||t.key;if(n!=="Unidentified")return n}return t.type==="keypress"?(t=Vf(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?rM[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Y0,charCode:function(t){return t.type==="keypress"?Vf(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Vf(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),sM=Ni(oM),aM=Rr({},Om,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ob=Ni(aM),lM=Rr({},Wd,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Y0}),cM=Ni(lM),uM=Rr({},Su,{propertyName:0,elapsedTime:0,pseudoElement:0}),hM=Ni(uM),dM=Rr({},Om,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),pM=Ni(dM),fM=[9,13,27,32],Q0=Ls&&"CompositionEvent"in window,md=null;Ls&&"documentMode"in document&&(md=document.documentMode);var mM=Ls&&"TextEvent"in window&&!md,C2=Ls&&(!Q0||md&&8<md&&11>=md),sb=" ",ab=!1;function E2(t,n){switch(t){case"keyup":return fM.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function M2(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Hc=!1;function gM(t,n){switch(t){case"compositionend":return M2(n);case"keypress":return n.which!==32?null:(ab=!0,sb);case"textInput":return t=n.data,t===sb&&ab?null:t;default:return null}}function _M(t,n){if(Hc)return t==="compositionend"||!Q0&&E2(t,n)?(t=P2(),$f=X0=ba=null,Hc=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return C2&&n.locale!=="ko"?null:n.data;default:return null}}var yM={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function lb(t){var n=t&&t.nodeName&&t.nodeName.toLowerCase();return n==="input"?!!yM[t.type]:n==="textarea"}function I2(t,n,a,p){s2(p),n=hm(n,"onChange"),0<n.length&&(a=new K0("onChange","change",null,a,p),t.push({event:a,listeners:n}))}var gd=null,Id=null;function vM(t){N2(t,0)}function jm(t){var n=Yc(t);if(Jw(n))return t}function xM(t,n){if(t==="change")return n}var k2=!1;if(Ls){var iy;if(Ls){var oy="oninput"in document;if(!oy){var cb=document.createElement("div");cb.setAttribute("oninput","return;"),oy=typeof cb.oninput=="function"}iy=oy}else iy=!1;k2=iy&&(!document.documentMode||9<document.documentMode)}function ub(){gd&&(gd.detachEvent("onpropertychange",A2),Id=gd=null)}function A2(t){if(t.propertyName==="value"&&jm(Id)){var n=[];I2(n,Id,t,Z0(t)),u2(vM,n)}}function bM(t,n,a){t==="focusin"?(ub(),gd=n,Id=a,gd.attachEvent("onpropertychange",A2)):t==="focusout"&&ub()}function wM(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return jm(Id)}function SM(t,n){if(t==="click")return jm(n)}function TM(t,n){if(t==="input"||t==="change")return jm(n)}function PM(t,n){return t===n&&(t!==0||1/t===1/n)||t!==t&&n!==n}var Co=typeof Object.is=="function"?Object.is:PM;function kd(t,n){if(Co(t,n))return!0;if(typeof t!="object"||t===null||typeof n!="object"||n===null)return!1;var a=Object.keys(t),p=Object.keys(n);if(a.length!==p.length)return!1;for(p=0;p<a.length;p++){var m=a[p];if(!My.call(n,m)||!Co(t[m],n[m]))return!1}return!0}function hb(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function db(t,n){var a=hb(t);t=0;for(var p;a;){if(a.nodeType===3){if(p=t+a.textContent.length,t<=n&&p>=n)return{node:a,offset:n-t};t=p}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=hb(a)}}function z2(t,n){return t&&n?t===n?!0:t&&t.nodeType===3?!1:n&&n.nodeType===3?z2(t,n.parentNode):"contains"in t?t.contains(n):t.compareDocumentPosition?!!(t.compareDocumentPosition(n)&16):!1:!1}function R2(){for(var t=window,n=im();n instanceof t.HTMLIFrameElement;){try{var a=typeof n.contentWindow.location.href=="string"}catch{a=!1}if(a)t=n.contentWindow;else break;n=im(t.document)}return n}function J0(t){var n=t&&t.nodeName&&t.nodeName.toLowerCase();return n&&(n==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||n==="textarea"||t.contentEditable==="true")}function CM(t){var n=R2(),a=t.focusedElem,p=t.selectionRange;if(n!==a&&a&&a.ownerDocument&&z2(a.ownerDocument.documentElement,a)){if(p!==null&&J0(a)){if(n=p.start,t=p.end,t===void 0&&(t=n),"selectionStart"in a)a.selectionStart=n,a.selectionEnd=Math.min(t,a.value.length);else if(t=(n=a.ownerDocument||document)&&n.defaultView||window,t.getSelection){t=t.getSelection();var m=a.textContent.length,b=Math.min(p.start,m);p=p.end===void 0?b:Math.min(p.end,m),!t.extend&&b>p&&(m=p,p=b,b=m),m=db(a,b);var x=db(a,p);m&&x&&(t.rangeCount!==1||t.anchorNode!==m.node||t.anchorOffset!==m.offset||t.focusNode!==x.node||t.focusOffset!==x.offset)&&(n=n.createRange(),n.setStart(m.node,m.offset),t.removeAllRanges(),b>p?(t.addRange(n),t.extend(x.node,x.offset)):(n.setEnd(x.node,x.offset),t.addRange(n)))}}for(n=[],t=a;t=t.parentNode;)t.nodeType===1&&n.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof a.focus=="function"&&a.focus(),a=0;a<n.length;a++)t=n[a],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var EM=Ls&&"documentMode"in document&&11>=document.documentMode,Xc=null,Wy=null,_d=null,Hy=!1;function pb(t,n,a){var p=a.window===a?a.document:a.nodeType===9?a:a.ownerDocument;Hy||Xc==null||Xc!==im(p)||(p=Xc,"selectionStart"in p&&J0(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),_d&&kd(_d,p)||(_d=p,p=hm(Wy,"onSelect"),0<p.length&&(n=new K0("onSelect","select",null,n,a),t.push({event:n,listeners:p}),n.target=Xc)))}function Tf(t,n){var a={};return a[t.toLowerCase()]=n.toLowerCase(),a["Webkit"+t]="webkit"+n,a["Moz"+t]="moz"+n,a}var Kc={animationend:Tf("Animation","AnimationEnd"),animationiteration:Tf("Animation","AnimationIteration"),animationstart:Tf("Animation","AnimationStart"),transitionend:Tf("Transition","TransitionEnd")},sy={},L2={};Ls&&(L2=document.createElement("div").style,"AnimationEvent"in window||(delete Kc.animationend.animation,delete Kc.animationiteration.animation,delete Kc.animationstart.animation),"TransitionEvent"in window||delete Kc.transitionend.transition);function Nm(t){if(sy[t])return sy[t];if(!Kc[t])return t;var n=Kc[t],a;for(a in n)if(n.hasOwnProperty(a)&&a in L2)return sy[t]=n[a];return t}var D2=Nm("animationend"),F2=Nm("animationiteration"),B2=Nm("animationstart"),O2=Nm("transitionend"),j2=new Map,fb="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Da(t,n){j2.set(t,n),El(n,[t])}for(var ay=0;ay<fb.length;ay++){var ly=fb[ay],MM=ly.toLowerCase(),IM=ly[0].toUpperCase()+ly.slice(1);Da(MM,"on"+IM)}Da(D2,"onAnimationEnd");Da(F2,"onAnimationIteration");Da(B2,"onAnimationStart");Da("dblclick","onDoubleClick");Da("focusin","onFocus");Da("focusout","onBlur");Da(O2,"onTransitionEnd");du("onMouseEnter",["mouseout","mouseover"]);du("onMouseLeave",["mouseout","mouseover"]);du("onPointerEnter",["pointerout","pointerover"]);du("onPointerLeave",["pointerout","pointerover"]);El("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));El("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));El("onBeforeInput",["compositionend","keypress","textInput","paste"]);El("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));El("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));El("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var cd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),kM=new Set("cancel close invalid load scroll toggle".split(" ").concat(cd));function mb(t,n,a){var p=t.type||"unknown-event";t.currentTarget=a,ME(p,n,void 0,t),t.currentTarget=null}function N2(t,n){n=(n&4)!==0;for(var a=0;a<t.length;a++){var p=t[a],m=p.event;p=p.listeners;e:{var b=void 0;if(n)for(var x=p.length-1;0<=x;x--){var c=p[x],A=c.instance,j=c.currentTarget;if(c=c.listener,A!==b&&m.isPropagationStopped())break e;mb(m,c,j),b=A}else for(x=0;x<p.length;x++){if(c=p[x],A=c.instance,j=c.currentTarget,c=c.listener,A!==b&&m.isPropagationStopped())break e;mb(m,c,j),b=A}}}if(sm)throw t=Uy,sm=!1,Uy=null,t}function vr(t,n){var a=n[Jy];a===void 0&&(a=n[Jy]=new Set);var p=t+"__bubble";a.has(p)||($2(n,t,2,!1),a.add(p))}function cy(t,n,a){var p=0;n&&(p|=4),$2(a,t,p,n)}var Pf="_reactListening"+Math.random().toString(36).slice(2);function Ad(t){if(!t[Pf]){t[Pf]=!0,Hw.forEach(function(a){a!=="selectionchange"&&(kM.has(a)||cy(a,!1,t),cy(a,!0,t))});var n=t.nodeType===9?t:t.ownerDocument;n===null||n[Pf]||(n[Pf]=!0,cy("selectionchange",!1,n))}}function $2(t,n,a,p){switch(T2(n)){case 1:var m=ZE;break;case 4:m=GE;break;default:m=H0}a=m.bind(null,n,a,t),m=void 0,!Vy||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(m=!0),p?m!==void 0?t.addEventListener(n,a,{capture:!0,passive:m}):t.addEventListener(n,a,!0):m!==void 0?t.addEventListener(n,a,{passive:m}):t.addEventListener(n,a,!1)}function uy(t,n,a,p,m){var b=p;if(!(n&1)&&!(n&2)&&p!==null)e:for(;;){if(p===null)return;var x=p.tag;if(x===3||x===4){var c=p.stateNode.containerInfo;if(c===m||c.nodeType===8&&c.parentNode===m)break;if(x===4)for(x=p.return;x!==null;){var A=x.tag;if((A===3||A===4)&&(A=x.stateNode.containerInfo,A===m||A.nodeType===8&&A.parentNode===m))return;x=x.return}for(;c!==null;){if(x=ml(c),x===null)return;if(A=x.tag,A===5||A===6){p=b=x;continue e}c=c.parentNode}}p=p.return}u2(function(){var j=b,Y=Z0(a),Q=[];e:{var H=j2.get(t);if(H!==void 0){var G=K0,le=t;switch(t){case"keypress":if(Vf(a)===0)break e;case"keydown":case"keyup":G=sM;break;case"focusin":le="focus",G=ny;break;case"focusout":le="blur",G=ny;break;case"beforeblur":case"afterblur":G=ny;break;case"click":if(a.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":G=nb;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":G=HE;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":G=cM;break;case D2:case F2:case B2:G=YE;break;case O2:G=hM;break;case"scroll":G=qE;break;case"wheel":G=pM;break;case"copy":case"cut":case"paste":G=JE;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":G=ob}var ve=(n&4)!==0,Ae=!ve&&t==="scroll",ee=ve?H!==null?H+"Capture":null:H;ve=[];for(var re=j,se;re!==null;){se=re;var _e=se.stateNode;if(se.tag===5&&_e!==null&&(se=_e,ee!==null&&(_e=Pd(re,ee),_e!=null&&ve.push(zd(re,_e,se)))),Ae)break;re=re.return}0<ve.length&&(H=new G(H,le,null,a,Y),Q.push({event:H,listeners:ve}))}}if(!(n&7)){e:{if(H=t==="mouseover"||t==="pointerover",G=t==="mouseout"||t==="pointerout",H&&a!==Ny&&(le=a.relatedTarget||a.fromElement)&&(ml(le)||le[Ds]))break e;if((G||H)&&(H=Y.window===Y?Y:(H=Y.ownerDocument)?H.defaultView||H.parentWindow:window,G?(le=a.relatedTarget||a.toElement,G=j,le=le?ml(le):null,le!==null&&(Ae=Ml(le),le!==Ae||le.tag!==5&&le.tag!==6)&&(le=null)):(G=null,le=j),G!==le)){if(ve=nb,_e="onMouseLeave",ee="onMouseEnter",re="mouse",(t==="pointerout"||t==="pointerover")&&(ve=ob,_e="onPointerLeave",ee="onPointerEnter",re="pointer"),Ae=G==null?H:Yc(G),se=le==null?H:Yc(le),H=new ve(_e,re+"leave",G,a,Y),H.target=Ae,H.relatedTarget=se,_e=null,ml(Y)===j&&(ve=new ve(ee,re+"enter",le,a,Y),ve.target=se,ve.relatedTarget=Ae,_e=ve),Ae=_e,G&&le)t:{for(ve=G,ee=le,re=0,se=ve;se;se=Fc(se))re++;for(se=0,_e=ee;_e;_e=Fc(_e))se++;for(;0<re-se;)ve=Fc(ve),re--;for(;0<se-re;)ee=Fc(ee),se--;for(;re--;){if(ve===ee||ee!==null&&ve===ee.alternate)break t;ve=Fc(ve),ee=Fc(ee)}ve=null}else ve=null;G!==null&&gb(Q,H,G,ve,!1),le!==null&&Ae!==null&&gb(Q,Ae,le,ve,!0)}}e:{if(H=j?Yc(j):window,G=H.nodeName&&H.nodeName.toLowerCase(),G==="select"||G==="input"&&H.type==="file")var De=xM;else if(lb(H))if(k2)De=TM;else{De=wM;var Fe=bM}else(G=H.nodeName)&&G.toLowerCase()==="input"&&(H.type==="checkbox"||H.type==="radio")&&(De=SM);if(De&&(De=De(t,j))){I2(Q,De,a,Y);break e}Fe&&Fe(t,H,j),t==="focusout"&&(Fe=H._wrapperState)&&Fe.controlled&&H.type==="number"&&Dy(H,"number",H.value)}switch(Fe=j?Yc(j):window,t){case"focusin":(lb(Fe)||Fe.contentEditable==="true")&&(Xc=Fe,Wy=j,_d=null);break;case"focusout":_d=Wy=Xc=null;break;case"mousedown":Hy=!0;break;case"contextmenu":case"mouseup":case"dragend":Hy=!1,pb(Q,a,Y);break;case"selectionchange":if(EM)break;case"keydown":case"keyup":pb(Q,a,Y)}var ze;if(Q0)e:{switch(t){case"compositionstart":var We="onCompositionStart";break e;case"compositionend":We="onCompositionEnd";break e;case"compositionupdate":We="onCompositionUpdate";break e}We=void 0}else Hc?E2(t,a)&&(We="onCompositionEnd"):t==="keydown"&&a.keyCode===229&&(We="onCompositionStart");We&&(C2&&a.locale!=="ko"&&(Hc||We!=="onCompositionStart"?We==="onCompositionEnd"&&Hc&&(ze=P2()):(ba=Y,X0="value"in ba?ba.value:ba.textContent,Hc=!0)),Fe=hm(j,We),0<Fe.length&&(We=new ib(We,t,null,a,Y),Q.push({event:We,listeners:Fe}),ze?We.data=ze:(ze=M2(a),ze!==null&&(We.data=ze)))),(ze=mM?gM(t,a):_M(t,a))&&(j=hm(j,"onBeforeInput"),0<j.length&&(Y=new ib("onBeforeInput","beforeinput",null,a,Y),Q.push({event:Y,listeners:j}),Y.data=ze))}N2(Q,n)})}function zd(t,n,a){return{instance:t,listener:n,currentTarget:a}}function hm(t,n){for(var a=n+"Capture",p=[];t!==null;){var m=t,b=m.stateNode;m.tag===5&&b!==null&&(m=b,b=Pd(t,a),b!=null&&p.unshift(zd(t,b,m)),b=Pd(t,n),b!=null&&p.push(zd(t,b,m))),t=t.return}return p}function Fc(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function gb(t,n,a,p,m){for(var b=n._reactName,x=[];a!==null&&a!==p;){var c=a,A=c.alternate,j=c.stateNode;if(A!==null&&A===p)break;c.tag===5&&j!==null&&(c=j,m?(A=Pd(a,b),A!=null&&x.unshift(zd(a,A,c))):m||(A=Pd(a,b),A!=null&&x.push(zd(a,A,c)))),a=a.return}x.length!==0&&t.push({event:n,listeners:x})}var AM=/\r\n?/g,zM=/\u0000|\uFFFD/g;function _b(t){return(typeof t=="string"?t:""+t).replace(AM,`
`).replace(zM,"")}function Cf(t,n,a){if(n=_b(n),_b(t)!==n&&a)throw Error(Je(425))}function dm(){}var Xy=null,Ky=null;function Yy(t,n){return t==="textarea"||t==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var Qy=typeof setTimeout=="function"?setTimeout:void 0,RM=typeof clearTimeout=="function"?clearTimeout:void 0,yb=typeof Promise=="function"?Promise:void 0,LM=typeof queueMicrotask=="function"?queueMicrotask:typeof yb<"u"?function(t){return yb.resolve(null).then(t).catch(DM)}:Qy;function DM(t){setTimeout(function(){throw t})}function hy(t,n){var a=n,p=0;do{var m=a.nextSibling;if(t.removeChild(a),m&&m.nodeType===8)if(a=m.data,a==="/$"){if(p===0){t.removeChild(m),Md(n);return}p--}else a!=="$"&&a!=="$?"&&a!=="$!"||p++;a=m}while(a);Md(n)}function Ea(t){for(;t!=null;t=t.nextSibling){var n=t.nodeType;if(n===1||n===3)break;if(n===8){if(n=t.data,n==="$"||n==="$!"||n==="$?")break;if(n==="/$")return null}}return t}function vb(t){t=t.previousSibling;for(var n=0;t;){if(t.nodeType===8){var a=t.data;if(a==="$"||a==="$!"||a==="$?"){if(n===0)return t;n--}else a==="/$"&&n++}t=t.previousSibling}return null}var Tu=Math.random().toString(36).slice(2),qo="__reactFiber$"+Tu,Rd="__reactProps$"+Tu,Ds="__reactContainer$"+Tu,Jy="__reactEvents$"+Tu,FM="__reactListeners$"+Tu,BM="__reactHandles$"+Tu;function ml(t){var n=t[qo];if(n)return n;for(var a=t.parentNode;a;){if(n=a[Ds]||a[qo]){if(a=n.alternate,n.child!==null||a!==null&&a.child!==null)for(t=vb(t);t!==null;){if(a=t[qo])return a;t=vb(t)}return n}t=a,a=t.parentNode}return null}function Hd(t){return t=t[qo]||t[Ds],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Yc(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Je(33))}function $m(t){return t[Rd]||null}var e0=[],Qc=-1;function Fa(t){return{current:t}}function xr(t){0>Qc||(t.current=e0[Qc],e0[Qc]=null,Qc--)}function pr(t,n){Qc++,e0[Qc]=t.current,t.current=n}var Ra={},Zn=Fa(Ra),gi=Fa(!1),bl=Ra;function pu(t,n){var a=t.type.contextTypes;if(!a)return Ra;var p=t.stateNode;if(p&&p.__reactInternalMemoizedUnmaskedChildContext===n)return p.__reactInternalMemoizedMaskedChildContext;var m={},b;for(b in a)m[b]=n[b];return p&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=n,t.__reactInternalMemoizedMaskedChildContext=m),m}function _i(t){return t=t.childContextTypes,t!=null}function pm(){xr(gi),xr(Zn)}function xb(t,n,a){if(Zn.current!==Ra)throw Error(Je(168));pr(Zn,n),pr(gi,a)}function V2(t,n,a){var p=t.stateNode;if(n=n.childContextTypes,typeof p.getChildContext!="function")return a;p=p.getChildContext();for(var m in p)if(!(m in n))throw Error(Je(108,bE(t)||"Unknown",m));return Rr({},a,p)}function fm(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ra,bl=Zn.current,pr(Zn,t),pr(gi,gi.current),!0}function bb(t,n,a){var p=t.stateNode;if(!p)throw Error(Je(169));a?(t=V2(t,n,bl),p.__reactInternalMemoizedMergedChildContext=t,xr(gi),xr(Zn),pr(Zn,t)):xr(gi),pr(gi,a)}var Ms=null,Vm=!1,dy=!1;function U2(t){Ms===null?Ms=[t]:Ms.push(t)}function OM(t){Vm=!0,U2(t)}function Ba(){if(!dy&&Ms!==null){dy=!0;var t=0,n=Jt;try{var a=Ms;for(Jt=1;t<a.length;t++){var p=a[t];do p=p(!0);while(p!==null)}Ms=null,Vm=!1}catch(m){throw Ms!==null&&(Ms=Ms.slice(t+1)),f2(G0,Ba),m}finally{Jt=n,dy=!1}}return null}var Jc=[],eu=0,mm=null,gm=0,Yi=[],Qi=0,wl=null,ks=1,As="";function pl(t,n){Jc[eu++]=gm,Jc[eu++]=mm,mm=t,gm=n}function Z2(t,n,a){Yi[Qi++]=ks,Yi[Qi++]=As,Yi[Qi++]=wl,wl=t;var p=ks;t=As;var m=32-To(p)-1;p&=~(1<<m),a+=1;var b=32-To(n)+m;if(30<b){var x=m-m%5;b=(p&(1<<x)-1).toString(32),p>>=x,m-=x,ks=1<<32-To(n)+m|a<<m|p,As=b+t}else ks=1<<b|a<<m|p,As=t}function ev(t){t.return!==null&&(pl(t,1),Z2(t,1,0))}function tv(t){for(;t===mm;)mm=Jc[--eu],Jc[eu]=null,gm=Jc[--eu],Jc[eu]=null;for(;t===wl;)wl=Yi[--Qi],Yi[Qi]=null,As=Yi[--Qi],Yi[Qi]=null,ks=Yi[--Qi],Yi[Qi]=null}var Li=null,Ri=null,Pr=!1,So=null;function G2(t,n){var a=eo(5,null,null,0);a.elementType="DELETED",a.stateNode=n,a.return=t,n=t.deletions,n===null?(t.deletions=[a],t.flags|=16):n.push(a)}function wb(t,n){switch(t.tag){case 5:var a=t.type;return n=n.nodeType!==1||a.toLowerCase()!==n.nodeName.toLowerCase()?null:n,n!==null?(t.stateNode=n,Li=t,Ri=Ea(n.firstChild),!0):!1;case 6:return n=t.pendingProps===""||n.nodeType!==3?null:n,n!==null?(t.stateNode=n,Li=t,Ri=null,!0):!1;case 13:return n=n.nodeType!==8?null:n,n!==null?(a=wl!==null?{id:ks,overflow:As}:null,t.memoizedState={dehydrated:n,treeContext:a,retryLane:1073741824},a=eo(18,null,null,0),a.stateNode=n,a.return=t,t.child=a,Li=t,Ri=null,!0):!1;default:return!1}}function t0(t){return(t.mode&1)!==0&&(t.flags&128)===0}function r0(t){if(Pr){var n=Ri;if(n){var a=n;if(!wb(t,n)){if(t0(t))throw Error(Je(418));n=Ea(a.nextSibling);var p=Li;n&&wb(t,n)?G2(p,a):(t.flags=t.flags&-4097|2,Pr=!1,Li=t)}}else{if(t0(t))throw Error(Je(418));t.flags=t.flags&-4097|2,Pr=!1,Li=t}}}function Sb(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Li=t}function Ef(t){if(t!==Li)return!1;if(!Pr)return Sb(t),Pr=!0,!1;var n;if((n=t.tag!==3)&&!(n=t.tag!==5)&&(n=t.type,n=n!=="head"&&n!=="body"&&!Yy(t.type,t.memoizedProps)),n&&(n=Ri)){if(t0(t))throw q2(),Error(Je(418));for(;n;)G2(t,n),n=Ea(n.nextSibling)}if(Sb(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Je(317));e:{for(t=t.nextSibling,n=0;t;){if(t.nodeType===8){var a=t.data;if(a==="/$"){if(n===0){Ri=Ea(t.nextSibling);break e}n--}else a!=="$"&&a!=="$!"&&a!=="$?"||n++}t=t.nextSibling}Ri=null}}else Ri=Li?Ea(t.stateNode.nextSibling):null;return!0}function q2(){for(var t=Ri;t;)t=Ea(t.nextSibling)}function fu(){Ri=Li=null,Pr=!1}function rv(t){So===null?So=[t]:So.push(t)}var jM=Ns.ReactCurrentBatchConfig;function ed(t,n,a){if(t=a.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(a._owner){if(a=a._owner,a){if(a.tag!==1)throw Error(Je(309));var p=a.stateNode}if(!p)throw Error(Je(147,t));var m=p,b=""+t;return n!==null&&n.ref!==null&&typeof n.ref=="function"&&n.ref._stringRef===b?n.ref:(n=function(x){var c=m.refs;x===null?delete c[b]:c[b]=x},n._stringRef=b,n)}if(typeof t!="string")throw Error(Je(284));if(!a._owner)throw Error(Je(290,t))}return t}function Mf(t,n){throw t=Object.prototype.toString.call(n),Error(Je(31,t==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":t))}function Tb(t){var n=t._init;return n(t._payload)}function W2(t){function n(ee,re){if(t){var se=ee.deletions;se===null?(ee.deletions=[re],ee.flags|=16):se.push(re)}}function a(ee,re){if(!t)return null;for(;re!==null;)n(ee,re),re=re.sibling;return null}function p(ee,re){for(ee=new Map;re!==null;)re.key!==null?ee.set(re.key,re):ee.set(re.index,re),re=re.sibling;return ee}function m(ee,re){return ee=Aa(ee,re),ee.index=0,ee.sibling=null,ee}function b(ee,re,se){return ee.index=se,t?(se=ee.alternate,se!==null?(se=se.index,se<re?(ee.flags|=2,re):se):(ee.flags|=2,re)):(ee.flags|=1048576,re)}function x(ee){return t&&ee.alternate===null&&(ee.flags|=2),ee}function c(ee,re,se,_e){return re===null||re.tag!==6?(re=vy(se,ee.mode,_e),re.return=ee,re):(re=m(re,se),re.return=ee,re)}function A(ee,re,se,_e){var De=se.type;return De===Wc?Y(ee,re,se.props.children,_e,se.key):re!==null&&(re.elementType===De||typeof De=="object"&&De!==null&&De.$$typeof===_a&&Tb(De)===re.type)?(_e=m(re,se.props),_e.ref=ed(ee,re,se),_e.return=ee,_e):(_e=Xf(se.type,se.key,se.props,null,ee.mode,_e),_e.ref=ed(ee,re,se),_e.return=ee,_e)}function j(ee,re,se,_e){return re===null||re.tag!==4||re.stateNode.containerInfo!==se.containerInfo||re.stateNode.implementation!==se.implementation?(re=xy(se,ee.mode,_e),re.return=ee,re):(re=m(re,se.children||[]),re.return=ee,re)}function Y(ee,re,se,_e,De){return re===null||re.tag!==7?(re=xl(se,ee.mode,_e,De),re.return=ee,re):(re=m(re,se),re.return=ee,re)}function Q(ee,re,se){if(typeof re=="string"&&re!==""||typeof re=="number")return re=vy(""+re,ee.mode,se),re.return=ee,re;if(typeof re=="object"&&re!==null){switch(re.$$typeof){case _f:return se=Xf(re.type,re.key,re.props,null,ee.mode,se),se.ref=ed(ee,null,re),se.return=ee,se;case qc:return re=xy(re,ee.mode,se),re.return=ee,re;case _a:var _e=re._init;return Q(ee,_e(re._payload),se)}if(ad(re)||Xh(re))return re=xl(re,ee.mode,se,null),re.return=ee,re;Mf(ee,re)}return null}function H(ee,re,se,_e){var De=re!==null?re.key:null;if(typeof se=="string"&&se!==""||typeof se=="number")return De!==null?null:c(ee,re,""+se,_e);if(typeof se=="object"&&se!==null){switch(se.$$typeof){case _f:return se.key===De?A(ee,re,se,_e):null;case qc:return se.key===De?j(ee,re,se,_e):null;case _a:return De=se._init,H(ee,re,De(se._payload),_e)}if(ad(se)||Xh(se))return De!==null?null:Y(ee,re,se,_e,null);Mf(ee,se)}return null}function G(ee,re,se,_e,De){if(typeof _e=="string"&&_e!==""||typeof _e=="number")return ee=ee.get(se)||null,c(re,ee,""+_e,De);if(typeof _e=="object"&&_e!==null){switch(_e.$$typeof){case _f:return ee=ee.get(_e.key===null?se:_e.key)||null,A(re,ee,_e,De);case qc:return ee=ee.get(_e.key===null?se:_e.key)||null,j(re,ee,_e,De);case _a:var Fe=_e._init;return G(ee,re,se,Fe(_e._payload),De)}if(ad(_e)||Xh(_e))return ee=ee.get(se)||null,Y(re,ee,_e,De,null);Mf(re,_e)}return null}function le(ee,re,se,_e){for(var De=null,Fe=null,ze=re,We=re=0,gt=null;ze!==null&&We<se.length;We++){ze.index>We?(gt=ze,ze=null):gt=ze.sibling;var X=H(ee,ze,se[We],_e);if(X===null){ze===null&&(ze=gt);break}t&&ze&&X.alternate===null&&n(ee,ze),re=b(X,re,We),Fe===null?De=X:Fe.sibling=X,Fe=X,ze=gt}if(We===se.length)return a(ee,ze),Pr&&pl(ee,We),De;if(ze===null){for(;We<se.length;We++)ze=Q(ee,se[We],_e),ze!==null&&(re=b(ze,re,We),Fe===null?De=ze:Fe.sibling=ze,Fe=ze);return Pr&&pl(ee,We),De}for(ze=p(ee,ze);We<se.length;We++)gt=G(ze,ee,We,se[We],_e),gt!==null&&(t&&gt.alternate!==null&&ze.delete(gt.key===null?We:gt.key),re=b(gt,re,We),Fe===null?De=gt:Fe.sibling=gt,Fe=gt);return t&&ze.forEach(function(Ye){return n(ee,Ye)}),Pr&&pl(ee,We),De}function ve(ee,re,se,_e){var De=Xh(se);if(typeof De!="function")throw Error(Je(150));if(se=De.call(se),se==null)throw Error(Je(151));for(var Fe=De=null,ze=re,We=re=0,gt=null,X=se.next();ze!==null&&!X.done;We++,X=se.next()){ze.index>We?(gt=ze,ze=null):gt=ze.sibling;var Ye=H(ee,ze,X.value,_e);if(Ye===null){ze===null&&(ze=gt);break}t&&ze&&Ye.alternate===null&&n(ee,ze),re=b(Ye,re,We),Fe===null?De=Ye:Fe.sibling=Ye,Fe=Ye,ze=gt}if(X.done)return a(ee,ze),Pr&&pl(ee,We),De;if(ze===null){for(;!X.done;We++,X=se.next())X=Q(ee,X.value,_e),X!==null&&(re=b(X,re,We),Fe===null?De=X:Fe.sibling=X,Fe=X);return Pr&&pl(ee,We),De}for(ze=p(ee,ze);!X.done;We++,X=se.next())X=G(ze,ee,We,X.value,_e),X!==null&&(t&&X.alternate!==null&&ze.delete(X.key===null?We:X.key),re=b(X,re,We),Fe===null?De=X:Fe.sibling=X,Fe=X);return t&&ze.forEach(function(at){return n(ee,at)}),Pr&&pl(ee,We),De}function Ae(ee,re,se,_e){if(typeof se=="object"&&se!==null&&se.type===Wc&&se.key===null&&(se=se.props.children),typeof se=="object"&&se!==null){switch(se.$$typeof){case _f:e:{for(var De=se.key,Fe=re;Fe!==null;){if(Fe.key===De){if(De=se.type,De===Wc){if(Fe.tag===7){a(ee,Fe.sibling),re=m(Fe,se.props.children),re.return=ee,ee=re;break e}}else if(Fe.elementType===De||typeof De=="object"&&De!==null&&De.$$typeof===_a&&Tb(De)===Fe.type){a(ee,Fe.sibling),re=m(Fe,se.props),re.ref=ed(ee,Fe,se),re.return=ee,ee=re;break e}a(ee,Fe);break}else n(ee,Fe);Fe=Fe.sibling}se.type===Wc?(re=xl(se.props.children,ee.mode,_e,se.key),re.return=ee,ee=re):(_e=Xf(se.type,se.key,se.props,null,ee.mode,_e),_e.ref=ed(ee,re,se),_e.return=ee,ee=_e)}return x(ee);case qc:e:{for(Fe=se.key;re!==null;){if(re.key===Fe)if(re.tag===4&&re.stateNode.containerInfo===se.containerInfo&&re.stateNode.implementation===se.implementation){a(ee,re.sibling),re=m(re,se.children||[]),re.return=ee,ee=re;break e}else{a(ee,re);break}else n(ee,re);re=re.sibling}re=xy(se,ee.mode,_e),re.return=ee,ee=re}return x(ee);case _a:return Fe=se._init,Ae(ee,re,Fe(se._payload),_e)}if(ad(se))return le(ee,re,se,_e);if(Xh(se))return ve(ee,re,se,_e);Mf(ee,se)}return typeof se=="string"&&se!==""||typeof se=="number"?(se=""+se,re!==null&&re.tag===6?(a(ee,re.sibling),re=m(re,se),re.return=ee,ee=re):(a(ee,re),re=vy(se,ee.mode,_e),re.return=ee,ee=re),x(ee)):a(ee,re)}return Ae}var mu=W2(!0),H2=W2(!1),_m=Fa(null),ym=null,tu=null,nv=null;function iv(){nv=tu=ym=null}function ov(t){var n=_m.current;xr(_m),t._currentValue=n}function n0(t,n,a){for(;t!==null;){var p=t.alternate;if((t.childLanes&n)!==n?(t.childLanes|=n,p!==null&&(p.childLanes|=n)):p!==null&&(p.childLanes&n)!==n&&(p.childLanes|=n),t===a)break;t=t.return}}function lu(t,n){ym=t,nv=tu=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&n&&(mi=!0),t.firstContext=null)}function ro(t){var n=t._currentValue;if(nv!==t)if(t={context:t,memoizedValue:n,next:null},tu===null){if(ym===null)throw Error(Je(308));tu=t,ym.dependencies={lanes:0,firstContext:t}}else tu=tu.next=t;return n}var gl=null;function sv(t){gl===null?gl=[t]:gl.push(t)}function X2(t,n,a,p){var m=n.interleaved;return m===null?(a.next=a,sv(n)):(a.next=m.next,m.next=a),n.interleaved=a,Fs(t,p)}function Fs(t,n){t.lanes|=n;var a=t.alternate;for(a!==null&&(a.lanes|=n),a=t,t=t.return;t!==null;)t.childLanes|=n,a=t.alternate,a!==null&&(a.childLanes|=n),a=t,t=t.return;return a.tag===3?a.stateNode:null}var ya=!1;function av(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function K2(t,n){t=t.updateQueue,n.updateQueue===t&&(n.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function zs(t,n){return{eventTime:t,lane:n,tag:0,payload:null,callback:null,next:null}}function Ma(t,n,a){var p=t.updateQueue;if(p===null)return null;if(p=p.shared,Zt&2){var m=p.pending;return m===null?n.next=n:(n.next=m.next,m.next=n),p.pending=n,Fs(t,a)}return m=p.interleaved,m===null?(n.next=n,sv(p)):(n.next=m.next,m.next=n),p.interleaved=n,Fs(t,a)}function Uf(t,n,a){if(n=n.updateQueue,n!==null&&(n=n.shared,(a&4194240)!==0)){var p=n.lanes;p&=t.pendingLanes,a|=p,n.lanes=a,q0(t,a)}}function Pb(t,n){var a=t.updateQueue,p=t.alternate;if(p!==null&&(p=p.updateQueue,a===p)){var m=null,b=null;if(a=a.firstBaseUpdate,a!==null){do{var x={eventTime:a.eventTime,lane:a.lane,tag:a.tag,payload:a.payload,callback:a.callback,next:null};b===null?m=b=x:b=b.next=x,a=a.next}while(a!==null);b===null?m=b=n:b=b.next=n}else m=b=n;a={baseState:p.baseState,firstBaseUpdate:m,lastBaseUpdate:b,shared:p.shared,effects:p.effects},t.updateQueue=a;return}t=a.lastBaseUpdate,t===null?a.firstBaseUpdate=n:t.next=n,a.lastBaseUpdate=n}function vm(t,n,a,p){var m=t.updateQueue;ya=!1;var b=m.firstBaseUpdate,x=m.lastBaseUpdate,c=m.shared.pending;if(c!==null){m.shared.pending=null;var A=c,j=A.next;A.next=null,x===null?b=j:x.next=j,x=A;var Y=t.alternate;Y!==null&&(Y=Y.updateQueue,c=Y.lastBaseUpdate,c!==x&&(c===null?Y.firstBaseUpdate=j:c.next=j,Y.lastBaseUpdate=A))}if(b!==null){var Q=m.baseState;x=0,Y=j=A=null,c=b;do{var H=c.lane,G=c.eventTime;if((p&H)===H){Y!==null&&(Y=Y.next={eventTime:G,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var le=t,ve=c;switch(H=n,G=a,ve.tag){case 1:if(le=ve.payload,typeof le=="function"){Q=le.call(G,Q,H);break e}Q=le;break e;case 3:le.flags=le.flags&-65537|128;case 0:if(le=ve.payload,H=typeof le=="function"?le.call(G,Q,H):le,H==null)break e;Q=Rr({},Q,H);break e;case 2:ya=!0}}c.callback!==null&&c.lane!==0&&(t.flags|=64,H=m.effects,H===null?m.effects=[c]:H.push(c))}else G={eventTime:G,lane:H,tag:c.tag,payload:c.payload,callback:c.callback,next:null},Y===null?(j=Y=G,A=Q):Y=Y.next=G,x|=H;if(c=c.next,c===null){if(c=m.shared.pending,c===null)break;H=c,c=H.next,H.next=null,m.lastBaseUpdate=H,m.shared.pending=null}}while(!0);if(Y===null&&(A=Q),m.baseState=A,m.firstBaseUpdate=j,m.lastBaseUpdate=Y,n=m.shared.interleaved,n!==null){m=n;do x|=m.lane,m=m.next;while(m!==n)}else b===null&&(m.shared.lanes=0);Tl|=x,t.lanes=x,t.memoizedState=Q}}function Cb(t,n,a){if(t=n.effects,n.effects=null,t!==null)for(n=0;n<t.length;n++){var p=t[n],m=p.callback;if(m!==null){if(p.callback=null,p=a,typeof m!="function")throw Error(Je(191,m));m.call(p)}}}var Xd={},Ho=Fa(Xd),Ld=Fa(Xd),Dd=Fa(Xd);function _l(t){if(t===Xd)throw Error(Je(174));return t}function lv(t,n){switch(pr(Dd,n),pr(Ld,t),pr(Ho,Xd),t=n.nodeType,t){case 9:case 11:n=(n=n.documentElement)?n.namespaceURI:By(null,"");break;default:t=t===8?n.parentNode:n,n=t.namespaceURI||null,t=t.tagName,n=By(n,t)}xr(Ho),pr(Ho,n)}function gu(){xr(Ho),xr(Ld),xr(Dd)}function Y2(t){_l(Dd.current);var n=_l(Ho.current),a=By(n,t.type);n!==a&&(pr(Ld,t),pr(Ho,a))}function cv(t){Ld.current===t&&(xr(Ho),xr(Ld))}var kr=Fa(0);function xm(t){for(var n=t;n!==null;){if(n.tag===13){var a=n.memoizedState;if(a!==null&&(a=a.dehydrated,a===null||a.data==="$?"||a.data==="$!"))return n}else if(n.tag===19&&n.memoizedProps.revealOrder!==void 0){if(n.flags&128)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var py=[];function uv(){for(var t=0;t<py.length;t++)py[t]._workInProgressVersionPrimary=null;py.length=0}var Zf=Ns.ReactCurrentDispatcher,fy=Ns.ReactCurrentBatchConfig,Sl=0,Ar=null,fn=null,bn=null,bm=!1,yd=!1,Fd=0,NM=0;function Nn(){throw Error(Je(321))}function hv(t,n){if(n===null)return!1;for(var a=0;a<n.length&&a<t.length;a++)if(!Co(t[a],n[a]))return!1;return!0}function dv(t,n,a,p,m,b){if(Sl=b,Ar=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,Zf.current=t===null||t.memoizedState===null?ZM:GM,t=a(p,m),yd){b=0;do{if(yd=!1,Fd=0,25<=b)throw Error(Je(301));b+=1,bn=fn=null,n.updateQueue=null,Zf.current=qM,t=a(p,m)}while(yd)}if(Zf.current=wm,n=fn!==null&&fn.next!==null,Sl=0,bn=fn=Ar=null,bm=!1,n)throw Error(Je(300));return t}function pv(){var t=Fd!==0;return Fd=0,t}function Uo(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return bn===null?Ar.memoizedState=bn=t:bn=bn.next=t,bn}function no(){if(fn===null){var t=Ar.alternate;t=t!==null?t.memoizedState:null}else t=fn.next;var n=bn===null?Ar.memoizedState:bn.next;if(n!==null)bn=n,fn=t;else{if(t===null)throw Error(Je(310));fn=t,t={memoizedState:fn.memoizedState,baseState:fn.baseState,baseQueue:fn.baseQueue,queue:fn.queue,next:null},bn===null?Ar.memoizedState=bn=t:bn=bn.next=t}return bn}function Bd(t,n){return typeof n=="function"?n(t):n}function my(t){var n=no(),a=n.queue;if(a===null)throw Error(Je(311));a.lastRenderedReducer=t;var p=fn,m=p.baseQueue,b=a.pending;if(b!==null){if(m!==null){var x=m.next;m.next=b.next,b.next=x}p.baseQueue=m=b,a.pending=null}if(m!==null){b=m.next,p=p.baseState;var c=x=null,A=null,j=b;do{var Y=j.lane;if((Sl&Y)===Y)A!==null&&(A=A.next={lane:0,action:j.action,hasEagerState:j.hasEagerState,eagerState:j.eagerState,next:null}),p=j.hasEagerState?j.eagerState:t(p,j.action);else{var Q={lane:Y,action:j.action,hasEagerState:j.hasEagerState,eagerState:j.eagerState,next:null};A===null?(c=A=Q,x=p):A=A.next=Q,Ar.lanes|=Y,Tl|=Y}j=j.next}while(j!==null&&j!==b);A===null?x=p:A.next=c,Co(p,n.memoizedState)||(mi=!0),n.memoizedState=p,n.baseState=x,n.baseQueue=A,a.lastRenderedState=p}if(t=a.interleaved,t!==null){m=t;do b=m.lane,Ar.lanes|=b,Tl|=b,m=m.next;while(m!==t)}else m===null&&(a.lanes=0);return[n.memoizedState,a.dispatch]}function gy(t){var n=no(),a=n.queue;if(a===null)throw Error(Je(311));a.lastRenderedReducer=t;var p=a.dispatch,m=a.pending,b=n.memoizedState;if(m!==null){a.pending=null;var x=m=m.next;do b=t(b,x.action),x=x.next;while(x!==m);Co(b,n.memoizedState)||(mi=!0),n.memoizedState=b,n.baseQueue===null&&(n.baseState=b),a.lastRenderedState=b}return[b,p]}function Q2(){}function J2(t,n){var a=Ar,p=no(),m=n(),b=!Co(p.memoizedState,m);if(b&&(p.memoizedState=m,mi=!0),p=p.queue,fv(rS.bind(null,a,p,t),[t]),p.getSnapshot!==n||b||bn!==null&&bn.memoizedState.tag&1){if(a.flags|=2048,Od(9,tS.bind(null,a,p,m,n),void 0,null),Sn===null)throw Error(Je(349));Sl&30||eS(a,n,m)}return m}function eS(t,n,a){t.flags|=16384,t={getSnapshot:n,value:a},n=Ar.updateQueue,n===null?(n={lastEffect:null,stores:null},Ar.updateQueue=n,n.stores=[t]):(a=n.stores,a===null?n.stores=[t]:a.push(t))}function tS(t,n,a,p){n.value=a,n.getSnapshot=p,nS(n)&&iS(t)}function rS(t,n,a){return a(function(){nS(n)&&iS(t)})}function nS(t){var n=t.getSnapshot;t=t.value;try{var a=n();return!Co(t,a)}catch{return!0}}function iS(t){var n=Fs(t,1);n!==null&&Po(n,t,1,-1)}function Eb(t){var n=Uo();return typeof t=="function"&&(t=t()),n.memoizedState=n.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Bd,lastRenderedState:t},n.queue=t,t=t.dispatch=UM.bind(null,Ar,t),[n.memoizedState,t]}function Od(t,n,a,p){return t={tag:t,create:n,destroy:a,deps:p,next:null},n=Ar.updateQueue,n===null?(n={lastEffect:null,stores:null},Ar.updateQueue=n,n.lastEffect=t.next=t):(a=n.lastEffect,a===null?n.lastEffect=t.next=t:(p=a.next,a.next=t,t.next=p,n.lastEffect=t)),t}function oS(){return no().memoizedState}function Gf(t,n,a,p){var m=Uo();Ar.flags|=t,m.memoizedState=Od(1|n,a,void 0,p===void 0?null:p)}function Um(t,n,a,p){var m=no();p=p===void 0?null:p;var b=void 0;if(fn!==null){var x=fn.memoizedState;if(b=x.destroy,p!==null&&hv(p,x.deps)){m.memoizedState=Od(n,a,b,p);return}}Ar.flags|=t,m.memoizedState=Od(1|n,a,b,p)}function Mb(t,n){return Gf(8390656,8,t,n)}function fv(t,n){return Um(2048,8,t,n)}function sS(t,n){return Um(4,2,t,n)}function aS(t,n){return Um(4,4,t,n)}function lS(t,n){if(typeof n=="function")return t=t(),n(t),function(){n(null)};if(n!=null)return t=t(),n.current=t,function(){n.current=null}}function cS(t,n,a){return a=a!=null?a.concat([t]):null,Um(4,4,lS.bind(null,n,t),a)}function mv(){}function uS(t,n){var a=no();n=n===void 0?null:n;var p=a.memoizedState;return p!==null&&n!==null&&hv(n,p[1])?p[0]:(a.memoizedState=[t,n],t)}function hS(t,n){var a=no();n=n===void 0?null:n;var p=a.memoizedState;return p!==null&&n!==null&&hv(n,p[1])?p[0]:(t=t(),a.memoizedState=[t,n],t)}function dS(t,n,a){return Sl&21?(Co(a,n)||(a=_2(),Ar.lanes|=a,Tl|=a,t.baseState=!0),n):(t.baseState&&(t.baseState=!1,mi=!0),t.memoizedState=a)}function $M(t,n){var a=Jt;Jt=a!==0&&4>a?a:4,t(!0);var p=fy.transition;fy.transition={};try{t(!1),n()}finally{Jt=a,fy.transition=p}}function pS(){return no().memoizedState}function VM(t,n,a){var p=ka(t);if(a={lane:p,action:a,hasEagerState:!1,eagerState:null,next:null},fS(t))mS(n,a);else if(a=X2(t,n,a,p),a!==null){var m=ti();Po(a,t,p,m),gS(a,n,p)}}function UM(t,n,a){var p=ka(t),m={lane:p,action:a,hasEagerState:!1,eagerState:null,next:null};if(fS(t))mS(n,m);else{var b=t.alternate;if(t.lanes===0&&(b===null||b.lanes===0)&&(b=n.lastRenderedReducer,b!==null))try{var x=n.lastRenderedState,c=b(x,a);if(m.hasEagerState=!0,m.eagerState=c,Co(c,x)){var A=n.interleaved;A===null?(m.next=m,sv(n)):(m.next=A.next,A.next=m),n.interleaved=m;return}}catch{}finally{}a=X2(t,n,m,p),a!==null&&(m=ti(),Po(a,t,p,m),gS(a,n,p))}}function fS(t){var n=t.alternate;return t===Ar||n!==null&&n===Ar}function mS(t,n){yd=bm=!0;var a=t.pending;a===null?n.next=n:(n.next=a.next,a.next=n),t.pending=n}function gS(t,n,a){if(a&4194240){var p=n.lanes;p&=t.pendingLanes,a|=p,n.lanes=a,q0(t,a)}}var wm={readContext:ro,useCallback:Nn,useContext:Nn,useEffect:Nn,useImperativeHandle:Nn,useInsertionEffect:Nn,useLayoutEffect:Nn,useMemo:Nn,useReducer:Nn,useRef:Nn,useState:Nn,useDebugValue:Nn,useDeferredValue:Nn,useTransition:Nn,useMutableSource:Nn,useSyncExternalStore:Nn,useId:Nn,unstable_isNewReconciler:!1},ZM={readContext:ro,useCallback:function(t,n){return Uo().memoizedState=[t,n===void 0?null:n],t},useContext:ro,useEffect:Mb,useImperativeHandle:function(t,n,a){return a=a!=null?a.concat([t]):null,Gf(4194308,4,lS.bind(null,n,t),a)},useLayoutEffect:function(t,n){return Gf(4194308,4,t,n)},useInsertionEffect:function(t,n){return Gf(4,2,t,n)},useMemo:function(t,n){var a=Uo();return n=n===void 0?null:n,t=t(),a.memoizedState=[t,n],t},useReducer:function(t,n,a){var p=Uo();return n=a!==void 0?a(n):n,p.memoizedState=p.baseState=n,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:n},p.queue=t,t=t.dispatch=VM.bind(null,Ar,t),[p.memoizedState,t]},useRef:function(t){var n=Uo();return t={current:t},n.memoizedState=t},useState:Eb,useDebugValue:mv,useDeferredValue:function(t){return Uo().memoizedState=t},useTransition:function(){var t=Eb(!1),n=t[0];return t=$M.bind(null,t[1]),Uo().memoizedState=t,[n,t]},useMutableSource:function(){},useSyncExternalStore:function(t,n,a){var p=Ar,m=Uo();if(Pr){if(a===void 0)throw Error(Je(407));a=a()}else{if(a=n(),Sn===null)throw Error(Je(349));Sl&30||eS(p,n,a)}m.memoizedState=a;var b={value:a,getSnapshot:n};return m.queue=b,Mb(rS.bind(null,p,b,t),[t]),p.flags|=2048,Od(9,tS.bind(null,p,b,a,n),void 0,null),a},useId:function(){var t=Uo(),n=Sn.identifierPrefix;if(Pr){var a=As,p=ks;a=(p&~(1<<32-To(p)-1)).toString(32)+a,n=":"+n+"R"+a,a=Fd++,0<a&&(n+="H"+a.toString(32)),n+=":"}else a=NM++,n=":"+n+"r"+a.toString(32)+":";return t.memoizedState=n},unstable_isNewReconciler:!1},GM={readContext:ro,useCallback:uS,useContext:ro,useEffect:fv,useImperativeHandle:cS,useInsertionEffect:sS,useLayoutEffect:aS,useMemo:hS,useReducer:my,useRef:oS,useState:function(){return my(Bd)},useDebugValue:mv,useDeferredValue:function(t){var n=no();return dS(n,fn.memoizedState,t)},useTransition:function(){var t=my(Bd)[0],n=no().memoizedState;return[t,n]},useMutableSource:Q2,useSyncExternalStore:J2,useId:pS,unstable_isNewReconciler:!1},qM={readContext:ro,useCallback:uS,useContext:ro,useEffect:fv,useImperativeHandle:cS,useInsertionEffect:sS,useLayoutEffect:aS,useMemo:hS,useReducer:gy,useRef:oS,useState:function(){return gy(Bd)},useDebugValue:mv,useDeferredValue:function(t){var n=no();return fn===null?n.memoizedState=t:dS(n,fn.memoizedState,t)},useTransition:function(){var t=gy(Bd)[0],n=no().memoizedState;return[t,n]},useMutableSource:Q2,useSyncExternalStore:J2,useId:pS,unstable_isNewReconciler:!1};function bo(t,n){if(t&&t.defaultProps){n=Rr({},n),t=t.defaultProps;for(var a in t)n[a]===void 0&&(n[a]=t[a]);return n}return n}function i0(t,n,a,p){n=t.memoizedState,a=a(p,n),a=a==null?n:Rr({},n,a),t.memoizedState=a,t.lanes===0&&(t.updateQueue.baseState=a)}var Zm={isMounted:function(t){return(t=t._reactInternals)?Ml(t)===t:!1},enqueueSetState:function(t,n,a){t=t._reactInternals;var p=ti(),m=ka(t),b=zs(p,m);b.payload=n,a!=null&&(b.callback=a),n=Ma(t,b,m),n!==null&&(Po(n,t,m,p),Uf(n,t,m))},enqueueReplaceState:function(t,n,a){t=t._reactInternals;var p=ti(),m=ka(t),b=zs(p,m);b.tag=1,b.payload=n,a!=null&&(b.callback=a),n=Ma(t,b,m),n!==null&&(Po(n,t,m,p),Uf(n,t,m))},enqueueForceUpdate:function(t,n){t=t._reactInternals;var a=ti(),p=ka(t),m=zs(a,p);m.tag=2,n!=null&&(m.callback=n),n=Ma(t,m,p),n!==null&&(Po(n,t,p,a),Uf(n,t,p))}};function Ib(t,n,a,p,m,b,x){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(p,b,x):n.prototype&&n.prototype.isPureReactComponent?!kd(a,p)||!kd(m,b):!0}function _S(t,n,a){var p=!1,m=Ra,b=n.contextType;return typeof b=="object"&&b!==null?b=ro(b):(m=_i(n)?bl:Zn.current,p=n.contextTypes,b=(p=p!=null)?pu(t,m):Ra),n=new n(a,b),t.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,n.updater=Zm,t.stateNode=n,n._reactInternals=t,p&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=m,t.__reactInternalMemoizedMaskedChildContext=b),n}function kb(t,n,a,p){t=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(a,p),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(a,p),n.state!==t&&Zm.enqueueReplaceState(n,n.state,null)}function o0(t,n,a,p){var m=t.stateNode;m.props=a,m.state=t.memoizedState,m.refs={},av(t);var b=n.contextType;typeof b=="object"&&b!==null?m.context=ro(b):(b=_i(n)?bl:Zn.current,m.context=pu(t,b)),m.state=t.memoizedState,b=n.getDerivedStateFromProps,typeof b=="function"&&(i0(t,n,b,a),m.state=t.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof m.getSnapshotBeforeUpdate=="function"||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(n=m.state,typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount(),n!==m.state&&Zm.enqueueReplaceState(m,m.state,null),vm(t,a,m,p),m.state=t.memoizedState),typeof m.componentDidMount=="function"&&(t.flags|=4194308)}function _u(t,n){try{var a="",p=n;do a+=xE(p),p=p.return;while(p);var m=a}catch(b){m=`
Error generating stack: `+b.message+`
`+b.stack}return{value:t,source:n,stack:m,digest:null}}function _y(t,n,a){return{value:t,source:null,stack:a??null,digest:n??null}}function s0(t,n){try{console.error(n.value)}catch(a){setTimeout(function(){throw a})}}var WM=typeof WeakMap=="function"?WeakMap:Map;function yS(t,n,a){a=zs(-1,a),a.tag=3,a.payload={element:null};var p=n.value;return a.callback=function(){Tm||(Tm=!0,g0=p),s0(t,n)},a}function vS(t,n,a){a=zs(-1,a),a.tag=3;var p=t.type.getDerivedStateFromError;if(typeof p=="function"){var m=n.value;a.payload=function(){return p(m)},a.callback=function(){s0(t,n)}}var b=t.stateNode;return b!==null&&typeof b.componentDidCatch=="function"&&(a.callback=function(){s0(t,n),typeof p!="function"&&(Ia===null?Ia=new Set([this]):Ia.add(this));var x=n.stack;this.componentDidCatch(n.value,{componentStack:x!==null?x:""})}),a}function Ab(t,n,a){var p=t.pingCache;if(p===null){p=t.pingCache=new WM;var m=new Set;p.set(n,m)}else m=p.get(n),m===void 0&&(m=new Set,p.set(n,m));m.has(a)||(m.add(a),t=aI.bind(null,t,n,a),n.then(t,t))}function zb(t){do{var n;if((n=t.tag===13)&&(n=t.memoizedState,n=n!==null?n.dehydrated!==null:!0),n)return t;t=t.return}while(t!==null);return null}function Rb(t,n,a,p,m){return t.mode&1?(t.flags|=65536,t.lanes=m,t):(t===n?t.flags|=65536:(t.flags|=128,a.flags|=131072,a.flags&=-52805,a.tag===1&&(a.alternate===null?a.tag=17:(n=zs(-1,1),n.tag=2,Ma(a,n,1))),a.lanes|=1),t)}var HM=Ns.ReactCurrentOwner,mi=!1;function ei(t,n,a,p){n.child=t===null?H2(n,null,a,p):mu(n,t.child,a,p)}function Lb(t,n,a,p,m){a=a.render;var b=n.ref;return lu(n,m),p=dv(t,n,a,p,b,m),a=pv(),t!==null&&!mi?(n.updateQueue=t.updateQueue,n.flags&=-2053,t.lanes&=~m,Bs(t,n,m)):(Pr&&a&&ev(n),n.flags|=1,ei(t,n,p,m),n.child)}function Db(t,n,a,p,m){if(t===null){var b=a.type;return typeof b=="function"&&!Sv(b)&&b.defaultProps===void 0&&a.compare===null&&a.defaultProps===void 0?(n.tag=15,n.type=b,xS(t,n,b,p,m)):(t=Xf(a.type,null,p,n,n.mode,m),t.ref=n.ref,t.return=n,n.child=t)}if(b=t.child,!(t.lanes&m)){var x=b.memoizedProps;if(a=a.compare,a=a!==null?a:kd,a(x,p)&&t.ref===n.ref)return Bs(t,n,m)}return n.flags|=1,t=Aa(b,p),t.ref=n.ref,t.return=n,n.child=t}function xS(t,n,a,p,m){if(t!==null){var b=t.memoizedProps;if(kd(b,p)&&t.ref===n.ref)if(mi=!1,n.pendingProps=p=b,(t.lanes&m)!==0)t.flags&131072&&(mi=!0);else return n.lanes=t.lanes,Bs(t,n,m)}return a0(t,n,a,p,m)}function bS(t,n,a){var p=n.pendingProps,m=p.children,b=t!==null?t.memoizedState:null;if(p.mode==="hidden")if(!(n.mode&1))n.memoizedState={baseLanes:0,cachePool:null,transitions:null},pr(nu,ki),ki|=a;else{if(!(a&1073741824))return t=b!==null?b.baseLanes|a:a,n.lanes=n.childLanes=1073741824,n.memoizedState={baseLanes:t,cachePool:null,transitions:null},n.updateQueue=null,pr(nu,ki),ki|=t,null;n.memoizedState={baseLanes:0,cachePool:null,transitions:null},p=b!==null?b.baseLanes:a,pr(nu,ki),ki|=p}else b!==null?(p=b.baseLanes|a,n.memoizedState=null):p=a,pr(nu,ki),ki|=p;return ei(t,n,m,a),n.child}function wS(t,n){var a=n.ref;(t===null&&a!==null||t!==null&&t.ref!==a)&&(n.flags|=512,n.flags|=2097152)}function a0(t,n,a,p,m){var b=_i(a)?bl:Zn.current;return b=pu(n,b),lu(n,m),a=dv(t,n,a,p,b,m),p=pv(),t!==null&&!mi?(n.updateQueue=t.updateQueue,n.flags&=-2053,t.lanes&=~m,Bs(t,n,m)):(Pr&&p&&ev(n),n.flags|=1,ei(t,n,a,m),n.child)}function Fb(t,n,a,p,m){if(_i(a)){var b=!0;fm(n)}else b=!1;if(lu(n,m),n.stateNode===null)qf(t,n),_S(n,a,p),o0(n,a,p,m),p=!0;else if(t===null){var x=n.stateNode,c=n.memoizedProps;x.props=c;var A=x.context,j=a.contextType;typeof j=="object"&&j!==null?j=ro(j):(j=_i(a)?bl:Zn.current,j=pu(n,j));var Y=a.getDerivedStateFromProps,Q=typeof Y=="function"||typeof x.getSnapshotBeforeUpdate=="function";Q||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(c!==p||A!==j)&&kb(n,x,p,j),ya=!1;var H=n.memoizedState;x.state=H,vm(n,p,x,m),A=n.memoizedState,c!==p||H!==A||gi.current||ya?(typeof Y=="function"&&(i0(n,a,Y,p),A=n.memoizedState),(c=ya||Ib(n,a,c,p,H,A,j))?(Q||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount()),typeof x.componentDidMount=="function"&&(n.flags|=4194308)):(typeof x.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=p,n.memoizedState=A),x.props=p,x.state=A,x.context=j,p=c):(typeof x.componentDidMount=="function"&&(n.flags|=4194308),p=!1)}else{x=n.stateNode,K2(t,n),c=n.memoizedProps,j=n.type===n.elementType?c:bo(n.type,c),x.props=j,Q=n.pendingProps,H=x.context,A=a.contextType,typeof A=="object"&&A!==null?A=ro(A):(A=_i(a)?bl:Zn.current,A=pu(n,A));var G=a.getDerivedStateFromProps;(Y=typeof G=="function"||typeof x.getSnapshotBeforeUpdate=="function")||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(c!==Q||H!==A)&&kb(n,x,p,A),ya=!1,H=n.memoizedState,x.state=H,vm(n,p,x,m);var le=n.memoizedState;c!==Q||H!==le||gi.current||ya?(typeof G=="function"&&(i0(n,a,G,p),le=n.memoizedState),(j=ya||Ib(n,a,j,p,H,le,A)||!1)?(Y||typeof x.UNSAFE_componentWillUpdate!="function"&&typeof x.componentWillUpdate!="function"||(typeof x.componentWillUpdate=="function"&&x.componentWillUpdate(p,le,A),typeof x.UNSAFE_componentWillUpdate=="function"&&x.UNSAFE_componentWillUpdate(p,le,A)),typeof x.componentDidUpdate=="function"&&(n.flags|=4),typeof x.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof x.componentDidUpdate!="function"||c===t.memoizedProps&&H===t.memoizedState||(n.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&H===t.memoizedState||(n.flags|=1024),n.memoizedProps=p,n.memoizedState=le),x.props=p,x.state=le,x.context=A,p=j):(typeof x.componentDidUpdate!="function"||c===t.memoizedProps&&H===t.memoizedState||(n.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&H===t.memoizedState||(n.flags|=1024),p=!1)}return l0(t,n,a,p,b,m)}function l0(t,n,a,p,m,b){wS(t,n);var x=(n.flags&128)!==0;if(!p&&!x)return m&&bb(n,a,!1),Bs(t,n,b);p=n.stateNode,HM.current=n;var c=x&&typeof a.getDerivedStateFromError!="function"?null:p.render();return n.flags|=1,t!==null&&x?(n.child=mu(n,t.child,null,b),n.child=mu(n,null,c,b)):ei(t,n,c,b),n.memoizedState=p.state,m&&bb(n,a,!0),n.child}function SS(t){var n=t.stateNode;n.pendingContext?xb(t,n.pendingContext,n.pendingContext!==n.context):n.context&&xb(t,n.context,!1),lv(t,n.containerInfo)}function Bb(t,n,a,p,m){return fu(),rv(m),n.flags|=256,ei(t,n,a,p),n.child}var c0={dehydrated:null,treeContext:null,retryLane:0};function u0(t){return{baseLanes:t,cachePool:null,transitions:null}}function TS(t,n,a){var p=n.pendingProps,m=kr.current,b=!1,x=(n.flags&128)!==0,c;if((c=x)||(c=t!==null&&t.memoizedState===null?!1:(m&2)!==0),c?(b=!0,n.flags&=-129):(t===null||t.memoizedState!==null)&&(m|=1),pr(kr,m&1),t===null)return r0(n),t=n.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(n.mode&1?t.data==="$!"?n.lanes=8:n.lanes=1073741824:n.lanes=1,null):(x=p.children,t=p.fallback,b?(p=n.mode,b=n.child,x={mode:"hidden",children:x},!(p&1)&&b!==null?(b.childLanes=0,b.pendingProps=x):b=Wm(x,p,0,null),t=xl(t,p,a,null),b.return=n,t.return=n,b.sibling=t,n.child=b,n.child.memoizedState=u0(a),n.memoizedState=c0,t):gv(n,x));if(m=t.memoizedState,m!==null&&(c=m.dehydrated,c!==null))return XM(t,n,x,p,c,m,a);if(b){b=p.fallback,x=n.mode,m=t.child,c=m.sibling;var A={mode:"hidden",children:p.children};return!(x&1)&&n.child!==m?(p=n.child,p.childLanes=0,p.pendingProps=A,n.deletions=null):(p=Aa(m,A),p.subtreeFlags=m.subtreeFlags&14680064),c!==null?b=Aa(c,b):(b=xl(b,x,a,null),b.flags|=2),b.return=n,p.return=n,p.sibling=b,n.child=p,p=b,b=n.child,x=t.child.memoizedState,x=x===null?u0(a):{baseLanes:x.baseLanes|a,cachePool:null,transitions:x.transitions},b.memoizedState=x,b.childLanes=t.childLanes&~a,n.memoizedState=c0,p}return b=t.child,t=b.sibling,p=Aa(b,{mode:"visible",children:p.children}),!(n.mode&1)&&(p.lanes=a),p.return=n,p.sibling=null,t!==null&&(a=n.deletions,a===null?(n.deletions=[t],n.flags|=16):a.push(t)),n.child=p,n.memoizedState=null,p}function gv(t,n){return n=Wm({mode:"visible",children:n},t.mode,0,null),n.return=t,t.child=n}function If(t,n,a,p){return p!==null&&rv(p),mu(n,t.child,null,a),t=gv(n,n.pendingProps.children),t.flags|=2,n.memoizedState=null,t}function XM(t,n,a,p,m,b,x){if(a)return n.flags&256?(n.flags&=-257,p=_y(Error(Je(422))),If(t,n,x,p)):n.memoizedState!==null?(n.child=t.child,n.flags|=128,null):(b=p.fallback,m=n.mode,p=Wm({mode:"visible",children:p.children},m,0,null),b=xl(b,m,x,null),b.flags|=2,p.return=n,b.return=n,p.sibling=b,n.child=p,n.mode&1&&mu(n,t.child,null,x),n.child.memoizedState=u0(x),n.memoizedState=c0,b);if(!(n.mode&1))return If(t,n,x,null);if(m.data==="$!"){if(p=m.nextSibling&&m.nextSibling.dataset,p)var c=p.dgst;return p=c,b=Error(Je(419)),p=_y(b,p,void 0),If(t,n,x,p)}if(c=(x&t.childLanes)!==0,mi||c){if(p=Sn,p!==null){switch(x&-x){case 4:m=2;break;case 16:m=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:m=32;break;case 536870912:m=268435456;break;default:m=0}m=m&(p.suspendedLanes|x)?0:m,m!==0&&m!==b.retryLane&&(b.retryLane=m,Fs(t,m),Po(p,t,m,-1))}return wv(),p=_y(Error(Je(421))),If(t,n,x,p)}return m.data==="$?"?(n.flags|=128,n.child=t.child,n=lI.bind(null,t),m._reactRetry=n,null):(t=b.treeContext,Ri=Ea(m.nextSibling),Li=n,Pr=!0,So=null,t!==null&&(Yi[Qi++]=ks,Yi[Qi++]=As,Yi[Qi++]=wl,ks=t.id,As=t.overflow,wl=n),n=gv(n,p.children),n.flags|=4096,n)}function Ob(t,n,a){t.lanes|=n;var p=t.alternate;p!==null&&(p.lanes|=n),n0(t.return,n,a)}function yy(t,n,a,p,m){var b=t.memoizedState;b===null?t.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:p,tail:a,tailMode:m}:(b.isBackwards=n,b.rendering=null,b.renderingStartTime=0,b.last=p,b.tail=a,b.tailMode=m)}function PS(t,n,a){var p=n.pendingProps,m=p.revealOrder,b=p.tail;if(ei(t,n,p.children,a),p=kr.current,p&2)p=p&1|2,n.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=n.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Ob(t,a,n);else if(t.tag===19)Ob(t,a,n);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===n)break e;for(;t.sibling===null;){if(t.return===null||t.return===n)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}p&=1}if(pr(kr,p),!(n.mode&1))n.memoizedState=null;else switch(m){case"forwards":for(a=n.child,m=null;a!==null;)t=a.alternate,t!==null&&xm(t)===null&&(m=a),a=a.sibling;a=m,a===null?(m=n.child,n.child=null):(m=a.sibling,a.sibling=null),yy(n,!1,m,a,b);break;case"backwards":for(a=null,m=n.child,n.child=null;m!==null;){if(t=m.alternate,t!==null&&xm(t)===null){n.child=m;break}t=m.sibling,m.sibling=a,a=m,m=t}yy(n,!0,a,null,b);break;case"together":yy(n,!1,null,null,void 0);break;default:n.memoizedState=null}return n.child}function qf(t,n){!(n.mode&1)&&t!==null&&(t.alternate=null,n.alternate=null,n.flags|=2)}function Bs(t,n,a){if(t!==null&&(n.dependencies=t.dependencies),Tl|=n.lanes,!(a&n.childLanes))return null;if(t!==null&&n.child!==t.child)throw Error(Je(153));if(n.child!==null){for(t=n.child,a=Aa(t,t.pendingProps),n.child=a,a.return=n;t.sibling!==null;)t=t.sibling,a=a.sibling=Aa(t,t.pendingProps),a.return=n;a.sibling=null}return n.child}function KM(t,n,a){switch(n.tag){case 3:SS(n),fu();break;case 5:Y2(n);break;case 1:_i(n.type)&&fm(n);break;case 4:lv(n,n.stateNode.containerInfo);break;case 10:var p=n.type._context,m=n.memoizedProps.value;pr(_m,p._currentValue),p._currentValue=m;break;case 13:if(p=n.memoizedState,p!==null)return p.dehydrated!==null?(pr(kr,kr.current&1),n.flags|=128,null):a&n.child.childLanes?TS(t,n,a):(pr(kr,kr.current&1),t=Bs(t,n,a),t!==null?t.sibling:null);pr(kr,kr.current&1);break;case 19:if(p=(a&n.childLanes)!==0,t.flags&128){if(p)return PS(t,n,a);n.flags|=128}if(m=n.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),pr(kr,kr.current),p)break;return null;case 22:case 23:return n.lanes=0,bS(t,n,a)}return Bs(t,n,a)}var CS,h0,ES,MS;CS=function(t,n){for(var a=n.child;a!==null;){if(a.tag===5||a.tag===6)t.appendChild(a.stateNode);else if(a.tag!==4&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===n)break;for(;a.sibling===null;){if(a.return===null||a.return===n)return;a=a.return}a.sibling.return=a.return,a=a.sibling}};h0=function(){};ES=function(t,n,a,p){var m=t.memoizedProps;if(m!==p){t=n.stateNode,_l(Ho.current);var b=null;switch(a){case"input":m=Ry(t,m),p=Ry(t,p),b=[];break;case"select":m=Rr({},m,{value:void 0}),p=Rr({},p,{value:void 0}),b=[];break;case"textarea":m=Fy(t,m),p=Fy(t,p),b=[];break;default:typeof m.onClick!="function"&&typeof p.onClick=="function"&&(t.onclick=dm)}Oy(a,p);var x;a=null;for(j in m)if(!p.hasOwnProperty(j)&&m.hasOwnProperty(j)&&m[j]!=null)if(j==="style"){var c=m[j];for(x in c)c.hasOwnProperty(x)&&(a||(a={}),a[x]="")}else j!=="dangerouslySetInnerHTML"&&j!=="children"&&j!=="suppressContentEditableWarning"&&j!=="suppressHydrationWarning"&&j!=="autoFocus"&&(Sd.hasOwnProperty(j)?b||(b=[]):(b=b||[]).push(j,null));for(j in p){var A=p[j];if(c=m!=null?m[j]:void 0,p.hasOwnProperty(j)&&A!==c&&(A!=null||c!=null))if(j==="style")if(c){for(x in c)!c.hasOwnProperty(x)||A&&A.hasOwnProperty(x)||(a||(a={}),a[x]="");for(x in A)A.hasOwnProperty(x)&&c[x]!==A[x]&&(a||(a={}),a[x]=A[x])}else a||(b||(b=[]),b.push(j,a)),a=A;else j==="dangerouslySetInnerHTML"?(A=A?A.__html:void 0,c=c?c.__html:void 0,A!=null&&c!==A&&(b=b||[]).push(j,A)):j==="children"?typeof A!="string"&&typeof A!="number"||(b=b||[]).push(j,""+A):j!=="suppressContentEditableWarning"&&j!=="suppressHydrationWarning"&&(Sd.hasOwnProperty(j)?(A!=null&&j==="onScroll"&&vr("scroll",t),b||c===A||(b=[])):(b=b||[]).push(j,A))}a&&(b=b||[]).push("style",a);var j=b;(n.updateQueue=j)&&(n.flags|=4)}};MS=function(t,n,a,p){a!==p&&(n.flags|=4)};function td(t,n){if(!Pr)switch(t.tailMode){case"hidden":n=t.tail;for(var a=null;n!==null;)n.alternate!==null&&(a=n),n=n.sibling;a===null?t.tail=null:a.sibling=null;break;case"collapsed":a=t.tail;for(var p=null;a!==null;)a.alternate!==null&&(p=a),a=a.sibling;p===null?n||t.tail===null?t.tail=null:t.tail.sibling=null:p.sibling=null}}function $n(t){var n=t.alternate!==null&&t.alternate.child===t.child,a=0,p=0;if(n)for(var m=t.child;m!==null;)a|=m.lanes|m.childLanes,p|=m.subtreeFlags&14680064,p|=m.flags&14680064,m.return=t,m=m.sibling;else for(m=t.child;m!==null;)a|=m.lanes|m.childLanes,p|=m.subtreeFlags,p|=m.flags,m.return=t,m=m.sibling;return t.subtreeFlags|=p,t.childLanes=a,n}function YM(t,n,a){var p=n.pendingProps;switch(tv(n),n.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return $n(n),null;case 1:return _i(n.type)&&pm(),$n(n),null;case 3:return p=n.stateNode,gu(),xr(gi),xr(Zn),uv(),p.pendingContext&&(p.context=p.pendingContext,p.pendingContext=null),(t===null||t.child===null)&&(Ef(n)?n.flags|=4:t===null||t.memoizedState.isDehydrated&&!(n.flags&256)||(n.flags|=1024,So!==null&&(v0(So),So=null))),h0(t,n),$n(n),null;case 5:cv(n);var m=_l(Dd.current);if(a=n.type,t!==null&&n.stateNode!=null)ES(t,n,a,p,m),t.ref!==n.ref&&(n.flags|=512,n.flags|=2097152);else{if(!p){if(n.stateNode===null)throw Error(Je(166));return $n(n),null}if(t=_l(Ho.current),Ef(n)){p=n.stateNode,a=n.type;var b=n.memoizedProps;switch(p[qo]=n,p[Rd]=b,t=(n.mode&1)!==0,a){case"dialog":vr("cancel",p),vr("close",p);break;case"iframe":case"object":case"embed":vr("load",p);break;case"video":case"audio":for(m=0;m<cd.length;m++)vr(cd[m],p);break;case"source":vr("error",p);break;case"img":case"image":case"link":vr("error",p),vr("load",p);break;case"details":vr("toggle",p);break;case"input":W1(p,b),vr("invalid",p);break;case"select":p._wrapperState={wasMultiple:!!b.multiple},vr("invalid",p);break;case"textarea":X1(p,b),vr("invalid",p)}Oy(a,b),m=null;for(var x in b)if(b.hasOwnProperty(x)){var c=b[x];x==="children"?typeof c=="string"?p.textContent!==c&&(b.suppressHydrationWarning!==!0&&Cf(p.textContent,c,t),m=["children",c]):typeof c=="number"&&p.textContent!==""+c&&(b.suppressHydrationWarning!==!0&&Cf(p.textContent,c,t),m=["children",""+c]):Sd.hasOwnProperty(x)&&c!=null&&x==="onScroll"&&vr("scroll",p)}switch(a){case"input":yf(p),H1(p,b,!0);break;case"textarea":yf(p),K1(p);break;case"select":case"option":break;default:typeof b.onClick=="function"&&(p.onclick=dm)}p=m,n.updateQueue=p,p!==null&&(n.flags|=4)}else{x=m.nodeType===9?m:m.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=r2(a)),t==="http://www.w3.org/1999/xhtml"?a==="script"?(t=x.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof p.is=="string"?t=x.createElement(a,{is:p.is}):(t=x.createElement(a),a==="select"&&(x=t,p.multiple?x.multiple=!0:p.size&&(x.size=p.size))):t=x.createElementNS(t,a),t[qo]=n,t[Rd]=p,CS(t,n,!1,!1),n.stateNode=t;e:{switch(x=jy(a,p),a){case"dialog":vr("cancel",t),vr("close",t),m=p;break;case"iframe":case"object":case"embed":vr("load",t),m=p;break;case"video":case"audio":for(m=0;m<cd.length;m++)vr(cd[m],t);m=p;break;case"source":vr("error",t),m=p;break;case"img":case"image":case"link":vr("error",t),vr("load",t),m=p;break;case"details":vr("toggle",t),m=p;break;case"input":W1(t,p),m=Ry(t,p),vr("invalid",t);break;case"option":m=p;break;case"select":t._wrapperState={wasMultiple:!!p.multiple},m=Rr({},p,{value:void 0}),vr("invalid",t);break;case"textarea":X1(t,p),m=Fy(t,p),vr("invalid",t);break;default:m=p}Oy(a,m),c=m;for(b in c)if(c.hasOwnProperty(b)){var A=c[b];b==="style"?o2(t,A):b==="dangerouslySetInnerHTML"?(A=A?A.__html:void 0,A!=null&&n2(t,A)):b==="children"?typeof A=="string"?(a!=="textarea"||A!=="")&&Td(t,A):typeof A=="number"&&Td(t,""+A):b!=="suppressContentEditableWarning"&&b!=="suppressHydrationWarning"&&b!=="autoFocus"&&(Sd.hasOwnProperty(b)?A!=null&&b==="onScroll"&&vr("scroll",t):A!=null&&N0(t,b,A,x))}switch(a){case"input":yf(t),H1(t,p,!1);break;case"textarea":yf(t),K1(t);break;case"option":p.value!=null&&t.setAttribute("value",""+za(p.value));break;case"select":t.multiple=!!p.multiple,b=p.value,b!=null?iu(t,!!p.multiple,b,!1):p.defaultValue!=null&&iu(t,!!p.multiple,p.defaultValue,!0);break;default:typeof m.onClick=="function"&&(t.onclick=dm)}switch(a){case"button":case"input":case"select":case"textarea":p=!!p.autoFocus;break e;case"img":p=!0;break e;default:p=!1}}p&&(n.flags|=4)}n.ref!==null&&(n.flags|=512,n.flags|=2097152)}return $n(n),null;case 6:if(t&&n.stateNode!=null)MS(t,n,t.memoizedProps,p);else{if(typeof p!="string"&&n.stateNode===null)throw Error(Je(166));if(a=_l(Dd.current),_l(Ho.current),Ef(n)){if(p=n.stateNode,a=n.memoizedProps,p[qo]=n,(b=p.nodeValue!==a)&&(t=Li,t!==null))switch(t.tag){case 3:Cf(p.nodeValue,a,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Cf(p.nodeValue,a,(t.mode&1)!==0)}b&&(n.flags|=4)}else p=(a.nodeType===9?a:a.ownerDocument).createTextNode(p),p[qo]=n,n.stateNode=p}return $n(n),null;case 13:if(xr(kr),p=n.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Pr&&Ri!==null&&n.mode&1&&!(n.flags&128))q2(),fu(),n.flags|=98560,b=!1;else if(b=Ef(n),p!==null&&p.dehydrated!==null){if(t===null){if(!b)throw Error(Je(318));if(b=n.memoizedState,b=b!==null?b.dehydrated:null,!b)throw Error(Je(317));b[qo]=n}else fu(),!(n.flags&128)&&(n.memoizedState=null),n.flags|=4;$n(n),b=!1}else So!==null&&(v0(So),So=null),b=!0;if(!b)return n.flags&65536?n:null}return n.flags&128?(n.lanes=a,n):(p=p!==null,p!==(t!==null&&t.memoizedState!==null)&&p&&(n.child.flags|=8192,n.mode&1&&(t===null||kr.current&1?mn===0&&(mn=3):wv())),n.updateQueue!==null&&(n.flags|=4),$n(n),null);case 4:return gu(),h0(t,n),t===null&&Ad(n.stateNode.containerInfo),$n(n),null;case 10:return ov(n.type._context),$n(n),null;case 17:return _i(n.type)&&pm(),$n(n),null;case 19:if(xr(kr),b=n.memoizedState,b===null)return $n(n),null;if(p=(n.flags&128)!==0,x=b.rendering,x===null)if(p)td(b,!1);else{if(mn!==0||t!==null&&t.flags&128)for(t=n.child;t!==null;){if(x=xm(t),x!==null){for(n.flags|=128,td(b,!1),p=x.updateQueue,p!==null&&(n.updateQueue=p,n.flags|=4),n.subtreeFlags=0,p=a,a=n.child;a!==null;)b=a,t=p,b.flags&=14680066,x=b.alternate,x===null?(b.childLanes=0,b.lanes=t,b.child=null,b.subtreeFlags=0,b.memoizedProps=null,b.memoizedState=null,b.updateQueue=null,b.dependencies=null,b.stateNode=null):(b.childLanes=x.childLanes,b.lanes=x.lanes,b.child=x.child,b.subtreeFlags=0,b.deletions=null,b.memoizedProps=x.memoizedProps,b.memoizedState=x.memoizedState,b.updateQueue=x.updateQueue,b.type=x.type,t=x.dependencies,b.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),a=a.sibling;return pr(kr,kr.current&1|2),n.child}t=t.sibling}b.tail!==null&&Wr()>yu&&(n.flags|=128,p=!0,td(b,!1),n.lanes=4194304)}else{if(!p)if(t=xm(x),t!==null){if(n.flags|=128,p=!0,a=t.updateQueue,a!==null&&(n.updateQueue=a,n.flags|=4),td(b,!0),b.tail===null&&b.tailMode==="hidden"&&!x.alternate&&!Pr)return $n(n),null}else 2*Wr()-b.renderingStartTime>yu&&a!==1073741824&&(n.flags|=128,p=!0,td(b,!1),n.lanes=4194304);b.isBackwards?(x.sibling=n.child,n.child=x):(a=b.last,a!==null?a.sibling=x:n.child=x,b.last=x)}return b.tail!==null?(n=b.tail,b.rendering=n,b.tail=n.sibling,b.renderingStartTime=Wr(),n.sibling=null,a=kr.current,pr(kr,p?a&1|2:a&1),n):($n(n),null);case 22:case 23:return bv(),p=n.memoizedState!==null,t!==null&&t.memoizedState!==null!==p&&(n.flags|=8192),p&&n.mode&1?ki&1073741824&&($n(n),n.subtreeFlags&6&&(n.flags|=8192)):$n(n),null;case 24:return null;case 25:return null}throw Error(Je(156,n.tag))}function QM(t,n){switch(tv(n),n.tag){case 1:return _i(n.type)&&pm(),t=n.flags,t&65536?(n.flags=t&-65537|128,n):null;case 3:return gu(),xr(gi),xr(Zn),uv(),t=n.flags,t&65536&&!(t&128)?(n.flags=t&-65537|128,n):null;case 5:return cv(n),null;case 13:if(xr(kr),t=n.memoizedState,t!==null&&t.dehydrated!==null){if(n.alternate===null)throw Error(Je(340));fu()}return t=n.flags,t&65536?(n.flags=t&-65537|128,n):null;case 19:return xr(kr),null;case 4:return gu(),null;case 10:return ov(n.type._context),null;case 22:case 23:return bv(),null;case 24:return null;default:return null}}var kf=!1,Un=!1,JM=typeof WeakSet=="function"?WeakSet:Set,ft=null;function ru(t,n){var a=t.ref;if(a!==null)if(typeof a=="function")try{a(null)}catch(p){jr(t,n,p)}else a.current=null}function d0(t,n,a){try{a()}catch(p){jr(t,n,p)}}var jb=!1;function eI(t,n){if(Xy=cm,t=R2(),J0(t)){if("selectionStart"in t)var a={start:t.selectionStart,end:t.selectionEnd};else e:{a=(a=t.ownerDocument)&&a.defaultView||window;var p=a.getSelection&&a.getSelection();if(p&&p.rangeCount!==0){a=p.anchorNode;var m=p.anchorOffset,b=p.focusNode;p=p.focusOffset;try{a.nodeType,b.nodeType}catch{a=null;break e}var x=0,c=-1,A=-1,j=0,Y=0,Q=t,H=null;t:for(;;){for(var G;Q!==a||m!==0&&Q.nodeType!==3||(c=x+m),Q!==b||p!==0&&Q.nodeType!==3||(A=x+p),Q.nodeType===3&&(x+=Q.nodeValue.length),(G=Q.firstChild)!==null;)H=Q,Q=G;for(;;){if(Q===t)break t;if(H===a&&++j===m&&(c=x),H===b&&++Y===p&&(A=x),(G=Q.nextSibling)!==null)break;Q=H,H=Q.parentNode}Q=G}a=c===-1||A===-1?null:{start:c,end:A}}else a=null}a=a||{start:0,end:0}}else a=null;for(Ky={focusedElem:t,selectionRange:a},cm=!1,ft=n;ft!==null;)if(n=ft,t=n.child,(n.subtreeFlags&1028)!==0&&t!==null)t.return=n,ft=t;else for(;ft!==null;){n=ft;try{var le=n.alternate;if(n.flags&1024)switch(n.tag){case 0:case 11:case 15:break;case 1:if(le!==null){var ve=le.memoizedProps,Ae=le.memoizedState,ee=n.stateNode,re=ee.getSnapshotBeforeUpdate(n.elementType===n.type?ve:bo(n.type,ve),Ae);ee.__reactInternalSnapshotBeforeUpdate=re}break;case 3:var se=n.stateNode.containerInfo;se.nodeType===1?se.textContent="":se.nodeType===9&&se.documentElement&&se.removeChild(se.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Je(163))}}catch(_e){jr(n,n.return,_e)}if(t=n.sibling,t!==null){t.return=n.return,ft=t;break}ft=n.return}return le=jb,jb=!1,le}function vd(t,n,a){var p=n.updateQueue;if(p=p!==null?p.lastEffect:null,p!==null){var m=p=p.next;do{if((m.tag&t)===t){var b=m.destroy;m.destroy=void 0,b!==void 0&&d0(n,a,b)}m=m.next}while(m!==p)}}function Gm(t,n){if(n=n.updateQueue,n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&t)===t){var p=a.create;a.destroy=p()}a=a.next}while(a!==n)}}function p0(t){var n=t.ref;if(n!==null){var a=t.stateNode;switch(t.tag){case 5:t=a;break;default:t=a}typeof n=="function"?n(t):n.current=t}}function IS(t){var n=t.alternate;n!==null&&(t.alternate=null,IS(n)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(n=t.stateNode,n!==null&&(delete n[qo],delete n[Rd],delete n[Jy],delete n[FM],delete n[BM])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function kS(t){return t.tag===5||t.tag===3||t.tag===4}function Nb(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||kS(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function f0(t,n,a){var p=t.tag;if(p===5||p===6)t=t.stateNode,n?a.nodeType===8?a.parentNode.insertBefore(t,n):a.insertBefore(t,n):(a.nodeType===8?(n=a.parentNode,n.insertBefore(t,a)):(n=a,n.appendChild(t)),a=a._reactRootContainer,a!=null||n.onclick!==null||(n.onclick=dm));else if(p!==4&&(t=t.child,t!==null))for(f0(t,n,a),t=t.sibling;t!==null;)f0(t,n,a),t=t.sibling}function m0(t,n,a){var p=t.tag;if(p===5||p===6)t=t.stateNode,n?a.insertBefore(t,n):a.appendChild(t);else if(p!==4&&(t=t.child,t!==null))for(m0(t,n,a),t=t.sibling;t!==null;)m0(t,n,a),t=t.sibling}var Mn=null,wo=!1;function ma(t,n,a){for(a=a.child;a!==null;)AS(t,n,a),a=a.sibling}function AS(t,n,a){if(Wo&&typeof Wo.onCommitFiberUnmount=="function")try{Wo.onCommitFiberUnmount(Bm,a)}catch{}switch(a.tag){case 5:Un||ru(a,n);case 6:var p=Mn,m=wo;Mn=null,ma(t,n,a),Mn=p,wo=m,Mn!==null&&(wo?(t=Mn,a=a.stateNode,t.nodeType===8?t.parentNode.removeChild(a):t.removeChild(a)):Mn.removeChild(a.stateNode));break;case 18:Mn!==null&&(wo?(t=Mn,a=a.stateNode,t.nodeType===8?hy(t.parentNode,a):t.nodeType===1&&hy(t,a),Md(t)):hy(Mn,a.stateNode));break;case 4:p=Mn,m=wo,Mn=a.stateNode.containerInfo,wo=!0,ma(t,n,a),Mn=p,wo=m;break;case 0:case 11:case 14:case 15:if(!Un&&(p=a.updateQueue,p!==null&&(p=p.lastEffect,p!==null))){m=p=p.next;do{var b=m,x=b.destroy;b=b.tag,x!==void 0&&(b&2||b&4)&&d0(a,n,x),m=m.next}while(m!==p)}ma(t,n,a);break;case 1:if(!Un&&(ru(a,n),p=a.stateNode,typeof p.componentWillUnmount=="function"))try{p.props=a.memoizedProps,p.state=a.memoizedState,p.componentWillUnmount()}catch(c){jr(a,n,c)}ma(t,n,a);break;case 21:ma(t,n,a);break;case 22:a.mode&1?(Un=(p=Un)||a.memoizedState!==null,ma(t,n,a),Un=p):ma(t,n,a);break;default:ma(t,n,a)}}function $b(t){var n=t.updateQueue;if(n!==null){t.updateQueue=null;var a=t.stateNode;a===null&&(a=t.stateNode=new JM),n.forEach(function(p){var m=cI.bind(null,t,p);a.has(p)||(a.add(p),p.then(m,m))})}}function xo(t,n){var a=n.deletions;if(a!==null)for(var p=0;p<a.length;p++){var m=a[p];try{var b=t,x=n,c=x;e:for(;c!==null;){switch(c.tag){case 5:Mn=c.stateNode,wo=!1;break e;case 3:Mn=c.stateNode.containerInfo,wo=!0;break e;case 4:Mn=c.stateNode.containerInfo,wo=!0;break e}c=c.return}if(Mn===null)throw Error(Je(160));AS(b,x,m),Mn=null,wo=!1;var A=m.alternate;A!==null&&(A.return=null),m.return=null}catch(j){jr(m,n,j)}}if(n.subtreeFlags&12854)for(n=n.child;n!==null;)zS(n,t),n=n.sibling}function zS(t,n){var a=t.alternate,p=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(xo(n,t),$o(t),p&4){try{vd(3,t,t.return),Gm(3,t)}catch(ve){jr(t,t.return,ve)}try{vd(5,t,t.return)}catch(ve){jr(t,t.return,ve)}}break;case 1:xo(n,t),$o(t),p&512&&a!==null&&ru(a,a.return);break;case 5:if(xo(n,t),$o(t),p&512&&a!==null&&ru(a,a.return),t.flags&32){var m=t.stateNode;try{Td(m,"")}catch(ve){jr(t,t.return,ve)}}if(p&4&&(m=t.stateNode,m!=null)){var b=t.memoizedProps,x=a!==null?a.memoizedProps:b,c=t.type,A=t.updateQueue;if(t.updateQueue=null,A!==null)try{c==="input"&&b.type==="radio"&&b.name!=null&&e2(m,b),jy(c,x);var j=jy(c,b);for(x=0;x<A.length;x+=2){var Y=A[x],Q=A[x+1];Y==="style"?o2(m,Q):Y==="dangerouslySetInnerHTML"?n2(m,Q):Y==="children"?Td(m,Q):N0(m,Y,Q,j)}switch(c){case"input":Ly(m,b);break;case"textarea":t2(m,b);break;case"select":var H=m._wrapperState.wasMultiple;m._wrapperState.wasMultiple=!!b.multiple;var G=b.value;G!=null?iu(m,!!b.multiple,G,!1):H!==!!b.multiple&&(b.defaultValue!=null?iu(m,!!b.multiple,b.defaultValue,!0):iu(m,!!b.multiple,b.multiple?[]:"",!1))}m[Rd]=b}catch(ve){jr(t,t.return,ve)}}break;case 6:if(xo(n,t),$o(t),p&4){if(t.stateNode===null)throw Error(Je(162));m=t.stateNode,b=t.memoizedProps;try{m.nodeValue=b}catch(ve){jr(t,t.return,ve)}}break;case 3:if(xo(n,t),$o(t),p&4&&a!==null&&a.memoizedState.isDehydrated)try{Md(n.containerInfo)}catch(ve){jr(t,t.return,ve)}break;case 4:xo(n,t),$o(t);break;case 13:xo(n,t),$o(t),m=t.child,m.flags&8192&&(b=m.memoizedState!==null,m.stateNode.isHidden=b,!b||m.alternate!==null&&m.alternate.memoizedState!==null||(vv=Wr())),p&4&&$b(t);break;case 22:if(Y=a!==null&&a.memoizedState!==null,t.mode&1?(Un=(j=Un)||Y,xo(n,t),Un=j):xo(n,t),$o(t),p&8192){if(j=t.memoizedState!==null,(t.stateNode.isHidden=j)&&!Y&&t.mode&1)for(ft=t,Y=t.child;Y!==null;){for(Q=ft=Y;ft!==null;){switch(H=ft,G=H.child,H.tag){case 0:case 11:case 14:case 15:vd(4,H,H.return);break;case 1:ru(H,H.return);var le=H.stateNode;if(typeof le.componentWillUnmount=="function"){p=H,a=H.return;try{n=p,le.props=n.memoizedProps,le.state=n.memoizedState,le.componentWillUnmount()}catch(ve){jr(p,a,ve)}}break;case 5:ru(H,H.return);break;case 22:if(H.memoizedState!==null){Ub(Q);continue}}G!==null?(G.return=H,ft=G):Ub(Q)}Y=Y.sibling}e:for(Y=null,Q=t;;){if(Q.tag===5){if(Y===null){Y=Q;try{m=Q.stateNode,j?(b=m.style,typeof b.setProperty=="function"?b.setProperty("display","none","important"):b.display="none"):(c=Q.stateNode,A=Q.memoizedProps.style,x=A!=null&&A.hasOwnProperty("display")?A.display:null,c.style.display=i2("display",x))}catch(ve){jr(t,t.return,ve)}}}else if(Q.tag===6){if(Y===null)try{Q.stateNode.nodeValue=j?"":Q.memoizedProps}catch(ve){jr(t,t.return,ve)}}else if((Q.tag!==22&&Q.tag!==23||Q.memoizedState===null||Q===t)&&Q.child!==null){Q.child.return=Q,Q=Q.child;continue}if(Q===t)break e;for(;Q.sibling===null;){if(Q.return===null||Q.return===t)break e;Y===Q&&(Y=null),Q=Q.return}Y===Q&&(Y=null),Q.sibling.return=Q.return,Q=Q.sibling}}break;case 19:xo(n,t),$o(t),p&4&&$b(t);break;case 21:break;default:xo(n,t),$o(t)}}function $o(t){var n=t.flags;if(n&2){try{e:{for(var a=t.return;a!==null;){if(kS(a)){var p=a;break e}a=a.return}throw Error(Je(160))}switch(p.tag){case 5:var m=p.stateNode;p.flags&32&&(Td(m,""),p.flags&=-33);var b=Nb(t);m0(t,b,m);break;case 3:case 4:var x=p.stateNode.containerInfo,c=Nb(t);f0(t,c,x);break;default:throw Error(Je(161))}}catch(A){jr(t,t.return,A)}t.flags&=-3}n&4096&&(t.flags&=-4097)}function tI(t,n,a){ft=t,RS(t)}function RS(t,n,a){for(var p=(t.mode&1)!==0;ft!==null;){var m=ft,b=m.child;if(m.tag===22&&p){var x=m.memoizedState!==null||kf;if(!x){var c=m.alternate,A=c!==null&&c.memoizedState!==null||Un;c=kf;var j=Un;if(kf=x,(Un=A)&&!j)for(ft=m;ft!==null;)x=ft,A=x.child,x.tag===22&&x.memoizedState!==null?Zb(m):A!==null?(A.return=x,ft=A):Zb(m);for(;b!==null;)ft=b,RS(b),b=b.sibling;ft=m,kf=c,Un=j}Vb(t)}else m.subtreeFlags&8772&&b!==null?(b.return=m,ft=b):Vb(t)}}function Vb(t){for(;ft!==null;){var n=ft;if(n.flags&8772){var a=n.alternate;try{if(n.flags&8772)switch(n.tag){case 0:case 11:case 15:Un||Gm(5,n);break;case 1:var p=n.stateNode;if(n.flags&4&&!Un)if(a===null)p.componentDidMount();else{var m=n.elementType===n.type?a.memoizedProps:bo(n.type,a.memoizedProps);p.componentDidUpdate(m,a.memoizedState,p.__reactInternalSnapshotBeforeUpdate)}var b=n.updateQueue;b!==null&&Cb(n,b,p);break;case 3:var x=n.updateQueue;if(x!==null){if(a=null,n.child!==null)switch(n.child.tag){case 5:a=n.child.stateNode;break;case 1:a=n.child.stateNode}Cb(n,x,a)}break;case 5:var c=n.stateNode;if(a===null&&n.flags&4){a=c;var A=n.memoizedProps;switch(n.type){case"button":case"input":case"select":case"textarea":A.autoFocus&&a.focus();break;case"img":A.src&&(a.src=A.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(n.memoizedState===null){var j=n.alternate;if(j!==null){var Y=j.memoizedState;if(Y!==null){var Q=Y.dehydrated;Q!==null&&Md(Q)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Je(163))}Un||n.flags&512&&p0(n)}catch(H){jr(n,n.return,H)}}if(n===t){ft=null;break}if(a=n.sibling,a!==null){a.return=n.return,ft=a;break}ft=n.return}}function Ub(t){for(;ft!==null;){var n=ft;if(n===t){ft=null;break}var a=n.sibling;if(a!==null){a.return=n.return,ft=a;break}ft=n.return}}function Zb(t){for(;ft!==null;){var n=ft;try{switch(n.tag){case 0:case 11:case 15:var a=n.return;try{Gm(4,n)}catch(A){jr(n,a,A)}break;case 1:var p=n.stateNode;if(typeof p.componentDidMount=="function"){var m=n.return;try{p.componentDidMount()}catch(A){jr(n,m,A)}}var b=n.return;try{p0(n)}catch(A){jr(n,b,A)}break;case 5:var x=n.return;try{p0(n)}catch(A){jr(n,x,A)}}}catch(A){jr(n,n.return,A)}if(n===t){ft=null;break}var c=n.sibling;if(c!==null){c.return=n.return,ft=c;break}ft=n.return}}var rI=Math.ceil,Sm=Ns.ReactCurrentDispatcher,_v=Ns.ReactCurrentOwner,to=Ns.ReactCurrentBatchConfig,Zt=0,Sn=null,an=null,kn=0,ki=0,nu=Fa(0),mn=0,jd=null,Tl=0,qm=0,yv=0,xd=null,fi=null,vv=0,yu=1/0,Es=null,Tm=!1,g0=null,Ia=null,Af=!1,wa=null,Pm=0,bd=0,_0=null,Wf=-1,Hf=0;function ti(){return Zt&6?Wr():Wf!==-1?Wf:Wf=Wr()}function ka(t){return t.mode&1?Zt&2&&kn!==0?kn&-kn:jM.transition!==null?(Hf===0&&(Hf=_2()),Hf):(t=Jt,t!==0||(t=window.event,t=t===void 0?16:T2(t.type)),t):1}function Po(t,n,a,p){if(50<bd)throw bd=0,_0=null,Error(Je(185));qd(t,a,p),(!(Zt&2)||t!==Sn)&&(t===Sn&&(!(Zt&2)&&(qm|=a),mn===4&&xa(t,kn)),yi(t,p),a===1&&Zt===0&&!(n.mode&1)&&(yu=Wr()+500,Vm&&Ba()))}function yi(t,n){var a=t.callbackNode;jE(t,n);var p=lm(t,t===Sn?kn:0);if(p===0)a!==null&&J1(a),t.callbackNode=null,t.callbackPriority=0;else if(n=p&-p,t.callbackPriority!==n){if(a!=null&&J1(a),n===1)t.tag===0?OM(Gb.bind(null,t)):U2(Gb.bind(null,t)),LM(function(){!(Zt&6)&&Ba()}),a=null;else{switch(y2(p)){case 1:a=G0;break;case 4:a=m2;break;case 16:a=am;break;case 536870912:a=g2;break;default:a=am}a=$S(a,LS.bind(null,t))}t.callbackPriority=n,t.callbackNode=a}}function LS(t,n){if(Wf=-1,Hf=0,Zt&6)throw Error(Je(327));var a=t.callbackNode;if(cu()&&t.callbackNode!==a)return null;var p=lm(t,t===Sn?kn:0);if(p===0)return null;if(p&30||p&t.expiredLanes||n)n=Cm(t,p);else{n=p;var m=Zt;Zt|=2;var b=FS();(Sn!==t||kn!==n)&&(Es=null,yu=Wr()+500,vl(t,n));do try{oI();break}catch(c){DS(t,c)}while(!0);iv(),Sm.current=b,Zt=m,an!==null?n=0:(Sn=null,kn=0,n=mn)}if(n!==0){if(n===2&&(m=Zy(t),m!==0&&(p=m,n=y0(t,m))),n===1)throw a=jd,vl(t,0),xa(t,p),yi(t,Wr()),a;if(n===6)xa(t,p);else{if(m=t.current.alternate,!(p&30)&&!nI(m)&&(n=Cm(t,p),n===2&&(b=Zy(t),b!==0&&(p=b,n=y0(t,b))),n===1))throw a=jd,vl(t,0),xa(t,p),yi(t,Wr()),a;switch(t.finishedWork=m,t.finishedLanes=p,n){case 0:case 1:throw Error(Je(345));case 2:fl(t,fi,Es);break;case 3:if(xa(t,p),(p&130023424)===p&&(n=vv+500-Wr(),10<n)){if(lm(t,0)!==0)break;if(m=t.suspendedLanes,(m&p)!==p){ti(),t.pingedLanes|=t.suspendedLanes&m;break}t.timeoutHandle=Qy(fl.bind(null,t,fi,Es),n);break}fl(t,fi,Es);break;case 4:if(xa(t,p),(p&4194240)===p)break;for(n=t.eventTimes,m=-1;0<p;){var x=31-To(p);b=1<<x,x=n[x],x>m&&(m=x),p&=~b}if(p=m,p=Wr()-p,p=(120>p?120:480>p?480:1080>p?1080:1920>p?1920:3e3>p?3e3:4320>p?4320:1960*rI(p/1960))-p,10<p){t.timeoutHandle=Qy(fl.bind(null,t,fi,Es),p);break}fl(t,fi,Es);break;case 5:fl(t,fi,Es);break;default:throw Error(Je(329))}}}return yi(t,Wr()),t.callbackNode===a?LS.bind(null,t):null}function y0(t,n){var a=xd;return t.current.memoizedState.isDehydrated&&(vl(t,n).flags|=256),t=Cm(t,n),t!==2&&(n=fi,fi=a,n!==null&&v0(n)),t}function v0(t){fi===null?fi=t:fi.push.apply(fi,t)}function nI(t){for(var n=t;;){if(n.flags&16384){var a=n.updateQueue;if(a!==null&&(a=a.stores,a!==null))for(var p=0;p<a.length;p++){var m=a[p],b=m.getSnapshot;m=m.value;try{if(!Co(b(),m))return!1}catch{return!1}}}if(a=n.child,n.subtreeFlags&16384&&a!==null)a.return=n,n=a;else{if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function xa(t,n){for(n&=~yv,n&=~qm,t.suspendedLanes|=n,t.pingedLanes&=~n,t=t.expirationTimes;0<n;){var a=31-To(n),p=1<<a;t[a]=-1,n&=~p}}function Gb(t){if(Zt&6)throw Error(Je(327));cu();var n=lm(t,0);if(!(n&1))return yi(t,Wr()),null;var a=Cm(t,n);if(t.tag!==0&&a===2){var p=Zy(t);p!==0&&(n=p,a=y0(t,p))}if(a===1)throw a=jd,vl(t,0),xa(t,n),yi(t,Wr()),a;if(a===6)throw Error(Je(345));return t.finishedWork=t.current.alternate,t.finishedLanes=n,fl(t,fi,Es),yi(t,Wr()),null}function xv(t,n){var a=Zt;Zt|=1;try{return t(n)}finally{Zt=a,Zt===0&&(yu=Wr()+500,Vm&&Ba())}}function Pl(t){wa!==null&&wa.tag===0&&!(Zt&6)&&cu();var n=Zt;Zt|=1;var a=to.transition,p=Jt;try{if(to.transition=null,Jt=1,t)return t()}finally{Jt=p,to.transition=a,Zt=n,!(Zt&6)&&Ba()}}function bv(){ki=nu.current,xr(nu)}function vl(t,n){t.finishedWork=null,t.finishedLanes=0;var a=t.timeoutHandle;if(a!==-1&&(t.timeoutHandle=-1,RM(a)),an!==null)for(a=an.return;a!==null;){var p=a;switch(tv(p),p.tag){case 1:p=p.type.childContextTypes,p!=null&&pm();break;case 3:gu(),xr(gi),xr(Zn),uv();break;case 5:cv(p);break;case 4:gu();break;case 13:xr(kr);break;case 19:xr(kr);break;case 10:ov(p.type._context);break;case 22:case 23:bv()}a=a.return}if(Sn=t,an=t=Aa(t.current,null),kn=ki=n,mn=0,jd=null,yv=qm=Tl=0,fi=xd=null,gl!==null){for(n=0;n<gl.length;n++)if(a=gl[n],p=a.interleaved,p!==null){a.interleaved=null;var m=p.next,b=a.pending;if(b!==null){var x=b.next;b.next=m,p.next=x}a.pending=p}gl=null}return t}function DS(t,n){do{var a=an;try{if(iv(),Zf.current=wm,bm){for(var p=Ar.memoizedState;p!==null;){var m=p.queue;m!==null&&(m.pending=null),p=p.next}bm=!1}if(Sl=0,bn=fn=Ar=null,yd=!1,Fd=0,_v.current=null,a===null||a.return===null){mn=1,jd=n,an=null;break}e:{var b=t,x=a.return,c=a,A=n;if(n=kn,c.flags|=32768,A!==null&&typeof A=="object"&&typeof A.then=="function"){var j=A,Y=c,Q=Y.tag;if(!(Y.mode&1)&&(Q===0||Q===11||Q===15)){var H=Y.alternate;H?(Y.updateQueue=H.updateQueue,Y.memoizedState=H.memoizedState,Y.lanes=H.lanes):(Y.updateQueue=null,Y.memoizedState=null)}var G=zb(x);if(G!==null){G.flags&=-257,Rb(G,x,c,b,n),G.mode&1&&Ab(b,j,n),n=G,A=j;var le=n.updateQueue;if(le===null){var ve=new Set;ve.add(A),n.updateQueue=ve}else le.add(A);break e}else{if(!(n&1)){Ab(b,j,n),wv();break e}A=Error(Je(426))}}else if(Pr&&c.mode&1){var Ae=zb(x);if(Ae!==null){!(Ae.flags&65536)&&(Ae.flags|=256),Rb(Ae,x,c,b,n),rv(_u(A,c));break e}}b=A=_u(A,c),mn!==4&&(mn=2),xd===null?xd=[b]:xd.push(b),b=x;do{switch(b.tag){case 3:b.flags|=65536,n&=-n,b.lanes|=n;var ee=yS(b,A,n);Pb(b,ee);break e;case 1:c=A;var re=b.type,se=b.stateNode;if(!(b.flags&128)&&(typeof re.getDerivedStateFromError=="function"||se!==null&&typeof se.componentDidCatch=="function"&&(Ia===null||!Ia.has(se)))){b.flags|=65536,n&=-n,b.lanes|=n;var _e=vS(b,c,n);Pb(b,_e);break e}}b=b.return}while(b!==null)}OS(a)}catch(De){n=De,an===a&&a!==null&&(an=a=a.return);continue}break}while(!0)}function FS(){var t=Sm.current;return Sm.current=wm,t===null?wm:t}function wv(){(mn===0||mn===3||mn===2)&&(mn=4),Sn===null||!(Tl&268435455)&&!(qm&268435455)||xa(Sn,kn)}function Cm(t,n){var a=Zt;Zt|=2;var p=FS();(Sn!==t||kn!==n)&&(Es=null,vl(t,n));do try{iI();break}catch(m){DS(t,m)}while(!0);if(iv(),Zt=a,Sm.current=p,an!==null)throw Error(Je(261));return Sn=null,kn=0,mn}function iI(){for(;an!==null;)BS(an)}function oI(){for(;an!==null&&!kE();)BS(an)}function BS(t){var n=NS(t.alternate,t,ki);t.memoizedProps=t.pendingProps,n===null?OS(t):an=n,_v.current=null}function OS(t){var n=t;do{var a=n.alternate;if(t=n.return,n.flags&32768){if(a=QM(a,n),a!==null){a.flags&=32767,an=a;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{mn=6,an=null;return}}else if(a=YM(a,n,ki),a!==null){an=a;return}if(n=n.sibling,n!==null){an=n;return}an=n=t}while(n!==null);mn===0&&(mn=5)}function fl(t,n,a){var p=Jt,m=to.transition;try{to.transition=null,Jt=1,sI(t,n,a,p)}finally{to.transition=m,Jt=p}return null}function sI(t,n,a,p){do cu();while(wa!==null);if(Zt&6)throw Error(Je(327));a=t.finishedWork;var m=t.finishedLanes;if(a===null)return null;if(t.finishedWork=null,t.finishedLanes=0,a===t.current)throw Error(Je(177));t.callbackNode=null,t.callbackPriority=0;var b=a.lanes|a.childLanes;if(NE(t,b),t===Sn&&(an=Sn=null,kn=0),!(a.subtreeFlags&2064)&&!(a.flags&2064)||Af||(Af=!0,$S(am,function(){return cu(),null})),b=(a.flags&15990)!==0,a.subtreeFlags&15990||b){b=to.transition,to.transition=null;var x=Jt;Jt=1;var c=Zt;Zt|=4,_v.current=null,eI(t,a),zS(a,t),CM(Ky),cm=!!Xy,Ky=Xy=null,t.current=a,tI(a),AE(),Zt=c,Jt=x,to.transition=b}else t.current=a;if(Af&&(Af=!1,wa=t,Pm=m),b=t.pendingLanes,b===0&&(Ia=null),LE(a.stateNode),yi(t,Wr()),n!==null)for(p=t.onRecoverableError,a=0;a<n.length;a++)m=n[a],p(m.value,{componentStack:m.stack,digest:m.digest});if(Tm)throw Tm=!1,t=g0,g0=null,t;return Pm&1&&t.tag!==0&&cu(),b=t.pendingLanes,b&1?t===_0?bd++:(bd=0,_0=t):bd=0,Ba(),null}function cu(){if(wa!==null){var t=y2(Pm),n=to.transition,a=Jt;try{if(to.transition=null,Jt=16>t?16:t,wa===null)var p=!1;else{if(t=wa,wa=null,Pm=0,Zt&6)throw Error(Je(331));var m=Zt;for(Zt|=4,ft=t.current;ft!==null;){var b=ft,x=b.child;if(ft.flags&16){var c=b.deletions;if(c!==null){for(var A=0;A<c.length;A++){var j=c[A];for(ft=j;ft!==null;){var Y=ft;switch(Y.tag){case 0:case 11:case 15:vd(8,Y,b)}var Q=Y.child;if(Q!==null)Q.return=Y,ft=Q;else for(;ft!==null;){Y=ft;var H=Y.sibling,G=Y.return;if(IS(Y),Y===j){ft=null;break}if(H!==null){H.return=G,ft=H;break}ft=G}}}var le=b.alternate;if(le!==null){var ve=le.child;if(ve!==null){le.child=null;do{var Ae=ve.sibling;ve.sibling=null,ve=Ae}while(ve!==null)}}ft=b}}if(b.subtreeFlags&2064&&x!==null)x.return=b,ft=x;else e:for(;ft!==null;){if(b=ft,b.flags&2048)switch(b.tag){case 0:case 11:case 15:vd(9,b,b.return)}var ee=b.sibling;if(ee!==null){ee.return=b.return,ft=ee;break e}ft=b.return}}var re=t.current;for(ft=re;ft!==null;){x=ft;var se=x.child;if(x.subtreeFlags&2064&&se!==null)se.return=x,ft=se;else e:for(x=re;ft!==null;){if(c=ft,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:Gm(9,c)}}catch(De){jr(c,c.return,De)}if(c===x){ft=null;break e}var _e=c.sibling;if(_e!==null){_e.return=c.return,ft=_e;break e}ft=c.return}}if(Zt=m,Ba(),Wo&&typeof Wo.onPostCommitFiberRoot=="function")try{Wo.onPostCommitFiberRoot(Bm,t)}catch{}p=!0}return p}finally{Jt=a,to.transition=n}}return!1}function qb(t,n,a){n=_u(a,n),n=yS(t,n,1),t=Ma(t,n,1),n=ti(),t!==null&&(qd(t,1,n),yi(t,n))}function jr(t,n,a){if(t.tag===3)qb(t,t,a);else for(;n!==null;){if(n.tag===3){qb(n,t,a);break}else if(n.tag===1){var p=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(Ia===null||!Ia.has(p))){t=_u(a,t),t=vS(n,t,1),n=Ma(n,t,1),t=ti(),n!==null&&(qd(n,1,t),yi(n,t));break}}n=n.return}}function aI(t,n,a){var p=t.pingCache;p!==null&&p.delete(n),n=ti(),t.pingedLanes|=t.suspendedLanes&a,Sn===t&&(kn&a)===a&&(mn===4||mn===3&&(kn&130023424)===kn&&500>Wr()-vv?vl(t,0):yv|=a),yi(t,n)}function jS(t,n){n===0&&(t.mode&1?(n=bf,bf<<=1,!(bf&130023424)&&(bf=4194304)):n=1);var a=ti();t=Fs(t,n),t!==null&&(qd(t,n,a),yi(t,a))}function lI(t){var n=t.memoizedState,a=0;n!==null&&(a=n.retryLane),jS(t,a)}function cI(t,n){var a=0;switch(t.tag){case 13:var p=t.stateNode,m=t.memoizedState;m!==null&&(a=m.retryLane);break;case 19:p=t.stateNode;break;default:throw Error(Je(314))}p!==null&&p.delete(n),jS(t,a)}var NS;NS=function(t,n,a){if(t!==null)if(t.memoizedProps!==n.pendingProps||gi.current)mi=!0;else{if(!(t.lanes&a)&&!(n.flags&128))return mi=!1,KM(t,n,a);mi=!!(t.flags&131072)}else mi=!1,Pr&&n.flags&1048576&&Z2(n,gm,n.index);switch(n.lanes=0,n.tag){case 2:var p=n.type;qf(t,n),t=n.pendingProps;var m=pu(n,Zn.current);lu(n,a),m=dv(null,n,p,t,m,a);var b=pv();return n.flags|=1,typeof m=="object"&&m!==null&&typeof m.render=="function"&&m.$$typeof===void 0?(n.tag=1,n.memoizedState=null,n.updateQueue=null,_i(p)?(b=!0,fm(n)):b=!1,n.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,av(n),m.updater=Zm,n.stateNode=m,m._reactInternals=n,o0(n,p,t,a),n=l0(null,n,p,!0,b,a)):(n.tag=0,Pr&&b&&ev(n),ei(null,n,m,a),n=n.child),n;case 16:p=n.elementType;e:{switch(qf(t,n),t=n.pendingProps,m=p._init,p=m(p._payload),n.type=p,m=n.tag=hI(p),t=bo(p,t),m){case 0:n=a0(null,n,p,t,a);break e;case 1:n=Fb(null,n,p,t,a);break e;case 11:n=Lb(null,n,p,t,a);break e;case 14:n=Db(null,n,p,bo(p.type,t),a);break e}throw Error(Je(306,p,""))}return n;case 0:return p=n.type,m=n.pendingProps,m=n.elementType===p?m:bo(p,m),a0(t,n,p,m,a);case 1:return p=n.type,m=n.pendingProps,m=n.elementType===p?m:bo(p,m),Fb(t,n,p,m,a);case 3:e:{if(SS(n),t===null)throw Error(Je(387));p=n.pendingProps,b=n.memoizedState,m=b.element,K2(t,n),vm(n,p,null,a);var x=n.memoizedState;if(p=x.element,b.isDehydrated)if(b={element:p,isDehydrated:!1,cache:x.cache,pendingSuspenseBoundaries:x.pendingSuspenseBoundaries,transitions:x.transitions},n.updateQueue.baseState=b,n.memoizedState=b,n.flags&256){m=_u(Error(Je(423)),n),n=Bb(t,n,p,a,m);break e}else if(p!==m){m=_u(Error(Je(424)),n),n=Bb(t,n,p,a,m);break e}else for(Ri=Ea(n.stateNode.containerInfo.firstChild),Li=n,Pr=!0,So=null,a=H2(n,null,p,a),n.child=a;a;)a.flags=a.flags&-3|4096,a=a.sibling;else{if(fu(),p===m){n=Bs(t,n,a);break e}ei(t,n,p,a)}n=n.child}return n;case 5:return Y2(n),t===null&&r0(n),p=n.type,m=n.pendingProps,b=t!==null?t.memoizedProps:null,x=m.children,Yy(p,m)?x=null:b!==null&&Yy(p,b)&&(n.flags|=32),wS(t,n),ei(t,n,x,a),n.child;case 6:return t===null&&r0(n),null;case 13:return TS(t,n,a);case 4:return lv(n,n.stateNode.containerInfo),p=n.pendingProps,t===null?n.child=mu(n,null,p,a):ei(t,n,p,a),n.child;case 11:return p=n.type,m=n.pendingProps,m=n.elementType===p?m:bo(p,m),Lb(t,n,p,m,a);case 7:return ei(t,n,n.pendingProps,a),n.child;case 8:return ei(t,n,n.pendingProps.children,a),n.child;case 12:return ei(t,n,n.pendingProps.children,a),n.child;case 10:e:{if(p=n.type._context,m=n.pendingProps,b=n.memoizedProps,x=m.value,pr(_m,p._currentValue),p._currentValue=x,b!==null)if(Co(b.value,x)){if(b.children===m.children&&!gi.current){n=Bs(t,n,a);break e}}else for(b=n.child,b!==null&&(b.return=n);b!==null;){var c=b.dependencies;if(c!==null){x=b.child;for(var A=c.firstContext;A!==null;){if(A.context===p){if(b.tag===1){A=zs(-1,a&-a),A.tag=2;var j=b.updateQueue;if(j!==null){j=j.shared;var Y=j.pending;Y===null?A.next=A:(A.next=Y.next,Y.next=A),j.pending=A}}b.lanes|=a,A=b.alternate,A!==null&&(A.lanes|=a),n0(b.return,a,n),c.lanes|=a;break}A=A.next}}else if(b.tag===10)x=b.type===n.type?null:b.child;else if(b.tag===18){if(x=b.return,x===null)throw Error(Je(341));x.lanes|=a,c=x.alternate,c!==null&&(c.lanes|=a),n0(x,a,n),x=b.sibling}else x=b.child;if(x!==null)x.return=b;else for(x=b;x!==null;){if(x===n){x=null;break}if(b=x.sibling,b!==null){b.return=x.return,x=b;break}x=x.return}b=x}ei(t,n,m.children,a),n=n.child}return n;case 9:return m=n.type,p=n.pendingProps.children,lu(n,a),m=ro(m),p=p(m),n.flags|=1,ei(t,n,p,a),n.child;case 14:return p=n.type,m=bo(p,n.pendingProps),m=bo(p.type,m),Db(t,n,p,m,a);case 15:return xS(t,n,n.type,n.pendingProps,a);case 17:return p=n.type,m=n.pendingProps,m=n.elementType===p?m:bo(p,m),qf(t,n),n.tag=1,_i(p)?(t=!0,fm(n)):t=!1,lu(n,a),_S(n,p,m),o0(n,p,m,a),l0(null,n,p,!0,t,a);case 19:return PS(t,n,a);case 22:return bS(t,n,a)}throw Error(Je(156,n.tag))};function $S(t,n){return f2(t,n)}function uI(t,n,a,p){this.tag=t,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function eo(t,n,a,p){return new uI(t,n,a,p)}function Sv(t){return t=t.prototype,!(!t||!t.isReactComponent)}function hI(t){if(typeof t=="function")return Sv(t)?1:0;if(t!=null){if(t=t.$$typeof,t===V0)return 11;if(t===U0)return 14}return 2}function Aa(t,n){var a=t.alternate;return a===null?(a=eo(t.tag,n,t.key,t.mode),a.elementType=t.elementType,a.type=t.type,a.stateNode=t.stateNode,a.alternate=t,t.alternate=a):(a.pendingProps=n,a.type=t.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=t.flags&14680064,a.childLanes=t.childLanes,a.lanes=t.lanes,a.child=t.child,a.memoizedProps=t.memoizedProps,a.memoizedState=t.memoizedState,a.updateQueue=t.updateQueue,n=t.dependencies,a.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},a.sibling=t.sibling,a.index=t.index,a.ref=t.ref,a}function Xf(t,n,a,p,m,b){var x=2;if(p=t,typeof t=="function")Sv(t)&&(x=1);else if(typeof t=="string")x=5;else e:switch(t){case Wc:return xl(a.children,m,b,n);case $0:x=8,m|=8;break;case Iy:return t=eo(12,a,n,m|2),t.elementType=Iy,t.lanes=b,t;case ky:return t=eo(13,a,n,m),t.elementType=ky,t.lanes=b,t;case Ay:return t=eo(19,a,n,m),t.elementType=Ay,t.lanes=b,t;case Yw:return Wm(a,m,b,n);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Xw:x=10;break e;case Kw:x=9;break e;case V0:x=11;break e;case U0:x=14;break e;case _a:x=16,p=null;break e}throw Error(Je(130,t==null?t:typeof t,""))}return n=eo(x,a,n,m),n.elementType=t,n.type=p,n.lanes=b,n}function xl(t,n,a,p){return t=eo(7,t,p,n),t.lanes=a,t}function Wm(t,n,a,p){return t=eo(22,t,p,n),t.elementType=Yw,t.lanes=a,t.stateNode={isHidden:!1},t}function vy(t,n,a){return t=eo(6,t,null,n),t.lanes=a,t}function xy(t,n,a){return n=eo(4,t.children!==null?t.children:[],t.key,n),n.lanes=a,n.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},n}function dI(t,n,a,p,m){this.tag=n,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ey(0),this.expirationTimes=ey(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ey(0),this.identifierPrefix=p,this.onRecoverableError=m,this.mutableSourceEagerHydrationData=null}function Tv(t,n,a,p,m,b,x,c,A){return t=new dI(t,n,a,c,A),n===1?(n=1,b===!0&&(n|=8)):n=0,b=eo(3,null,null,n),t.current=b,b.stateNode=t,b.memoizedState={element:p,isDehydrated:a,cache:null,transitions:null,pendingSuspenseBoundaries:null},av(b),t}function pI(t,n,a){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:qc,key:p==null?null:""+p,children:t,containerInfo:n,implementation:a}}function VS(t){if(!t)return Ra;t=t._reactInternals;e:{if(Ml(t)!==t||t.tag!==1)throw Error(Je(170));var n=t;do{switch(n.tag){case 3:n=n.stateNode.context;break e;case 1:if(_i(n.type)){n=n.stateNode.__reactInternalMemoizedMergedChildContext;break e}}n=n.return}while(n!==null);throw Error(Je(171))}if(t.tag===1){var a=t.type;if(_i(a))return V2(t,a,n)}return n}function US(t,n,a,p,m,b,x,c,A){return t=Tv(a,p,!0,t,m,b,x,c,A),t.context=VS(null),a=t.current,p=ti(),m=ka(a),b=zs(p,m),b.callback=n??null,Ma(a,b,m),t.current.lanes=m,qd(t,m,p),yi(t,p),t}function Hm(t,n,a,p){var m=n.current,b=ti(),x=ka(m);return a=VS(a),n.context===null?n.context=a:n.pendingContext=a,n=zs(b,x),n.payload={element:t},p=p===void 0?null:p,p!==null&&(n.callback=p),t=Ma(m,n,x),t!==null&&(Po(t,m,x,b),Uf(t,m,x)),x}function Em(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Wb(t,n){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var a=t.retryLane;t.retryLane=a!==0&&a<n?a:n}}function Pv(t,n){Wb(t,n),(t=t.alternate)&&Wb(t,n)}function fI(){return null}var ZS=typeof reportError=="function"?reportError:function(t){console.error(t)};function Cv(t){this._internalRoot=t}Xm.prototype.render=Cv.prototype.render=function(t){var n=this._internalRoot;if(n===null)throw Error(Je(409));Hm(t,n,null,null)};Xm.prototype.unmount=Cv.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var n=t.containerInfo;Pl(function(){Hm(null,t,null,null)}),n[Ds]=null}};function Xm(t){this._internalRoot=t}Xm.prototype.unstable_scheduleHydration=function(t){if(t){var n=b2();t={blockedOn:null,target:t,priority:n};for(var a=0;a<va.length&&n!==0&&n<va[a].priority;a++);va.splice(a,0,t),a===0&&S2(t)}};function Ev(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Km(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Hb(){}function mI(t,n,a,p,m){if(m){if(typeof p=="function"){var b=p;p=function(){var j=Em(x);b.call(j)}}var x=US(n,p,t,0,null,!1,!1,"",Hb);return t._reactRootContainer=x,t[Ds]=x.current,Ad(t.nodeType===8?t.parentNode:t),Pl(),x}for(;m=t.lastChild;)t.removeChild(m);if(typeof p=="function"){var c=p;p=function(){var j=Em(A);c.call(j)}}var A=Tv(t,0,!1,null,null,!1,!1,"",Hb);return t._reactRootContainer=A,t[Ds]=A.current,Ad(t.nodeType===8?t.parentNode:t),Pl(function(){Hm(n,A,a,p)}),A}function Ym(t,n,a,p,m){var b=a._reactRootContainer;if(b){var x=b;if(typeof m=="function"){var c=m;m=function(){var A=Em(x);c.call(A)}}Hm(n,x,t,m)}else x=mI(a,n,t,m,p);return Em(x)}v2=function(t){switch(t.tag){case 3:var n=t.stateNode;if(n.current.memoizedState.isDehydrated){var a=ld(n.pendingLanes);a!==0&&(q0(n,a|1),yi(n,Wr()),!(Zt&6)&&(yu=Wr()+500,Ba()))}break;case 13:Pl(function(){var p=Fs(t,1);if(p!==null){var m=ti();Po(p,t,1,m)}}),Pv(t,1)}};W0=function(t){if(t.tag===13){var n=Fs(t,134217728);if(n!==null){var a=ti();Po(n,t,134217728,a)}Pv(t,134217728)}};x2=function(t){if(t.tag===13){var n=ka(t),a=Fs(t,n);if(a!==null){var p=ti();Po(a,t,n,p)}Pv(t,n)}};b2=function(){return Jt};w2=function(t,n){var a=Jt;try{return Jt=t,n()}finally{Jt=a}};$y=function(t,n,a){switch(n){case"input":if(Ly(t,a),n=a.name,a.type==="radio"&&n!=null){for(a=t;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll("input[name="+JSON.stringify(""+n)+'][type="radio"]'),n=0;n<a.length;n++){var p=a[n];if(p!==t&&p.form===t.form){var m=$m(p);if(!m)throw Error(Je(90));Jw(p),Ly(p,m)}}}break;case"textarea":t2(t,a);break;case"select":n=a.value,n!=null&&iu(t,!!a.multiple,n,!1)}};l2=xv;c2=Pl;var gI={usingClientEntryPoint:!1,Events:[Hd,Yc,$m,s2,a2,xv]},rd={findFiberByHostInstance:ml,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},_I={bundleType:rd.bundleType,version:rd.version,rendererPackageName:rd.rendererPackageName,rendererConfig:rd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ns.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=d2(t),t===null?null:t.stateNode},findFiberByHostInstance:rd.findFiberByHostInstance||fI,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var zf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!zf.isDisabled&&zf.supportsFiber)try{Bm=zf.inject(_I),Wo=zf}catch{}}ji.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=gI;ji.createPortal=function(t,n){var a=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Ev(n))throw Error(Je(200));return pI(t,n,null,a)};ji.createRoot=function(t,n){if(!Ev(t))throw Error(Je(299));var a=!1,p="",m=ZS;return n!=null&&(n.unstable_strictMode===!0&&(a=!0),n.identifierPrefix!==void 0&&(p=n.identifierPrefix),n.onRecoverableError!==void 0&&(m=n.onRecoverableError)),n=Tv(t,1,!1,null,null,a,!1,p,m),t[Ds]=n.current,Ad(t.nodeType===8?t.parentNode:t),new Cv(n)};ji.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var n=t._reactInternals;if(n===void 0)throw typeof t.render=="function"?Error(Je(188)):(t=Object.keys(t).join(","),Error(Je(268,t)));return t=d2(n),t=t===null?null:t.stateNode,t};ji.flushSync=function(t){return Pl(t)};ji.hydrate=function(t,n,a){if(!Km(n))throw Error(Je(200));return Ym(null,t,n,!0,a)};ji.hydrateRoot=function(t,n,a){if(!Ev(t))throw Error(Je(405));var p=a!=null&&a.hydratedSources||null,m=!1,b="",x=ZS;if(a!=null&&(a.unstable_strictMode===!0&&(m=!0),a.identifierPrefix!==void 0&&(b=a.identifierPrefix),a.onRecoverableError!==void 0&&(x=a.onRecoverableError)),n=US(n,null,t,1,a??null,m,!1,b,x),t[Ds]=n.current,Ad(t),p)for(t=0;t<p.length;t++)a=p[t],m=a._getVersion,m=m(a._source),n.mutableSourceEagerHydrationData==null?n.mutableSourceEagerHydrationData=[a,m]:n.mutableSourceEagerHydrationData.push(a,m);return new Xm(n)};ji.render=function(t,n,a){if(!Km(n))throw Error(Je(200));return Ym(null,t,n,!1,a)};ji.unmountComponentAtNode=function(t){if(!Km(t))throw Error(Je(40));return t._reactRootContainer?(Pl(function(){Ym(null,null,t,!1,function(){t._reactRootContainer=null,t[Ds]=null})}),!0):!1};ji.unstable_batchedUpdates=xv;ji.unstable_renderSubtreeIntoContainer=function(t,n,a,p){if(!Km(a))throw Error(Je(200));if(t==null||t._reactInternals===void 0)throw Error(Je(38));return Ym(t,n,a,!1,p)};ji.version="18.3.1-next-f1338f8080-20240426";function GS(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(GS)}catch(t){console.error(t)}}GS(),Gw.exports=ji;var yI=Gw.exports,qS,Xb=yI;qS=Xb.createRoot,Xb.hydrateRoot;var Mv={};Object.defineProperty(Mv,"__esModule",{value:!0});Mv.parse=PI;Mv.serialize=CI;const vI=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,xI=/^[\u0021-\u003A\u003C-\u007E]*$/,bI=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,wI=/^[\u0020-\u003A\u003D-\u007E]*$/,SI=Object.prototype.toString,TI=(()=>{const t=function(){};return t.prototype=Object.create(null),t})();function PI(t,n){const a=new TI,p=t.length;if(p<2)return a;const m=(n==null?void 0:n.decode)||EI;let b=0;do{const x=t.indexOf("=",b);if(x===-1)break;const c=t.indexOf(";",b),A=c===-1?p:c;if(x>A){b=t.lastIndexOf(";",x-1)+1;continue}const j=Kb(t,b,x),Y=Yb(t,x,j),Q=t.slice(j,Y);if(a[Q]===void 0){let H=Kb(t,x+1,A),G=Yb(t,A,H);const le=m(t.slice(H,G));a[Q]=le}b=A+1}while(b<p);return a}function Kb(t,n,a){do{const p=t.charCodeAt(n);if(p!==32&&p!==9)return n}while(++n<a);return a}function Yb(t,n,a){for(;n>a;){const p=t.charCodeAt(--n);if(p!==32&&p!==9)return n+1}return a}function CI(t,n,a){const p=(a==null?void 0:a.encode)||encodeURIComponent;if(!vI.test(t))throw new TypeError(`argument name is invalid: ${t}`);const m=p(n);if(!xI.test(m))throw new TypeError(`argument val is invalid: ${n}`);let b=t+"="+m;if(!a)return b;if(a.maxAge!==void 0){if(!Number.isInteger(a.maxAge))throw new TypeError(`option maxAge is invalid: ${a.maxAge}`);b+="; Max-Age="+a.maxAge}if(a.domain){if(!bI.test(a.domain))throw new TypeError(`option domain is invalid: ${a.domain}`);b+="; Domain="+a.domain}if(a.path){if(!wI.test(a.path))throw new TypeError(`option path is invalid: ${a.path}`);b+="; Path="+a.path}if(a.expires){if(!MI(a.expires)||!Number.isFinite(a.expires.valueOf()))throw new TypeError(`option expires is invalid: ${a.expires}`);b+="; Expires="+a.expires.toUTCString()}if(a.httpOnly&&(b+="; HttpOnly"),a.secure&&(b+="; Secure"),a.partitioned&&(b+="; Partitioned"),a.priority)switch(typeof a.priority=="string"?a.priority.toLowerCase():void 0){case"low":b+="; Priority=Low";break;case"medium":b+="; Priority=Medium";break;case"high":b+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${a.priority}`)}if(a.sameSite)switch(typeof a.sameSite=="string"?a.sameSite.toLowerCase():a.sameSite){case!0:case"strict":b+="; SameSite=Strict";break;case"lax":b+="; SameSite=Lax";break;case"none":b+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${a.sameSite}`)}return b}function EI(t){if(t.indexOf("%")===-1)return t;try{return decodeURIComponent(t)}catch{return t}}function MI(t){return SI.call(t)==="[object Date]"}/**
 * react-router v7.3.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var Qb="popstate";function II(t={}){function n(p,m){let{pathname:b,search:x,hash:c}=p.location;return x0("",{pathname:b,search:x,hash:c},m.state&&m.state.usr||null,m.state&&m.state.key||"default")}function a(p,m){return typeof m=="string"?m:Nd(m)}return AI(n,a,null,t)}function zr(t,n){if(t===!1||t===null||typeof t>"u")throw new Error(n)}function Ko(t,n){if(!t){typeof console<"u"&&console.warn(n);try{throw new Error(n)}catch{}}}function kI(){return Math.random().toString(36).substring(2,10)}function Jb(t,n){return{usr:t.state,key:t.key,idx:n}}function x0(t,n,a=null,p){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof n=="string"?Pu(n):n,state:a,key:n&&n.key||p||kI()}}function Nd({pathname:t="/",search:n="",hash:a=""}){return n&&n!=="?"&&(t+=n.charAt(0)==="?"?n:"?"+n),a&&a!=="#"&&(t+=a.charAt(0)==="#"?a:"#"+a),t}function Pu(t){let n={};if(t){let a=t.indexOf("#");a>=0&&(n.hash=t.substring(a),t=t.substring(0,a));let p=t.indexOf("?");p>=0&&(n.search=t.substring(p),t=t.substring(0,p)),t&&(n.pathname=t)}return n}function AI(t,n,a,p={}){let{window:m=document.defaultView,v5Compat:b=!1}=p,x=m.history,c="POP",A=null,j=Y();j==null&&(j=0,x.replaceState({...x.state,idx:j},""));function Y(){return(x.state||{idx:null}).idx}function Q(){c="POP";let Ae=Y(),ee=Ae==null?null:Ae-j;j=Ae,A&&A({action:c,location:ve.location,delta:ee})}function H(Ae,ee){c="PUSH";let re=x0(ve.location,Ae,ee);j=Y()+1;let se=Jb(re,j),_e=ve.createHref(re);try{x.pushState(se,"",_e)}catch(De){if(De instanceof DOMException&&De.name==="DataCloneError")throw De;m.location.assign(_e)}b&&A&&A({action:c,location:ve.location,delta:1})}function G(Ae,ee){c="REPLACE";let re=x0(ve.location,Ae,ee);j=Y();let se=Jb(re,j),_e=ve.createHref(re);x.replaceState(se,"",_e),b&&A&&A({action:c,location:ve.location,delta:0})}function le(Ae){let ee=m.location.origin!=="null"?m.location.origin:m.location.href,re=typeof Ae=="string"?Ae:Nd(Ae);return re=re.replace(/ $/,"%20"),zr(ee,`No window.location.(origin|href) available to create URL for href: ${re}`),new URL(re,ee)}let ve={get action(){return c},get location(){return t(m,x)},listen(Ae){if(A)throw new Error("A history only accepts one active listener");return m.addEventListener(Qb,Q),A=Ae,()=>{m.removeEventListener(Qb,Q),A=null}},createHref(Ae){return n(m,Ae)},createURL:le,encodeLocation(Ae){let ee=le(Ae);return{pathname:ee.pathname,search:ee.search,hash:ee.hash}},push:H,replace:G,go(Ae){return x.go(Ae)}};return ve}function WS(t,n,a="/"){return zI(t,n,a,!1)}function zI(t,n,a,p){let m=typeof n=="string"?Pu(n):n,b=Os(m.pathname||"/",a);if(b==null)return null;let x=HS(t);RI(x);let c=null;for(let A=0;c==null&&A<x.length;++A){let j=ZI(b);c=VI(x[A],j,p)}return c}function HS(t,n=[],a=[],p=""){let m=(b,x,c)=>{let A={relativePath:c===void 0?b.path||"":c,caseSensitive:b.caseSensitive===!0,childrenIndex:x,route:b};A.relativePath.startsWith("/")&&(zr(A.relativePath.startsWith(p),`Absolute route path "${A.relativePath}" nested under path "${p}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),A.relativePath=A.relativePath.slice(p.length));let j=Rs([p,A.relativePath]),Y=a.concat(A);b.children&&b.children.length>0&&(zr(b.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${j}".`),HS(b.children,n,Y,j)),!(b.path==null&&!b.index)&&n.push({path:j,score:NI(j,b.index),routesMeta:Y})};return t.forEach((b,x)=>{var c;if(b.path===""||!((c=b.path)!=null&&c.includes("?")))m(b,x);else for(let A of XS(b.path))m(b,x,A)}),n}function XS(t){let n=t.split("/");if(n.length===0)return[];let[a,...p]=n,m=a.endsWith("?"),b=a.replace(/\?$/,"");if(p.length===0)return m?[b,""]:[b];let x=XS(p.join("/")),c=[];return c.push(...x.map(A=>A===""?b:[b,A].join("/"))),m&&c.push(...x),c.map(A=>t.startsWith("/")&&A===""?"/":A)}function RI(t){t.sort((n,a)=>n.score!==a.score?a.score-n.score:$I(n.routesMeta.map(p=>p.childrenIndex),a.routesMeta.map(p=>p.childrenIndex)))}var LI=/^:[\w-]+$/,DI=3,FI=2,BI=1,OI=10,jI=-2,ew=t=>t==="*";function NI(t,n){let a=t.split("/"),p=a.length;return a.some(ew)&&(p+=jI),n&&(p+=FI),a.filter(m=>!ew(m)).reduce((m,b)=>m+(LI.test(b)?DI:b===""?BI:OI),p)}function $I(t,n){return t.length===n.length&&t.slice(0,-1).every((p,m)=>p===n[m])?t[t.length-1]-n[n.length-1]:0}function VI(t,n,a=!1){let{routesMeta:p}=t,m={},b="/",x=[];for(let c=0;c<p.length;++c){let A=p[c],j=c===p.length-1,Y=b==="/"?n:n.slice(b.length)||"/",Q=Mm({path:A.relativePath,caseSensitive:A.caseSensitive,end:j},Y),H=A.route;if(!Q&&j&&a&&!p[p.length-1].route.index&&(Q=Mm({path:A.relativePath,caseSensitive:A.caseSensitive,end:!1},Y)),!Q)return null;Object.assign(m,Q.params),x.push({params:m,pathname:Rs([b,Q.pathname]),pathnameBase:HI(Rs([b,Q.pathnameBase])),route:H}),Q.pathnameBase!=="/"&&(b=Rs([b,Q.pathnameBase]))}return x}function Mm(t,n){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[a,p]=UI(t.path,t.caseSensitive,t.end),m=n.match(a);if(!m)return null;let b=m[0],x=b.replace(/(.)\/+$/,"$1"),c=m.slice(1);return{params:p.reduce((j,{paramName:Y,isOptional:Q},H)=>{if(Y==="*"){let le=c[H]||"";x=b.slice(0,b.length-le.length).replace(/(.)\/+$/,"$1")}const G=c[H];return Q&&!G?j[Y]=void 0:j[Y]=(G||"").replace(/%2F/g,"/"),j},{}),pathname:b,pathnameBase:x,pattern:t}}function UI(t,n=!1,a=!0){Ko(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let p=[],m="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(x,c,A)=>(p.push({paramName:c,isOptional:A!=null}),A?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(p.push({paramName:"*"}),m+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):a?m+="\\/*$":t!==""&&t!=="/"&&(m+="(?:(?=\\/|$))"),[new RegExp(m,n?void 0:"i"),p]}function ZI(t){try{return t.split("/").map(n=>decodeURIComponent(n).replace(/\//g,"%2F")).join("/")}catch(n){return Ko(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${n}).`),t}}function Os(t,n){if(n==="/")return t;if(!t.toLowerCase().startsWith(n.toLowerCase()))return null;let a=n.endsWith("/")?n.length-1:n.length,p=t.charAt(a);return p&&p!=="/"?null:t.slice(a)||"/"}function GI(t,n="/"){let{pathname:a,search:p="",hash:m=""}=typeof t=="string"?Pu(t):t;return{pathname:a?a.startsWith("/")?a:qI(a,n):n,search:XI(p),hash:KI(m)}}function qI(t,n){let a=n.replace(/\/+$/,"").split("/");return t.split("/").forEach(m=>{m===".."?a.length>1&&a.pop():m!=="."&&a.push(m)}),a.length>1?a.join("/"):"/"}function by(t,n,a,p){return`Cannot include a '${t}' character in a manually specified \`to.${n}\` field [${JSON.stringify(p)}].  Please separate it out to the \`to.${a}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function WI(t){return t.filter((n,a)=>a===0||n.route.path&&n.route.path.length>0)}function KS(t){let n=WI(t);return n.map((a,p)=>p===n.length-1?a.pathname:a.pathnameBase)}function YS(t,n,a,p=!1){let m;typeof t=="string"?m=Pu(t):(m={...t},zr(!m.pathname||!m.pathname.includes("?"),by("?","pathname","search",m)),zr(!m.pathname||!m.pathname.includes("#"),by("#","pathname","hash",m)),zr(!m.search||!m.search.includes("#"),by("#","search","hash",m)));let b=t===""||m.pathname==="",x=b?"/":m.pathname,c;if(x==null)c=a;else{let Q=n.length-1;if(!p&&x.startsWith("..")){let H=x.split("/");for(;H[0]==="..";)H.shift(),Q-=1;m.pathname=H.join("/")}c=Q>=0?n[Q]:"/"}let A=GI(m,c),j=x&&x!=="/"&&x.endsWith("/"),Y=(b||x===".")&&a.endsWith("/");return!A.pathname.endsWith("/")&&(j||Y)&&(A.pathname+="/"),A}var Rs=t=>t.join("/").replace(/\/\/+/g,"/"),HI=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),XI=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,KI=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function YI(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}var QS=["POST","PUT","PATCH","DELETE"];new Set(QS);var QI=["GET",...QS];new Set(QI);var Cu=we.createContext(null);Cu.displayName="DataRouter";var Qm=we.createContext(null);Qm.displayName="DataRouterState";var JS=we.createContext({isTransitioning:!1});JS.displayName="ViewTransition";var JI=we.createContext(new Map);JI.displayName="Fetchers";var ek=we.createContext(null);ek.displayName="Await";var Jo=we.createContext(null);Jo.displayName="Navigation";var Kd=we.createContext(null);Kd.displayName="Location";var $s=we.createContext({outlet:null,matches:[],isDataRoute:!1});$s.displayName="Route";var Iv=we.createContext(null);Iv.displayName="RouteError";function tk(t,{relative:n}={}){zr(Yd(),"useHref() may be used only in the context of a <Router> component.");let{basename:a,navigator:p}=we.useContext(Jo),{hash:m,pathname:b,search:x}=Qd(t,{relative:n}),c=b;return a!=="/"&&(c=b==="/"?a:Rs([a,b])),p.createHref({pathname:c,search:x,hash:m})}function Yd(){return we.useContext(Kd)!=null}function Il(){return zr(Yd(),"useLocation() may be used only in the context of a <Router> component."),we.useContext(Kd).location}var eT="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function tT(t){we.useContext(Jo).static||we.useLayoutEffect(t)}function rk(){let{isDataRoute:t}=we.useContext($s);return t?mk():nk()}function nk(){zr(Yd(),"useNavigate() may be used only in the context of a <Router> component.");let t=we.useContext(Cu),{basename:n,navigator:a}=we.useContext(Jo),{matches:p}=we.useContext($s),{pathname:m}=Il(),b=JSON.stringify(KS(p)),x=we.useRef(!1);return tT(()=>{x.current=!0}),we.useCallback((A,j={})=>{if(Ko(x.current,eT),!x.current)return;if(typeof A=="number"){a.go(A);return}let Y=YS(A,JSON.parse(b),m,j.relative==="path");t==null&&n!=="/"&&(Y.pathname=Y.pathname==="/"?n:Rs([n,Y.pathname])),(j.replace?a.replace:a.push)(Y,j.state,j)},[n,a,b,m,t])}we.createContext(null);function Qd(t,{relative:n}={}){let{matches:a}=we.useContext($s),{pathname:p}=Il(),m=JSON.stringify(KS(a));return we.useMemo(()=>YS(t,JSON.parse(m),p,n==="path"),[t,m,p,n])}function ik(t,n){return rT(t,n)}function rT(t,n,a,p){var re;zr(Yd(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:m,static:b}=we.useContext(Jo),{matches:x}=we.useContext($s),c=x[x.length-1],A=c?c.params:{},j=c?c.pathname:"/",Y=c?c.pathnameBase:"/",Q=c&&c.route;{let se=Q&&Q.path||"";nT(j,!Q||se.endsWith("*")||se.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${j}" (under <Route path="${se}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${se}"> to <Route path="${se==="/"?"*":`${se}/*`}">.`)}let H=Il(),G;if(n){let se=typeof n=="string"?Pu(n):n;zr(Y==="/"||((re=se.pathname)==null?void 0:re.startsWith(Y)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${Y}" but pathname "${se.pathname}" was given in the \`location\` prop.`),G=se}else G=H;let le=G.pathname||"/",ve=le;if(Y!=="/"){let se=Y.replace(/^\//,"").split("/");ve="/"+le.replace(/^\//,"").split("/").slice(se.length).join("/")}let Ae=!b&&a&&a.matches&&a.matches.length>0?a.matches:WS(t,{pathname:ve});Ko(Q||Ae!=null,`No routes matched location "${G.pathname}${G.search}${G.hash}" `),Ko(Ae==null||Ae[Ae.length-1].route.element!==void 0||Ae[Ae.length-1].route.Component!==void 0||Ae[Ae.length-1].route.lazy!==void 0,`Matched leaf route at location "${G.pathname}${G.search}${G.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let ee=ck(Ae&&Ae.map(se=>Object.assign({},se,{params:Object.assign({},A,se.params),pathname:Rs([Y,m.encodeLocation?m.encodeLocation(se.pathname).pathname:se.pathname]),pathnameBase:se.pathnameBase==="/"?Y:Rs([Y,m.encodeLocation?m.encodeLocation(se.pathnameBase).pathname:se.pathnameBase])})),x,a,p);return n&&ee?we.createElement(Kd.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...G},navigationType:"POP"}},ee):ee}function ok(){let t=fk(),n=YI(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),a=t instanceof Error?t.stack:null,p="rgba(200,200,200, 0.5)",m={padding:"0.5rem",backgroundColor:p},b={padding:"2px 4px",backgroundColor:p},x=null;return console.error("Error handled by React Router default ErrorBoundary:",t),x=we.createElement(we.Fragment,null,we.createElement("p",null," Hey developer "),we.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",we.createElement("code",{style:b},"ErrorBoundary")," or"," ",we.createElement("code",{style:b},"errorElement")," prop on your route.")),we.createElement(we.Fragment,null,we.createElement("h2",null,"Unexpected Application Error!"),we.createElement("h3",{style:{fontStyle:"italic"}},n),a?we.createElement("pre",{style:m},a):null,x)}var sk=we.createElement(ok,null),ak=class extends we.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,n){return n.location!==t.location||n.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:n.error,location:n.location,revalidation:t.revalidation||n.revalidation}}componentDidCatch(t,n){console.error("React Router caught the following error during render",t,n)}render(){return this.state.error!==void 0?we.createElement($s.Provider,{value:this.props.routeContext},we.createElement(Iv.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function lk({routeContext:t,match:n,children:a}){let p=we.useContext(Cu);return p&&p.static&&p.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(p.staticContext._deepestRenderedBoundaryId=n.route.id),we.createElement($s.Provider,{value:t},a)}function ck(t,n=[],a=null,p=null){if(t==null){if(!a)return null;if(a.errors)t=a.matches;else if(n.length===0&&!a.initialized&&a.matches.length>0)t=a.matches;else return null}let m=t,b=a==null?void 0:a.errors;if(b!=null){let A=m.findIndex(j=>j.route.id&&(b==null?void 0:b[j.route.id])!==void 0);zr(A>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(b).join(",")}`),m=m.slice(0,Math.min(m.length,A+1))}let x=!1,c=-1;if(a)for(let A=0;A<m.length;A++){let j=m[A];if((j.route.HydrateFallback||j.route.hydrateFallbackElement)&&(c=A),j.route.id){let{loaderData:Y,errors:Q}=a,H=j.route.loader&&!Y.hasOwnProperty(j.route.id)&&(!Q||Q[j.route.id]===void 0);if(j.route.lazy||H){x=!0,c>=0?m=m.slice(0,c+1):m=[m[0]];break}}}return m.reduceRight((A,j,Y)=>{let Q,H=!1,G=null,le=null;a&&(Q=b&&j.route.id?b[j.route.id]:void 0,G=j.route.errorElement||sk,x&&(c<0&&Y===0?(nT("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),H=!0,le=null):c===Y&&(H=!0,le=j.route.hydrateFallbackElement||null)));let ve=n.concat(m.slice(0,Y+1)),Ae=()=>{let ee;return Q?ee=G:H?ee=le:j.route.Component?ee=we.createElement(j.route.Component,null):j.route.element?ee=j.route.element:ee=A,we.createElement(lk,{match:j,routeContext:{outlet:A,matches:ve,isDataRoute:a!=null},children:ee})};return a&&(j.route.ErrorBoundary||j.route.errorElement||Y===0)?we.createElement(ak,{location:a.location,revalidation:a.revalidation,component:G,error:Q,children:Ae(),routeContext:{outlet:null,matches:ve,isDataRoute:!0}}):Ae()},null)}function kv(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function uk(t){let n=we.useContext(Cu);return zr(n,kv(t)),n}function hk(t){let n=we.useContext(Qm);return zr(n,kv(t)),n}function dk(t){let n=we.useContext($s);return zr(n,kv(t)),n}function Av(t){let n=dk(t),a=n.matches[n.matches.length-1];return zr(a.route.id,`${t} can only be used on routes that contain a unique "id"`),a.route.id}function pk(){return Av("useRouteId")}function fk(){var p;let t=we.useContext(Iv),n=hk("useRouteError"),a=Av("useRouteError");return t!==void 0?t:(p=n.errors)==null?void 0:p[a]}function mk(){let{router:t}=uk("useNavigate"),n=Av("useNavigate"),a=we.useRef(!1);return tT(()=>{a.current=!0}),we.useCallback(async(m,b={})=>{Ko(a.current,eT),a.current&&(typeof m=="number"?t.navigate(m):await t.navigate(m,{fromRouteId:n,...b}))},[t,n])}var tw={};function nT(t,n,a){!n&&!tw[t]&&(tw[t]=!0,Ko(!1,a))}we.memo(gk);function gk({routes:t,future:n,state:a}){return rT(t,void 0,a,n)}function ud(t){zr(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function _k({basename:t="/",children:n=null,location:a,navigationType:p="POP",navigator:m,static:b=!1}){zr(!Yd(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let x=t.replace(/^\/*/,"/"),c=we.useMemo(()=>({basename:x,navigator:m,static:b,future:{}}),[x,m,b]);typeof a=="string"&&(a=Pu(a));let{pathname:A="/",search:j="",hash:Y="",state:Q=null,key:H="default"}=a,G=we.useMemo(()=>{let le=Os(A,x);return le==null?null:{location:{pathname:le,search:j,hash:Y,state:Q,key:H},navigationType:p}},[x,A,j,Y,Q,H,p]);return Ko(G!=null,`<Router basename="${x}"> is not able to match the URL "${A}${j}${Y}" because it does not start with the basename, so the <Router> won't render anything.`),G==null?null:we.createElement(Jo.Provider,{value:c},we.createElement(Kd.Provider,{children:n,value:G}))}function yk({children:t,location:n}){return ik(b0(t),n)}function b0(t,n=[]){let a=[];return we.Children.forEach(t,(p,m)=>{if(!we.isValidElement(p))return;let b=[...n,m];if(p.type===we.Fragment){a.push.apply(a,b0(p.props.children,b));return}zr(p.type===ud,`[${typeof p.type=="string"?p.type:p.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),zr(!p.props.index||!p.props.children,"An index route cannot have child routes.");let x={id:p.props.id||b.join("-"),caseSensitive:p.props.caseSensitive,element:p.props.element,Component:p.props.Component,index:p.props.index,path:p.props.path,loader:p.props.loader,action:p.props.action,hydrateFallbackElement:p.props.hydrateFallbackElement,HydrateFallback:p.props.HydrateFallback,errorElement:p.props.errorElement,ErrorBoundary:p.props.ErrorBoundary,hasErrorBoundary:p.props.hasErrorBoundary===!0||p.props.ErrorBoundary!=null||p.props.errorElement!=null,shouldRevalidate:p.props.shouldRevalidate,handle:p.props.handle,lazy:p.props.lazy};p.props.children&&(x.children=b0(p.props.children,b)),a.push(x)}),a}var Kf="get",Yf="application/x-www-form-urlencoded";function Jm(t){return t!=null&&typeof t.tagName=="string"}function vk(t){return Jm(t)&&t.tagName.toLowerCase()==="button"}function xk(t){return Jm(t)&&t.tagName.toLowerCase()==="form"}function bk(t){return Jm(t)&&t.tagName.toLowerCase()==="input"}function wk(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function Sk(t,n){return t.button===0&&(!n||n==="_self")&&!wk(t)}var Rf=null;function Tk(){if(Rf===null)try{new FormData(document.createElement("form"),0),Rf=!1}catch{Rf=!0}return Rf}var Pk=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function wy(t){return t!=null&&!Pk.has(t)?(Ko(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Yf}"`),null):t}function Ck(t,n){let a,p,m,b,x;if(xk(t)){let c=t.getAttribute("action");p=c?Os(c,n):null,a=t.getAttribute("method")||Kf,m=wy(t.getAttribute("enctype"))||Yf,b=new FormData(t)}else if(vk(t)||bk(t)&&(t.type==="submit"||t.type==="image")){let c=t.form;if(c==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let A=t.getAttribute("formaction")||c.getAttribute("action");if(p=A?Os(A,n):null,a=t.getAttribute("formmethod")||c.getAttribute("method")||Kf,m=wy(t.getAttribute("formenctype"))||wy(c.getAttribute("enctype"))||Yf,b=new FormData(c,t),!Tk()){let{name:j,type:Y,value:Q}=t;if(Y==="image"){let H=j?`${j}.`:"";b.append(`${H}x`,"0"),b.append(`${H}y`,"0")}else j&&b.append(j,Q)}}else{if(Jm(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');a=Kf,p=null,m=Yf,x=t}return b&&m==="text/plain"&&(x=b,b=void 0),{action:p,method:a.toLowerCase(),encType:m,formData:b,body:x}}function zv(t,n){if(t===!1||t===null||typeof t>"u")throw new Error(n)}async function Ek(t,n){if(t.id in n)return n[t.id];try{let a=await import(t.module);return n[t.id]=a,a}catch(a){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(a),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Mk(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function Ik(t,n,a){let p=await Promise.all(t.map(async m=>{let b=n.routes[m.route.id];if(b){let x=await Ek(b,a);return x.links?x.links():[]}return[]}));return Rk(p.flat(1).filter(Mk).filter(m=>m.rel==="stylesheet"||m.rel==="preload").map(m=>m.rel==="stylesheet"?{...m,rel:"prefetch",as:"style"}:{...m,rel:"prefetch"}))}function rw(t,n,a,p,m,b){let x=(A,j)=>a[j]?A.route.id!==a[j].route.id:!0,c=(A,j)=>{var Y;return a[j].pathname!==A.pathname||((Y=a[j].route.path)==null?void 0:Y.endsWith("*"))&&a[j].params["*"]!==A.params["*"]};return b==="assets"?n.filter((A,j)=>x(A,j)||c(A,j)):b==="data"?n.filter((A,j)=>{var Q;let Y=p.routes[A.route.id];if(!Y||!Y.hasLoader)return!1;if(x(A,j)||c(A,j))return!0;if(A.route.shouldRevalidate){let H=A.route.shouldRevalidate({currentUrl:new URL(m.pathname+m.search+m.hash,window.origin),currentParams:((Q=a[0])==null?void 0:Q.params)||{},nextUrl:new URL(t,window.origin),nextParams:A.params,defaultShouldRevalidate:!0});if(typeof H=="boolean")return H}return!0}):[]}function kk(t,n,{includeHydrateFallback:a}={}){return Ak(t.map(p=>{let m=n.routes[p.route.id];if(!m)return[];let b=[m.module];return m.clientActionModule&&(b=b.concat(m.clientActionModule)),m.clientLoaderModule&&(b=b.concat(m.clientLoaderModule)),a&&m.hydrateFallbackModule&&(b=b.concat(m.hydrateFallbackModule)),m.imports&&(b=b.concat(m.imports)),b}).flat(1))}function Ak(t){return[...new Set(t)]}function zk(t){let n={},a=Object.keys(t).sort();for(let p of a)n[p]=t[p];return n}function Rk(t,n){let a=new Set;return new Set(n),t.reduce((p,m)=>{let b=JSON.stringify(zk(m));return a.has(b)||(a.add(b),p.push({key:b,link:m})),p},[])}function Lk(t,n){let a=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return a.pathname==="/"?a.pathname="_root.data":n&&Os(a.pathname,n)==="/"?a.pathname=`${n.replace(/\/$/,"")}/_root.data`:a.pathname=`${a.pathname.replace(/\/$/,"")}.data`,a}function iT(){let t=we.useContext(Cu);return zv(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function Dk(){let t=we.useContext(Qm);return zv(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var Rv=we.createContext(void 0);Rv.displayName="FrameworkContext";function oT(){let t=we.useContext(Rv);return zv(t,"You must render this element inside a <HydratedRouter> element"),t}function Fk(t,n){let a=we.useContext(Rv),[p,m]=we.useState(!1),[b,x]=we.useState(!1),{onFocus:c,onBlur:A,onMouseEnter:j,onMouseLeave:Y,onTouchStart:Q}=n,H=we.useRef(null);we.useEffect(()=>{if(t==="render"&&x(!0),t==="viewport"){let ve=ee=>{ee.forEach(re=>{x(re.isIntersecting)})},Ae=new IntersectionObserver(ve,{threshold:.5});return H.current&&Ae.observe(H.current),()=>{Ae.disconnect()}}},[t]),we.useEffect(()=>{if(p){let ve=setTimeout(()=>{x(!0)},100);return()=>{clearTimeout(ve)}}},[p]);let G=()=>{m(!0)},le=()=>{m(!1),x(!1)};return a?t!=="intent"?[b,H,{}]:[b,H,{onFocus:nd(c,G),onBlur:nd(A,le),onMouseEnter:nd(j,G),onMouseLeave:nd(Y,le),onTouchStart:nd(Q,G)}]:[!1,H,{}]}function nd(t,n){return a=>{t&&t(a),a.defaultPrevented||n(a)}}function Bk({page:t,...n}){let{router:a}=iT(),p=we.useMemo(()=>WS(a.routes,t,a.basename),[a.routes,t,a.basename]);return p?we.createElement(jk,{page:t,matches:p,...n}):null}function Ok(t){let{manifest:n,routeModules:a}=oT(),[p,m]=we.useState([]);return we.useEffect(()=>{let b=!1;return Ik(t,n,a).then(x=>{b||m(x)}),()=>{b=!0}},[t,n,a]),p}function jk({page:t,matches:n,...a}){let p=Il(),{manifest:m,routeModules:b}=oT(),{basename:x}=iT(),{loaderData:c,matches:A}=Dk(),j=we.useMemo(()=>rw(t,n,A,m,p,"data"),[t,n,A,m,p]),Y=we.useMemo(()=>rw(t,n,A,m,p,"assets"),[t,n,A,m,p]),Q=we.useMemo(()=>{if(t===p.pathname+p.search+p.hash)return[];let le=new Set,ve=!1;if(n.forEach(ee=>{var se;let re=m.routes[ee.route.id];!re||!re.hasLoader||(!j.some(_e=>_e.route.id===ee.route.id)&&ee.route.id in c&&((se=b[ee.route.id])!=null&&se.shouldRevalidate)||re.hasClientLoader?ve=!0:le.add(ee.route.id))}),le.size===0)return[];let Ae=Lk(t,x);return ve&&le.size>0&&Ae.searchParams.set("_routes",n.filter(ee=>le.has(ee.route.id)).map(ee=>ee.route.id).join(",")),[Ae.pathname+Ae.search]},[x,c,p,m,j,n,t,b]),H=we.useMemo(()=>kk(Y,m),[Y,m]),G=Ok(Y);return we.createElement(we.Fragment,null,Q.map(le=>we.createElement("link",{key:le,rel:"prefetch",as:"fetch",href:le,...a})),H.map(le=>we.createElement("link",{key:le,rel:"modulepreload",href:le,...a})),G.map(({key:le,link:ve})=>we.createElement("link",{key:le,...ve})))}function Nk(...t){return n=>{t.forEach(a=>{typeof a=="function"?a(n):a!=null&&(a.current=n)})}}var sT=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{sT&&(window.__reactRouterVersion="7.3.0")}catch{}function $k({basename:t,children:n,window:a}){let p=we.useRef();p.current==null&&(p.current=II({window:a,v5Compat:!0}));let m=p.current,[b,x]=we.useState({action:m.action,location:m.location}),c=we.useCallback(A=>{we.startTransition(()=>x(A))},[x]);return we.useLayoutEffect(()=>m.listen(c),[m,c]),we.createElement(_k,{basename:t,children:n,location:b.location,navigationType:b.action,navigator:m})}var aT=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Sa=we.forwardRef(function({onClick:n,discover:a="render",prefetch:p="none",relative:m,reloadDocument:b,replace:x,state:c,target:A,to:j,preventScrollReset:Y,viewTransition:Q,...H},G){let{basename:le}=we.useContext(Jo),ve=typeof j=="string"&&aT.test(j),Ae,ee=!1;if(typeof j=="string"&&ve&&(Ae=j,sT))try{let gt=new URL(window.location.href),X=j.startsWith("//")?new URL(gt.protocol+j):new URL(j),Ye=Os(X.pathname,le);X.origin===gt.origin&&Ye!=null?j=Ye+X.search+X.hash:ee=!0}catch{Ko(!1,`<Link to="${j}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let re=tk(j,{relative:m}),[se,_e,De]=Fk(p,H),Fe=Gk(j,{replace:x,state:c,target:A,preventScrollReset:Y,relative:m,viewTransition:Q});function ze(gt){n&&n(gt),gt.defaultPrevented||Fe(gt)}let We=we.createElement("a",{...H,...De,href:Ae||re,onClick:ee||b?n:ze,ref:Nk(G,_e),target:A,"data-discover":!ve&&a==="render"?"true":void 0});return se&&!ve?we.createElement(we.Fragment,null,We,we.createElement(Bk,{page:re})):We});Sa.displayName="Link";var Vk=we.forwardRef(function({"aria-current":n="page",caseSensitive:a=!1,className:p="",end:m=!1,style:b,to:x,viewTransition:c,children:A,...j},Y){let Q=Qd(x,{relative:j.relative}),H=Il(),G=we.useContext(Qm),{navigator:le,basename:ve}=we.useContext(Jo),Ae=G!=null&&Kk(Q)&&c===!0,ee=le.encodeLocation?le.encodeLocation(Q).pathname:Q.pathname,re=H.pathname,se=G&&G.navigation&&G.navigation.location?G.navigation.location.pathname:null;a||(re=re.toLowerCase(),se=se?se.toLowerCase():null,ee=ee.toLowerCase()),se&&ve&&(se=Os(se,ve)||se);const _e=ee!=="/"&&ee.endsWith("/")?ee.length-1:ee.length;let De=re===ee||!m&&re.startsWith(ee)&&re.charAt(_e)==="/",Fe=se!=null&&(se===ee||!m&&se.startsWith(ee)&&se.charAt(ee.length)==="/"),ze={isActive:De,isPending:Fe,isTransitioning:Ae},We=De?n:void 0,gt;typeof p=="function"?gt=p(ze):gt=[p,De?"active":null,Fe?"pending":null,Ae?"transitioning":null].filter(Boolean).join(" ");let X=typeof b=="function"?b(ze):b;return we.createElement(Sa,{...j,"aria-current":We,className:gt,ref:Y,style:X,to:x,viewTransition:c},typeof A=="function"?A(ze):A)});Vk.displayName="NavLink";var Uk=we.forwardRef(({discover:t="render",fetcherKey:n,navigate:a,reloadDocument:p,replace:m,state:b,method:x=Kf,action:c,onSubmit:A,relative:j,preventScrollReset:Y,viewTransition:Q,...H},G)=>{let le=Hk(),ve=Xk(c,{relative:j}),Ae=x.toLowerCase()==="get"?"get":"post",ee=typeof c=="string"&&aT.test(c),re=se=>{if(A&&A(se),se.defaultPrevented)return;se.preventDefault();let _e=se.nativeEvent.submitter,De=(_e==null?void 0:_e.getAttribute("formmethod"))||x;le(_e||se.currentTarget,{fetcherKey:n,method:De,navigate:a,replace:m,state:b,relative:j,preventScrollReset:Y,viewTransition:Q})};return we.createElement("form",{ref:G,method:Ae,action:ve,onSubmit:p?A:re,...H,"data-discover":!ee&&t==="render"?"true":void 0})});Uk.displayName="Form";function Zk(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function lT(t){let n=we.useContext(Cu);return zr(n,Zk(t)),n}function Gk(t,{target:n,replace:a,state:p,preventScrollReset:m,relative:b,viewTransition:x}={}){let c=rk(),A=Il(),j=Qd(t,{relative:b});return we.useCallback(Y=>{if(Sk(Y,n)){Y.preventDefault();let Q=a!==void 0?a:Nd(A)===Nd(j);c(t,{replace:Q,state:p,preventScrollReset:m,relative:b,viewTransition:x})}},[A,c,j,a,p,n,t,m,b,x])}var qk=0,Wk=()=>`__${String(++qk)}__`;function Hk(){let{router:t}=lT("useSubmit"),{basename:n}=we.useContext(Jo),a=pk();return we.useCallback(async(p,m={})=>{let{action:b,method:x,encType:c,formData:A,body:j}=Ck(p,n);if(m.navigate===!1){let Y=m.fetcherKey||Wk();await t.fetch(Y,a,m.action||b,{preventScrollReset:m.preventScrollReset,formData:A,body:j,formMethod:m.method||x,formEncType:m.encType||c,flushSync:m.flushSync})}else await t.navigate(m.action||b,{preventScrollReset:m.preventScrollReset,formData:A,body:j,formMethod:m.method||x,formEncType:m.encType||c,replace:m.replace,state:m.state,fromRouteId:a,flushSync:m.flushSync,viewTransition:m.viewTransition})},[t,n,a])}function Xk(t,{relative:n}={}){let{basename:a}=we.useContext(Jo),p=we.useContext($s);zr(p,"useFormAction must be used inside a RouteContext");let[m]=p.matches.slice(-1),b={...Qd(t||".",{relative:n})},x=Il();if(t==null){b.search=x.search;let c=new URLSearchParams(b.search),A=c.getAll("index");if(A.some(Y=>Y==="")){c.delete("index"),A.filter(Q=>Q).forEach(Q=>c.append("index",Q));let Y=c.toString();b.search=Y?`?${Y}`:""}}return(!t||t===".")&&m.route.index&&(b.search=b.search?b.search.replace(/^\?/,"?index&"):"?index"),a!=="/"&&(b.pathname=b.pathname==="/"?a:Rs([a,b.pathname])),Nd(b)}function Kk(t,n={}){let a=we.useContext(JS);zr(a!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:p}=lT("useViewTransitionState"),m=Qd(t,{relative:n.relative});if(!a.isTransitioning)return!1;let b=Os(a.currentLocation.pathname,p)||a.currentLocation.pathname,x=Os(a.nextLocation.pathname,p)||a.nextLocation.pathname;return Mm(m.pathname,x)!=null||Mm(m.pathname,b)!=null}new TextEncoder;function nw(t){return t.replace(/_/g," ").replace(/\b\w/g,n=>n.toUpperCase())}function Yk(){let t=[{name:"home",link:"/InteractiveLanguageMap2/"},"world_map","database","credits"];return tt.jsx(tt.Fragment,{children:tt.jsxs("nav",{className:"globalNav",children:[tt.jsx("div",{className:"globalNavDivLogo",children:tt.jsx("h1",{className:"globalNavLogoH1",children:"Hello there!"})}),tt.jsx("div",{className:"globalNavDivLinks",children:tt.jsx("ul",{className:"globalNavLinkList",children:t.map(n=>tt.jsx("li",{className:"globalNavLinkListElement",children:typeof n=="string"?tt.jsx(Sa,{to:"/InteractiveLanguageMap2/"+n,children:nw(n)}):tt.jsx(Sa,{to:n.link,children:nw(n.name)})}))})})]})})}function Lf(t){return t.replace(/_/g," ").replace(/\b\w/g,n=>n.toUpperCase())}function Qk(){let t=[{name:"home",link:"/InteractiveLanguageMap2/"},"world_map","database","credits"],n=["YouTube","Facebook","Twitter","Instagram","LinkedIn"],a=["Privacy Policy","Terms of Service","Contact Us"];return tt.jsx(tt.Fragment,{children:tt.jsx("footer",{className:"globalFooter",children:tt.jsxs("div",{className:"globalFooterDiv",children:[tt.jsxs("div",{className:"globalFooterDiv1",children:[tt.jsx("p",{className:"globalFooterP",children:"Links"}),tt.jsx("ul",{className:"globalFooterList",children:t.map(p=>tt.jsx("li",{className:"globalFooterListElement",children:typeof p=="string"?tt.jsx(Sa,{to:"/InteractiveLanguageMap2/"+p,children:Lf(p)}):tt.jsx(Sa,{to:p.link,children:Lf(p.name)})}))})]}),tt.jsxs("div",{className:"globalFooterDiv2",children:[tt.jsx("p",{className:"globalFooterP",children:"Socials"}),tt.jsx("ul",{className:"globalFooterList",children:n.map(p=>tt.jsx("li",{className:"globalFooterListElement",children:tt.jsx(Sa,{to:"/InteractiveLanguageMap2/",children:Lf(p)})}))})]}),tt.jsxs("div",{className:"globalFooterDiv3",children:[tt.jsx("p",{className:"globalFooterP",children:"Terms"}),tt.jsx("ul",{className:"globalFooterList",children:a.map(p=>tt.jsx("li",{className:"globalFooterListElement",children:tt.jsx(Sa,{to:"/InteractiveLanguageMap2/",children:Lf(p)})}))})]})]})})})}function Jk(){return tt.jsx(tt.Fragment,{children:tt.jsxs("div",{className:"homePage",children:[tt.jsx("h1",{className:"homePageH1",children:"Home"}),tt.jsx("p",{className:"homePageP",children:"Boop"})]})})}var cT={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.2.0/LICENSE.txt
 */(function(t,n){(function(a,p){t.exports=p()})(qC,function(){var a={},p={};function m(x,c,A){if(p[x]=A,x==="index"){var j="var sharedModule = {}; ("+p.shared+")(sharedModule); ("+p.worker+")(sharedModule);",Y={};return p.shared(Y),p.index(a,Y),typeof window<"u"&&a.setWorkerUrl(window.URL.createObjectURL(new Blob([j],{type:"text/javascript"}))),a}}m("shared",["exports"],function(x){function c(o,r,s,l){return new(s||(s=Promise))(function(d,_){function y(C){try{T(l.next(C))}catch(M){_(M)}}function w(C){try{T(l.throw(C))}catch(M){_(M)}}function T(C){var M;C.done?d(C.value):(M=C.value,M instanceof s?M:new s(function(I){I(M)})).then(y,w)}T((l=l.apply(o,r||[])).next())})}function A(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}var j,Y;function Q(){if(Y)return j;function o(r,s){this.x=r,this.y=s}return Y=1,j=o,o.prototype={clone:function(){return new o(this.x,this.y)},add:function(r){return this.clone()._add(r)},sub:function(r){return this.clone()._sub(r)},multByPoint:function(r){return this.clone()._multByPoint(r)},divByPoint:function(r){return this.clone()._divByPoint(r)},mult:function(r){return this.clone()._mult(r)},div:function(r){return this.clone()._div(r)},rotate:function(r){return this.clone()._rotate(r)},rotateAround:function(r,s){return this.clone()._rotateAround(r,s)},matMult:function(r){return this.clone()._matMult(r)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(r){return this.x===r.x&&this.y===r.y},dist:function(r){return Math.sqrt(this.distSqr(r))},distSqr:function(r){var s=r.x-this.x,l=r.y-this.y;return s*s+l*l},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(r){return Math.atan2(this.y-r.y,this.x-r.x)},angleWith:function(r){return this.angleWithSep(r.x,r.y)},angleWithSep:function(r,s){return Math.atan2(this.x*s-this.y*r,this.x*r+this.y*s)},_matMult:function(r){var s=r[2]*this.x+r[3]*this.y;return this.x=r[0]*this.x+r[1]*this.y,this.y=s,this},_add:function(r){return this.x+=r.x,this.y+=r.y,this},_sub:function(r){return this.x-=r.x,this.y-=r.y,this},_mult:function(r){return this.x*=r,this.y*=r,this},_div:function(r){return this.x/=r,this.y/=r,this},_multByPoint:function(r){return this.x*=r.x,this.y*=r.y,this},_divByPoint:function(r){return this.x/=r.x,this.y/=r.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var r=this.y;return this.y=this.x,this.x=-r,this},_rotate:function(r){var s=Math.cos(r),l=Math.sin(r),d=l*this.x+s*this.y;return this.x=s*this.x-l*this.y,this.y=d,this},_rotateAround:function(r,s){var l=Math.cos(r),d=Math.sin(r),_=s.y+d*(this.x-s.x)+l*(this.y-s.y);return this.x=s.x+l*(this.x-s.x)-d*(this.y-s.y),this.y=_,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},o.convert=function(r){return r instanceof o?r:Array.isArray(r)?new o(r[0],r[1]):r},j}typeof SuppressedError=="function"&&SuppressedError;var H,G,le=A(Q()),ve=function(){if(G)return H;function o(r,s,l,d){this.cx=3*r,this.bx=3*(l-r)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*s,this.by=3*(d-s)-this.cy,this.ay=1-this.cy-this.by,this.p1x=r,this.p1y=s,this.p2x=l,this.p2y=d}return G=1,H=o,o.prototype={sampleCurveX:function(r){return((this.ax*r+this.bx)*r+this.cx)*r},sampleCurveY:function(r){return((this.ay*r+this.by)*r+this.cy)*r},sampleCurveDerivativeX:function(r){return(3*this.ax*r+2*this.bx)*r+this.cx},solveCurveX:function(r,s){if(s===void 0&&(s=1e-6),r<0)return 0;if(r>1)return 1;for(var l=r,d=0;d<8;d++){var _=this.sampleCurveX(l)-r;if(Math.abs(_)<s)return l;var y=this.sampleCurveDerivativeX(l);if(Math.abs(y)<1e-6)break;l-=_/y}var w=0,T=1;for(l=r,d=0;d<20&&(_=this.sampleCurveX(l),!(Math.abs(_-r)<s));d++)r>_?w=l:T=l,l=.5*(T-w)+w;return l},solve:function(r,s){return this.sampleCurveY(this.solveCurveX(r,s))}},H}(),Ae=A(ve);let ee,re;function se(){return ee==null&&(ee=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),ee}function _e(){if(re==null&&(re=!1,se())){const r=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(r){for(let l=0;l<5*5;l++){const d=4*l;r.fillStyle=`rgb(${d},${d+1},${d+2})`,r.fillRect(l%5,Math.floor(l/5),1,1)}const s=r.getImageData(0,0,5,5).data;for(let l=0;l<5*5*4;l++)if(l%4!=3&&s[l]!==l){re=!0;break}}}return re||!1}var De,Fe=1e-6,ze=typeof Float32Array<"u"?Float32Array:Array;function We(){var o=new ze(9);return ze!=Float32Array&&(o[1]=0,o[2]=0,o[3]=0,o[5]=0,o[6]=0,o[7]=0),o[0]=1,o[4]=1,o[8]=1,o}function gt(o){return o[0]=1,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=1,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=1,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o}function X(){var o=new ze(3);return ze!=Float32Array&&(o[0]=0,o[1]=0,o[2]=0),o}function Ye(o,r,s){var l=new ze(3);return l[0]=o,l[1]=r,l[2]=s,l}function at(o,r,s){var l=r[0],d=r[1],_=r[2],y=r[3];return o[0]=s[0]*l+s[4]*d+s[8]*_+s[12]*y,o[1]=s[1]*l+s[5]*d+s[9]*_+s[13]*y,o[2]=s[2]*l+s[6]*d+s[10]*_+s[14]*y,o[3]=s[3]*l+s[7]*d+s[11]*_+s[15]*y,o}function ht(){var o=new ze(4);return ze!=Float32Array&&(o[0]=0,o[1]=0,o[2]=0),o[3]=1,o}function Ct(){var o=new ze(2);return ze!=Float32Array&&(o[0]=0,o[1]=0),o}function tr(o,r){var s=new ze(2);return s[0]=o,s[1]=r,s}Math.hypot||(Math.hypot=function(){for(var o=0,r=arguments.length;r--;)o+=arguments[r]*arguments[r];return Math.sqrt(o)}),X(),De=new ze(4),ze!=Float32Array&&(De[0]=0,De[1]=0,De[2]=0,De[3]=0),X(),Ye(1,0,0),Ye(0,1,0),ht(),ht(),We(),Ct();const St=8192;function br(o,r,s){return r*(St/(o.tileSize*Math.pow(2,s-o.tileID.overscaledZ)))}function rt(o,r){return(o%r+r)%r}function ut(o,r,s){return o*(1-s)+r*s}function Tt(o){if(o<=0)return 0;if(o>=1)return 1;const r=o*o,s=r*o;return 4*(o<.5?s:3*(o-r)+s-.75)}function Lt(o,r,s,l){const d=new Ae(o,r,s,l);return _=>d.solve(_)}const Nt=Lt(.25,.1,.25,1);function Xr(o,r,s){return Math.min(s,Math.max(r,o))}function wr(o,r,s){const l=s-r,d=((o-r)%l+l)%l+r;return d===r?s:d}function fr(o,...r){for(const s of r)for(const l in s)o[l]=s[l];return o}let ln=1;function zn(o,r,s){const l={};for(const d in o)l[d]=r.call(this,o[d],d,o);return l}function so(o,r,s){const l={};for(const d in o)r.call(this,o[d],d,o)&&(l[d]=o[d]);return l}function Pn(o){return Array.isArray(o)?o.map(Pn):typeof o=="object"&&o?zn(o,Pn):o}const es={};function Kr(o){es[o]||(typeof console<"u"&&console.warn(o),es[o]=!0)}function Cr(o,r,s){return(s.y-o.y)*(r.x-o.x)>(r.y-o.y)*(s.x-o.x)}function xi(o){return typeof WorkerGlobalScope<"u"&&o!==void 0&&o instanceof WorkerGlobalScope}let or=null;function ao(o){return typeof ImageBitmap<"u"&&o instanceof ImageBitmap}const lo="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function gn(o,r,s,l,d){return c(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const _=new VideoFrame(o,{timestamp:0});try{const y=_==null?void 0:_.format;if(!y||!y.startsWith("BGR")&&!y.startsWith("RGB"))throw new Error(`Unrecognized format ${y}`);const w=y.startsWith("BGR"),T=new Uint8ClampedArray(l*d*4);if(yield _.copyTo(T,function(C,M,I,D,B){const O=4*Math.max(1,0),$=(Math.max(0,I)-I)*D*4+O,q=4*D,ne=Math.max(0,M),me=Math.max(0,I);return{rect:{x:ne,y:me,width:Math.min(C.width,M+D)-ne,height:Math.min(C.height,I+B)-me},layout:[{offset:$,stride:q}]}}(o,r,s,l,d)),w)for(let C=0;C<T.length;C+=4){const M=T[C];T[C]=T[C+2],T[C+2]=M}return T}finally{_.close()}})}let Rn,Vi;function Gn(o,r,s,l){return o.addEventListener(r,s,l),{unsubscribe:()=>{o.removeEventListener(r,s,l)}}}function qn(o){return o/Math.PI*180}const Et="AbortError";function ts(){return new Error(Et)}const rs={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function Vs(o){return rs.REGISTERED_PROTOCOLS[o.substring(0,o.indexOf("://"))]}const ns="global-dispatcher";class co extends Error{constructor(r,s,l,d){super(`AJAXError: ${s} (${r}): ${l}`),this.status=r,this.statusText=s,this.url=l,this.body=d}}const uo=()=>xi(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Io=function(o,r){if(/:\/\//.test(o.url)&&!/^https?:|^file:/.test(o.url)){const l=Vs(o.url);if(l)return l(o,r);if(xi(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:o,targetMapId:ns},r)}if(!(/^file:/.test(s=o.url)||/^file:/.test(uo())&&!/^\w+:/.test(s))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(l,d){return c(this,void 0,void 0,function*(){const _=new Request(l.url,{method:l.method||"GET",body:l.body,credentials:l.credentials,headers:l.headers,cache:l.cache,referrer:uo(),signal:d.signal});let y,w;l.type!=="json"||_.headers.has("Accept")||_.headers.set("Accept","application/json");try{y=yield fetch(_)}catch(C){throw new co(0,C.message,l.url,new Blob)}if(!y.ok){const C=yield y.blob();throw new co(y.status,y.statusText,l.url,C)}w=l.type==="arrayBuffer"||l.type==="image"?y.arrayBuffer():l.type==="json"?y.json():y.text();const T=yield w;if(d.signal.aborted)throw ts();return{data:T,cacheControl:y.headers.get("Cache-Control"),expires:y.headers.get("Expires")}})}(o,r);if(xi(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:o,mustQueue:!0,targetMapId:ns},r)}var s;return function(l,d){return new Promise((_,y)=>{var w;const T=new XMLHttpRequest;T.open(l.method||"GET",l.url,!0),l.type!=="arrayBuffer"&&l.type!=="image"||(T.responseType="arraybuffer");for(const C in l.headers)T.setRequestHeader(C,l.headers[C]);l.type==="json"&&(T.responseType="text",!((w=l.headers)===null||w===void 0)&&w.Accept||T.setRequestHeader("Accept","application/json")),T.withCredentials=l.credentials==="include",T.onerror=()=>{y(new Error(T.statusText))},T.onload=()=>{if(!d.signal.aborted)if((T.status>=200&&T.status<300||T.status===0)&&T.response!==null){let C=T.response;if(l.type==="json")try{C=JSON.parse(T.response)}catch(M){return void y(M)}_({data:C,cacheControl:T.getResponseHeader("Cache-Control"),expires:T.getResponseHeader("Expires")})}else{const C=new Blob([T.response],{type:T.getResponseHeader("Content-Type")});y(new co(T.status,T.statusText,l.url,C))}},d.signal.addEventListener("abort",()=>{T.abort(),y(ts())}),T.send(l.body)})}(o,r)};function ko(o){if(!o||o.indexOf("://")<=0||o.indexOf("data:image/")===0||o.indexOf("blob:")===0)return!0;const r=new URL(o),s=window.location;return r.protocol===s.protocol&&r.host===s.host}function Oa(o,r,s){s[o]&&s[o].indexOf(r)!==-1||(s[o]=s[o]||[],s[o].push(r))}function Us(o,r,s){if(s&&s[o]){const l=s[o].indexOf(r);l!==-1&&s[o].splice(l,1)}}class ja{constructor(r,s={}){fr(this,s),this.type=r}}class ho extends ja{constructor(r,s={}){super("error",fr({error:r},s))}}class be{on(r,s){return this._listeners=this._listeners||{},Oa(r,s,this._listeners),{unsubscribe:()=>{this.off(r,s)}}}off(r,s){return Us(r,s,this._listeners),Us(r,s,this._oneTimeListeners),this}once(r,s){return s?(this._oneTimeListeners=this._oneTimeListeners||{},Oa(r,s,this._oneTimeListeners),this):new Promise(l=>this.once(r,l))}fire(r,s){typeof r=="string"&&(r=new ja(r,s||{}));const l=r.type;if(this.listens(l)){r.target=this;const d=this._listeners&&this._listeners[l]?this._listeners[l].slice():[];for(const w of d)w.call(this,r);const _=this._oneTimeListeners&&this._oneTimeListeners[l]?this._oneTimeListeners[l].slice():[];for(const w of _)Us(l,w,this._oneTimeListeners),w.call(this,r);const y=this._eventedParent;y&&(fr(r,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),y.fire(r))}else r instanceof ho&&console.error(r.error);return this}listens(r){return this._listeners&&this._listeners[r]&&this._listeners[r].length>0||this._oneTimeListeners&&this._oneTimeListeners[r]&&this._oneTimeListeners[r].length>0||this._eventedParent&&this._eventedParent.listens(r)}setEventedParent(r,s){return this._eventedParent=r,this._eventedParentData=s,this}}var z={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const U=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function W(o,r){const s={};for(const l in o)l!=="ref"&&(s[l]=o[l]);return U.forEach(l=>{l in r&&(s[l]=r[l])}),s}function ie(o,r){if(Array.isArray(o)){if(!Array.isArray(r)||o.length!==r.length)return!1;for(let s=0;s<o.length;s++)if(!ie(o[s],r[s]))return!1;return!0}if(typeof o=="object"&&o!==null&&r!==null){if(typeof r!="object"||Object.keys(o).length!==Object.keys(r).length)return!1;for(const s in o)if(!ie(o[s],r[s]))return!1;return!0}return o===r}function de(o,r){o.push(r)}function xe(o,r,s){de(s,{command:"addSource",args:[o,r[o]]})}function Me(o,r,s){de(r,{command:"removeSource",args:[o]}),s[o]=!0}function ye(o,r,s,l){Me(o,s,l),xe(o,r,s)}function Oe(o,r,s){let l;for(l in o[s])if(Object.prototype.hasOwnProperty.call(o[s],l)&&l!=="data"&&!ie(o[s][l],r[s][l]))return!1;for(l in r[s])if(Object.prototype.hasOwnProperty.call(r[s],l)&&l!=="data"&&!ie(o[s][l],r[s][l]))return!1;return!0}function ke(o,r,s,l,d,_){o=o||{},r=r||{};for(const y in o)Object.prototype.hasOwnProperty.call(o,y)&&(ie(o[y],r[y])||s.push({command:_,args:[l,y,r[y],d]}));for(const y in r)Object.prototype.hasOwnProperty.call(r,y)&&!Object.prototype.hasOwnProperty.call(o,y)&&(ie(o[y],r[y])||s.push({command:_,args:[l,y,r[y],d]}))}function Se(o){return o.id}function Ue(o,r){return o[r.id]=r,o}class Te{constructor(r,s,l,d){this.message=(r?`${r}: `:"")+l,d&&(this.identifier=d),s!=null&&s.__line__&&(this.line=s.__line__)}}function et(o,...r){for(const s of r)for(const l in s)o[l]=s[l];return o}class dt extends Error{constructor(r,s){super(s),this.message=s,this.key=r}}class Pt{constructor(r,s=[]){this.parent=r,this.bindings={};for(const[l,d]of s)this.bindings[l]=d}concat(r){return new Pt(this,r)}get(r){if(this.bindings[r])return this.bindings[r];if(this.parent)return this.parent.get(r);throw new Error(`${r} not found in scope.`)}has(r){return!!this.bindings[r]||!!this.parent&&this.parent.has(r)}}const bt={kind:"null"},$e={kind:"number"},st={kind:"string"},ot={kind:"boolean"},It={kind:"color"},wt={kind:"projectionDefinition"},kt={kind:"object"},_t={kind:"value"},is={kind:"collator"},Lr={kind:"formatted"},Nr={kind:"padding"},rr={kind:"resolvedImage"},kl={kind:"variableAnchorOffsetCollection"};function Ln(o,r){return{kind:"array",itemType:o,N:r}}function Xt(o){if(o.kind==="array"){const r=Xt(o.itemType);return typeof o.N=="number"?`array<${r}, ${o.N}>`:o.itemType.kind==="value"?"array":`array<${r}>`}return o.kind}const np=[bt,$e,st,ot,It,wt,Lr,kt,Ln(_t),Nr,rr,kl];function Na(o,r){if(r.kind==="error")return null;if(o.kind==="array"){if(r.kind==="array"&&(r.N===0&&r.itemType.kind==="value"||!Na(o.itemType,r.itemType))&&(typeof o.N!="number"||o.N===r.N))return null}else{if(o.kind===r.kind)return null;if(o.kind==="value"){for(const s of np)if(!Na(s,r))return null}}return`Expected ${Xt(o)} but found ${Xt(r)} instead.`}function Mu(o,r){return r.some(s=>s.kind===o.kind)}function Ao(o,r){return r.some(s=>s==="null"?o===null:s==="array"?Array.isArray(o):s==="object"?o&&!Array.isArray(o)&&typeof o=="object":s===typeof o)}function Zs(o,r){return o.kind==="array"&&r.kind==="array"?o.itemType.kind===r.itemType.kind&&typeof o.N=="number":o.kind===r.kind}const Iu=.96422,ip=.82521,op=4/29,Gs=6/29,sp=3*Gs*Gs,Fg=Gs*Gs*Gs,Bg=Math.PI/180,Og=180/Math.PI;function ku(o){return(o%=360)<0&&(o+=360),o}function qs([o,r,s,l]){let d,_;const y=zu((.2225045*(o=Au(o))+.7168786*(r=Au(r))+.0606169*(s=Au(s)))/1);o===r&&r===s?d=_=y:(d=zu((.4360747*o+.3850649*r+.1430804*s)/Iu),_=zu((.0139322*o+.0971045*r+.7141733*s)/ip));const w=116*y-16;return[w<0?0:w,500*(d-y),200*(y-_),l]}function Au(o){return o<=.04045?o/12.92:Math.pow((o+.055)/1.055,2.4)}function zu(o){return o>Fg?Math.pow(o,1/3):o/sp+op}function Ws([o,r,s,l]){let d=(o+16)/116,_=isNaN(r)?d:d+r/500,y=isNaN(s)?d:d-s/200;return d=1*Lu(d),_=Iu*Lu(_),y=ip*Lu(y),[Ru(3.1338561*_-1.6168667*d-.4906146*y),Ru(-.9787684*_+1.9161415*d+.033454*y),Ru(.0719453*_-.2289914*d+1.4052427*y),l]}function Ru(o){return(o=o<=.00304?12.92*o:1.055*Math.pow(o,1/2.4)-.055)<0?0:o>1?1:o}function Lu(o){return o>Gs?o*o*o:sp*(o-op)}function Al(o){return parseInt(o.padEnd(2,o),16)/255}function Du(o,r){return os(r?o/100:o,0,1)}function os(o,r,s){return Math.min(Math.max(r,o),s)}function bi(o){return!o.some(Number.isNaN)}const Ft={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function Wn(o,r,s){return o+s*(r-o)}function ii(o,r,s){return o.map((l,d)=>Wn(l,r[d],s))}class Bt{constructor(r,s,l,d=1,_=!0){this.r=r,this.g=s,this.b=l,this.a=d,_||(this.r*=d,this.g*=d,this.b*=d,d||this.overwriteGetter("rgb",[r,s,l,d]))}static parse(r){if(r instanceof Bt)return r;if(typeof r!="string")return;const s=function(l){if((l=l.toLowerCase().trim())==="transparent")return[0,0,0,0];const d=Ft[l];if(d){const[y,w,T]=d;return[y/255,w/255,T/255,1]}if(l.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(l)){const y=l.length<6?1:2;let w=1;return[Al(l.slice(w,w+=y)),Al(l.slice(w,w+=y)),Al(l.slice(w,w+=y)),Al(l.slice(w,w+y)||"ff")]}if(l.startsWith("rgb")){const y=l.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(y){const[w,T,C,M,I,D,B,O,$,q,ne,me]=y,ae=[M||" ",B||" ",q].join("");if(ae==="  "||ae==="  /"||ae===",,"||ae===",,,"){const F=[C,D,$].join(""),Z=F==="%%%"?100:F===""?255:0;if(Z){const ce=[os(+T/Z,0,1),os(+I/Z,0,1),os(+O/Z,0,1),ne?Du(+ne,me):1];if(bi(ce))return ce}}return}}const _=l.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(_){const[y,w,T,C,M,I,D,B,O]=_,$=[T||" ",M||" ",D].join("");if($==="  "||$==="  /"||$===",,"||$===",,,"){const q=[+w,os(+C,0,100),os(+I,0,100),B?Du(+B,O):1];if(bi(q))return function([ne,me,ae,F]){function Z(ce){const Ce=(ce+ne/30)%12,Ze=me*Math.min(ae,1-ae);return ae-Ze*Math.max(-1,Math.min(Ce-3,9-Ce,1))}return ne=ku(ne),me/=100,ae/=100,[Z(0),Z(8),Z(4),F]}(q)}}}(r);return s?new Bt(...s,!1):void 0}get rgb(){const{r,g:s,b:l,a:d}=this,_=d||1/0;return this.overwriteGetter("rgb",[r/_,s/_,l/_,d])}get hcl(){return this.overwriteGetter("hcl",function(r){const[s,l,d,_]=qs(r),y=Math.sqrt(l*l+d*d);return[Math.round(1e4*y)?ku(Math.atan2(d,l)*Og):NaN,y,s,_]}(this.rgb))}get lab(){return this.overwriteGetter("lab",qs(this.rgb))}overwriteGetter(r,s){return Object.defineProperty(this,r,{value:s}),s}toString(){const[r,s,l,d]=this.rgb;return`rgba(${[r,s,l].map(_=>Math.round(255*_)).join(",")},${d})`}static interpolate(r,s,l,d="rgb"){switch(d){case"rgb":{const[_,y,w,T]=ii(r.rgb,s.rgb,l);return new Bt(_,y,w,T,!1)}case"hcl":{const[_,y,w,T]=r.hcl,[C,M,I,D]=s.hcl;let B,O;if(isNaN(_)||isNaN(C))isNaN(_)?isNaN(C)?B=NaN:(B=C,w!==1&&w!==0||(O=M)):(B=_,I!==1&&I!==0||(O=y));else{let ae=C-_;C>_&&ae>180?ae-=360:C<_&&_-C>180&&(ae+=360),B=_+l*ae}const[$,q,ne,me]=function([ae,F,Z,ce]){return ae=isNaN(ae)?0:ae*Bg,Ws([Z,Math.cos(ae)*F,Math.sin(ae)*F,ce])}([B,O??Wn(y,M,l),Wn(w,I,l),Wn(T,D,l)]);return new Bt($,q,ne,me,!1)}case"lab":{const[_,y,w,T]=Ws(ii(r.lab,s.lab,l));return new Bt(_,y,w,T,!1)}}}}Bt.black=new Bt(0,0,0,1),Bt.white=new Bt(1,1,1,1),Bt.transparent=new Bt(0,0,0,0),Bt.red=new Bt(1,0,0,1);class zl{constructor(r,s,l){this.sensitivity=r?s?"variant":"case":s?"accent":"base",this.locale=l,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(r,s){return this.collator.compare(r,s)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const Fu=["bottom","center","top"];class oi{constructor(r,s,l,d,_,y){this.text=r,this.image=s,this.scale=l,this.fontStack=d,this.textColor=_,this.verticalAlign=y}}class cn{constructor(r){this.sections=r}static fromString(r){return new cn([new oi(r,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(r=>r.text.length!==0||r.image&&r.image.name.length!==0)}static factory(r){return r instanceof cn?r:cn.fromString(r)}toString(){return this.sections.length===0?"":this.sections.map(r=>r.text).join("")}}class Yr{constructor(r){this.values=r.slice()}static parse(r){if(r instanceof Yr)return r;if(typeof r=="number")return new Yr([r,r,r,r]);if(Array.isArray(r)&&!(r.length<1||r.length>4)){for(const s of r)if(typeof s!="number")return;switch(r.length){case 1:r=[r[0],r[0],r[0],r[0]];break;case 2:r=[r[0],r[1],r[0],r[1]];break;case 3:r=[r[0],r[1],r[2],r[1]]}return new Yr(r)}}toString(){return JSON.stringify(this.values)}static interpolate(r,s,l){return new Yr(ii(r.values,s.values,l))}}class mr{constructor(r){this.name="ExpressionEvaluationError",this.message=r}toJSON(){return this.message}}const Bu=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Qr{constructor(r){this.values=r.slice()}static parse(r){if(r instanceof Qr)return r;if(Array.isArray(r)&&!(r.length<1)&&r.length%2==0){for(let s=0;s<r.length;s+=2){const l=r[s],d=r[s+1];if(typeof l!="string"||!Bu.has(l)||!Array.isArray(d)||d.length!==2||typeof d[0]!="number"||typeof d[1]!="number")return}return new Qr(r)}}toString(){return JSON.stringify(this.values)}static interpolate(r,s,l){const d=r.values,_=s.values;if(d.length!==_.length)throw new mr(`Cannot interpolate values of different length. from: ${r.toString()}, to: ${s.toString()}`);const y=[];for(let w=0;w<d.length;w+=2){if(d[w]!==_[w])throw new mr(`Cannot interpolate values containing mismatched anchors. from[${w}]: ${d[w]}, to[${w}]: ${_[w]}`);y.push(d[w]);const[T,C]=d[w+1],[M,I]=_[w+1];y.push([Wn(T,M,l),Wn(C,I,l)])}return new Qr(y)}}class Cn{constructor(r){this.name=r.name,this.available=r.available}toString(){return this.name}static fromString(r){return r?new Cn({name:r,available:!1}):null}}class Dn{constructor(r,s,l){this.from=r,this.to=s,this.transition=l}static interpolate(r,s,l){return new Dn(r,s,l)}static parse(r){return r instanceof Dn?r:Array.isArray(r)&&r.length===3&&typeof r[0]=="string"&&typeof r[1]=="string"&&typeof r[2]=="number"?new Dn(r[0],r[1],r[2]):typeof r=="object"&&typeof r.from=="string"&&typeof r.to=="string"&&typeof r.transition=="number"?new Dn(r.from,r.to,r.transition):typeof r=="string"?new Dn(r,r,1):void 0}}function Rl(o,r,s,l){return typeof o=="number"&&o>=0&&o<=255&&typeof r=="number"&&r>=0&&r<=255&&typeof s=="number"&&s>=0&&s<=255?l===void 0||typeof l=="number"&&l>=0&&l<=1?null:`Invalid rgba value [${[o,r,s,l].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof l=="number"?[o,r,s,l]:[o,r,s]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function wi(o){if(o===null||typeof o=="string"||typeof o=="boolean"||typeof o=="number"||o instanceof Dn||o instanceof Bt||o instanceof zl||o instanceof cn||o instanceof Yr||o instanceof Qr||o instanceof Cn)return!0;if(Array.isArray(o)){for(const r of o)if(!wi(r))return!1;return!0}if(typeof o=="object"){for(const r in o)if(!wi(o[r]))return!1;return!0}return!1}function Dr(o){if(o===null)return bt;if(typeof o=="string")return st;if(typeof o=="boolean")return ot;if(typeof o=="number")return $e;if(o instanceof Bt)return It;if(o instanceof Dn)return wt;if(o instanceof zl)return is;if(o instanceof cn)return Lr;if(o instanceof Yr)return Nr;if(o instanceof Qr)return kl;if(o instanceof Cn)return rr;if(Array.isArray(o)){const r=o.length;let s;for(const l of o){const d=Dr(l);if(s){if(s===d)continue;s=_t;break}s=d}return Ln(s||_t,r)}return kt}function zo(o){const r=typeof o;return o===null?"":r==="string"||r==="number"||r==="boolean"?String(o):o instanceof Bt||o instanceof Dn||o instanceof cn||o instanceof Yr||o instanceof Qr||o instanceof Cn?o.toString():JSON.stringify(o)}class si{constructor(r,s){this.type=r,this.value=s}static parse(r,s){if(r.length!==2)return s.error(`'literal' expression requires exactly one argument, but found ${r.length-1} instead.`);if(!wi(r[1]))return s.error("invalid value");const l=r[1];let d=Dr(l);const _=s.expectedType;return d.kind!=="array"||d.N!==0||!_||_.kind!=="array"||typeof _.N=="number"&&_.N!==0||(d=_),new si(d,l)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const $a={string:st,number:$e,boolean:ot,object:kt};class ai{constructor(r,s){this.type=r,this.args=s}static parse(r,s){if(r.length<2)return s.error("Expected at least one argument.");let l,d=1;const _=r[0];if(_==="array"){let w,T;if(r.length>2){const C=r[1];if(typeof C!="string"||!(C in $a)||C==="object")return s.error('The item type argument of "array" must be one of string, number, boolean',1);w=$a[C],d++}else w=_t;if(r.length>3){if(r[2]!==null&&(typeof r[2]!="number"||r[2]<0||r[2]!==Math.floor(r[2])))return s.error('The length argument to "array" must be a positive integer literal',2);T=r[2],d++}l=Ln(w,T)}else{if(!$a[_])throw new Error(`Types doesn't contain name = ${_}`);l=$a[_]}const y=[];for(;d<r.length;d++){const w=s.parse(r[d],d,_t);if(!w)return null;y.push(w)}return new ai(l,y)}evaluate(r){for(let s=0;s<this.args.length;s++){const l=this.args[s].evaluate(r);if(!Na(this.type,Dr(l)))return l;if(s===this.args.length-1)throw new mr(`Expected value to be of type ${Xt(this.type)}, but found ${Xt(Dr(l))} instead.`)}throw new Error}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}}const Ou={"to-boolean":ot,"to-color":It,"to-number":$e,"to-string":st};class Si{constructor(r,s){this.type=r,this.args=s}static parse(r,s){if(r.length<2)return s.error("Expected at least one argument.");const l=r[0];if(!Ou[l])throw new Error(`Can't parse ${l} as it is not part of the known types`);if((l==="to-boolean"||l==="to-string")&&r.length!==2)return s.error("Expected one argument.");const d=Ou[l],_=[];for(let y=1;y<r.length;y++){const w=s.parse(r[y],y,_t);if(!w)return null;_.push(w)}return new Si(d,_)}evaluate(r){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(r);case"color":{let s,l;for(const d of this.args){if(s=d.evaluate(r),l=null,s instanceof Bt)return s;if(typeof s=="string"){const _=r.parseColor(s);if(_)return _}else if(Array.isArray(s)&&(l=s.length<3||s.length>4?`Invalid rgba value ${JSON.stringify(s)}: expected an array containing either three or four numeric values.`:Rl(s[0],s[1],s[2],s[3]),!l))return new Bt(s[0]/255,s[1]/255,s[2]/255,s[3])}throw new mr(l||`Could not parse color from value '${typeof s=="string"?s:JSON.stringify(s)}'`)}case"padding":{let s;for(const l of this.args){s=l.evaluate(r);const d=Yr.parse(s);if(d)return d}throw new mr(`Could not parse padding from value '${typeof s=="string"?s:JSON.stringify(s)}'`)}case"variableAnchorOffsetCollection":{let s;for(const l of this.args){s=l.evaluate(r);const d=Qr.parse(s);if(d)return d}throw new mr(`Could not parse variableAnchorOffsetCollection from value '${typeof s=="string"?s:JSON.stringify(s)}'`)}case"number":{let s=null;for(const l of this.args){if(s=l.evaluate(r),s===null)return 0;const d=Number(s);if(!isNaN(d))return d}throw new mr(`Could not convert ${JSON.stringify(s)} to number.`)}case"formatted":return cn.fromString(zo(this.args[0].evaluate(r)));case"resolvedImage":return Cn.fromString(zo(this.args[0].evaluate(r)));case"projectionDefinition":return this.args[0].evaluate(r);default:return zo(this.args[0].evaluate(r))}}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}}const sr=["Unknown","Point","LineString","Polygon"];class Ll{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?sr[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(r){let s=this._parseColorCache[r];return s||(s=this._parseColorCache[r]=Bt.parse(r)),s}}class Rt{constructor(r,s,l=[],d,_=new Pt,y=[]){this.registry=r,this.path=l,this.key=l.map(w=>`[${w}]`).join(""),this.scope=_,this.errors=y,this.expectedType=d,this._isConstant=s}parse(r,s,l,d,_={}){return s?this.concat(s,l,d)._parse(r,_):this._parse(r,_)}_parse(r,s){function l(d,_,y){return y==="assert"?new ai(_,[d]):y==="coerce"?new Si(_,[d]):d}if(r!==null&&typeof r!="string"&&typeof r!="boolean"&&typeof r!="number"||(r=["literal",r]),Array.isArray(r)){if(r.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const d=r[0];if(typeof d!="string")return this.error(`Expression name must be a string, but found ${typeof d} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const _=this.registry[d];if(_){let y=_.parse(r,this);if(!y)return null;if(this.expectedType){const w=this.expectedType,T=y.type;if(w.kind!=="string"&&w.kind!=="number"&&w.kind!=="boolean"&&w.kind!=="object"&&w.kind!=="array"||T.kind!=="value")if(w.kind!=="projectionDefinition"||T.kind!=="string"&&T.kind!=="array")if(w.kind!=="color"&&w.kind!=="formatted"&&w.kind!=="resolvedImage"||T.kind!=="value"&&T.kind!=="string")if(w.kind!=="padding"||T.kind!=="value"&&T.kind!=="number"&&T.kind!=="array")if(w.kind!=="variableAnchorOffsetCollection"||T.kind!=="value"&&T.kind!=="array"){if(this.checkSubtype(w,T))return null}else y=l(y,w,s.typeAnnotation||"coerce");else y=l(y,w,s.typeAnnotation||"coerce");else y=l(y,w,s.typeAnnotation||"coerce");else y=l(y,w,s.typeAnnotation||"coerce");else y=l(y,w,s.typeAnnotation||"assert")}if(!(y instanceof si)&&y.type.kind!=="resolvedImage"&&this._isConstant(y)){const w=new Ll;try{y=new si(y.type,y.evaluate(w))}catch(T){return this.error(T.message),null}}return y}return this.error(`Unknown expression "${d}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(r===void 0?"'undefined' value invalid. Use null instead.":typeof r=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof r} instead.`)}concat(r,s,l){const d=typeof r=="number"?this.path.concat(r):this.path,_=l?this.scope.concat(l):this.scope;return new Rt(this.registry,this._isConstant,d,s||null,_,this.errors)}error(r,...s){const l=`${this.key}${s.map(d=>`[${d}]`).join("")}`;this.errors.push(new dt(l,r))}checkSubtype(r,s){const l=Na(r,s);return l&&this.error(l),l}}class Mt{constructor(r,s){this.type=s.type,this.bindings=[].concat(r),this.result=s}evaluate(r){return this.result.evaluate(r)}eachChild(r){for(const s of this.bindings)r(s[1]);r(this.result)}static parse(r,s){if(r.length<4)return s.error(`Expected at least 3 arguments, but found ${r.length-1} instead.`);const l=[];for(let _=1;_<r.length-1;_+=2){const y=r[_];if(typeof y!="string")return s.error(`Expected string, but found ${typeof y} instead.`,_);if(/[^a-zA-Z0-9_]/.test(y))return s.error("Variable names must contain only alphanumeric characters or '_'.",_);const w=s.parse(r[_+1],_+1);if(!w)return null;l.push([y,w])}const d=s.parse(r[r.length-1],r.length-1,s.expectedType,l);return d?new Mt(l,d):null}outputDefined(){return this.result.outputDefined()}}class Hs{constructor(r,s){this.type=s.type,this.name=r,this.boundExpression=s}static parse(r,s){if(r.length!==2||typeof r[1]!="string")return s.error("'var' expression requires exactly one string literal argument.");const l=r[1];return s.scope.has(l)?new Hs(l,s.scope.get(l)):s.error(`Unknown variable "${l}". Make sure "${l}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(r){return this.boundExpression.evaluate(r)}eachChild(){}outputDefined(){return!1}}class Dt{constructor(r,s,l){this.type=r,this.index=s,this.input=l}static parse(r,s){if(r.length!==3)return s.error(`Expected 2 arguments, but found ${r.length-1} instead.`);const l=s.parse(r[1],1,$e),d=s.parse(r[2],2,Ln(s.expectedType||_t));return l&&d?new Dt(d.type.itemType,l,d):null}evaluate(r){const s=this.index.evaluate(r),l=this.input.evaluate(r);if(s<0)throw new mr(`Array index out of bounds: ${s} < 0.`);if(s>=l.length)throw new mr(`Array index out of bounds: ${s} > ${l.length-1}.`);if(s!==Math.floor(s))throw new mr(`Array index must be an integer, but found ${s} instead.`);return l[s]}eachChild(r){r(this.index),r(this.input)}outputDefined(){return!1}}class Va{constructor(r,s){this.type=ot,this.needle=r,this.haystack=s}static parse(r,s){if(r.length!==3)return s.error(`Expected 2 arguments, but found ${r.length-1} instead.`);const l=s.parse(r[1],1,_t),d=s.parse(r[2],2,_t);return l&&d?Mu(l.type,[ot,st,$e,bt,_t])?new Va(l,d):s.error(`Expected first argument to be of type boolean, string, number or null, but found ${Xt(l.type)} instead`):null}evaluate(r){const s=this.needle.evaluate(r),l=this.haystack.evaluate(r);if(!l)return!1;if(!Ao(s,["boolean","string","number","null"]))throw new mr(`Expected first argument to be of type boolean, string, number or null, but found ${Xt(Dr(s))} instead.`);if(!Ao(l,["string","array"]))throw new mr(`Expected second argument to be of type array or string, but found ${Xt(Dr(l))} instead.`);return l.indexOf(s)>=0}eachChild(r){r(this.needle),r(this.haystack)}outputDefined(){return!0}}class li{constructor(r,s,l){this.type=$e,this.needle=r,this.haystack=s,this.fromIndex=l}static parse(r,s){if(r.length<=2||r.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${r.length-1} instead.`);const l=s.parse(r[1],1,_t),d=s.parse(r[2],2,_t);if(!l||!d)return null;if(!Mu(l.type,[ot,st,$e,bt,_t]))return s.error(`Expected first argument to be of type boolean, string, number or null, but found ${Xt(l.type)} instead`);if(r.length===4){const _=s.parse(r[3],3,$e);return _?new li(l,d,_):null}return new li(l,d)}evaluate(r){const s=this.needle.evaluate(r),l=this.haystack.evaluate(r);if(!Ao(s,["boolean","string","number","null"]))throw new mr(`Expected first argument to be of type boolean, string, number or null, but found ${Xt(Dr(s))} instead.`);let d;if(this.fromIndex&&(d=this.fromIndex.evaluate(r)),Ao(l,["string"])){const _=l.indexOf(s,d);return _===-1?-1:[...l.slice(0,_)].length}if(Ao(l,["array"]))return l.indexOf(s,d);throw new mr(`Expected second argument to be of type array or string, but found ${Xt(Dr(l))} instead.`)}eachChild(r){r(this.needle),r(this.haystack),this.fromIndex&&r(this.fromIndex)}outputDefined(){return!1}}class Ua{constructor(r,s,l,d,_,y){this.inputType=r,this.type=s,this.input=l,this.cases=d,this.outputs=_,this.otherwise=y}static parse(r,s){if(r.length<5)return s.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if(r.length%2!=1)return s.error("Expected an even number of arguments.");let l,d;s.expectedType&&s.expectedType.kind!=="value"&&(d=s.expectedType);const _={},y=[];for(let C=2;C<r.length-1;C+=2){let M=r[C];const I=r[C+1];Array.isArray(M)||(M=[M]);const D=s.concat(C);if(M.length===0)return D.error("Expected at least one branch label.");for(const O of M){if(typeof O!="number"&&typeof O!="string")return D.error("Branch labels must be numbers or strings.");if(typeof O=="number"&&Math.abs(O)>Number.MAX_SAFE_INTEGER)return D.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof O=="number"&&Math.floor(O)!==O)return D.error("Numeric branch labels must be integer values.");if(l){if(D.checkSubtype(l,Dr(O)))return null}else l=Dr(O);if(_[String(O)]!==void 0)return D.error("Branch labels must be unique.");_[String(O)]=y.length}const B=s.parse(I,C,d);if(!B)return null;d=d||B.type,y.push(B)}const w=s.parse(r[1],1,_t);if(!w)return null;const T=s.parse(r[r.length-1],r.length-1,d);return T?w.type.kind!=="value"&&s.concat(1).checkSubtype(l,w.type)?null:new Ua(l,d,w,_,y,T):null}evaluate(r){const s=this.input.evaluate(r);return(Dr(s)===this.inputType&&this.outputs[this.cases[s]]||this.otherwise).evaluate(r)}eachChild(r){r(this.input),this.outputs.forEach(r),r(this.otherwise)}outputDefined(){return this.outputs.every(r=>r.outputDefined())&&this.otherwise.outputDefined()}}class Dl{constructor(r,s,l){this.type=r,this.branches=s,this.otherwise=l}static parse(r,s){if(r.length<4)return s.error(`Expected at least 3 arguments, but found only ${r.length-1}.`);if(r.length%2!=0)return s.error("Expected an odd number of arguments.");let l;s.expectedType&&s.expectedType.kind!=="value"&&(l=s.expectedType);const d=[];for(let y=1;y<r.length-1;y+=2){const w=s.parse(r[y],y,ot);if(!w)return null;const T=s.parse(r[y+1],y+1,l);if(!T)return null;d.push([w,T]),l=l||T.type}const _=s.parse(r[r.length-1],r.length-1,l);if(!_)return null;if(!l)throw new Error("Can't infer output type");return new Dl(l,d,_)}evaluate(r){for(const[s,l]of this.branches)if(s.evaluate(r))return l.evaluate(r);return this.otherwise.evaluate(r)}eachChild(r){for(const[s,l]of this.branches)r(s),r(l);r(this.otherwise)}outputDefined(){return this.branches.every(([r,s])=>s.outputDefined())&&this.otherwise.outputDefined()}}class Za{constructor(r,s,l,d){this.type=r,this.input=s,this.beginIndex=l,this.endIndex=d}static parse(r,s){if(r.length<=2||r.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${r.length-1} instead.`);const l=s.parse(r[1],1,_t),d=s.parse(r[2],2,$e);if(!l||!d)return null;if(!Mu(l.type,[Ln(_t),st,_t]))return s.error(`Expected first argument to be of type array or string, but found ${Xt(l.type)} instead`);if(r.length===4){const _=s.parse(r[3],3,$e);return _?new Za(l.type,l,d,_):null}return new Za(l.type,l,d)}evaluate(r){const s=this.input.evaluate(r),l=this.beginIndex.evaluate(r);let d;if(this.endIndex&&(d=this.endIndex.evaluate(r)),Ao(s,["string"]))return[...s].slice(l,d).join("");if(Ao(s,["array"]))return s.slice(l,d);throw new mr(`Expected first argument to be of type array or string, but found ${Xt(Dr(s))} instead.`)}eachChild(r){r(this.input),r(this.beginIndex),this.endIndex&&r(this.endIndex)}outputDefined(){return!1}}function Xs(o,r){const s=o.length-1;let l,d,_=0,y=s,w=0;for(;_<=y;)if(w=Math.floor((_+y)/2),l=o[w],d=o[w+1],l<=r){if(w===s||r<d)return w;_=w+1}else{if(!(l>r))throw new mr("Input is not a number.");y=w-1}return 0}class Ks{constructor(r,s,l){this.type=r,this.input=s,this.labels=[],this.outputs=[];for(const[d,_]of l)this.labels.push(d),this.outputs.push(_)}static parse(r,s){if(r.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if((r.length-1)%2!=0)return s.error("Expected an even number of arguments.");const l=s.parse(r[1],1,$e);if(!l)return null;const d=[];let _=null;s.expectedType&&s.expectedType.kind!=="value"&&(_=s.expectedType);for(let y=1;y<r.length;y+=2){const w=y===1?-1/0:r[y],T=r[y+1],C=y,M=y+1;if(typeof w!="number")return s.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',C);if(d.length&&d[d.length-1][0]>=w)return s.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',C);const I=s.parse(T,M,_);if(!I)return null;_=_||I.type,d.push([w,I])}return new Ks(_,l,d)}evaluate(r){const s=this.labels,l=this.outputs;if(s.length===1)return l[0].evaluate(r);const d=this.input.evaluate(r);if(d<=s[0])return l[0].evaluate(r);const _=s.length;return d>=s[_-1]?l[_-1].evaluate(r):l[Xs(s,d)].evaluate(r)}eachChild(r){r(this.input);for(const s of this.outputs)r(s)}outputDefined(){return this.outputs.every(r=>r.outputDefined())}}function jg(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}var Fl,ju,Ga=function(){if(ju)return Fl;function o(r,s,l,d){this.cx=3*r,this.bx=3*(l-r)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*s,this.by=3*(d-s)-this.cy,this.ay=1-this.cy-this.by,this.p1x=r,this.p1y=s,this.p2x=l,this.p2y=d}return ju=1,Fl=o,o.prototype={sampleCurveX:function(r){return((this.ax*r+this.bx)*r+this.cx)*r},sampleCurveY:function(r){return((this.ay*r+this.by)*r+this.cy)*r},sampleCurveDerivativeX:function(r){return(3*this.ax*r+2*this.bx)*r+this.cx},solveCurveX:function(r,s){if(s===void 0&&(s=1e-6),r<0)return 0;if(r>1)return 1;for(var l=r,d=0;d<8;d++){var _=this.sampleCurveX(l)-r;if(Math.abs(_)<s)return l;var y=this.sampleCurveDerivativeX(l);if(Math.abs(y)<1e-6)break;l-=_/y}var w=0,T=1;for(l=r,d=0;d<20&&(_=this.sampleCurveX(l),!(Math.abs(_-r)<s));d++)r>_?w=l:T=l,l=.5*(T-w)+w;return l},solve:function(r,s){return this.sampleCurveY(this.solveCurveX(r,s))}},Fl}(),_n=jg(Ga);class yn{constructor(r,s,l,d,_){this.type=r,this.operator=s,this.interpolation=l,this.input=d,this.labels=[],this.outputs=[];for(const[y,w]of _)this.labels.push(y),this.outputs.push(w)}static interpolationFactor(r,s,l,d){let _=0;if(r.name==="exponential")_=Bl(s,r.base,l,d);else if(r.name==="linear")_=Bl(s,1,l,d);else if(r.name==="cubic-bezier"){const y=r.controlPoints;_=new _n(y[0],y[1],y[2],y[3]).solve(Bl(s,1,l,d))}return _}static parse(r,s){let[l,d,_,...y]=r;if(!Array.isArray(d)||d.length===0)return s.error("Expected an interpolation type expression.",1);if(d[0]==="linear")d={name:"linear"};else if(d[0]==="exponential"){const C=d[1];if(typeof C!="number")return s.error("Exponential interpolation requires a numeric base.",1,1);d={name:"exponential",base:C}}else{if(d[0]!=="cubic-bezier")return s.error(`Unknown interpolation type ${String(d[0])}`,1,0);{const C=d.slice(1);if(C.length!==4||C.some(M=>typeof M!="number"||M<0||M>1))return s.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);d={name:"cubic-bezier",controlPoints:C}}}if(r.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if((r.length-1)%2!=0)return s.error("Expected an even number of arguments.");if(_=s.parse(_,2,$e),!_)return null;const w=[];let T=null;l==="interpolate-hcl"||l==="interpolate-lab"?T=It:s.expectedType&&s.expectedType.kind!=="value"&&(T=s.expectedType);for(let C=0;C<y.length;C+=2){const M=y[C],I=y[C+1],D=C+3,B=C+4;if(typeof M!="number")return s.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',D);if(w.length&&w[w.length-1][0]>=M)return s.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',D);const O=s.parse(I,B,T);if(!O)return null;T=T||O.type,w.push([M,O])}return Zs(T,$e)||Zs(T,wt)||Zs(T,It)||Zs(T,Nr)||Zs(T,kl)||Zs(T,Ln($e))?new yn(T,l,d,_,w):s.error(`Type ${Xt(T)} is not interpolatable.`)}evaluate(r){const s=this.labels,l=this.outputs;if(s.length===1)return l[0].evaluate(r);const d=this.input.evaluate(r);if(d<=s[0])return l[0].evaluate(r);const _=s.length;if(d>=s[_-1])return l[_-1].evaluate(r);const y=Xs(s,d),w=yn.interpolationFactor(this.interpolation,d,s[y],s[y+1]),T=l[y].evaluate(r),C=l[y+1].evaluate(r);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return Wn(T,C,w);case"color":return Bt.interpolate(T,C,w);case"padding":return Yr.interpolate(T,C,w);case"variableAnchorOffsetCollection":return Qr.interpolate(T,C,w);case"array":return ii(T,C,w);case"projectionDefinition":return Dn.interpolate(T,C,w)}case"interpolate-hcl":return Bt.interpolate(T,C,w,"hcl");case"interpolate-lab":return Bt.interpolate(T,C,w,"lab")}}eachChild(r){r(this.input);for(const s of this.outputs)r(s)}outputDefined(){return this.outputs.every(r=>r.outputDefined())}}function Bl(o,r,s,l){const d=l-s,_=o-s;return d===0?0:r===1?_/d:(Math.pow(r,_)-1)/(Math.pow(r,d)-1)}const Hn={color:Bt.interpolate,number:Wn,padding:Yr.interpolate,variableAnchorOffsetCollection:Qr.interpolate,array:ii};class Er{constructor(r,s){this.type=r,this.args=s}static parse(r,s){if(r.length<2)return s.error("Expected at least one argument.");let l=null;const d=s.expectedType;d&&d.kind!=="value"&&(l=d);const _=[];for(const w of r.slice(1)){const T=s.parse(w,1+_.length,l,void 0,{typeAnnotation:"omit"});if(!T)return null;l=l||T.type,_.push(T)}if(!l)throw new Error("No output type");const y=d&&_.some(w=>Na(d,w.type));return new Er(y?_t:l,_)}evaluate(r){let s,l=null,d=0;for(const _ of this.args)if(d++,l=_.evaluate(r),l&&l instanceof Cn&&!l.available&&(s||(s=l.name),l=null,d===this.args.length&&(l=s)),l!==null)break;return l}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}}function Nu(o,r){return o==="=="||o==="!="?r.kind==="boolean"||r.kind==="string"||r.kind==="number"||r.kind==="null"||r.kind==="value":r.kind==="string"||r.kind==="number"||r.kind==="value"}function Ol(o,r,s,l){return l.compare(r,s)===0}function ss(o,r,s){const l=o!=="=="&&o!=="!=";return class uT{constructor(_,y,w){this.type=ot,this.lhs=_,this.rhs=y,this.collator=w,this.hasUntypedArgument=_.type.kind==="value"||y.type.kind==="value"}static parse(_,y){if(_.length!==3&&_.length!==4)return y.error("Expected two or three arguments.");const w=_[0];let T=y.parse(_[1],1,_t);if(!T)return null;if(!Nu(w,T.type))return y.concat(1).error(`"${w}" comparisons are not supported for type '${Xt(T.type)}'.`);let C=y.parse(_[2],2,_t);if(!C)return null;if(!Nu(w,C.type))return y.concat(2).error(`"${w}" comparisons are not supported for type '${Xt(C.type)}'.`);if(T.type.kind!==C.type.kind&&T.type.kind!=="value"&&C.type.kind!=="value")return y.error(`Cannot compare types '${Xt(T.type)}' and '${Xt(C.type)}'.`);l&&(T.type.kind==="value"&&C.type.kind!=="value"?T=new ai(C.type,[T]):T.type.kind!=="value"&&C.type.kind==="value"&&(C=new ai(T.type,[C])));let M=null;if(_.length===4){if(T.type.kind!=="string"&&C.type.kind!=="string"&&T.type.kind!=="value"&&C.type.kind!=="value")return y.error("Cannot use collator to compare non-string types.");if(M=y.parse(_[3],3,is),!M)return null}return new uT(T,C,M)}evaluate(_){const y=this.lhs.evaluate(_),w=this.rhs.evaluate(_);if(l&&this.hasUntypedArgument){const T=Dr(y),C=Dr(w);if(T.kind!==C.kind||T.kind!=="string"&&T.kind!=="number")throw new mr(`Expected arguments for "${o}" to be (string, string) or (number, number), but found (${T.kind}, ${C.kind}) instead.`)}if(this.collator&&!l&&this.hasUntypedArgument){const T=Dr(y),C=Dr(w);if(T.kind!=="string"||C.kind!=="string")return r(_,y,w)}return this.collator?s(_,y,w,this.collator.evaluate(_)):r(_,y,w)}eachChild(_){_(this.lhs),_(this.rhs),this.collator&&_(this.collator)}outputDefined(){return!0}}}const Ng=ss("==",function(o,r,s){return r===s},Ol),jl=ss("!=",function(o,r,s){return r!==s},function(o,r,s,l){return!Ol(0,r,s,l)}),$u=ss("<",function(o,r,s){return r<s},function(o,r,s,l){return l.compare(r,s)<0}),$g=ss(">",function(o,r,s){return r>s},function(o,r,s,l){return l.compare(r,s)>0}),Nl=ss("<=",function(o,r,s){return r<=s},function(o,r,s,l){return l.compare(r,s)<=0}),$l=ss(">=",function(o,r,s){return r>=s},function(o,r,s,l){return l.compare(r,s)>=0});class Fn{constructor(r,s,l){this.type=is,this.locale=l,this.caseSensitive=r,this.diacriticSensitive=s}static parse(r,s){if(r.length!==2)return s.error("Expected one argument.");const l=r[1];if(typeof l!="object"||Array.isArray(l))return s.error("Collator options argument must be an object.");const d=s.parse(l["case-sensitive"]!==void 0&&l["case-sensitive"],1,ot);if(!d)return null;const _=s.parse(l["diacritic-sensitive"]!==void 0&&l["diacritic-sensitive"],1,ot);if(!_)return null;let y=null;return l.locale&&(y=s.parse(l.locale,1,st),!y)?null:new Fn(d,_,y)}evaluate(r){return new zl(this.caseSensitive.evaluate(r),this.diacriticSensitive.evaluate(r),this.locale?this.locale.evaluate(r):null)}eachChild(r){r(this.caseSensitive),r(this.diacriticSensitive),this.locale&&r(this.locale)}outputDefined(){return!1}}class Vl{constructor(r,s,l,d,_){this.type=st,this.number=r,this.locale=s,this.currency=l,this.minFractionDigits=d,this.maxFractionDigits=_}static parse(r,s){if(r.length!==3)return s.error("Expected two arguments.");const l=s.parse(r[1],1,$e);if(!l)return null;const d=r[2];if(typeof d!="object"||Array.isArray(d))return s.error("NumberFormat options argument must be an object.");let _=null;if(d.locale&&(_=s.parse(d.locale,1,st),!_))return null;let y=null;if(d.currency&&(y=s.parse(d.currency,1,st),!y))return null;let w=null;if(d["min-fraction-digits"]&&(w=s.parse(d["min-fraction-digits"],1,$e),!w))return null;let T=null;return d["max-fraction-digits"]&&(T=s.parse(d["max-fraction-digits"],1,$e),!T)?null:new Vl(l,_,y,w,T)}evaluate(r){return new Intl.NumberFormat(this.locale?this.locale.evaluate(r):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(r):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(r):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(r):void 0}).format(this.number.evaluate(r))}eachChild(r){r(this.number),this.locale&&r(this.locale),this.currency&&r(this.currency),this.minFractionDigits&&r(this.minFractionDigits),this.maxFractionDigits&&r(this.maxFractionDigits)}outputDefined(){return!1}}class as{constructor(r){this.type=Lr,this.sections=r}static parse(r,s){if(r.length<2)return s.error("Expected at least one argument.");const l=r[1];if(!Array.isArray(l)&&typeof l=="object")return s.error("First argument must be an image or text section.");const d=[];let _=!1;for(let y=1;y<=r.length-1;++y){const w=r[y];if(_&&typeof w=="object"&&!Array.isArray(w)){_=!1;let T=null;if(w["font-scale"]&&(T=s.parse(w["font-scale"],1,$e),!T))return null;let C=null;if(w["text-font"]&&(C=s.parse(w["text-font"],1,Ln(st)),!C))return null;let M=null;if(w["text-color"]&&(M=s.parse(w["text-color"],1,It),!M))return null;let I=null;if(w["vertical-align"]){if(typeof w["vertical-align"]=="string"&&!Fu.includes(w["vertical-align"]))return s.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${w["vertical-align"]}' instead.`);if(I=s.parse(w["vertical-align"],1,st),!I)return null}const D=d[d.length-1];D.scale=T,D.font=C,D.textColor=M,D.verticalAlign=I}else{const T=s.parse(r[y],1,_t);if(!T)return null;const C=T.type.kind;if(C!=="string"&&C!=="value"&&C!=="null"&&C!=="resolvedImage")return s.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");_=!0,d.push({content:T,scale:null,font:null,textColor:null,verticalAlign:null})}}return new as(d)}evaluate(r){return new cn(this.sections.map(s=>{const l=s.content.evaluate(r);return Dr(l)===rr?new oi("",l,null,null,null,s.verticalAlign?s.verticalAlign.evaluate(r):null):new oi(zo(l),null,s.scale?s.scale.evaluate(r):null,s.font?s.font.evaluate(r).join(","):null,s.textColor?s.textColor.evaluate(r):null,s.verticalAlign?s.verticalAlign.evaluate(r):null)}))}eachChild(r){for(const s of this.sections)r(s.content),s.scale&&r(s.scale),s.font&&r(s.font),s.textColor&&r(s.textColor),s.verticalAlign&&r(s.verticalAlign)}outputDefined(){return!1}}class Vu{constructor(r){this.type=rr,this.input=r}static parse(r,s){if(r.length!==2)return s.error("Expected two arguments.");const l=s.parse(r[1],1,st);return l?new Vu(l):s.error("No image name provided.")}evaluate(r){const s=this.input.evaluate(r),l=Cn.fromString(s);return l&&r.availableImages&&(l.available=r.availableImages.indexOf(s)>-1),l}eachChild(r){r(this.input)}outputDefined(){return!1}}class qa{constructor(r){this.type=$e,this.input=r}static parse(r,s){if(r.length!==2)return s.error(`Expected 1 argument, but found ${r.length-1} instead.`);const l=s.parse(r[1],1);return l?l.type.kind!=="array"&&l.type.kind!=="string"&&l.type.kind!=="value"?s.error(`Expected argument of type string or array, but found ${Xt(l.type)} instead.`):new qa(l):null}evaluate(r){const s=this.input.evaluate(r);if(typeof s=="string")return[...s].length;if(Array.isArray(s))return s.length;throw new mr(`Expected value to be of type string or array, but found ${Xt(Dr(s))} instead.`)}eachChild(r){r(this.input)}outputDefined(){return!1}}const Ui=8192;function Vg(o,r){const s=(180+o[0])/360,l=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+o[1]*Math.PI/360)))/360,d=Math.pow(2,r.z);return[Math.round(s*d*Ui),Math.round(l*d*Ui)]}function Uu(o,r){const s=Math.pow(2,r.z);return[(d=(o[0]/Ui+r.x)/s,360*d-180),(l=(o[1]/Ui+r.y)/s,360/Math.PI*Math.atan(Math.exp((180-360*l)*Math.PI/180))-90)];var l,d}function Wa(o,r){o[0]=Math.min(o[0],r[0]),o[1]=Math.min(o[1],r[1]),o[2]=Math.max(o[2],r[0]),o[3]=Math.max(o[3],r[1])}function Ro(o,r){return!(o[0]<=r[0]||o[2]>=r[2]||o[1]<=r[1]||o[3]>=r[3])}function Ug(o,r,s){const l=o[0]-r[0],d=o[1]-r[1],_=o[0]-s[0],y=o[1]-s[1];return l*y-_*d==0&&l*_<=0&&d*y<=0}function Ha(o,r,s,l){return(d=[l[0]-s[0],l[1]-s[1]])[0]*(_=[r[0]-o[0],r[1]-o[1]])[1]-d[1]*_[0]!=0&&!(!up(o,r,s,l)||!up(s,l,o,r));var d,_}function ap(o,r,s){for(const l of s)for(let d=0;d<l.length-1;++d)if(Ha(o,r,l[d],l[d+1]))return!0;return!1}function Ys(o,r,s=!1){let l=!1;for(const w of r)for(let T=0;T<w.length-1;T++){if(Ug(o,w[T],w[T+1]))return s;(_=w[T])[1]>(d=o)[1]!=(y=w[T+1])[1]>d[1]&&d[0]<(y[0]-_[0])*(d[1]-_[1])/(y[1]-_[1])+_[0]&&(l=!l)}var d,_,y;return l}function lp(o,r){for(const s of r)if(Ys(o,s))return!0;return!1}function cp(o,r){for(const s of o)if(!Ys(s,r))return!1;for(let s=0;s<o.length-1;++s)if(ap(o[s],o[s+1],r))return!1;return!0}function Zg(o,r){for(const s of r)if(cp(o,s))return!0;return!1}function up(o,r,s,l){const d=l[0]-s[0],_=l[1]-s[1],y=(o[0]-s[0])*_-d*(o[1]-s[1]),w=(r[0]-s[0])*_-d*(r[1]-s[1]);return y>0&&w<0||y<0&&w>0}function Zu(o,r,s){const l=[];for(let d=0;d<o.length;d++){const _=[];for(let y=0;y<o[d].length;y++){const w=Vg(o[d][y],s);Wa(r,w),_.push(w)}l.push(_)}return l}function hp(o,r,s){const l=[];for(let d=0;d<o.length;d++){const _=Zu(o[d],r,s);l.push(_)}return l}function Gu(o,r,s,l){if(o[0]<s[0]||o[0]>s[2]){const d=.5*l;let _=o[0]-s[0]>d?-l:s[0]-o[0]>d?l:0;_===0&&(_=o[0]-s[2]>d?-l:s[2]-o[0]>d?l:0),o[0]+=_}Wa(r,o)}function qu(o,r,s,l){const d=Math.pow(2,l.z)*Ui,_=[l.x*Ui,l.y*Ui],y=[];for(const w of o)for(const T of w){const C=[T.x+_[0],T.y+_[1]];Gu(C,r,s,d),y.push(C)}return y}function Wu(o,r,s,l){const d=Math.pow(2,l.z)*Ui,_=[l.x*Ui,l.y*Ui],y=[];for(const T of o){const C=[];for(const M of T){const I=[M.x+_[0],M.y+_[1]];Wa(r,I),C.push(I)}y.push(C)}if(r[2]-r[0]<=d/2){(w=r)[0]=w[1]=1/0,w[2]=w[3]=-1/0;for(const T of y)for(const C of T)Gu(C,r,s,d)}var w;return y}class ls{constructor(r,s){this.type=ot,this.geojson=r,this.geometries=s}static parse(r,s){if(r.length!==2)return s.error(`'within' expression requires exactly one argument, but found ${r.length-1} instead.`);if(wi(r[1])){const l=r[1];if(l.type==="FeatureCollection"){const d=[];for(const _ of l.features){const{type:y,coordinates:w}=_.geometry;y==="Polygon"&&d.push(w),y==="MultiPolygon"&&d.push(...w)}if(d.length)return new ls(l,{type:"MultiPolygon",coordinates:d})}else if(l.type==="Feature"){const d=l.geometry.type;if(d==="Polygon"||d==="MultiPolygon")return new ls(l,l.geometry)}else if(l.type==="Polygon"||l.type==="MultiPolygon")return new ls(l,l)}return s.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(r){if(r.geometry()!=null&&r.canonicalID()!=null){if(r.geometryType()==="Point")return function(s,l){const d=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],y=s.canonicalID();if(l.type==="Polygon"){const w=Zu(l.coordinates,_,y),T=qu(s.geometry(),d,_,y);if(!Ro(d,_))return!1;for(const C of T)if(!Ys(C,w))return!1}if(l.type==="MultiPolygon"){const w=hp(l.coordinates,_,y),T=qu(s.geometry(),d,_,y);if(!Ro(d,_))return!1;for(const C of T)if(!lp(C,w))return!1}return!0}(r,this.geometries);if(r.geometryType()==="LineString")return function(s,l){const d=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],y=s.canonicalID();if(l.type==="Polygon"){const w=Zu(l.coordinates,_,y),T=Wu(s.geometry(),d,_,y);if(!Ro(d,_))return!1;for(const C of T)if(!cp(C,w))return!1}if(l.type==="MultiPolygon"){const w=hp(l.coordinates,_,y),T=Wu(s.geometry(),d,_,y);if(!Ro(d,_))return!1;for(const C of T)if(!Zg(C,w))return!1}return!0}(r,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let dp=class{constructor(o=[],r=(s,l)=>s<l?-1:s>l?1:0){if(this.data=o,this.length=this.data.length,this.compare=r,this.length>0)for(let s=(this.length>>1)-1;s>=0;s--)this._down(s)}push(o){this.data.push(o),this._up(this.length++)}pop(){if(this.length===0)return;const o=this.data[0],r=this.data.pop();return--this.length>0&&(this.data[0]=r,this._down(0)),o}peek(){return this.data[0]}_up(o){const{data:r,compare:s}=this,l=r[o];for(;o>0;){const d=o-1>>1,_=r[d];if(s(l,_)>=0)break;r[o]=_,o=d}r[o]=l}_down(o){const{data:r,compare:s}=this,l=this.length>>1,d=r[o];for(;o<l;){let _=1+(o<<1);const y=_+1;if(y<this.length&&s(r[y],r[_])<0&&(_=y),s(r[_],d)>=0)break;r[o]=r[_],o=_}r[o]=d}};function pp(o,r,s=0,l=o.length-1,d=Gg){for(;l>s;){if(l-s>600){const T=l-s+1,C=r-s+1,M=Math.log(T),I=.5*Math.exp(2*M/3),D=.5*Math.sqrt(M*I*(T-I)/T)*(C-T/2<0?-1:1);pp(o,r,Math.max(s,Math.floor(r-C*I/T+D)),Math.min(l,Math.floor(r+(T-C)*I/T+D)),d)}const _=o[r];let y=s,w=l;for(cs(o,s,r),d(o[l],_)>0&&cs(o,s,l);y<w;){for(cs(o,y,w),y++,w--;d(o[y],_)<0;)y++;for(;d(o[w],_)>0;)w--}d(o[s],_)===0?cs(o,s,w):(w++,cs(o,w,l)),w<=r&&(s=w+1),r<=w&&(l=w-1)}}function cs(o,r,s){const l=o[r];o[r]=o[s],o[s]=l}function Gg(o,r){return o<r?-1:o>r?1:0}function Ul(o,r){if(o.length<=1)return[o];const s=[];let l,d;for(const _ of o){const y=fp(_);y!==0&&(_.area=Math.abs(y),d===void 0&&(d=y<0),d===y<0?(l&&s.push(l),l=[_]):l.push(_))}if(l&&s.push(l),r>1)for(let _=0;_<s.length;_++)s[_].length<=r||(pp(s[_],r,1,s[_].length-1,qg),s[_]=s[_].slice(0,r));return s}function qg(o,r){return r.area-o.area}function fp(o){let r=0;for(let s,l,d=0,_=o.length,y=_-1;d<_;y=d++)s=o[d],l=o[y],r+=(l.x-s.x)*(s.y+l.y);return r}const Hu=1/298.257223563,mp=Hu*(2-Hu),gp=Math.PI/180;class Zl{constructor(r){const s=6378.137*gp*1e3,l=Math.cos(r*gp),d=1/(1-mp*(1-l*l)),_=Math.sqrt(d);this.kx=s*_*l,this.ky=s*_*d*(1-mp)}distance(r,s){const l=this.wrap(r[0]-s[0])*this.kx,d=(r[1]-s[1])*this.ky;return Math.sqrt(l*l+d*d)}pointOnLine(r,s){let l,d,_,y,w=1/0;for(let T=0;T<r.length-1;T++){let C=r[T][0],M=r[T][1],I=this.wrap(r[T+1][0]-C)*this.kx,D=(r[T+1][1]-M)*this.ky,B=0;I===0&&D===0||(B=(this.wrap(s[0]-C)*this.kx*I+(s[1]-M)*this.ky*D)/(I*I+D*D),B>1?(C=r[T+1][0],M=r[T+1][1]):B>0&&(C+=I/this.kx*B,M+=D/this.ky*B)),I=this.wrap(s[0]-C)*this.kx,D=(s[1]-M)*this.ky;const O=I*I+D*D;O<w&&(w=O,l=C,d=M,_=T,y=B)}return{point:[l,d],index:_,t:Math.max(0,Math.min(1,y))}}wrap(r){for(;r<-180;)r+=360;for(;r>180;)r-=360;return r}}function Xu(o,r){return r[0]-o[0]}function Gl(o){return o[1]-o[0]+1}function po(o,r){return o[1]>=o[0]&&o[1]<r}function Ku(o,r){if(o[0]>o[1])return[null,null];const s=Gl(o);if(r){if(s===2)return[o,null];const d=Math.floor(s/2);return[[o[0],o[0]+d],[o[0]+d,o[1]]]}if(s===1)return[o,null];const l=Math.floor(s/2)-1;return[[o[0],o[0]+l],[o[0]+l+1,o[1]]]}function ql(o,r){if(!po(r,o.length))return[1/0,1/0,-1/0,-1/0];const s=[1/0,1/0,-1/0,-1/0];for(let l=r[0];l<=r[1];++l)Wa(s,o[l]);return s}function Yu(o){const r=[1/0,1/0,-1/0,-1/0];for(const s of o)for(const l of s)Wa(r,l);return r}function _p(o){return o[0]!==-1/0&&o[1]!==-1/0&&o[2]!==1/0&&o[3]!==1/0}function Qu(o,r,s){if(!_p(o)||!_p(r))return NaN;let l=0,d=0;return o[2]<r[0]&&(l=r[0]-o[2]),o[0]>r[2]&&(l=o[0]-r[2]),o[1]>r[3]&&(d=o[1]-r[3]),o[3]<r[1]&&(d=r[1]-o[3]),s.distance([0,0],[l,d])}function us(o,r,s){const l=s.pointOnLine(r,o);return s.distance(o,l.point)}function $t(o,r,s,l,d){const _=Math.min(us(o,[s,l],d),us(r,[s,l],d)),y=Math.min(us(s,[o,r],d),us(l,[o,r],d));return Math.min(_,y)}function Wg(o,r,s,l,d){if(!po(r,o.length)||!po(l,s.length))return 1/0;let _=1/0;for(let y=r[0];y<r[1];++y){const w=o[y],T=o[y+1];for(let C=l[0];C<l[1];++C){const M=s[C],I=s[C+1];if(Ha(w,T,M,I))return 0;_=Math.min(_,$t(w,T,M,I,d))}}return _}function Hg(o,r,s,l,d){if(!po(r,o.length)||!po(l,s.length))return NaN;let _=1/0;for(let y=r[0];y<=r[1];++y)for(let w=l[0];w<=l[1];++w)if(_=Math.min(_,d.distance(o[y],s[w])),_===0)return _;return _}function Xg(o,r,s){if(Ys(o,r,!0))return 0;let l=1/0;for(const d of r){const _=d[0],y=d[d.length-1];if(_!==y&&(l=Math.min(l,us(o,[y,_],s)),l===0))return l;const w=s.pointOnLine(d,o);if(l=Math.min(l,s.distance(o,w.point)),l===0)return l}return l}function Kg(o,r,s,l){if(!po(r,o.length))return NaN;for(let _=r[0];_<=r[1];++_)if(Ys(o[_],s,!0))return 0;let d=1/0;for(let _=r[0];_<r[1];++_){const y=o[_],w=o[_+1];for(const T of s)for(let C=0,M=T.length,I=M-1;C<M;I=C++){const D=T[I],B=T[C];if(Ha(y,w,D,B))return 0;d=Math.min(d,$t(y,w,D,B,l))}}return d}function yp(o,r){for(const s of o)for(const l of s)if(Ys(l,r,!0))return!0;return!1}function Yg(o,r,s,l=1/0){const d=Yu(o),_=Yu(r);if(l!==1/0&&Qu(d,_,s)>=l)return l;if(Ro(d,_)){if(yp(o,r))return 0}else if(yp(r,o))return 0;let y=1/0;for(const w of o)for(let T=0,C=w.length,M=C-1;T<C;M=T++){const I=w[M],D=w[T];for(const B of r)for(let O=0,$=B.length,q=$-1;O<$;q=O++){const ne=B[q],me=B[O];if(Ha(I,D,ne,me))return 0;y=Math.min(y,$t(I,D,ne,me,s))}}return y}function vp(o,r,s,l,d,_){if(!_)return;const y=Qu(ql(l,_),d,s);y<r&&o.push([y,_,[0,0]])}function Wl(o,r,s,l,d,_,y){if(!_||!y)return;const w=Qu(ql(l,_),ql(d,y),s);w<r&&o.push([w,_,y])}function Hl(o,r,s,l,d=1/0){let _=Math.min(l.distance(o[0],s[0][0]),d);if(_===0)return _;const y=new dp([[0,[0,o.length-1],[0,0]]],Xu),w=Yu(s);for(;y.length>0;){const T=y.pop();if(T[0]>=_)continue;const C=T[1],M=r?50:100;if(Gl(C)<=M){if(!po(C,o.length))return NaN;if(r){const I=Kg(o,C,s,l);if(isNaN(I)||I===0)return I;_=Math.min(_,I)}else for(let I=C[0];I<=C[1];++I){const D=Xg(o[I],s,l);if(_=Math.min(_,D),_===0)return 0}}else{const I=Ku(C,r);vp(y,_,l,o,w,I[0]),vp(y,_,l,o,w,I[1])}}return _}function Xl(o,r,s,l,d,_=1/0){let y=Math.min(_,d.distance(o[0],s[0]));if(y===0)return y;const w=new dp([[0,[0,o.length-1],[0,s.length-1]]],Xu);for(;w.length>0;){const T=w.pop();if(T[0]>=y)continue;const C=T[1],M=T[2],I=r?50:100,D=l?50:100;if(Gl(C)<=I&&Gl(M)<=D){if(!po(C,o.length)&&po(M,s.length))return NaN;let B;if(r&&l)B=Wg(o,C,s,M,d),y=Math.min(y,B);else if(r&&!l){const O=o.slice(C[0],C[1]+1);for(let $=M[0];$<=M[1];++$)if(B=us(s[$],O,d),y=Math.min(y,B),y===0)return y}else if(!r&&l){const O=s.slice(M[0],M[1]+1);for(let $=C[0];$<=C[1];++$)if(B=us(o[$],O,d),y=Math.min(y,B),y===0)return y}else B=Hg(o,C,s,M,d),y=Math.min(y,B)}else{const B=Ku(C,r),O=Ku(M,l);Wl(w,y,d,o,s,B[0],O[0]),Wl(w,y,d,o,s,B[0],O[1]),Wl(w,y,d,o,s,B[1],O[0]),Wl(w,y,d,o,s,B[1],O[1])}}return y}function Ju(o){return o.type==="MultiPolygon"?o.coordinates.map(r=>({type:"Polygon",coordinates:r})):o.type==="MultiLineString"?o.coordinates.map(r=>({type:"LineString",coordinates:r})):o.type==="MultiPoint"?o.coordinates.map(r=>({type:"Point",coordinates:r})):[o]}class hs{constructor(r,s){this.type=$e,this.geojson=r,this.geometries=s}static parse(r,s){if(r.length!==2)return s.error(`'distance' expression requires exactly one argument, but found ${r.length-1} instead.`);if(wi(r[1])){const l=r[1];if(l.type==="FeatureCollection")return new hs(l,l.features.map(d=>Ju(d.geometry)).flat());if(l.type==="Feature")return new hs(l,Ju(l.geometry));if("type"in l&&"coordinates"in l)return new hs(l,Ju(l))}return s.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(r){if(r.geometry()!=null&&r.canonicalID()!=null){if(r.geometryType()==="Point")return function(s,l){const d=s.geometry(),_=d.flat().map(T=>Uu([T.x,T.y],s.canonical));if(d.length===0)return NaN;const y=new Zl(_[0][1]);let w=1/0;for(const T of l){switch(T.type){case"Point":w=Math.min(w,Xl(_,!1,[T.coordinates],!1,y,w));break;case"LineString":w=Math.min(w,Xl(_,!1,T.coordinates,!0,y,w));break;case"Polygon":w=Math.min(w,Hl(_,!1,T.coordinates,y,w))}if(w===0)return w}return w}(r,this.geometries);if(r.geometryType()==="LineString")return function(s,l){const d=s.geometry(),_=d.flat().map(T=>Uu([T.x,T.y],s.canonical));if(d.length===0)return NaN;const y=new Zl(_[0][1]);let w=1/0;for(const T of l){switch(T.type){case"Point":w=Math.min(w,Xl(_,!0,[T.coordinates],!1,y,w));break;case"LineString":w=Math.min(w,Xl(_,!0,T.coordinates,!0,y,w));break;case"Polygon":w=Math.min(w,Hl(_,!0,T.coordinates,y,w))}if(w===0)return w}return w}(r,this.geometries);if(r.geometryType()==="Polygon")return function(s,l){const d=s.geometry();if(d.length===0||d[0].length===0)return NaN;const _=Ul(d,0).map(T=>T.map(C=>C.map(M=>Uu([M.x,M.y],s.canonical)))),y=new Zl(_[0][0][0][1]);let w=1/0;for(const T of l)for(const C of _){switch(T.type){case"Point":w=Math.min(w,Hl([T.coordinates],!1,C,y,w));break;case"LineString":w=Math.min(w,Hl(T.coordinates,!0,C,y,w));break;case"Polygon":w=Math.min(w,Yg(C,T.coordinates,y,w))}if(w===0)return w}return w}(r,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}const Qs={"==":Ng,"!=":jl,">":$g,"<":$u,">=":$l,"<=":Nl,array:ai,at:Dt,boolean:ai,case:Dl,coalesce:Er,collator:Fn,format:as,image:Vu,in:Va,"index-of":li,interpolate:yn,"interpolate-hcl":yn,"interpolate-lab":yn,length:qa,let:Mt,literal:si,match:Ua,number:ai,"number-format":Vl,object:ai,slice:Za,step:Ks,string:ai,"to-boolean":Si,"to-color":Si,"to-number":Si,"to-string":Si,var:Hs,within:ls,distance:hs};class ci{constructor(r,s,l,d){this.name=r,this.type=s,this._evaluate=l,this.args=d}evaluate(r){return this._evaluate(r,this.args)}eachChild(r){this.args.forEach(r)}outputDefined(){return!1}static parse(r,s){const l=r[0],d=ci.definitions[l];if(!d)return s.error(`Unknown expression "${l}". If you wanted a literal array, use ["literal", [...]].`,0);const _=Array.isArray(d)?d[0]:d.type,y=Array.isArray(d)?[[d[1],d[2]]]:d.overloads,w=y.filter(([C])=>!Array.isArray(C)||C.length===r.length-1);let T=null;for(const[C,M]of w){T=new Rt(s.registry,Kl,s.path,null,s.scope);const I=[];let D=!1;for(let B=1;B<r.length;B++){const O=r[B],$=Array.isArray(C)?C[B-1]:C.type,q=T.parse(O,1+I.length,$);if(!q){D=!0;break}I.push(q)}if(!D)if(Array.isArray(C)&&C.length!==I.length)T.error(`Expected ${C.length} arguments, but found ${I.length} instead.`);else{for(let B=0;B<I.length;B++){const O=Array.isArray(C)?C[B]:C.type,$=I[B];T.concat(B+1).checkSubtype(O,$.type)}if(T.errors.length===0)return new ci(l,_,M,I)}}if(w.length===1)s.errors.push(...T.errors);else{const C=(w.length?w:y).map(([I])=>{return D=I,Array.isArray(D)?`(${D.map(Xt).join(", ")})`:`(${Xt(D.type)}...)`;var D}).join(" | "),M=[];for(let I=1;I<r.length;I++){const D=s.parse(r[I],1+M.length);if(!D)return null;M.push(Xt(D.type))}s.error(`Expected arguments of type ${C}, but found (${M.join(", ")}) instead.`)}return null}static register(r,s){ci.definitions=s;for(const l in s)r[l]=ci}}function xp(o,[r,s,l,d]){r=r.evaluate(o),s=s.evaluate(o),l=l.evaluate(o);const _=d?d.evaluate(o):1,y=Rl(r,s,l,_);if(y)throw new mr(y);return new Bt(r/255,s/255,l/255,_,!1)}function bp(o,r){return o in r}function eh(o,r){const s=r[o];return s===void 0?null:s}function ds(o){return{type:o}}function Kl(o){if(o instanceof Hs)return Kl(o.boundExpression);if(o instanceof ci&&o.name==="error"||o instanceof Fn||o instanceof ls||o instanceof hs)return!1;const r=o instanceof Si||o instanceof ai;let s=!0;return o.eachChild(l=>{s=r?s&&Kl(l):s&&l instanceof si}),!!s&&Yl(o)&&Ql(o,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function Yl(o){if(o instanceof ci&&(o.name==="get"&&o.args.length===1||o.name==="feature-state"||o.name==="has"&&o.args.length===1||o.name==="properties"||o.name==="geometry-type"||o.name==="id"||/^filter-/.test(o.name))||o instanceof ls||o instanceof hs)return!1;let r=!0;return o.eachChild(s=>{r&&!Yl(s)&&(r=!1)}),r}function Xa(o){if(o instanceof ci&&o.name==="feature-state")return!1;let r=!0;return o.eachChild(s=>{r&&!Xa(s)&&(r=!1)}),r}function Ql(o,r){if(o instanceof ci&&r.indexOf(o.name)>=0)return!1;let s=!0;return o.eachChild(l=>{s&&!Ql(l,r)&&(s=!1)}),s}function wp(o){return{result:"success",value:o}}function Js(o){return{result:"error",value:o}}function ea(o){return o["property-type"]==="data-driven"||o["property-type"]==="cross-faded-data-driven"}function Sp(o){return!!o.expression&&o.expression.parameters.indexOf("zoom")>-1}function th(o){return!!o.expression&&o.expression.interpolated}function Ot(o){return o instanceof Number?"number":o instanceof String?"string":o instanceof Boolean?"boolean":Array.isArray(o)?"array":o===null?"null":typeof o}function Jl(o){return typeof o=="object"&&o!==null&&!Array.isArray(o)}function Qg(o){return o}function Tp(o,r){const s=r.type==="color",l=o.stops&&typeof o.stops[0][0]=="object",d=l||!(l||o.property!==void 0),_=o.type||(th(r)?"exponential":"interval");if(s||r.type==="padding"){const M=s?Bt.parse:Yr.parse;(o=et({},o)).stops&&(o.stops=o.stops.map(I=>[I[0],M(I[1])])),o.default=M(o.default?o.default:r.default)}if(o.colorSpace&&(y=o.colorSpace)!=="rgb"&&y!=="hcl"&&y!=="lab")throw new Error(`Unknown color space: "${o.colorSpace}"`);var y;let w,T,C;if(_==="exponential")w=Pp;else if(_==="interval")w=e_;else if(_==="categorical"){w=Jg,T=Object.create(null);for(const M of o.stops)T[M[0]]=M[1];C=typeof o.stops[0][0]}else{if(_!=="identity")throw new Error(`Unknown function type "${_}"`);w=Cp}if(l){const M={},I=[];for(let O=0;O<o.stops.length;O++){const $=o.stops[O],q=$[0].zoom;M[q]===void 0&&(M[q]={zoom:q,type:o.type,property:o.property,default:o.default,stops:[]},I.push(q)),M[q].stops.push([$[0].value,$[1]])}const D=[];for(const O of I)D.push([M[O].zoom,Tp(M[O],r)]);const B={name:"linear"};return{kind:"composite",interpolationType:B,interpolationFactor:yn.interpolationFactor.bind(void 0,B),zoomStops:D.map(O=>O[0]),evaluate:({zoom:O},$)=>Pp({stops:D,base:o.base},r,O).evaluate(O,$)}}if(d){const M=_==="exponential"?{name:"exponential",base:o.base!==void 0?o.base:1}:null;return{kind:"camera",interpolationType:M,interpolationFactor:yn.interpolationFactor.bind(void 0,M),zoomStops:o.stops.map(I=>I[0]),evaluate:({zoom:I})=>w(o,r,I,T,C)}}return{kind:"source",evaluate(M,I){const D=I&&I.properties?I.properties[o.property]:void 0;return D===void 0?ps(o.default,r.default):w(o,r,D,T,C)}}}function ps(o,r,s){return o!==void 0?o:r!==void 0?r:s!==void 0?s:void 0}function Jg(o,r,s,l,d){return ps(typeof s===d?l[s]:void 0,o.default,r.default)}function e_(o,r,s){if(Ot(s)!=="number")return ps(o.default,r.default);const l=o.stops.length;if(l===1||s<=o.stops[0][0])return o.stops[0][1];if(s>=o.stops[l-1][0])return o.stops[l-1][1];const d=Xs(o.stops.map(_=>_[0]),s);return o.stops[d][1]}function Pp(o,r,s){const l=o.base!==void 0?o.base:1;if(Ot(s)!=="number")return ps(o.default,r.default);const d=o.stops.length;if(d===1||s<=o.stops[0][0])return o.stops[0][1];if(s>=o.stops[d-1][0])return o.stops[d-1][1];const _=Xs(o.stops.map(M=>M[0]),s),y=function(M,I,D,B){const O=B-D,$=M-D;return O===0?0:I===1?$/O:(Math.pow(I,$)-1)/(Math.pow(I,O)-1)}(s,l,o.stops[_][0],o.stops[_+1][0]),w=o.stops[_][1],T=o.stops[_+1][1],C=Hn[r.type]||Qg;return typeof w.evaluate=="function"?{evaluate(...M){const I=w.evaluate.apply(void 0,M),D=T.evaluate.apply(void 0,M);if(I!==void 0&&D!==void 0)return C(I,D,y,o.colorSpace)}}:C(w,T,y,o.colorSpace)}function Cp(o,r,s){switch(r.type){case"color":s=Bt.parse(s);break;case"formatted":s=cn.fromString(s.toString());break;case"resolvedImage":s=Cn.fromString(s.toString());break;case"padding":s=Yr.parse(s);break;default:Ot(s)===r.type||r.type==="enum"&&r.values[s]||(s=void 0)}return ps(s,o.default,r.default)}ci.register(Qs,{error:[{kind:"error"},[st],(o,[r])=>{throw new mr(r.evaluate(o))}],typeof:[st,[_t],(o,[r])=>Xt(Dr(r.evaluate(o)))],"to-rgba":[Ln($e,4),[It],(o,[r])=>{const[s,l,d,_]=r.evaluate(o).rgb;return[255*s,255*l,255*d,_]}],rgb:[It,[$e,$e,$e],xp],rgba:[It,[$e,$e,$e,$e],xp],has:{type:ot,overloads:[[[st],(o,[r])=>bp(r.evaluate(o),o.properties())],[[st,kt],(o,[r,s])=>bp(r.evaluate(o),s.evaluate(o))]]},get:{type:_t,overloads:[[[st],(o,[r])=>eh(r.evaluate(o),o.properties())],[[st,kt],(o,[r,s])=>eh(r.evaluate(o),s.evaluate(o))]]},"feature-state":[_t,[st],(o,[r])=>eh(r.evaluate(o),o.featureState||{})],properties:[kt,[],o=>o.properties()],"geometry-type":[st,[],o=>o.geometryType()],id:[_t,[],o=>o.id()],zoom:[$e,[],o=>o.globals.zoom],"heatmap-density":[$e,[],o=>o.globals.heatmapDensity||0],"line-progress":[$e,[],o=>o.globals.lineProgress||0],accumulated:[_t,[],o=>o.globals.accumulated===void 0?null:o.globals.accumulated],"+":[$e,ds($e),(o,r)=>{let s=0;for(const l of r)s+=l.evaluate(o);return s}],"*":[$e,ds($e),(o,r)=>{let s=1;for(const l of r)s*=l.evaluate(o);return s}],"-":{type:$e,overloads:[[[$e,$e],(o,[r,s])=>r.evaluate(o)-s.evaluate(o)],[[$e],(o,[r])=>-r.evaluate(o)]]},"/":[$e,[$e,$e],(o,[r,s])=>r.evaluate(o)/s.evaluate(o)],"%":[$e,[$e,$e],(o,[r,s])=>r.evaluate(o)%s.evaluate(o)],ln2:[$e,[],()=>Math.LN2],pi:[$e,[],()=>Math.PI],e:[$e,[],()=>Math.E],"^":[$e,[$e,$e],(o,[r,s])=>Math.pow(r.evaluate(o),s.evaluate(o))],sqrt:[$e,[$e],(o,[r])=>Math.sqrt(r.evaluate(o))],log10:[$e,[$e],(o,[r])=>Math.log(r.evaluate(o))/Math.LN10],ln:[$e,[$e],(o,[r])=>Math.log(r.evaluate(o))],log2:[$e,[$e],(o,[r])=>Math.log(r.evaluate(o))/Math.LN2],sin:[$e,[$e],(o,[r])=>Math.sin(r.evaluate(o))],cos:[$e,[$e],(o,[r])=>Math.cos(r.evaluate(o))],tan:[$e,[$e],(o,[r])=>Math.tan(r.evaluate(o))],asin:[$e,[$e],(o,[r])=>Math.asin(r.evaluate(o))],acos:[$e,[$e],(o,[r])=>Math.acos(r.evaluate(o))],atan:[$e,[$e],(o,[r])=>Math.atan(r.evaluate(o))],min:[$e,ds($e),(o,r)=>Math.min(...r.map(s=>s.evaluate(o)))],max:[$e,ds($e),(o,r)=>Math.max(...r.map(s=>s.evaluate(o)))],abs:[$e,[$e],(o,[r])=>Math.abs(r.evaluate(o))],round:[$e,[$e],(o,[r])=>{const s=r.evaluate(o);return s<0?-Math.round(-s):Math.round(s)}],floor:[$e,[$e],(o,[r])=>Math.floor(r.evaluate(o))],ceil:[$e,[$e],(o,[r])=>Math.ceil(r.evaluate(o))],"filter-==":[ot,[st,_t],(o,[r,s])=>o.properties()[r.value]===s.value],"filter-id-==":[ot,[_t],(o,[r])=>o.id()===r.value],"filter-type-==":[ot,[st],(o,[r])=>o.geometryType()===r.value],"filter-<":[ot,[st,_t],(o,[r,s])=>{const l=o.properties()[r.value],d=s.value;return typeof l==typeof d&&l<d}],"filter-id-<":[ot,[_t],(o,[r])=>{const s=o.id(),l=r.value;return typeof s==typeof l&&s<l}],"filter->":[ot,[st,_t],(o,[r,s])=>{const l=o.properties()[r.value],d=s.value;return typeof l==typeof d&&l>d}],"filter-id->":[ot,[_t],(o,[r])=>{const s=o.id(),l=r.value;return typeof s==typeof l&&s>l}],"filter-<=":[ot,[st,_t],(o,[r,s])=>{const l=o.properties()[r.value],d=s.value;return typeof l==typeof d&&l<=d}],"filter-id-<=":[ot,[_t],(o,[r])=>{const s=o.id(),l=r.value;return typeof s==typeof l&&s<=l}],"filter->=":[ot,[st,_t],(o,[r,s])=>{const l=o.properties()[r.value],d=s.value;return typeof l==typeof d&&l>=d}],"filter-id->=":[ot,[_t],(o,[r])=>{const s=o.id(),l=r.value;return typeof s==typeof l&&s>=l}],"filter-has":[ot,[_t],(o,[r])=>r.value in o.properties()],"filter-has-id":[ot,[],o=>o.id()!==null&&o.id()!==void 0],"filter-type-in":[ot,[Ln(st)],(o,[r])=>r.value.indexOf(o.geometryType())>=0],"filter-id-in":[ot,[Ln(_t)],(o,[r])=>r.value.indexOf(o.id())>=0],"filter-in-small":[ot,[st,Ln(_t)],(o,[r,s])=>s.value.indexOf(o.properties()[r.value])>=0],"filter-in-large":[ot,[st,Ln(_t)],(o,[r,s])=>function(l,d,_,y){for(;_<=y;){const w=_+y>>1;if(d[w]===l)return!0;d[w]>l?y=w-1:_=w+1}return!1}(o.properties()[r.value],s.value,0,s.value.length-1)],all:{type:ot,overloads:[[[ot,ot],(o,[r,s])=>r.evaluate(o)&&s.evaluate(o)],[ds(ot),(o,r)=>{for(const s of r)if(!s.evaluate(o))return!1;return!0}]]},any:{type:ot,overloads:[[[ot,ot],(o,[r,s])=>r.evaluate(o)||s.evaluate(o)],[ds(ot),(o,r)=>{for(const s of r)if(s.evaluate(o))return!0;return!1}]]},"!":[ot,[ot],(o,[r])=>!r.evaluate(o)],"is-supported-script":[ot,[st],(o,[r])=>{const s=o.globals&&o.globals.isSupportedScript;return!s||s(r.evaluate(o))}],upcase:[st,[st],(o,[r])=>r.evaluate(o).toUpperCase()],downcase:[st,[st],(o,[r])=>r.evaluate(o).toLowerCase()],concat:[st,ds(_t),(o,r)=>r.map(s=>zo(s.evaluate(o))).join("")],"resolved-locale":[st,[is],(o,[r])=>r.evaluate(o).resolvedLocale()]});class rh{constructor(r,s){var l;this.expression=r,this._warningHistory={},this._evaluator=new Ll,this._defaultValue=s?(l=s).type==="color"&&Jl(l.default)?new Bt(0,0,0,0):l.type==="color"?Bt.parse(l.default)||null:l.type==="padding"?Yr.parse(l.default)||null:l.type==="variableAnchorOffsetCollection"?Qr.parse(l.default)||null:l.type==="projectionDefinition"?Dn.parse(l.default)||null:l.default===void 0?null:l.default:null,this._enumValues=s&&s.type==="enum"?s.values:null}evaluateWithoutErrorHandling(r,s,l,d,_,y){return this._evaluator.globals=r,this._evaluator.feature=s,this._evaluator.featureState=l,this._evaluator.canonical=d,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=y,this.expression.evaluate(this._evaluator)}evaluate(r,s,l,d,_,y){this._evaluator.globals=r,this._evaluator.feature=s||null,this._evaluator.featureState=l||null,this._evaluator.canonical=d,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=y||null;try{const w=this.expression.evaluate(this._evaluator);if(w==null||typeof w=="number"&&w!=w)return this._defaultValue;if(this._enumValues&&!(w in this._enumValues))throw new mr(`Expected value to be one of ${Object.keys(this._enumValues).map(T=>JSON.stringify(T)).join(", ")}, but found ${JSON.stringify(w)} instead.`);return w}catch(w){return this._warningHistory[w.message]||(this._warningHistory[w.message]=!0,typeof console<"u"&&console.warn(w.message)),this._defaultValue}}}function ec(o){return Array.isArray(o)&&o.length>0&&typeof o[0]=="string"&&o[0]in Qs}function fs(o,r){const s=new Rt(Qs,Kl,[],r?function(d){const _={color:It,string:st,number:$e,enum:st,boolean:ot,formatted:Lr,padding:Nr,projectionDefinition:wt,resolvedImage:rr,variableAnchorOffsetCollection:kl};return d.type==="array"?Ln(_[d.value]||_t,d.length):_[d.type]}(r):void 0),l=s.parse(o,void 0,void 0,void 0,r&&r.type==="string"?{typeAnnotation:"coerce"}:void 0);return l?wp(new rh(l,r)):Js(s.errors)}class tc{constructor(r,s){this.kind=r,this._styleExpression=s,this.isStateDependent=r!=="constant"&&!Xa(s.expression)}evaluateWithoutErrorHandling(r,s,l,d,_,y){return this._styleExpression.evaluateWithoutErrorHandling(r,s,l,d,_,y)}evaluate(r,s,l,d,_,y){return this._styleExpression.evaluate(r,s,l,d,_,y)}}class nh{constructor(r,s,l,d){this.kind=r,this.zoomStops=l,this._styleExpression=s,this.isStateDependent=r!=="camera"&&!Xa(s.expression),this.interpolationType=d}evaluateWithoutErrorHandling(r,s,l,d,_,y){return this._styleExpression.evaluateWithoutErrorHandling(r,s,l,d,_,y)}evaluate(r,s,l,d,_,y){return this._styleExpression.evaluate(r,s,l,d,_,y)}interpolationFactor(r,s,l){return this.interpolationType?yn.interpolationFactor(this.interpolationType,r,s,l):0}}function Ep(o,r){const s=fs(o,r);if(s.result==="error")return s;const l=s.value.expression,d=Yl(l);if(!d&&!ea(r))return Js([new dt("","data expressions not supported")]);const _=Ql(l,["zoom"]);if(!_&&!Sp(r))return Js([new dt("","zoom expressions not supported")]);const y=nc(l);return y||_?y instanceof dt?Js([y]):y instanceof yn&&!th(r)?Js([new dt("",'"interpolate" expressions cannot be used with this property')]):wp(y?new nh(d?"camera":"composite",s.value,y.labels,y instanceof yn?y.interpolation:void 0):new tc(d?"constant":"source",s.value)):Js([new dt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class rc{constructor(r,s){this._parameters=r,this._specification=s,et(this,Tp(this._parameters,this._specification))}static deserialize(r){return new rc(r._parameters,r._specification)}static serialize(r){return{_parameters:r._parameters,_specification:r._specification}}}function nc(o){let r=null;if(o instanceof Mt)r=nc(o.result);else if(o instanceof Er){for(const s of o.args)if(r=nc(s),r)break}else(o instanceof Ks||o instanceof yn)&&o.input instanceof ci&&o.input.name==="zoom"&&(r=o);return r instanceof dt||o.eachChild(s=>{const l=nc(s);l instanceof dt?r=l:!r&&l?r=new dt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):r&&l&&r!==l&&(r=new dt("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),r}function ih(o){if(o===!0||o===!1)return!0;if(!Array.isArray(o)||o.length===0)return!1;switch(o[0]){case"has":return o.length>=2&&o[1]!=="$id"&&o[1]!=="$type";case"in":return o.length>=3&&(typeof o[1]!="string"||Array.isArray(o[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return o.length!==3||Array.isArray(o[1])||Array.isArray(o[2]);case"any":case"all":for(const r of o.slice(1))if(!ih(r)&&typeof r!="boolean")return!1;return!0;default:return!0}}const Mp={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function ic(o){if(o==null)return{filter:()=>!0,needGeometry:!1};ih(o)||(o=Ka(o));const r=fs(o,Mp);if(r.result==="error")throw new Error(r.value.map(s=>`${s.key}: ${s.message}`).join(", "));return{filter:(s,l,d)=>r.value.evaluate(s,l,{},d),needGeometry:Ip(o)}}function t_(o,r){return o<r?-1:o>r?1:0}function Ip(o){if(!Array.isArray(o))return!1;if(o[0]==="within"||o[0]==="distance")return!0;for(let r=1;r<o.length;r++)if(Ip(o[r]))return!0;return!1}function Ka(o){if(!o)return!0;const r=o[0];return o.length<=1?r!=="any":r==="=="?oc(o[1],o[2],"=="):r==="!="?ta(oc(o[1],o[2],"==")):r==="<"||r===">"||r==="<="||r===">="?oc(o[1],o[2],r):r==="any"?(s=o.slice(1),["any"].concat(s.map(Ka))):r==="all"?["all"].concat(o.slice(1).map(Ka)):r==="none"?["all"].concat(o.slice(1).map(Ka).map(ta)):r==="in"?oh(o[1],o.slice(2)):r==="!in"?ta(oh(o[1],o.slice(2))):r==="has"?sh(o[1]):r!=="!has"||ta(sh(o[1]));var s}function oc(o,r,s){switch(o){case"$type":return[`filter-type-${s}`,r];case"$id":return[`filter-id-${s}`,r];default:return[`filter-${s}`,o,r]}}function oh(o,r){if(r.length===0)return!1;switch(o){case"$type":return["filter-type-in",["literal",r]];case"$id":return["filter-id-in",["literal",r]];default:return r.length>200&&!r.some(s=>typeof s!=typeof r[0])?["filter-in-large",o,["literal",r.sort(t_)]]:["filter-in-small",o,["literal",r]]}}function sh(o){switch(o){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",o]}}function ta(o){return["!",o]}function Ya(o){const r=typeof o;if(r==="number"||r==="boolean"||r==="string"||o==null)return JSON.stringify(o);if(Array.isArray(o)){let d="[";for(const _ of o)d+=`${Ya(_)},`;return`${d}]`}const s=Object.keys(o).sort();let l="{";for(let d=0;d<s.length;d++)l+=`${JSON.stringify(s[d])}:${Ya(o[s[d]])},`;return`${l}}`}function ah(o){let r="";for(const s of U)r+=`/${Ya(o[s])}`;return r}function Qa(o){const r=o.value;return r?[new Te(o.key,r,"constants have been deprecated as of v8")]:[]}function Sr(o){return o instanceof Number||o instanceof String||o instanceof Boolean?o.valueOf():o}function ms(o){if(Array.isArray(o))return o.map(ms);if(o instanceof Object&&!(o instanceof Number||o instanceof String||o instanceof Boolean)){const r={};for(const s in o)r[s]=ms(o[s]);return r}return Sr(o)}function ui(o){const r=o.key,s=o.value,l=o.valueSpec||{},d=o.objectElementValidators||{},_=o.style,y=o.styleSpec,w=o.validateSpec;let T=[];const C=Ot(s);if(C!=="object")return[new Te(r,s,`object expected, ${C} found`)];for(const M in s){const I=M.split(".")[0],D=l[I]||l["*"];let B;if(d[I])B=d[I];else if(l[I])B=w;else if(d["*"])B=d["*"];else{if(!l["*"]){T.push(new Te(r,s[M],`unknown property "${M}"`));continue}B=w}T=T.concat(B({key:(r&&`${r}.`)+M,value:s[M],valueSpec:D,style:_,styleSpec:y,object:s,objectKey:M,validateSpec:w},s))}for(const M in l)d[M]||l[M].required&&l[M].default===void 0&&s[M]===void 0&&T.push(new Te(r,s,`missing required property "${M}"`));return T}function lh(o){const r=o.value,s=o.valueSpec,l=o.style,d=o.styleSpec,_=o.key,y=o.arrayElementValidator||o.validateSpec;if(Ot(r)!=="array")return[new Te(_,r,`array expected, ${Ot(r)} found`)];if(s.length&&r.length!==s.length)return[new Te(_,r,`array length ${s.length} expected, length ${r.length} found`)];if(s["min-length"]&&r.length<s["min-length"])return[new Te(_,r,`array length at least ${s["min-length"]} expected, length ${r.length} found`)];let w={type:s.value,values:s.values};d.$version<7&&(w.function=s.function),Ot(s.value)==="object"&&(w=s.value);let T=[];for(let C=0;C<r.length;C++)T=T.concat(y({array:r,arrayIndex:C,value:r[C],valueSpec:w,validateSpec:o.validateSpec,style:l,styleSpec:d,key:`${_}[${C}]`}));return T}function ch(o){const r=o.key,s=o.value,l=o.valueSpec;let d=Ot(s);return d==="number"&&s!=s&&(d="NaN"),d!=="number"?[new Te(r,s,`number expected, ${d} found`)]:"minimum"in l&&s<l.minimum?[new Te(r,s,`${s} is less than the minimum value ${l.minimum}`)]:"maximum"in l&&s>l.maximum?[new Te(r,s,`${s} is greater than the maximum value ${l.maximum}`)]:[]}function kp(o){const r=o.valueSpec,s=Sr(o.value.type);let l,d,_,y={};const w=s!=="categorical"&&o.value.property===void 0,T=!w,C=Ot(o.value.stops)==="array"&&Ot(o.value.stops[0])==="array"&&Ot(o.value.stops[0][0])==="object",M=ui({key:o.key,value:o.value,valueSpec:o.styleSpec.function,validateSpec:o.validateSpec,style:o.style,styleSpec:o.styleSpec,objectElementValidators:{stops:function(B){if(s==="identity")return[new Te(B.key,B.value,'identity function may not have a "stops" property')];let O=[];const $=B.value;return O=O.concat(lh({key:B.key,value:$,valueSpec:B.valueSpec,validateSpec:B.validateSpec,style:B.style,styleSpec:B.styleSpec,arrayElementValidator:I})),Ot($)==="array"&&$.length===0&&O.push(new Te(B.key,$,"array must have at least one stop")),O},default:function(B){return B.validateSpec({key:B.key,value:B.value,valueSpec:r,validateSpec:B.validateSpec,style:B.style,styleSpec:B.styleSpec})}}});return s==="identity"&&w&&M.push(new Te(o.key,o.value,'missing required property "property"')),s==="identity"||o.value.stops||M.push(new Te(o.key,o.value,'missing required property "stops"')),s==="exponential"&&o.valueSpec.expression&&!th(o.valueSpec)&&M.push(new Te(o.key,o.value,"exponential functions not supported")),o.styleSpec.$version>=8&&(T&&!ea(o.valueSpec)?M.push(new Te(o.key,o.value,"property functions not supported")):w&&!Sp(o.valueSpec)&&M.push(new Te(o.key,o.value,"zoom functions not supported"))),s!=="categorical"&&!C||o.value.property!==void 0||M.push(new Te(o.key,o.value,'"property" property is required')),M;function I(B){let O=[];const $=B.value,q=B.key;if(Ot($)!=="array")return[new Te(q,$,`array expected, ${Ot($)} found`)];if($.length!==2)return[new Te(q,$,`array length 2 expected, length ${$.length} found`)];if(C){if(Ot($[0])!=="object")return[new Te(q,$,`object expected, ${Ot($[0])} found`)];if($[0].zoom===void 0)return[new Te(q,$,"object stop key must have zoom")];if($[0].value===void 0)return[new Te(q,$,"object stop key must have value")];if(_&&_>Sr($[0].zoom))return[new Te(q,$[0].zoom,"stop zoom values must appear in ascending order")];Sr($[0].zoom)!==_&&(_=Sr($[0].zoom),d=void 0,y={}),O=O.concat(ui({key:`${q}[0]`,value:$[0],valueSpec:{zoom:{}},validateSpec:B.validateSpec,style:B.style,styleSpec:B.styleSpec,objectElementValidators:{zoom:ch,value:D}}))}else O=O.concat(D({key:`${q}[0]`,value:$[0],validateSpec:B.validateSpec,style:B.style,styleSpec:B.styleSpec},$));return ec(ms($[1]))?O.concat([new Te(`${q}[1]`,$[1],"expressions are not allowed in function stops.")]):O.concat(B.validateSpec({key:`${q}[1]`,value:$[1],valueSpec:r,validateSpec:B.validateSpec,style:B.style,styleSpec:B.styleSpec}))}function D(B,O){const $=Ot(B.value),q=Sr(B.value),ne=B.value!==null?B.value:O;if(l){if($!==l)return[new Te(B.key,ne,`${$} stop domain type must match previous stop domain type ${l}`)]}else l=$;if($!=="number"&&$!=="string"&&$!=="boolean")return[new Te(B.key,ne,"stop domain value must be a number, string, or boolean")];if($!=="number"&&s!=="categorical"){let me=`number expected, ${$} found`;return ea(r)&&s===void 0&&(me+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Te(B.key,ne,me)]}return s!=="categorical"||$!=="number"||isFinite(q)&&Math.floor(q)===q?s!=="categorical"&&$==="number"&&d!==void 0&&q<d?[new Te(B.key,ne,"stop domain values must appear in ascending order")]:(d=q,s==="categorical"&&q in y?[new Te(B.key,ne,"stop domain values must be unique")]:(y[q]=!0,[])):[new Te(B.key,ne,`integer expected, found ${q}`)]}}function gs(o){const r=(o.expressionContext==="property"?Ep:fs)(ms(o.value),o.valueSpec);if(r.result==="error")return r.value.map(l=>new Te(`${o.key}${l.key}`,o.value,l.message));const s=r.value.expression||r.value._styleExpression.expression;if(o.expressionContext==="property"&&o.propertyKey==="text-font"&&!s.outputDefined())return[new Te(o.key,o.value,`Invalid data expression for "${o.propertyKey}". Output values must be contained as literals within the expression.`)];if(o.expressionContext==="property"&&o.propertyType==="layout"&&!Xa(s))return[new Te(o.key,o.value,'"feature-state" data expressions are not supported with layout properties.')];if(o.expressionContext==="filter"&&!Xa(s))return[new Te(o.key,o.value,'"feature-state" data expressions are not supported with filters.')];if(o.expressionContext&&o.expressionContext.indexOf("cluster")===0){if(!Ql(s,["zoom","feature-state"]))return[new Te(o.key,o.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(o.expressionContext==="cluster-initial"&&!Yl(s))return[new Te(o.key,o.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function ra(o){const r=o.key,s=o.value,l=o.valueSpec,d=[];return Array.isArray(l.values)?l.values.indexOf(Sr(s))===-1&&d.push(new Te(r,s,`expected one of [${l.values.join(", ")}], ${JSON.stringify(s)} found`)):Object.keys(l.values).indexOf(Sr(s))===-1&&d.push(new Te(r,s,`expected one of [${Object.keys(l.values).join(", ")}], ${JSON.stringify(s)} found`)),d}function na(o){return ih(ms(o.value))?gs(et({},o,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Ap(o)}function Ap(o){const r=o.value,s=o.key;if(Ot(r)!=="array")return[new Te(s,r,`array expected, ${Ot(r)} found`)];const l=o.styleSpec;let d,_=[];if(r.length<1)return[new Te(s,r,"filter array must have at least 1 element")];switch(_=_.concat(ra({key:`${s}[0]`,value:r[0],valueSpec:l.filter_operator,style:o.style,styleSpec:o.styleSpec})),Sr(r[0])){case"<":case"<=":case">":case">=":r.length>=2&&Sr(r[1])==="$type"&&_.push(new Te(s,r,`"$type" cannot be use with operator "${r[0]}"`));case"==":case"!=":r.length!==3&&_.push(new Te(s,r,`filter array for operator "${r[0]}" must have 3 elements`));case"in":case"!in":r.length>=2&&(d=Ot(r[1]),d!=="string"&&_.push(new Te(`${s}[1]`,r[1],`string expected, ${d} found`)));for(let y=2;y<r.length;y++)d=Ot(r[y]),Sr(r[1])==="$type"?_=_.concat(ra({key:`${s}[${y}]`,value:r[y],valueSpec:l.geometry_type,style:o.style,styleSpec:o.styleSpec})):d!=="string"&&d!=="number"&&d!=="boolean"&&_.push(new Te(`${s}[${y}]`,r[y],`string, number, or boolean expected, ${d} found`));break;case"any":case"all":case"none":for(let y=1;y<r.length;y++)_=_.concat(Ap({key:`${s}[${y}]`,value:r[y],style:o.style,styleSpec:o.styleSpec}));break;case"has":case"!has":d=Ot(r[1]),r.length!==2?_.push(new Te(s,r,`filter array for "${r[0]}" operator must have 2 elements`)):d!=="string"&&_.push(new Te(`${s}[1]`,r[1],`string expected, ${d} found`))}return _}function uh(o,r){const s=o.key,l=o.validateSpec,d=o.style,_=o.styleSpec,y=o.value,w=o.objectKey,T=_[`${r}_${o.layerType}`];if(!T)return[];const C=w.match(/^(.*)-transition$/);if(r==="paint"&&C&&T[C[1]]&&T[C[1]].transition)return l({key:s,value:y,valueSpec:_.transition,style:d,styleSpec:_});const M=o.valueSpec||T[w];if(!M)return[new Te(s,y,`unknown property "${w}"`)];let I;if(Ot(y)==="string"&&ea(M)&&!M.tokens&&(I=/^{([^}]+)}$/.exec(y)))return[new Te(s,y,`"${w}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(I[1])} }\`.`)];const D=[];return o.layerType==="symbol"&&(w==="text-field"&&d&&!d.glyphs&&D.push(new Te(s,y,'use of "text-field" requires a style "glyphs" property')),w==="text-font"&&Jl(ms(y))&&Sr(y.type)==="identity"&&D.push(new Te(s,y,'"text-font" does not support identity functions'))),D.concat(l({key:o.key,value:y,valueSpec:M,style:d,styleSpec:_,expressionContext:"property",propertyType:r,propertyKey:w}))}function hh(o){return uh(o,"paint")}function zp(o){return uh(o,"layout")}function dh(o){let r=[];const s=o.value,l=o.key,d=o.style,_=o.styleSpec;s.type||s.ref||r.push(new Te(l,s,'either "type" or "ref" is required'));let y=Sr(s.type);const w=Sr(s.ref);if(s.id){const T=Sr(s.id);for(let C=0;C<o.arrayIndex;C++){const M=d.layers[C];Sr(M.id)===T&&r.push(new Te(l,s.id,`duplicate layer id "${s.id}", previously used at line ${M.id.__line__}`))}}if("ref"in s){let T;["type","source","source-layer","filter","layout"].forEach(C=>{C in s&&r.push(new Te(l,s[C],`"${C}" is prohibited for ref layers`))}),d.layers.forEach(C=>{Sr(C.id)===w&&(T=C)}),T?T.ref?r.push(new Te(l,s.ref,"ref cannot reference another ref layer")):y=Sr(T.type):r.push(new Te(l,s.ref,`ref layer "${w}" not found`))}else if(y!=="background")if(s.source){const T=d.sources&&d.sources[s.source],C=T&&Sr(T.type);T?C==="vector"&&y==="raster"?r.push(new Te(l,s.source,`layer "${s.id}" requires a raster source`)):C!=="raster-dem"&&y==="hillshade"?r.push(new Te(l,s.source,`layer "${s.id}" requires a raster-dem source`)):C==="raster"&&y!=="raster"?r.push(new Te(l,s.source,`layer "${s.id}" requires a vector source`)):C!=="vector"||s["source-layer"]?C==="raster-dem"&&y!=="hillshade"?r.push(new Te(l,s.source,"raster-dem source can only be used with layer type 'hillshade'.")):y!=="line"||!s.paint||!s.paint["line-gradient"]||C==="geojson"&&T.lineMetrics||r.push(new Te(l,s,`layer "${s.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):r.push(new Te(l,s,`layer "${s.id}" must specify a "source-layer"`)):r.push(new Te(l,s.source,`source "${s.source}" not found`))}else r.push(new Te(l,s,'missing required property "source"'));return r=r.concat(ui({key:l,value:s,valueSpec:_.layer,style:o.style,styleSpec:o.styleSpec,validateSpec:o.validateSpec,objectElementValidators:{"*":()=>[],type:()=>o.validateSpec({key:`${l}.type`,value:s.type,valueSpec:_.layer.type,style:o.style,styleSpec:o.styleSpec,validateSpec:o.validateSpec,object:s,objectKey:"type"}),filter:na,layout:T=>ui({layer:s,key:T.key,value:T.value,style:T.style,styleSpec:T.styleSpec,validateSpec:T.validateSpec,objectElementValidators:{"*":C=>zp(et({layerType:y},C))}}),paint:T=>ui({layer:s,key:T.key,value:T.value,style:T.style,styleSpec:T.styleSpec,validateSpec:T.validateSpec,objectElementValidators:{"*":C=>hh(et({layerType:y},C))}})}})),r}function Lo(o){const r=o.value,s=o.key,l=Ot(r);return l!=="string"?[new Te(s,r,`string expected, ${l} found`)]:[]}const ia={promoteId:function({key:o,value:r}){if(Ot(r)==="string")return Lo({key:o,value:r});{const s=[];for(const l in r)s.push(...Lo({key:`${o}.${l}`,value:r[l]}));return s}}};function Rp(o){const r=o.value,s=o.key,l=o.styleSpec,d=o.style,_=o.validateSpec;if(!r.type)return[new Te(s,r,'"type" is required')];const y=Sr(r.type);let w;switch(y){case"vector":case"raster":return w=ui({key:s,value:r,valueSpec:l[`source_${y.replace("-","_")}`],style:o.style,styleSpec:l,objectElementValidators:ia,validateSpec:_}),w;case"raster-dem":return w=function(T){var C;const M=(C=T.sourceName)!==null&&C!==void 0?C:"",I=T.value,D=T.styleSpec,B=D.source_raster_dem,O=T.style;let $=[];const q=Ot(I);if(I===void 0)return $;if(q!=="object")return $.push(new Te("source_raster_dem",I,`object expected, ${q} found`)),$;const ne=Sr(I.encoding)==="custom",me=["redFactor","greenFactor","blueFactor","baseShift"],ae=T.value.encoding?`"${T.value.encoding}"`:"Default";for(const F in I)!ne&&me.includes(F)?$.push(new Te(F,I[F],`In "${M}": "${F}" is only valid when "encoding" is set to "custom". ${ae} encoding found`)):B[F]?$=$.concat(T.validateSpec({key:F,value:I[F],valueSpec:B[F],validateSpec:T.validateSpec,style:O,styleSpec:D})):$.push(new Te(F,I[F],`unknown property "${F}"`));return $}({sourceName:s,value:r,style:o.style,styleSpec:l,validateSpec:_}),w;case"geojson":if(w=ui({key:s,value:r,valueSpec:l.source_geojson,style:d,styleSpec:l,validateSpec:_,objectElementValidators:ia}),r.cluster)for(const T in r.clusterProperties){const[C,M]=r.clusterProperties[T],I=typeof C=="string"?[C,["accumulated"],["get",T]]:C;w.push(...gs({key:`${s}.${T}.map`,value:M,expressionContext:"cluster-map"})),w.push(...gs({key:`${s}.${T}.reduce`,value:I,expressionContext:"cluster-reduce"}))}return w;case"video":return ui({key:s,value:r,valueSpec:l.source_video,style:d,validateSpec:_,styleSpec:l});case"image":return ui({key:s,value:r,valueSpec:l.source_image,style:d,validateSpec:_,styleSpec:l});case"canvas":return[new Te(s,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return ra({key:`${s}.type`,value:r.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function Lp(o){const r=o.value,s=o.styleSpec,l=s.light,d=o.style;let _=[];const y=Ot(r);if(r===void 0)return _;if(y!=="object")return _=_.concat([new Te("light",r,`object expected, ${y} found`)]),_;for(const w in r){const T=w.match(/^(.*)-transition$/);_=_.concat(T&&l[T[1]]&&l[T[1]].transition?o.validateSpec({key:w,value:r[w],valueSpec:s.transition,validateSpec:o.validateSpec,style:d,styleSpec:s}):l[w]?o.validateSpec({key:w,value:r[w],valueSpec:l[w],validateSpec:o.validateSpec,style:d,styleSpec:s}):[new Te(w,r[w],`unknown property "${w}"`)])}return _}function Dp(o){const r=o.value,s=o.styleSpec,l=s.sky,d=o.style,_=Ot(r);if(r===void 0)return[];if(_!=="object")return[new Te("sky",r,`object expected, ${_} found`)];let y=[];for(const w in r)y=y.concat(l[w]?o.validateSpec({key:w,value:r[w],valueSpec:l[w],style:d,styleSpec:s}):[new Te(w,r[w],`unknown property "${w}"`)]);return y}function Fp(o){const r=o.value,s=o.styleSpec,l=s.terrain,d=o.style;let _=[];const y=Ot(r);if(r===void 0)return _;if(y!=="object")return _=_.concat([new Te("terrain",r,`object expected, ${y} found`)]),_;for(const w in r)_=_.concat(l[w]?o.validateSpec({key:w,value:r[w],valueSpec:l[w],validateSpec:o.validateSpec,style:d,styleSpec:s}):[new Te(w,r[w],`unknown property "${w}"`)]);return _}function Bp(o){let r=[];const s=o.value,l=o.key;if(Array.isArray(s)){const d=[],_=[];for(const y in s)s[y].id&&d.includes(s[y].id)&&r.push(new Te(l,s,`all the sprites' ids must be unique, but ${s[y].id} is duplicated`)),d.push(s[y].id),s[y].url&&_.includes(s[y].url)&&r.push(new Te(l,s,`all the sprites' URLs must be unique, but ${s[y].url} is duplicated`)),_.push(s[y].url),r=r.concat(ui({key:`${l}[${y}]`,value:s[y],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:o.validateSpec}));return r}return Lo({key:l,value:s})}const Op={"*":()=>[],array:lh,boolean:function(o){const r=o.value,s=o.key,l=Ot(r);return l!=="boolean"?[new Te(s,r,`boolean expected, ${l} found`)]:[]},number:ch,color:function(o){const r=o.key,s=o.value,l=Ot(s);return l!=="string"?[new Te(r,s,`color expected, ${l} found`)]:Bt.parse(String(s))?[]:[new Te(r,s,`color expected, "${s}" found`)]},constants:Qa,enum:ra,filter:na,function:kp,layer:dh,object:ui,source:Rp,light:Lp,sky:Dp,terrain:Fp,projection:function(o){const r=o.value,s=o.styleSpec,l=s.projection,d=o.style,_=Ot(r);if(r===void 0)return[];if(_!=="object")return[new Te("projection",r,`object expected, ${_} found`)];let y=[];for(const w in r)y=y.concat(l[w]?o.validateSpec({key:w,value:r[w],valueSpec:l[w],style:d,styleSpec:s}):[new Te(w,r[w],`unknown property "${w}"`)]);return y},projectionDefinition:function(o){const r=o.key;let s=o.value;s=s instanceof String?s.valueOf():s;const l=Ot(s);return l!=="array"||function(d){return Array.isArray(d)&&d.length===3&&typeof d[0]=="string"&&typeof d[1]=="string"&&typeof d[2]=="number"}(s)||function(d){return!!["interpolate","step","literal"].includes(d[0])}(s)?["array","string"].includes(l)?[]:[new Te(r,s,`projection expected, invalid type "${l}" found`)]:[new Te(r,s,`projection expected, invalid array ${JSON.stringify(s)} found`)]},string:Lo,formatted:function(o){return Lo(o).length===0?[]:gs(o)},resolvedImage:function(o){return Lo(o).length===0?[]:gs(o)},padding:function(o){const r=o.key,s=o.value;if(Ot(s)==="array"){if(s.length<1||s.length>4)return[new Te(r,s,`padding requires 1 to 4 values; ${s.length} values found`)];const l={type:"number"};let d=[];for(let _=0;_<s.length;_++)d=d.concat(o.validateSpec({key:`${r}[${_}]`,value:s[_],validateSpec:o.validateSpec,valueSpec:l}));return d}return ch({key:r,value:s,valueSpec:{}})},variableAnchorOffsetCollection:function(o){const r=o.key,s=o.value,l=Ot(s),d=o.styleSpec;if(l!=="array"||s.length<1||s.length%2!=0)return[new Te(r,s,"variableAnchorOffsetCollection requires a non-empty array of even length")];let _=[];for(let y=0;y<s.length;y+=2)_=_.concat(ra({key:`${r}[${y}]`,value:s[y],valueSpec:d.layout_symbol["text-anchor"]})),_=_.concat(lh({key:`${r}[${y+1}]`,value:s[y+1],valueSpec:{length:2,value:"number"},validateSpec:o.validateSpec,style:o.style,styleSpec:d}));return _},sprite:Bp};function Do(o){const r=o.value,s=o.valueSpec,l=o.styleSpec;return o.validateSpec=Do,s.expression&&Jl(Sr(r))?kp(o):s.expression&&ec(ms(r))?gs(o):s.type&&Op[s.type]?Op[s.type](o):ui(et({},o,{valueSpec:s.type?l[s.type]:s}))}function oa(o){const r=o.value,s=o.key,l=Lo(o);return l.length||(r.indexOf("{fontstack}")===-1&&l.push(new Te(s,r,'"glyphs" url must include a "{fontstack}" token')),r.indexOf("{range}")===-1&&l.push(new Te(s,r,'"glyphs" url must include a "{range}" token'))),l}function gr(o,r=z){let s=[];return s=s.concat(Do({key:"",value:o,valueSpec:r.$root,styleSpec:r,style:o,validateSpec:Do,objectElementValidators:{glyphs:oa,"*":()=>[]}})),o.constants&&(s=s.concat(Qa({key:"constants",value:o.constants}))),ph(s)}function Bn(o){return function(r){return o({...r,validateSpec:Do})}}function ph(o){return[].concat(o).sort((r,s)=>r.line-s.line)}function Zi(o){return function(...r){return ph(o.apply(this,r))}}gr.source=Zi(Bn(Rp)),gr.sprite=Zi(Bn(Bp)),gr.glyphs=Zi(Bn(oa)),gr.light=Zi(Bn(Lp)),gr.sky=Zi(Bn(Dp)),gr.terrain=Zi(Bn(Fp)),gr.layer=Zi(Bn(dh)),gr.filter=Zi(Bn(na)),gr.paintProperty=Zi(Bn(hh)),gr.layoutProperty=Zi(Bn(zp));const sa=gr,Ja=sa.light,jp=sa.sky,fh=sa.paintProperty,r_=sa.layoutProperty;function sc(o,r){let s=!1;if(r&&r.length)for(const l of r)o.fire(new ho(new Error(l.message))),s=!0;return s}class el{constructor(r,s,l){const d=this.cells=[];if(r instanceof ArrayBuffer){this.arrayBuffer=r;const y=new Int32Array(this.arrayBuffer);r=y[0],this.d=(s=y[1])+2*(l=y[2]);for(let T=0;T<this.d*this.d;T++){const C=y[3+T],M=y[3+T+1];d.push(C===M?null:y.subarray(C,M))}const w=y[3+d.length+1];this.keys=y.subarray(y[3+d.length],w),this.bboxes=y.subarray(w),this.insert=this._insertReadonly}else{this.d=s+2*l;for(let y=0;y<this.d*this.d;y++)d.push([]);this.keys=[],this.bboxes=[]}this.n=s,this.extent=r,this.padding=l,this.scale=s/r,this.uid=0;const _=l/s*r;this.min=-_,this.max=r+_}insert(r,s,l,d,_){this._forEachCell(s,l,d,_,this._insertCell,this.uid++,void 0,void 0),this.keys.push(r),this.bboxes.push(s),this.bboxes.push(l),this.bboxes.push(d),this.bboxes.push(_)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(r,s,l,d,_,y){this.cells[_].push(y)}query(r,s,l,d,_){const y=this.min,w=this.max;if(r<=y&&s<=y&&w<=l&&w<=d&&!_)return Array.prototype.slice.call(this.keys);{const T=[];return this._forEachCell(r,s,l,d,this._queryCell,T,{},_),T}}_queryCell(r,s,l,d,_,y,w,T){const C=this.cells[_];if(C!==null){const M=this.keys,I=this.bboxes;for(let D=0;D<C.length;D++){const B=C[D];if(w[B]===void 0){const O=4*B;(T?T(I[O+0],I[O+1],I[O+2],I[O+3]):r<=I[O+2]&&s<=I[O+3]&&l>=I[O+0]&&d>=I[O+1])?(w[B]=!0,y.push(M[B])):w[B]=!1}}}}_forEachCell(r,s,l,d,_,y,w,T){const C=this._convertToCellCoord(r),M=this._convertToCellCoord(s),I=this._convertToCellCoord(l),D=this._convertToCellCoord(d);for(let B=C;B<=I;B++)for(let O=M;O<=D;O++){const $=this.d*O+B;if((!T||T(this._convertFromCellCoord(B),this._convertFromCellCoord(O),this._convertFromCellCoord(B+1),this._convertFromCellCoord(O+1)))&&_.call(this,r,s,l,d,$,y,w,T))return}}_convertFromCellCoord(r){return(r-this.padding)/this.scale}_convertToCellCoord(r){return Math.max(0,Math.min(this.d-1,Math.floor(r*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const r=this.cells,s=3+this.cells.length+1+1;let l=0;for(let y=0;y<this.cells.length;y++)l+=this.cells[y].length;const d=new Int32Array(s+l+this.keys.length+this.bboxes.length);d[0]=this.extent,d[1]=this.n,d[2]=this.padding;let _=s;for(let y=0;y<r.length;y++){const w=r[y];d[3+y]=_,d.set(w,_),_+=w.length}return d[3+r.length]=_,d.set(this.keys,_),_+=this.keys.length,d[3+r.length+1]=_,d.set(this.bboxes,_),_+=this.bboxes.length,d.buffer}static serialize(r,s){const l=r.toArrayBuffer();return s&&s.push(l),{buffer:l}}static deserialize(r){return new el(r.buffer)}}const Xn={};function nt(o,r,s={}){if(Xn[o])throw new Error(`${o} is already registered.`);Object.defineProperty(r,"_classRegistryKey",{value:o,writeable:!1}),Xn[o]={klass:r,omit:s.omit||[],shallow:s.shallow||[]}}nt("Object",Object),nt("TransferableGridIndex",el),nt("Color",Bt),nt("Error",Error),nt("AJAXError",co),nt("ResolvedImage",Cn),nt("StylePropertyFunction",rc),nt("StyleExpression",rh,{omit:["_evaluator"]}),nt("ZoomDependentExpression",nh),nt("ZoomConstantExpression",tc),nt("CompoundExpression",ci,{omit:["_evaluate"]});for(const o in Qs)Qs[o]._classRegistryKey||nt(`Expression_${o}`,Qs[o]);function aa(o){return o&&typeof ArrayBuffer<"u"&&(o instanceof ArrayBuffer||o.constructor&&o.constructor.name==="ArrayBuffer")}function mh(o){return o.$name||o.constructor._classRegistryKey}function Np(o){return!function(r){if(r===null||typeof r!="object")return!1;const s=mh(r);return!(!s||s==="Object")}(o)&&(o==null||typeof o=="boolean"||typeof o=="number"||typeof o=="string"||o instanceof Boolean||o instanceof Number||o instanceof String||o instanceof Date||o instanceof RegExp||o instanceof Blob||o instanceof Error||aa(o)||ao(o)||ArrayBuffer.isView(o)||o instanceof ImageData)}function Fo(o,r){if(Np(o))return(aa(o)||ao(o))&&r&&r.push(o),ArrayBuffer.isView(o)&&r&&r.push(o.buffer),o instanceof ImageData&&r&&r.push(o.data.buffer),o;if(Array.isArray(o)){const _=[];for(const y of o)_.push(Fo(y,r));return _}if(typeof o!="object")throw new Error("can't serialize object of type "+typeof o);const s=mh(o);if(!s)throw new Error(`can't serialize object of unregistered class ${o.constructor.name}`);if(!Xn[s])throw new Error(`${s} is not registered.`);const{klass:l}=Xn[s],d=l.serialize?l.serialize(o,r):{};if(l.serialize){if(r&&d===r[r.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const _ in o){if(!o.hasOwnProperty(_)||Xn[s].omit.indexOf(_)>=0)continue;const y=o[_];d[_]=Xn[s].shallow.indexOf(_)>=0?y:Fo(y,r)}o instanceof Error&&(d.message=o.message)}if(d.$name)throw new Error("$name property is reserved for worker serialization logic.");return s!=="Object"&&(d.$name=s),d}function tl(o){if(Np(o))return o;if(Array.isArray(o))return o.map(tl);if(typeof o!="object")throw new Error("can't deserialize object of type "+typeof o);const r=mh(o)||"Object";if(!Xn[r])throw new Error(`can't deserialize unregistered class ${r}`);const{klass:s}=Xn[r];if(!s)throw new Error(`can't deserialize unregistered class ${r}`);if(s.deserialize)return s.deserialize(o);const l=Object.create(s.prototype);for(const d of Object.keys(o)){if(d==="$name")continue;const _=o[d];l[d]=Xn[r].shallow.indexOf(d)>=0?_:tl(_)}return l}class ac{constructor(){this.first=!0}update(r,s){const l=Math.floor(r);return this.first?(this.first=!1,this.lastIntegerZoom=l,this.lastIntegerZoomTime=0,this.lastZoom=r,this.lastFloorZoom=l,!0):(this.lastFloorZoom>l?(this.lastIntegerZoom=l+1,this.lastIntegerZoomTime=s):this.lastFloorZoom<l&&(this.lastIntegerZoom=l,this.lastIntegerZoomTime=s),r!==this.lastZoom&&(this.lastZoom=r,this.lastFloorZoom=l,!0))}}const At={"Latin-1 Supplement":o=>o>=128&&o<=255,"Hangul Jamo":o=>o>=4352&&o<=4607,Khmer:o=>o>=6016&&o<=6143,"General Punctuation":o=>o>=8192&&o<=8303,"Letterlike Symbols":o=>o>=8448&&o<=8527,"Number Forms":o=>o>=8528&&o<=8591,"Miscellaneous Technical":o=>o>=8960&&o<=9215,"Control Pictures":o=>o>=9216&&o<=9279,"Optical Character Recognition":o=>o>=9280&&o<=9311,"Enclosed Alphanumerics":o=>o>=9312&&o<=9471,"Geometric Shapes":o=>o>=9632&&o<=9727,"Miscellaneous Symbols":o=>o>=9728&&o<=9983,"Miscellaneous Symbols and Arrows":o=>o>=11008&&o<=11263,"Ideographic Description Characters":o=>o>=12272&&o<=12287,"CJK Symbols and Punctuation":o=>o>=12288&&o<=12351,Hiragana:o=>o>=12352&&o<=12447,Katakana:o=>o>=12448&&o<=12543,Kanbun:o=>o>=12688&&o<=12703,"CJK Strokes":o=>o>=12736&&o<=12783,"Enclosed CJK Letters and Months":o=>o>=12800&&o<=13055,"CJK Compatibility":o=>o>=13056&&o<=13311,"Yijing Hexagram Symbols":o=>o>=19904&&o<=19967,"CJK Unified Ideographs":o=>o>=19968&&o<=40959,"Hangul Syllables":o=>o>=44032&&o<=55215,"Private Use Area":o=>o>=57344&&o<=63743,"Vertical Forms":o=>o>=65040&&o<=65055,"CJK Compatibility Forms":o=>o>=65072&&o<=65103,"Small Form Variants":o=>o>=65104&&o<=65135,"Halfwidth and Fullwidth Forms":o=>o>=65280&&o<=65519};function lc(o){for(const r of o)if(yh(r.charCodeAt(0)))return!0;return!1}function $p(o){for(const r of o)if(!gh(r.charCodeAt(0)))return!1;return!0}function cc(o){const r=o.map(s=>{try{return new RegExp(`\\p{sc=${s}}`,"u").source}catch{return null}}).filter(s=>s);return new RegExp(r.join("|"),"u")}const Vp=cc(["Arab","Dupl","Mong","Ougr","Syrc"]);function gh(o){return!Vp.test(String.fromCodePoint(o))}const _h=cc(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function yh(o){return!(o!==746&&o!==747&&(o<4352||!(At["CJK Compatibility Forms"](o)&&!(o>=65097&&o<=65103)||At["CJK Compatibility"](o)||At["CJK Strokes"](o)||!(!At["CJK Symbols and Punctuation"](o)||o>=12296&&o<=12305||o>=12308&&o<=12319||o===12336)||At["Enclosed CJK Letters and Months"](o)||At["Ideographic Description Characters"](o)||At.Kanbun(o)||At.Katakana(o)&&o!==12540||!(!At["Halfwidth and Fullwidth Forms"](o)||o===65288||o===65289||o===65293||o>=65306&&o<=65310||o===65339||o===65341||o===65343||o>=65371&&o<=65503||o===65507||o>=65512&&o<=65519)||!(!At["Small Form Variants"](o)||o>=65112&&o<=65118||o>=65123&&o<=65126)||At["Vertical Forms"](o)||At["Yijing Hexagram Symbols"](o)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(o))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(o))||_h.test(String.fromCodePoint(o)))))}function vh(o){return!(yh(o)||function(r){return!!(At["Latin-1 Supplement"](r)&&(r===167||r===169||r===174||r===177||r===188||r===189||r===190||r===215||r===247)||At["General Punctuation"](r)&&(r===8214||r===8224||r===8225||r===8240||r===8241||r===8251||r===8252||r===8258||r===8263||r===8264||r===8265||r===8273)||At["Letterlike Symbols"](r)||At["Number Forms"](r)||At["Miscellaneous Technical"](r)&&(r>=8960&&r<=8967||r>=8972&&r<=8991||r>=8996&&r<=9e3||r===9003||r>=9085&&r<=9114||r>=9150&&r<=9165||r===9167||r>=9169&&r<=9179||r>=9186&&r<=9215)||At["Control Pictures"](r)&&r!==9251||At["Optical Character Recognition"](r)||At["Enclosed Alphanumerics"](r)||At["Geometric Shapes"](r)||At["Miscellaneous Symbols"](r)&&!(r>=9754&&r<=9759)||At["Miscellaneous Symbols and Arrows"](r)&&(r>=11026&&r<=11055||r>=11088&&r<=11097||r>=11192&&r<=11243)||At["CJK Symbols and Punctuation"](r)||At.Katakana(r)||At["Private Use Area"](r)||At["CJK Compatibility Forms"](r)||At["Small Form Variants"](r)||At["Halfwidth and Fullwidth Forms"](r)||r===8734||r===8756||r===8757||r>=9984&&r<=10087||r>=10102&&r<=10131||r===65532||r===65533)}(o))}const n_=cc(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function xh(o){return n_.test(String.fromCodePoint(o))}function Up(o,r){return!(!r&&xh(o)||o>=2304&&o<=3583||o>=3840&&o<=4255||At.Khmer(o))}function Zp(o){for(const r of o)if(xh(r.charCodeAt(0)))return!0;return!1}const Bo=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(o){this.pluginStatus=o.pluginStatus,this.pluginURL=o.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(o){if(Bo.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=o.applyArabicShaping,this.processBidirectionalText=o.processBidirectionalText,this.processStyledBidirectionalText=o.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(o,r){return c(this,void 0,void 0,function*(){if(this.isParsed())return this.getState();if(o.pluginStatus!=="loading")return this.setState(o),o;const s=o.pluginURL,l=new Promise(_=>{this.loadScriptResolve=_});r(s);const d=new Promise(_=>setTimeout(()=>_(),this.TIMEOUT));if(yield Promise.race([l,d]),this.isParsed()){const _={pluginStatus:"loaded",pluginURL:s};return this.setState(_),_}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${s}`)})}};class ar{constructor(r,s){this.zoom=r,s?(this.now=s.now,this.fadeDuration=s.fadeDuration,this.zoomHistory=s.zoomHistory,this.transition=s.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new ac,this.transition={})}isSupportedScript(r){return function(s,l){for(const d of s)if(!Up(d.charCodeAt(0),l))return!1;return!0}(r,Bo.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const r=this.zoom,s=r-Math.floor(r),l=this.crossFadingFactor();return r>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:s+(1-s)*l}:{fromScale:.5,toScale:1,t:1-(1-l)*s}}}class rl{constructor(r,s){this.property=r,this.value=s,this.expression=function(l,d){if(Jl(l))return new rc(l,d);if(ec(l)){const _=Ep(l,d);if(_.result==="error")throw new Error(_.value.map(y=>`${y.key}: ${y.message}`).join(", "));return _.value}{let _=l;return d.type==="color"&&typeof l=="string"?_=Bt.parse(l):d.type!=="padding"||typeof l!="number"&&!Array.isArray(l)?d.type==="variableAnchorOffsetCollection"&&Array.isArray(l)?_=Qr.parse(l):d.type==="projectionDefinition"&&typeof l=="string"&&(_=Dn.parse(l)):_=Yr.parse(l),{kind:"constant",evaluate:()=>_}}}(s===void 0?r.specification.default:s,r.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(r,s,l){return this.property.possiblyEvaluate(this,r,s,l)}}class uc{constructor(r){this.property=r,this.value=new rl(r,void 0)}transitioned(r,s){return new wh(this.property,this.value,s,fr({},r.transition,this.transition),r.now)}untransitioned(){return new wh(this.property,this.value,null,{},0)}}class bh{constructor(r){this._properties=r,this._values=Object.create(r.defaultTransitionablePropertyValues)}getValue(r){return Pn(this._values[r].value.value)}setValue(r,s){Object.prototype.hasOwnProperty.call(this._values,r)||(this._values[r]=new uc(this._values[r].property)),this._values[r].value=new rl(this._values[r].property,s===null?void 0:Pn(s))}getTransition(r){return Pn(this._values[r].transition)}setTransition(r,s){Object.prototype.hasOwnProperty.call(this._values,r)||(this._values[r]=new uc(this._values[r].property)),this._values[r].transition=Pn(s)||void 0}serialize(){const r={};for(const s of Object.keys(this._values)){const l=this.getValue(s);l!==void 0&&(r[s]=l);const d=this.getTransition(s);d!==void 0&&(r[`${s}-transition`]=d)}return r}transitioned(r,s){const l=new nl(this._properties);for(const d of Object.keys(this._values))l._values[d]=this._values[d].transitioned(r,s._values[d]);return l}untransitioned(){const r=new nl(this._properties);for(const s of Object.keys(this._values))r._values[s]=this._values[s].untransitioned();return r}}class wh{constructor(r,s,l,d,_){this.property=r,this.value=s,this.begin=_+d.delay||0,this.end=this.begin+d.duration||0,r.specification.transition&&(d.delay||d.duration)&&(this.prior=l)}possiblyEvaluate(r,s,l){const d=r.now||0,_=this.value.possiblyEvaluate(r,s,l),y=this.prior;if(y){if(d>this.end)return this.prior=null,_;if(this.value.isDataDriven())return this.prior=null,_;if(d<this.begin)return y.possiblyEvaluate(r,s,l);{const w=(d-this.begin)/(this.end-this.begin);return this.property.interpolate(y.possiblyEvaluate(r,s,l),_,Tt(w))}}return _}}class nl{constructor(r){this._properties=r,this._values=Object.create(r.defaultTransitioningPropertyValues)}possiblyEvaluate(r,s,l){const d=new hc(this._properties);for(const _ of Object.keys(this._values))d._values[_]=this._values[_].possiblyEvaluate(r,s,l);return d}hasTransition(){for(const r of Object.keys(this._values))if(this._values[r].prior)return!0;return!1}}class i_{constructor(r){this._properties=r,this._values=Object.create(r.defaultPropertyValues)}hasValue(r){return this._values[r].value!==void 0}getValue(r){return Pn(this._values[r].value)}setValue(r,s){this._values[r]=new rl(this._values[r].property,s===null?void 0:Pn(s))}serialize(){const r={};for(const s of Object.keys(this._values)){const l=this.getValue(s);l!==void 0&&(r[s]=l)}return r}possiblyEvaluate(r,s,l){const d=new hc(this._properties);for(const _ of Object.keys(this._values))d._values[_]=this._values[_].possiblyEvaluate(r,s,l);return d}}class hi{constructor(r,s,l){this.property=r,this.value=s,this.parameters=l}isConstant(){return this.value.kind==="constant"}constantOr(r){return this.value.kind==="constant"?this.value.value:r}evaluate(r,s,l,d){return this.property.evaluate(this.value,this.parameters,r,s,l,d)}}class hc{constructor(r){this._properties=r,this._values=Object.create(r.defaultPossiblyEvaluatedValues)}get(r){return this._values[r]}}class pt{constructor(r){this.specification=r}possiblyEvaluate(r,s){if(r.isDataDriven())throw new Error("Value should not be data driven");return r.expression.evaluate(s)}interpolate(r,s,l){const d=Hn[this.specification.type];return d?d(r,s,l):r}}class xt{constructor(r,s){this.specification=r,this.overrides=s}possiblyEvaluate(r,s,l,d){return new hi(this,r.expression.kind==="constant"||r.expression.kind==="camera"?{kind:"constant",value:r.expression.evaluate(s,null,{},l,d)}:r.expression,s)}interpolate(r,s,l){if(r.value.kind!=="constant"||s.value.kind!=="constant")return r;if(r.value.value===void 0||s.value.value===void 0)return new hi(this,{kind:"constant",value:void 0},r.parameters);const d=Hn[this.specification.type];if(d){const _=d(r.value.value,s.value.value,l);return new hi(this,{kind:"constant",value:_},r.parameters)}return r}evaluate(r,s,l,d,_,y){return r.kind==="constant"?r.value:r.evaluate(s,l,d,_,y)}}class il extends xt{possiblyEvaluate(r,s,l,d){if(r.value===void 0)return new hi(this,{kind:"constant",value:void 0},s);if(r.expression.kind==="constant"){const _=r.expression.evaluate(s,null,{},l,d),y=r.property.specification.type==="resolvedImage"&&typeof _!="string"?_.name:_,w=this._calculate(y,y,y,s);return new hi(this,{kind:"constant",value:w},s)}if(r.expression.kind==="camera"){const _=this._calculate(r.expression.evaluate({zoom:s.zoom-1}),r.expression.evaluate({zoom:s.zoom}),r.expression.evaluate({zoom:s.zoom+1}),s);return new hi(this,{kind:"constant",value:_},s)}return new hi(this,r.expression,s)}evaluate(r,s,l,d,_,y){if(r.kind==="source"){const w=r.evaluate(s,l,d,_,y);return this._calculate(w,w,w,s)}return r.kind==="composite"?this._calculate(r.evaluate({zoom:Math.floor(s.zoom)-1},l,d),r.evaluate({zoom:Math.floor(s.zoom)},l,d),r.evaluate({zoom:Math.floor(s.zoom)+1},l,d),s):r.value}_calculate(r,s,l,d){return d.zoom>d.zoomHistory.lastIntegerZoom?{from:r,to:s}:{from:l,to:s}}interpolate(r){return r}}class dc{constructor(r){this.specification=r}possiblyEvaluate(r,s,l,d){if(r.value!==void 0){if(r.expression.kind==="constant"){const _=r.expression.evaluate(s,null,{},l,d);return this._calculate(_,_,_,s)}return this._calculate(r.expression.evaluate(new ar(Math.floor(s.zoom-1),s)),r.expression.evaluate(new ar(Math.floor(s.zoom),s)),r.expression.evaluate(new ar(Math.floor(s.zoom+1),s)),s)}}_calculate(r,s,l,d){return d.zoom>d.zoomHistory.lastIntegerZoom?{from:r,to:s}:{from:l,to:s}}interpolate(r){return r}}class Sh{constructor(r){this.specification=r}possiblyEvaluate(r,s,l,d){return!!r.expression.evaluate(s,null,{},l,d)}interpolate(){return!1}}class On{constructor(r){this.properties=r,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const s in r){const l=r[s];l.specification.overridable&&this.overridableProperties.push(s);const d=this.defaultPropertyValues[s]=new rl(l,void 0),_=this.defaultTransitionablePropertyValues[s]=new uc(l);this.defaultTransitioningPropertyValues[s]=_.untransitioned(),this.defaultPossiblyEvaluatedValues[s]=d.possiblyEvaluate({})}}}nt("DataDrivenProperty",xt),nt("DataConstantProperty",pt),nt("CrossFadedDataDrivenProperty",il),nt("CrossFadedProperty",dc),nt("ColorRampProperty",Sh);const Gp="-transition";class Gi extends be{constructor(r,s){if(super(),this.id=r.id,this.type=r.type,this._featureFilter={filter:()=>!0,needGeometry:!1},r.type!=="custom"&&(this.metadata=r.metadata,this.minzoom=r.minzoom,this.maxzoom=r.maxzoom,r.type!=="background"&&(this.source=r.source,this.sourceLayer=r["source-layer"],this.filter=r.filter),s.layout&&(this._unevaluatedLayout=new i_(s.layout)),s.paint)){this._transitionablePaint=new bh(s.paint);for(const l in r.paint)this.setPaintProperty(l,r.paint[l],{validate:!1});for(const l in r.layout)this.setLayoutProperty(l,r.layout[l],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new hc(s.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(r){return r==="visibility"?this.visibility:this._unevaluatedLayout.getValue(r)}setLayoutProperty(r,s,l={}){s!=null&&this._validate(r_,`layers.${this.id}.layout.${r}`,r,s,l)||(r!=="visibility"?this._unevaluatedLayout.setValue(r,s):this.visibility=s)}getPaintProperty(r){return r.endsWith(Gp)?this._transitionablePaint.getTransition(r.slice(0,-11)):this._transitionablePaint.getValue(r)}setPaintProperty(r,s,l={}){if(s!=null&&this._validate(fh,`layers.${this.id}.paint.${r}`,r,s,l))return!1;if(r.endsWith(Gp))return this._transitionablePaint.setTransition(r.slice(0,-11),s||void 0),!1;{const d=this._transitionablePaint._values[r],_=d.property.specification["property-type"]==="cross-faded-data-driven",y=d.value.isDataDriven(),w=d.value;this._transitionablePaint.setValue(r,s),this._handleSpecialPaintPropertyUpdate(r);const T=this._transitionablePaint._values[r].value;return T.isDataDriven()||y||_||this._handleOverridablePaintPropertyUpdate(r,w,T)}}_handleSpecialPaintPropertyUpdate(r){}_handleOverridablePaintPropertyUpdate(r,s,l){return!1}isHidden(r){return!!(this.minzoom&&r<this.minzoom)||!!(this.maxzoom&&r>=this.maxzoom)||this.visibility==="none"}updateTransitions(r){this._transitioningPaint=this._transitionablePaint.transitioned(r,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(r,s){r.getCrossfadeParameters&&(this._crossfadeParameters=r.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(r,void 0,s)),this.paint=this._transitioningPaint.possiblyEvaluate(r,void 0,s)}serialize(){const r={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(r.layout=r.layout||{},r.layout.visibility=this.visibility),so(r,(s,l)=>!(s===void 0||l==="layout"&&!Object.keys(s).length||l==="paint"&&!Object.keys(s).length))}_validate(r,s,l,d,_={}){return(!_||_.validate!==!1)&&sc(this,r.call(sa,{key:s,layerType:this.type,objectKey:l,value:d,styleSpec:z,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const r in this.paint._values){const s=this.paint.get(r);if(s instanceof hi&&ea(s.property.specification)&&(s.value.kind==="source"||s.value.kind==="composite")&&s.value.isStateDependent)return!0}return!1}}const o_={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class qi{constructor(r,s){this._structArray=r,this._pos1=s*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class _r{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(r,s){return r._trim(),s&&(r.isTransferred=!0,s.push(r.arrayBuffer)),{length:r.length,arrayBuffer:r.arrayBuffer}}static deserialize(r){const s=Object.create(this.prototype);return s.arrayBuffer=r.arrayBuffer,s.length=r.length,s.capacity=r.arrayBuffer.byteLength/s.bytesPerElement,s._refreshViews(),s}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(r){this.reserve(r),this.length=r}reserve(r){if(r>this.capacity){this.capacity=Math.max(r,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const s=this.uint8;this._refreshViews(),s&&this.uint8.set(s)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Mr(o,r=1){let s=0,l=0;return{members:o.map(d=>{const _=o_[d.type].BYTES_PER_ELEMENT,y=s=qp(s,Math.max(r,_)),w=d.components||1;return l=Math.max(l,_),s+=_*w,{name:d.name,type:d.type,components:w,offset:y}}),size:qp(s,Math.max(l,r)),alignment:r}}function qp(o,r){return Math.ceil(o/r)*r}class la extends _r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s){const l=this.length;return this.resize(l+1),this.emplace(l,r,s)}emplace(r,s,l){const d=2*r;return this.int16[d+0]=s,this.int16[d+1]=l,r}}la.prototype.bytesPerElement=4,nt("StructArrayLayout2i4",la);class pc extends _r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s,l){const d=this.length;return this.resize(d+1),this.emplace(d,r,s,l)}emplace(r,s,l,d){const _=3*r;return this.int16[_+0]=s,this.int16[_+1]=l,this.int16[_+2]=d,r}}pc.prototype.bytesPerElement=6,nt("StructArrayLayout3i6",pc);class Th extends _r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s,l,d){const _=this.length;return this.resize(_+1),this.emplace(_,r,s,l,d)}emplace(r,s,l,d,_){const y=4*r;return this.int16[y+0]=s,this.int16[y+1]=l,this.int16[y+2]=d,this.int16[y+3]=_,r}}Th.prototype.bytesPerElement=8,nt("StructArrayLayout4i8",Th);class fo extends _r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s,l,d,_,y){const w=this.length;return this.resize(w+1),this.emplace(w,r,s,l,d,_,y)}emplace(r,s,l,d,_,y,w){const T=6*r;return this.int16[T+0]=s,this.int16[T+1]=l,this.int16[T+2]=d,this.int16[T+3]=_,this.int16[T+4]=y,this.int16[T+5]=w,r}}fo.prototype.bytesPerElement=12,nt("StructArrayLayout2i4i12",fo);class fc extends _r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s,l,d,_,y){const w=this.length;return this.resize(w+1),this.emplace(w,r,s,l,d,_,y)}emplace(r,s,l,d,_,y,w){const T=4*r,C=8*r;return this.int16[T+0]=s,this.int16[T+1]=l,this.uint8[C+4]=d,this.uint8[C+5]=_,this.uint8[C+6]=y,this.uint8[C+7]=w,r}}fc.prototype.bytesPerElement=8,nt("StructArrayLayout2i4ub8",fc);class _s extends _r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s){const l=this.length;return this.resize(l+1),this.emplace(l,r,s)}emplace(r,s,l){const d=2*r;return this.float32[d+0]=s,this.float32[d+1]=l,r}}_s.prototype.bytesPerElement=8,nt("StructArrayLayout2f8",_s);class mc extends _r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,s,l,d,_,y,w,T,C,M){const I=this.length;return this.resize(I+1),this.emplace(I,r,s,l,d,_,y,w,T,C,M)}emplace(r,s,l,d,_,y,w,T,C,M,I){const D=10*r;return this.uint16[D+0]=s,this.uint16[D+1]=l,this.uint16[D+2]=d,this.uint16[D+3]=_,this.uint16[D+4]=y,this.uint16[D+5]=w,this.uint16[D+6]=T,this.uint16[D+7]=C,this.uint16[D+8]=M,this.uint16[D+9]=I,r}}mc.prototype.bytesPerElement=20,nt("StructArrayLayout10ui20",mc);class ol extends _r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,s,l,d,_,y,w,T,C,M,I,D){const B=this.length;return this.resize(B+1),this.emplace(B,r,s,l,d,_,y,w,T,C,M,I,D)}emplace(r,s,l,d,_,y,w,T,C,M,I,D,B){const O=12*r;return this.int16[O+0]=s,this.int16[O+1]=l,this.int16[O+2]=d,this.int16[O+3]=_,this.uint16[O+4]=y,this.uint16[O+5]=w,this.uint16[O+6]=T,this.uint16[O+7]=C,this.int16[O+8]=M,this.int16[O+9]=I,this.int16[O+10]=D,this.int16[O+11]=B,r}}ol.prototype.bytesPerElement=24,nt("StructArrayLayout4i4ui4i24",ol);class Ph extends _r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s,l){const d=this.length;return this.resize(d+1),this.emplace(d,r,s,l)}emplace(r,s,l,d){const _=3*r;return this.float32[_+0]=s,this.float32[_+1]=l,this.float32[_+2]=d,r}}Ph.prototype.bytesPerElement=12,nt("StructArrayLayout3f12",Ph);class ca extends _r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(r){const s=this.length;return this.resize(s+1),this.emplace(s,r)}emplace(r,s){return this.uint32[1*r+0]=s,r}}ca.prototype.bytesPerElement=4,nt("StructArrayLayout1ul4",ca);class ys extends _r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,s,l,d,_,y,w,T,C){const M=this.length;return this.resize(M+1),this.emplace(M,r,s,l,d,_,y,w,T,C)}emplace(r,s,l,d,_,y,w,T,C,M){const I=10*r,D=5*r;return this.int16[I+0]=s,this.int16[I+1]=l,this.int16[I+2]=d,this.int16[I+3]=_,this.int16[I+4]=y,this.int16[I+5]=w,this.uint32[D+3]=T,this.uint16[I+8]=C,this.uint16[I+9]=M,r}}ys.prototype.bytesPerElement=20,nt("StructArrayLayout6i1ul2ui20",ys);class Ch extends _r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s,l,d,_,y){const w=this.length;return this.resize(w+1),this.emplace(w,r,s,l,d,_,y)}emplace(r,s,l,d,_,y,w){const T=6*r;return this.int16[T+0]=s,this.int16[T+1]=l,this.int16[T+2]=d,this.int16[T+3]=_,this.int16[T+4]=y,this.int16[T+5]=w,r}}Ch.prototype.bytesPerElement=12,nt("StructArrayLayout2i2i2i12",Ch);class gc extends _r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s,l,d,_){const y=this.length;return this.resize(y+1),this.emplace(y,r,s,l,d,_)}emplace(r,s,l,d,_,y){const w=4*r,T=8*r;return this.float32[w+0]=s,this.float32[w+1]=l,this.float32[w+2]=d,this.int16[T+6]=_,this.int16[T+7]=y,r}}gc.prototype.bytesPerElement=16,nt("StructArrayLayout2f1f2i16",gc);class vs extends _r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s,l,d,_,y){const w=this.length;return this.resize(w+1),this.emplace(w,r,s,l,d,_,y)}emplace(r,s,l,d,_,y,w){const T=16*r,C=4*r,M=8*r;return this.uint8[T+0]=s,this.uint8[T+1]=l,this.float32[C+1]=d,this.float32[C+2]=_,this.int16[M+6]=y,this.int16[M+7]=w,r}}vs.prototype.bytesPerElement=16,nt("StructArrayLayout2ub2f2i16",vs);class _c extends _r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,s,l){const d=this.length;return this.resize(d+1),this.emplace(d,r,s,l)}emplace(r,s,l,d){const _=3*r;return this.uint16[_+0]=s,this.uint16[_+1]=l,this.uint16[_+2]=d,r}}_c.prototype.bytesPerElement=6,nt("StructArrayLayout3ui6",_c);class Eh extends _r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s,l,d,_,y,w,T,C,M,I,D,B,O,$,q,ne){const me=this.length;return this.resize(me+1),this.emplace(me,r,s,l,d,_,y,w,T,C,M,I,D,B,O,$,q,ne)}emplace(r,s,l,d,_,y,w,T,C,M,I,D,B,O,$,q,ne,me){const ae=24*r,F=12*r,Z=48*r;return this.int16[ae+0]=s,this.int16[ae+1]=l,this.uint16[ae+2]=d,this.uint16[ae+3]=_,this.uint32[F+2]=y,this.uint32[F+3]=w,this.uint32[F+4]=T,this.uint16[ae+10]=C,this.uint16[ae+11]=M,this.uint16[ae+12]=I,this.float32[F+7]=D,this.float32[F+8]=B,this.uint8[Z+36]=O,this.uint8[Z+37]=$,this.uint8[Z+38]=q,this.uint32[F+10]=ne,this.int16[ae+22]=me,r}}Eh.prototype.bytesPerElement=48,nt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Eh);class yc extends _r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s,l,d,_,y,w,T,C,M,I,D,B,O,$,q,ne,me,ae,F,Z,ce,Ce,Ze,Ie,Re,He,qe){const Xe=this.length;return this.resize(Xe+1),this.emplace(Xe,r,s,l,d,_,y,w,T,C,M,I,D,B,O,$,q,ne,me,ae,F,Z,ce,Ce,Ze,Ie,Re,He,qe)}emplace(r,s,l,d,_,y,w,T,C,M,I,D,B,O,$,q,ne,me,ae,F,Z,ce,Ce,Ze,Ie,Re,He,qe,Xe){const Ne=32*r,it=16*r;return this.int16[Ne+0]=s,this.int16[Ne+1]=l,this.int16[Ne+2]=d,this.int16[Ne+3]=_,this.int16[Ne+4]=y,this.int16[Ne+5]=w,this.int16[Ne+6]=T,this.int16[Ne+7]=C,this.uint16[Ne+8]=M,this.uint16[Ne+9]=I,this.uint16[Ne+10]=D,this.uint16[Ne+11]=B,this.uint16[Ne+12]=O,this.uint16[Ne+13]=$,this.uint16[Ne+14]=q,this.uint16[Ne+15]=ne,this.uint16[Ne+16]=me,this.uint16[Ne+17]=ae,this.uint16[Ne+18]=F,this.uint16[Ne+19]=Z,this.uint16[Ne+20]=ce,this.uint16[Ne+21]=Ce,this.uint16[Ne+22]=Ze,this.uint32[it+12]=Ie,this.float32[it+13]=Re,this.float32[it+14]=He,this.uint16[Ne+30]=qe,this.uint16[Ne+31]=Xe,r}}yc.prototype.bytesPerElement=64,nt("StructArrayLayout8i15ui1ul2f2ui64",yc);class vc extends _r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r){const s=this.length;return this.resize(s+1),this.emplace(s,r)}emplace(r,s){return this.float32[1*r+0]=s,r}}vc.prototype.bytesPerElement=4,nt("StructArrayLayout1f4",vc);class f extends _r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s,l){const d=this.length;return this.resize(d+1),this.emplace(d,r,s,l)}emplace(r,s,l,d){const _=3*r;return this.uint16[6*r+0]=s,this.float32[_+1]=l,this.float32[_+2]=d,r}}f.prototype.bytesPerElement=12,nt("StructArrayLayout1ui2f12",f);class e extends _r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,s,l){const d=this.length;return this.resize(d+1),this.emplace(d,r,s,l)}emplace(r,s,l,d){const _=4*r;return this.uint32[2*r+0]=s,this.uint16[_+2]=l,this.uint16[_+3]=d,r}}e.prototype.bytesPerElement=8,nt("StructArrayLayout1ul2ui8",e);class i extends _r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,s){const l=this.length;return this.resize(l+1),this.emplace(l,r,s)}emplace(r,s,l){const d=2*r;return this.uint16[d+0]=s,this.uint16[d+1]=l,r}}i.prototype.bytesPerElement=4,nt("StructArrayLayout2ui4",i);class u extends _r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r){const s=this.length;return this.resize(s+1),this.emplace(s,r)}emplace(r,s){return this.uint16[1*r+0]=s,r}}u.prototype.bytesPerElement=2,nt("StructArrayLayout1ui2",u);class h extends _r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s,l,d){const _=this.length;return this.resize(_+1),this.emplace(_,r,s,l,d)}emplace(r,s,l,d,_){const y=4*r;return this.float32[y+0]=s,this.float32[y+1]=l,this.float32[y+2]=d,this.float32[y+3]=_,r}}h.prototype.bytesPerElement=16,nt("StructArrayLayout4f16",h);class g extends qi{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new le(this.anchorPointX,this.anchorPointY)}}g.prototype.size=20;class v extends ys{get(r){return new g(this,r)}}nt("CollisionBoxArray",v);class S extends qi{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(r){this._structArray.uint8[this._pos1+37]=r}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(r){this._structArray.uint8[this._pos1+38]=r}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(r){this._structArray.uint32[this._pos4+10]=r}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}S.prototype.size=48;class P extends Eh{get(r){return new S(this,r)}}nt("PlacedSymbolArray",P);class E extends qi{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(r){this._structArray.uint32[this._pos4+12]=r}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}E.prototype.size=64;class k extends yc{get(r){return new E(this,r)}}nt("SymbolInstanceArray",k);class R extends vc{getoffsetX(r){return this.float32[1*r+0]}}nt("GlyphOffsetArray",R);class L extends pc{getx(r){return this.int16[3*r+0]}gety(r){return this.int16[3*r+1]}gettileUnitDistanceFromAnchor(r){return this.int16[3*r+2]}}nt("SymbolLineVertexArray",L);class N extends qi{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}N.prototype.size=12;class V extends f{get(r){return new N(this,r)}}nt("TextAnchorOffsetArray",V);class J extends qi{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}J.prototype.size=8;class K extends e{get(r){return new J(this,r)}}nt("FeatureIndexArray",K);class te extends la{}class oe extends la{}class ue extends la{}class he extends fo{}class pe extends fc{}class ge extends _s{}class fe extends mc{}class Pe extends ol{}class Ee extends Ph{}class Be extends ca{}class je extends Ch{}class Le extends vs{}class Qe extends _c{}class Ke extends i{}const Ge=Mr([{name:"a_pos",components:2,type:"Int16"}],4),{members:lt}=Ge;class mt{constructor(r=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=r}prepareSegment(r,s,l,d){const _=this.segments[this.segments.length-1];return r>mt.MAX_VERTEX_ARRAY_LENGTH&&Kr(`Max vertices per segment is ${mt.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${r}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${mt.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!_||_.vertexLength+r>mt.MAX_VERTEX_ARRAY_LENGTH||_.sortKey!==d?this.createNewSegment(s,l,d):_}createNewSegment(r,s,l){const d={vertexOffset:r.length,primitiveOffset:s.length,vertexLength:0,primitiveLength:0,vaos:{}};return l!==void 0&&(d.sortKey=l),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(d),d}getOrCreateLatestSegment(r,s,l){return this.prepareSegment(0,r,s,l)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const r of this.segments)for(const s in r.vaos)r.vaos[s].destroy()}static simpleSegment(r,s,l,d){return new mt([{vertexOffset:r,primitiveOffset:s,vertexLength:l,primitiveLength:d,vaos:{},sortKey:0}])}}function Vt(o,r){return 256*(o=Xr(Math.floor(o),0,255))+Xr(Math.floor(r),0,255)}mt.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,nt("SegmentVector",mt);const Yt=Mr([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Gt,lr,nr,Ut={exports:{}},qt={exports:{}},Jr={exports:{}},en=function(){if(nr)return Ut.exports;nr=1;var o=(Gt||(Gt=1,qt.exports=function(s,l){var d,_,y,w,T,C,M,I;for(_=s.length-(d=3&s.length),y=l,T=3432918353,C=461845907,I=0;I<_;)M=255&s.charCodeAt(I)|(255&s.charCodeAt(++I))<<8|(255&s.charCodeAt(++I))<<16|(255&s.charCodeAt(++I))<<24,++I,y=27492+(65535&(w=5*(65535&(y=(y^=M=(65535&(M=(M=(65535&M)*T+(((M>>>16)*T&65535)<<16)&4294967295)<<15|M>>>17))*C+(((M>>>16)*C&65535)<<16)&4294967295)<<13|y>>>19))+((5*(y>>>16)&65535)<<16)&4294967295))+((58964+(w>>>16)&65535)<<16);switch(M=0,d){case 3:M^=(255&s.charCodeAt(I+2))<<16;case 2:M^=(255&s.charCodeAt(I+1))<<8;case 1:y^=M=(65535&(M=(M=(65535&(M^=255&s.charCodeAt(I)))*T+(((M>>>16)*T&65535)<<16)&4294967295)<<15|M>>>17))*C+(((M>>>16)*C&65535)<<16)&4294967295}return y^=s.length,y=2246822507*(65535&(y^=y>>>16))+((2246822507*(y>>>16)&65535)<<16)&4294967295,y=3266489909*(65535&(y^=y>>>13))+((3266489909*(y>>>16)&65535)<<16)&4294967295,(y^=y>>>16)>>>0}),qt.exports),r=(lr||(lr=1,Jr.exports=function(s,l){for(var d,_=s.length,y=l^_,w=0;_>=4;)d=1540483477*(65535&(d=255&s.charCodeAt(w)|(255&s.charCodeAt(++w))<<8|(255&s.charCodeAt(++w))<<16|(255&s.charCodeAt(++w))<<24))+((1540483477*(d>>>16)&65535)<<16),y=1540483477*(65535&y)+((1540483477*(y>>>16)&65535)<<16)^(d=1540483477*(65535&(d^=d>>>24))+((1540483477*(d>>>16)&65535)<<16)),_-=4,++w;switch(_){case 3:y^=(255&s.charCodeAt(w+2))<<16;case 2:y^=(255&s.charCodeAt(w+1))<<8;case 1:y=1540483477*(65535&(y^=255&s.charCodeAt(w)))+((1540483477*(y>>>16)&65535)<<16)}return y=1540483477*(65535&(y^=y>>>13))+((1540483477*(y>>>16)&65535)<<16),(y^=y>>>15)>>>0}),Jr.exports);return Ut.exports=o,Ut.exports.murmur3=o,Ut.exports.murmur2=r,Ut.exports}(),$r=A(en);class un{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(r,s,l,d){this.ids.push(Oo(r)),this.positions.push(s,l,d)}getPositions(r){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const s=Oo(r);let l=0,d=this.ids.length-1;for(;l<d;){const y=l+d>>1;this.ids[y]>=s?d=y:l=y+1}const _=[];for(;this.ids[l]===s;)_.push({index:this.positions[3*l],start:this.positions[3*l+1],end:this.positions[3*l+2]}),l++;return _}static serialize(r,s){const l=new Float64Array(r.ids),d=new Uint32Array(r.positions);return mo(l,d,0,l.length-1),s&&s.push(l.buffer,d.buffer),{ids:l,positions:d}}static deserialize(r){const s=new un;return s.ids=r.ids,s.positions=r.positions,s.indexed=!0,s}}function Oo(o){const r=+o;return!isNaN(r)&&r<=Number.MAX_SAFE_INTEGER?r:$r(String(o))}function mo(o,r,s,l){for(;s<l;){const d=o[s+l>>1];let _=s-1,y=l+1;for(;;){do _++;while(o[_]<d);do y--;while(o[y]>d);if(_>=y)break;Wi(o,_,y),Wi(r,3*_,3*y),Wi(r,3*_+1,3*y+1),Wi(r,3*_+2,3*y+2)}y-s<l-y?(mo(o,r,s,y),s=y+1):(mo(o,r,y+1,l),l=y)}}function Wi(o,r,s){const l=o[r];o[r]=o[s],o[s]=l}nt("FeaturePositionMap",un);class di{constructor(r,s){this.gl=r.gl,this.location=s}}class xs extends di{constructor(r,s){super(r,s),this.current=0}set(r){this.current!==r&&(this.current=r,this.gl.uniform1f(this.location,r))}}class sl extends di{constructor(r,s){super(r,s),this.current=[0,0,0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]&&r[3]===this.current[3]||(this.current=r,this.gl.uniform4f(this.location,r[0],r[1],r[2],r[3]))}}class bs extends di{constructor(r,s){super(r,s),this.current=Bt.transparent}set(r){r.r===this.current.r&&r.g===this.current.g&&r.b===this.current.b&&r.a===this.current.a||(this.current=r,this.gl.uniform4f(this.location,r.r,r.g,r.b,r.a))}}const pi=new Float32Array(16);function Hi(o){return[Vt(255*o.r,255*o.g),Vt(255*o.b,255*o.a)]}class Ti{constructor(r,s,l){this.value=r,this.uniformNames=s.map(d=>`u_${d}`),this.type=l}setUniform(r,s,l){r.set(l.constantOr(this.value))}getBinding(r,s,l){return this.type==="color"?new bs(r,s):new xs(r,s)}}class Xi{constructor(r,s){this.uniformNames=s.map(l=>`u_${l}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(r,s){this.pixelRatioFrom=s.pixelRatio,this.pixelRatioTo=r.pixelRatio,this.patternFrom=s.tlbr,this.patternTo=r.tlbr}setUniform(r,s,l,d){const _=d==="u_pattern_to"?this.patternTo:d==="u_pattern_from"?this.patternFrom:d==="u_pixel_ratio_to"?this.pixelRatioTo:d==="u_pixel_ratio_from"?this.pixelRatioFrom:null;_&&r.set(_)}getBinding(r,s,l){return l.substr(0,9)==="u_pattern"?new sl(r,s):new xs(r,s)}}class Qt{constructor(r,s,l,d){this.expression=r,this.type=l,this.maxValue=0,this.paintVertexAttributes=s.map(_=>({name:`a_${_}`,type:"Float32",components:l==="color"?2:1,offset:0})),this.paintVertexArray=new d}populatePaintArray(r,s,l,d,_){const y=this.paintVertexArray.length,w=this.expression.evaluate(new ar(0),s,{},d,[],_);this.paintVertexArray.resize(r),this._setPaintValue(y,r,w)}updatePaintArray(r,s,l,d){const _=this.expression.evaluate({zoom:0},l,d);this._setPaintValue(r,s,_)}_setPaintValue(r,s,l){if(this.type==="color"){const d=Hi(l);for(let _=r;_<s;_++)this.paintVertexArray.emplace(_,d[0],d[1])}else{for(let d=r;d<s;d++)this.paintVertexArray.emplace(d,l);this.maxValue=Math.max(this.maxValue,Math.abs(l))}}upload(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Kt{constructor(r,s,l,d,_,y){this.expression=r,this.uniformNames=s.map(w=>`u_${w}_t`),this.type=l,this.useIntegerZoom=d,this.zoom=_,this.maxValue=0,this.paintVertexAttributes=s.map(w=>({name:`a_${w}`,type:"Float32",components:l==="color"?4:2,offset:0})),this.paintVertexArray=new y}populatePaintArray(r,s,l,d,_){const y=this.expression.evaluate(new ar(this.zoom),s,{},d,[],_),w=this.expression.evaluate(new ar(this.zoom+1),s,{},d,[],_),T=this.paintVertexArray.length;this.paintVertexArray.resize(r),this._setPaintValue(T,r,y,w)}updatePaintArray(r,s,l,d){const _=this.expression.evaluate({zoom:this.zoom},l,d),y=this.expression.evaluate({zoom:this.zoom+1},l,d);this._setPaintValue(r,s,_,y)}_setPaintValue(r,s,l,d){if(this.type==="color"){const _=Hi(l),y=Hi(d);for(let w=r;w<s;w++)this.paintVertexArray.emplace(w,_[0],_[1],y[0],y[1])}else{for(let _=r;_<s;_++)this.paintVertexArray.emplace(_,l,d);this.maxValue=Math.max(this.maxValue,Math.abs(l),Math.abs(d))}}upload(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(r,s){const l=this.useIntegerZoom?Math.floor(s.zoom):s.zoom,d=Xr(this.expression.interpolationFactor(l,this.zoom,this.zoom+1),0,1);r.set(d)}getBinding(r,s,l){return new xs(r,s)}}class Vr{constructor(r,s,l,d,_,y){this.expression=r,this.type=s,this.useIntegerZoom=l,this.zoom=d,this.layerId=y,this.zoomInPaintVertexArray=new _,this.zoomOutPaintVertexArray=new _}populatePaintArray(r,s,l){const d=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(r),this.zoomOutPaintVertexArray.resize(r),this._setPaintValues(d,r,s.patterns&&s.patterns[this.layerId],l)}updatePaintArray(r,s,l,d,_){this._setPaintValues(r,s,l.patterns&&l.patterns[this.layerId],_)}_setPaintValues(r,s,l,d){if(!d||!l)return;const{min:_,mid:y,max:w}=l,T=d[_],C=d[y],M=d[w];if(T&&C&&M)for(let I=r;I<s;I++)this.zoomInPaintVertexArray.emplace(I,C.tl[0],C.tl[1],C.br[0],C.br[1],T.tl[0],T.tl[1],T.br[0],T.br[1],C.pixelRatio,T.pixelRatio),this.zoomOutPaintVertexArray.emplace(I,C.tl[0],C.tl[1],C.br[0],C.br[1],M.tl[0],M.tl[1],M.br[0],M.br[1],C.pixelRatio,M.pixelRatio)}upload(r){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=r.createVertexBuffer(this.zoomInPaintVertexArray,Yt.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=r.createVertexBuffer(this.zoomOutPaintVertexArray,Yt.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Ur{constructor(r,s,l){this.binders={},this._buffers=[];const d=[];for(const _ in r.paint._values){if(!l(_))continue;const y=r.paint.get(_);if(!(y instanceof hi&&ea(y.property.specification)))continue;const w=s_(_,r.type),T=y.value,C=y.property.specification.type,M=y.property.useIntegerZoom,I=y.property.specification["property-type"],D=I==="cross-faded"||I==="cross-faded-data-driven";if(T.kind==="constant")this.binders[_]=D?new Xi(T.value,w):new Ti(T.value,w,C),d.push(`/u_${_}`);else if(T.kind==="source"||D){const B=Wp(_,C,"source");this.binders[_]=D?new Vr(T,C,M,s,B,r.id):new Qt(T,w,C,B),d.push(`/a_${_}`)}else{const B=Wp(_,C,"composite");this.binders[_]=new Kt(T,w,C,M,s,B),d.push(`/z_${_}`)}}this.cacheKey=d.sort().join("")}getMaxValue(r){const s=this.binders[r];return s instanceof Qt||s instanceof Kt?s.maxValue:0}populatePaintArrays(r,s,l,d,_){for(const y in this.binders){const w=this.binders[y];(w instanceof Qt||w instanceof Kt||w instanceof Vr)&&w.populatePaintArray(r,s,l,d,_)}}setConstantPatternPositions(r,s){for(const l in this.binders){const d=this.binders[l];d instanceof Xi&&d.setConstantPatternPositions(r,s)}}updatePaintArrays(r,s,l,d,_){let y=!1;for(const w in r){const T=s.getPositions(w);for(const C of T){const M=l.feature(C.index);for(const I in this.binders){const D=this.binders[I];if((D instanceof Qt||D instanceof Kt||D instanceof Vr)&&D.expression.isStateDependent===!0){const B=d.paint.get(I);D.expression=B.value,D.updatePaintArray(C.start,C.end,M,r[w],_),y=!0}}}}return y}defines(){const r=[];for(const s in this.binders){const l=this.binders[s];(l instanceof Ti||l instanceof Xi)&&r.push(...l.uniformNames.map(d=>`#define HAS_UNIFORM_${d}`))}return r}getBinderAttributes(){const r=[];for(const s in this.binders){const l=this.binders[s];if(l instanceof Qt||l instanceof Kt)for(let d=0;d<l.paintVertexAttributes.length;d++)r.push(l.paintVertexAttributes[d].name);else if(l instanceof Vr)for(let d=0;d<Yt.members.length;d++)r.push(Yt.members[d].name)}return r}getBinderUniforms(){const r=[];for(const s in this.binders){const l=this.binders[s];if(l instanceof Ti||l instanceof Xi||l instanceof Kt)for(const d of l.uniformNames)r.push(d)}return r}getPaintVertexBuffers(){return this._buffers}getUniforms(r,s){const l=[];for(const d in this.binders){const _=this.binders[d];if(_ instanceof Ti||_ instanceof Xi||_ instanceof Kt){for(const y of _.uniformNames)if(s[y]){const w=_.getBinding(r,s[y],y);l.push({name:y,property:d,binding:w})}}}return l}setUniforms(r,s,l,d){for(const{name:_,property:y,binding:w}of s)this.binders[y].setUniform(w,d,l.get(y),_)}updatePaintBuffers(r){this._buffers=[];for(const s in this.binders){const l=this.binders[s];if(r&&l instanceof Vr){const d=r.fromScale===2?l.zoomInPaintVertexBuffer:l.zoomOutPaintVertexBuffer;d&&this._buffers.push(d)}else(l instanceof Qt||l instanceof Kt)&&l.paintVertexBuffer&&this._buffers.push(l.paintVertexBuffer)}}upload(r){for(const s in this.binders){const l=this.binders[s];(l instanceof Qt||l instanceof Kt||l instanceof Vr)&&l.upload(r)}this.updatePaintBuffers()}destroy(){for(const r in this.binders){const s=this.binders[r];(s instanceof Qt||s instanceof Kt||s instanceof Vr)&&s.destroy()}}}class ws{constructor(r,s,l=()=>!0){this.programConfigurations={};for(const d of r)this.programConfigurations[d.id]=new Ur(d,s,l);this.needsUpload=!1,this._featureMap=new un,this._bufferOffset=0}populatePaintArrays(r,s,l,d,_,y){for(const w in this.programConfigurations)this.programConfigurations[w].populatePaintArrays(r,s,d,_,y);s.id!==void 0&&this._featureMap.add(s.id,l,this._bufferOffset,r),this._bufferOffset=r,this.needsUpload=!0}updatePaintArrays(r,s,l,d){for(const _ of l)this.needsUpload=this.programConfigurations[_.id].updatePaintArrays(r,this._featureMap,s,_,d)||this.needsUpload}get(r){return this.programConfigurations[r]}upload(r){if(this.needsUpload){for(const s in this.programConfigurations)this.programConfigurations[s].upload(r);this.needsUpload=!1}}destroy(){for(const r in this.programConfigurations)this.programConfigurations[r].destroy()}}function s_(o,r){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[o]||[o.replace(`${r}-`,"").replace(/-/g,"_")]}function Wp(o,r,s){const l={color:{source:_s,composite:h},number:{source:vc,composite:_s}},d=function(_){return{"line-pattern":{source:fe,composite:fe},"fill-pattern":{source:fe,composite:fe},"fill-extrusion-pattern":{source:fe,composite:fe}}[_]}(o);return d&&d[s]||l[r][s]}nt("ConstantBinder",Ti),nt("CrossFadedConstantBinder",Xi),nt("SourceExpressionBinder",Qt),nt("CrossFadedCompositeBinder",Vr),nt("CompositeExpressionBinder",Kt),nt("ProgramConfiguration",Ur,{omit:["_buffers"]}),nt("ProgramConfigurationSet",ws);const Mh=Math.pow(2,14)-1,Hp=-Mh-1;function Ss(o){const r=St/o.extent,s=o.loadGeometry();for(let l=0;l<s.length;l++){const d=s[l];for(let _=0;_<d.length;_++){const y=d[_],w=Math.round(y.x*r),T=Math.round(y.y*r);y.x=Xr(w,Hp,Mh),y.y=Xr(T,Hp,Mh),(w<y.x||w>y.x+1||T<y.y||T>y.y+1)&&Kr("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return s}function Kn(o,r){return{type:o.type,id:o.id,properties:o.properties,geometry:r?Ss(o):[]}}const Ih=-32768;function Xp(o,r,s,l,d){o.emplaceBack(Ih+8*r+l,Ih+8*s+d)}class xc{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(s=>s.id),this.index=r.index,this.hasPattern=!1,this.layoutVertexArray=new oe,this.indexArray=new Qe,this.segments=new mt,this.programConfigurations=new ws(r.layers,r.zoom),this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(r,s,l){const d=this.layers[0],_=[];let y=null,w=!1,T=d.type==="heatmap";if(d.type==="circle"){const M=d;y=M.layout.get("circle-sort-key"),w=!y.isConstant(),T=T||M.paint.get("circle-pitch-alignment")==="map"}const C=T?s.subdivisionGranularity.circle:1;for(const{feature:M,id:I,index:D,sourceLayerIndex:B}of r){const O=this.layers[0]._featureFilter.needGeometry,$=Kn(M,O);if(!this.layers[0]._featureFilter.filter(new ar(this.zoom),$,l))continue;const q=w?y.evaluate($,{},l):void 0,ne={id:I,properties:M.properties,type:M.type,sourceLayerIndex:B,index:D,geometry:O?$.geometry:Ss(M),patterns:{},sortKey:q};_.push(ne)}w&&_.sort((M,I)=>M.sortKey-I.sortKey);for(const M of _){const{geometry:I,index:D,sourceLayerIndex:B}=M,O=r[D].feature;this.addFeature(M,I,D,l,C),s.featureIndex.insert(O,I,D,B,this.index)}}update(r,s,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,s,this.stateDependentLayers,l)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,lt),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(r,s,l,d,_=1){let y;switch(_){case 1:y=[0,7];break;case 3:y=[0,2,5,7];break;case 5:y=[0,1,3,4,6,7];break;case 7:y=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${_}; valid values are 1, 3, 5, 7.`)}const w=y.length;for(const T of s)for(const C of T){const M=C.x,I=C.y;if(M<0||M>=St||I<0||I>=St)continue;const D=this.segments.prepareSegment(w*w,this.layoutVertexArray,this.indexArray,r.sortKey),B=D.vertexLength;for(let O=0;O<w;O++)for(let $=0;$<w;$++)Xp(this.layoutVertexArray,M,I,y[$],y[O]);for(let O=0;O<w-1;O++)for(let $=0;$<w-1;$++){const q=B+O*w+$,ne=B+(O+1)*w+$;this.indexArray.emplaceBack(q,ne+1,q+1),this.indexArray.emplaceBack(q,ne,ne+1)}D.vertexLength+=w*w,D.primitiveLength+=(w-1)*(w-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,l,{},d)}}function bc(o,r){for(let s=0;s<o.length;s++)if(Sc(r,o[s]))return!0;for(let s=0;s<r.length;s++)if(Sc(o,r[s]))return!0;return!!a_(o,r)}function Kp(o,r,s){return!!Sc(o,r)||!!l_(r,o,s)}function wc(o,r){if(o.length===1)return ax(r,o[0]);for(let s=0;s<r.length;s++){const l=r[s];for(let d=0;d<l.length;d++)if(Sc(o,l[d]))return!0}for(let s=0;s<o.length;s++)if(ax(r,o[s]))return!0;for(let s=0;s<r.length;s++)if(a_(o,r[s]))return!0;return!1}function aP(o,r,s){if(o.length>1){if(a_(o,r))return!0;for(let l=0;l<r.length;l++)if(l_(r[l],o,s))return!0}for(let l=0;l<o.length;l++)if(l_(o[l],r,s))return!0;return!1}function a_(o,r){if(o.length===0||r.length===0)return!1;for(let s=0;s<o.length-1;s++){const l=o[s],d=o[s+1];for(let _=0;_<r.length-1;_++)if(lP(l,d,r[_],r[_+1]))return!0}return!1}function lP(o,r,s,l){return Cr(o,s,l)!==Cr(r,s,l)&&Cr(o,r,s)!==Cr(o,r,l)}function l_(o,r,s){const l=s*s;if(r.length===1)return o.distSqr(r[0])<l;for(let d=1;d<r.length;d++)if(sx(o,r[d-1],r[d])<l)return!0;return!1}function sx(o,r,s){const l=r.distSqr(s);if(l===0)return o.distSqr(r);const d=((o.x-r.x)*(s.x-r.x)+(o.y-r.y)*(s.y-r.y))/l;return o.distSqr(d<0?r:d>1?s:s.sub(r)._mult(d)._add(r))}function ax(o,r){let s,l,d,_=!1;for(let y=0;y<o.length;y++){s=o[y];for(let w=0,T=s.length-1;w<s.length;T=w++)l=s[w],d=s[T],l.y>r.y!=d.y>r.y&&r.x<(d.x-l.x)*(r.y-l.y)/(d.y-l.y)+l.x&&(_=!_)}return _}function Sc(o,r){let s=!1;for(let l=0,d=o.length-1;l<o.length;d=l++){const _=o[l],y=o[d];_.y>r.y!=y.y>r.y&&r.x<(y.x-_.x)*(r.y-_.y)/(y.y-_.y)+_.x&&(s=!s)}return s}function cP(o,r,s){const l=s[0],d=s[2];if(o.x<l.x&&r.x<l.x||o.x>d.x&&r.x>d.x||o.y<l.y&&r.y<l.y||o.y>d.y&&r.y>d.y)return!1;const _=Cr(o,r,s[0]);return _!==Cr(o,r,s[1])||_!==Cr(o,r,s[2])||_!==Cr(o,r,s[3])}function kh(o,r,s){const l=r.paint.get(o).value;return l.kind==="constant"?l.value:s.programConfigurations.get(r.id).getMaxValue(o)}function Yp(o){return Math.sqrt(o[0]*o[0]+o[1]*o[1])}function Qp(o,r,s,l,d){if(!r[0]&&!r[1])return o;const _=le.convert(r)._mult(d);s==="viewport"&&_._rotate(-l);const y=[];for(let w=0;w<o.length;w++)y.push(o[w].sub(_));return y}let lx,cx;nt("CircleBucket",xc,{omit:["layers"]});var uP={get paint(){return cx=cx||new On({"circle-radius":new xt(z.paint_circle["circle-radius"]),"circle-color":new xt(z.paint_circle["circle-color"]),"circle-blur":new xt(z.paint_circle["circle-blur"]),"circle-opacity":new xt(z.paint_circle["circle-opacity"]),"circle-translate":new pt(z.paint_circle["circle-translate"]),"circle-translate-anchor":new pt(z.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new pt(z.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new pt(z.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new xt(z.paint_circle["circle-stroke-width"]),"circle-stroke-color":new xt(z.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new xt(z.paint_circle["circle-stroke-opacity"])})},get layout(){return lx=lx||new On({"circle-sort-key":new xt(z.layout_circle["circle-sort-key"])})}};class hP extends Gi{constructor(r){super(r,uP)}createBucket(r){return new xc(r)}queryRadius(r){const s=r;return kh("circle-radius",this,s)+kh("circle-stroke-width",this,s)+Yp(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:r,feature:s,featureState:l,geometry:d,transform:_,pixelsToTileUnits:y,pixelPosMatrix:w}){const T=Qp(r,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-_.bearingInRadians,y),C=this.paint.get("circle-radius").evaluate(s,l)+this.paint.get("circle-stroke-width").evaluate(s,l),M=this.paint.get("circle-pitch-alignment")==="map",I=M?T:function(B,O){return B.map($=>ux($,O))}(T,w),D=M?C*y:C;for(const B of d)for(const O of B){const $=M?O:ux(O,w);let q=D;const ne=at([],[O.x,O.y,0,1],w);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?q*=ne[3]/_.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(q*=_.cameraToCenterDistance/ne[3]),Kp(I,$,q))return!0}return!1}}function ux(o,r){const s=at([],[o.x,o.y,0,1],r);return new le(s[0]/s[3],s[1]/s[3])}class hx extends xc{}let dx;nt("HeatmapBucket",hx,{omit:["layers"]});var dP={get paint(){return dx=dx||new On({"heatmap-radius":new xt(z.paint_heatmap["heatmap-radius"]),"heatmap-weight":new xt(z.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new pt(z.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Sh(z.paint_heatmap["heatmap-color"]),"heatmap-opacity":new pt(z.paint_heatmap["heatmap-opacity"])})}};function c_(o,{width:r,height:s},l,d){if(d){if(d instanceof Uint8ClampedArray)d=new Uint8Array(d.buffer);else if(d.length!==r*s*l)throw new RangeError(`mismatched image size. expected: ${d.length} but got: ${r*s*l}`)}else d=new Uint8Array(r*s*l);return o.width=r,o.height=s,o.data=d,o}function px(o,{width:r,height:s},l){if(r===o.width&&s===o.height)return;const d=c_({},{width:r,height:s},l);u_(o,d,{x:0,y:0},{x:0,y:0},{width:Math.min(o.width,r),height:Math.min(o.height,s)},l),o.width=r,o.height=s,o.data=d.data}function u_(o,r,s,l,d,_){if(d.width===0||d.height===0)return r;if(d.width>o.width||d.height>o.height||s.x>o.width-d.width||s.y>o.height-d.height)throw new RangeError("out of range source coordinates for image copy");if(d.width>r.width||d.height>r.height||l.x>r.width-d.width||l.y>r.height-d.height)throw new RangeError("out of range destination coordinates for image copy");const y=o.data,w=r.data;if(y===w)throw new Error("srcData equals dstData, so image is already copied");for(let T=0;T<d.height;T++){const C=((s.y+T)*o.width+s.x)*_,M=((l.y+T)*r.width+l.x)*_;for(let I=0;I<d.width*_;I++)w[M+I]=y[C+I]}return r}class Ah{constructor(r,s){c_(this,r,1,s)}resize(r){px(this,r,1)}clone(){return new Ah({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(r,s,l,d,_){u_(r,s,l,d,_,1)}}class Pi{constructor(r,s){c_(this,r,4,s)}resize(r){px(this,r,4)}replace(r,s){s?this.data.set(r):this.data=r instanceof Uint8ClampedArray?new Uint8Array(r.buffer):r}clone(){return new Pi({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(r,s,l,d,_){u_(r,s,l,d,_,4)}}function fx(o){const r={},s=o.resolution||256,l=o.clips?o.clips.length:1,d=o.image||new Pi({width:s,height:l});if(Math.log(s)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${s}`);const _=(y,w,T)=>{r[o.evaluationKey]=T;const C=o.expression.evaluate(r);d.data[y+w+0]=Math.floor(255*C.r/C.a),d.data[y+w+1]=Math.floor(255*C.g/C.a),d.data[y+w+2]=Math.floor(255*C.b/C.a),d.data[y+w+3]=Math.floor(255*C.a)};if(o.clips)for(let y=0,w=0;y<l;++y,w+=4*s)for(let T=0,C=0;T<s;T++,C+=4){const M=T/(s-1),{start:I,end:D}=o.clips[y];_(w,C,I*(1-M)+D*M)}else for(let y=0,w=0;y<s;y++,w+=4)_(0,w,y/(s-1));return d}nt("AlphaImage",Ah),nt("RGBAImage",Pi);const h_="big-fb";class pP extends Gi{createBucket(r){return new hx(r)}constructor(r){super(r,dP),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(r){r==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=fx({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(h_)&&this.heatmapFbos.delete(h_)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let mx;var fP={get paint(){return mx=mx||new On({"hillshade-illumination-direction":new pt(z.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new pt(z.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new pt(z.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new pt(z.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new pt(z.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new pt(z.paint_hillshade["hillshade-accent-color"])})}};class mP extends Gi{constructor(r){super(r,fP)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const gP=Mr([{name:"a_pos",components:2,type:"Int16"}],4),{members:_P}=gP;function d_(o,r,s){const l=s.patternDependencies;let d=!1;for(const _ of r){const y=_.paint.get(`${o}-pattern`);y.isConstant()||(d=!0);const w=y.constantOr(null);w&&(d=!0,l[w.to]=!0,l[w.from]=!0)}return d}function p_(o,r,s,l,d){const _=d.patternDependencies;for(const y of r){const w=y.paint.get(`${o}-pattern`).value;if(w.kind!=="constant"){let T=w.evaluate({zoom:l-1},s,{},d.availableImages),C=w.evaluate({zoom:l},s,{},d.availableImages),M=w.evaluate({zoom:l+1},s,{},d.availableImages);T=T&&T.name?T.name:T,C=C&&C.name?C.name:C,M=M&&M.name?M.name:M,_[T]=!0,_[C]=!0,_[M]=!0,s.patterns[y.id]={min:T,mid:C,max:M}}}return s}function gx(o,r,s,l,d){let _;if(d===function(y,w,T,C){let M=0;for(let I=w,D=T-C;I<T;I+=C)M+=(y[D]-y[I])*(y[I+1]+y[D+1]),D=I;return M}(o,r,s,l)>0)for(let y=r;y<s;y+=l)_=xx(y/l|0,o[y],o[y+1],_);else for(let y=s-l;y>=r;y-=l)_=xx(y/l|0,o[y],o[y+1],_);return _&&Tc(_,_.next)&&(Dh(_),_=_.next),_}function al(o,r){if(!o)return o;r||(r=o);let s,l=o;do if(s=!1,l.steiner||!Tc(l,l.next)&&Ir(l.prev,l,l.next)!==0)l=l.next;else{if(Dh(l),l=r=l.prev,l===l.next)break;s=!0}while(s||l!==r);return r}function zh(o,r,s,l,d,_,y){if(!o)return;!y&&_&&function(T,C,M,I){let D=T;do D.z===0&&(D.z=f_(D.x,D.y,C,M,I)),D.prevZ=D.prev,D.nextZ=D.next,D=D.next;while(D!==T);D.prevZ.nextZ=null,D.prevZ=null,function(B){let O,$=1;do{let q,ne=B;B=null;let me=null;for(O=0;ne;){O++;let ae=ne,F=0;for(let ce=0;ce<$&&(F++,ae=ae.nextZ,ae);ce++);let Z=$;for(;F>0||Z>0&&ae;)F!==0&&(Z===0||!ae||ne.z<=ae.z)?(q=ne,ne=ne.nextZ,F--):(q=ae,ae=ae.nextZ,Z--),me?me.nextZ=q:B=q,q.prevZ=me,me=q;ne=ae}me.nextZ=null,$*=2}while(O>1)}(D)}(o,l,d,_);let w=o;for(;o.prev!==o.next;){const T=o.prev,C=o.next;if(_?vP(o,l,d,_):yP(o))r.push(T.i,o.i,C.i),Dh(o),o=C.next,w=C.next;else if((o=C)===w){y?y===1?zh(o=xP(al(o),r),r,s,l,d,_,2):y===2&&bP(o,r,s,l,d,_):zh(al(o),r,s,l,d,_,1);break}}}function yP(o){const r=o.prev,s=o,l=o.next;if(Ir(r,s,l)>=0)return!1;const d=r.x,_=s.x,y=l.x,w=r.y,T=s.y,C=l.y,M=Math.min(d,_,y),I=Math.min(w,T,C),D=Math.max(d,_,y),B=Math.max(w,T,C);let O=l.next;for(;O!==r;){if(O.x>=M&&O.x<=D&&O.y>=I&&O.y<=B&&Rh(d,w,_,T,y,C,O.x,O.y)&&Ir(O.prev,O,O.next)>=0)return!1;O=O.next}return!0}function vP(o,r,s,l){const d=o.prev,_=o,y=o.next;if(Ir(d,_,y)>=0)return!1;const w=d.x,T=_.x,C=y.x,M=d.y,I=_.y,D=y.y,B=Math.min(w,T,C),O=Math.min(M,I,D),$=Math.max(w,T,C),q=Math.max(M,I,D),ne=f_(B,O,r,s,l),me=f_($,q,r,s,l);let ae=o.prevZ,F=o.nextZ;for(;ae&&ae.z>=ne&&F&&F.z<=me;){if(ae.x>=B&&ae.x<=$&&ae.y>=O&&ae.y<=q&&ae!==d&&ae!==y&&Rh(w,M,T,I,C,D,ae.x,ae.y)&&Ir(ae.prev,ae,ae.next)>=0||(ae=ae.prevZ,F.x>=B&&F.x<=$&&F.y>=O&&F.y<=q&&F!==d&&F!==y&&Rh(w,M,T,I,C,D,F.x,F.y)&&Ir(F.prev,F,F.next)>=0))return!1;F=F.nextZ}for(;ae&&ae.z>=ne;){if(ae.x>=B&&ae.x<=$&&ae.y>=O&&ae.y<=q&&ae!==d&&ae!==y&&Rh(w,M,T,I,C,D,ae.x,ae.y)&&Ir(ae.prev,ae,ae.next)>=0)return!1;ae=ae.prevZ}for(;F&&F.z<=me;){if(F.x>=B&&F.x<=$&&F.y>=O&&F.y<=q&&F!==d&&F!==y&&Rh(w,M,T,I,C,D,F.x,F.y)&&Ir(F.prev,F,F.next)>=0)return!1;F=F.nextZ}return!0}function xP(o,r){let s=o;do{const l=s.prev,d=s.next.next;!Tc(l,d)&&yx(l,s,s.next,d)&&Lh(l,d)&&Lh(d,l)&&(r.push(l.i,s.i,d.i),Dh(s),Dh(s.next),s=o=d),s=s.next}while(s!==o);return al(s)}function bP(o,r,s,l,d,_){let y=o;do{let w=y.next.next;for(;w!==y.prev;){if(y.i!==w.i&&CP(y,w)){let T=vx(y,w);return y=al(y,y.next),T=al(T,T.next),zh(y,r,s,l,d,_,0),void zh(T,r,s,l,d,_,0)}w=w.next}y=y.next}while(y!==o)}function wP(o,r){let s=o.x-r.x;return s===0&&(s=o.y-r.y,s===0)&&(s=(o.next.y-o.y)/(o.next.x-o.x)-(r.next.y-r.y)/(r.next.x-r.x)),s}function SP(o,r){const s=function(d,_){let y=_;const w=d.x,T=d.y;let C,M=-1/0;if(Tc(d,y))return y;do{if(Tc(d,y.next))return y.next;if(T<=y.y&&T>=y.next.y&&y.next.y!==y.y){const $=y.x+(T-y.y)*(y.next.x-y.x)/(y.next.y-y.y);if($<=w&&$>M&&(M=$,C=y.x<y.next.x?y:y.next,$===w))return C}y=y.next}while(y!==_);if(!C)return null;const I=C,D=C.x,B=C.y;let O=1/0;y=C;do{if(w>=y.x&&y.x>=D&&w!==y.x&&_x(T<B?w:M,T,D,B,T<B?M:w,T,y.x,y.y)){const $=Math.abs(T-y.y)/(w-y.x);Lh(y,d)&&($<O||$===O&&(y.x>C.x||y.x===C.x&&TP(C,y)))&&(C=y,O=$)}y=y.next}while(y!==I);return C}(o,r);if(!s)return r;const l=vx(s,o);return al(l,l.next),al(s,s.next)}function TP(o,r){return Ir(o.prev,o,r.prev)<0&&Ir(r.next,o,o.next)<0}function f_(o,r,s,l,d){return(o=1431655765&((o=858993459&((o=252645135&((o=16711935&((o=(o-s)*d|0)|o<<8))|o<<4))|o<<2))|o<<1))|(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=(r-l)*d|0)|r<<8))|r<<4))|r<<2))|r<<1))<<1}function PP(o){let r=o,s=o;do(r.x<s.x||r.x===s.x&&r.y<s.y)&&(s=r),r=r.next;while(r!==o);return s}function _x(o,r,s,l,d,_,y,w){return(d-y)*(r-w)>=(o-y)*(_-w)&&(o-y)*(l-w)>=(s-y)*(r-w)&&(s-y)*(_-w)>=(d-y)*(l-w)}function Rh(o,r,s,l,d,_,y,w){return!(o===y&&r===w)&&_x(o,r,s,l,d,_,y,w)}function CP(o,r){return o.next.i!==r.i&&o.prev.i!==r.i&&!function(s,l){let d=s;do{if(d.i!==s.i&&d.next.i!==s.i&&d.i!==l.i&&d.next.i!==l.i&&yx(d,d.next,s,l))return!0;d=d.next}while(d!==s);return!1}(o,r)&&(Lh(o,r)&&Lh(r,o)&&function(s,l){let d=s,_=!1;const y=(s.x+l.x)/2,w=(s.y+l.y)/2;do d.y>w!=d.next.y>w&&d.next.y!==d.y&&y<(d.next.x-d.x)*(w-d.y)/(d.next.y-d.y)+d.x&&(_=!_),d=d.next;while(d!==s);return _}(o,r)&&(Ir(o.prev,o,r.prev)||Ir(o,r.prev,r))||Tc(o,r)&&Ir(o.prev,o,o.next)>0&&Ir(r.prev,r,r.next)>0)}function Ir(o,r,s){return(r.y-o.y)*(s.x-r.x)-(r.x-o.x)*(s.y-r.y)}function Tc(o,r){return o.x===r.x&&o.y===r.y}function yx(o,r,s,l){const d=ef(Ir(o,r,s)),_=ef(Ir(o,r,l)),y=ef(Ir(s,l,o)),w=ef(Ir(s,l,r));return d!==_&&y!==w||!(d!==0||!Jp(o,s,r))||!(_!==0||!Jp(o,l,r))||!(y!==0||!Jp(s,o,l))||!(w!==0||!Jp(s,r,l))}function Jp(o,r,s){return r.x<=Math.max(o.x,s.x)&&r.x>=Math.min(o.x,s.x)&&r.y<=Math.max(o.y,s.y)&&r.y>=Math.min(o.y,s.y)}function ef(o){return o>0?1:o<0?-1:0}function Lh(o,r){return Ir(o.prev,o,o.next)<0?Ir(o,r,o.next)>=0&&Ir(o,o.prev,r)>=0:Ir(o,r,o.prev)<0||Ir(o,o.next,r)<0}function vx(o,r){const s=m_(o.i,o.x,o.y),l=m_(r.i,r.x,r.y),d=o.next,_=r.prev;return o.next=r,r.prev=o,s.next=d,d.prev=s,l.next=s,s.prev=l,_.next=l,l.prev=_,l}function xx(o,r,s,l){const d=m_(o,r,s);return l?(d.next=l.next,d.prev=l,l.next.prev=d,l.next=d):(d.prev=d,d.next=d),d}function Dh(o){o.next.prev=o.prev,o.prev.next=o.next,o.prevZ&&(o.prevZ.nextZ=o.nextZ),o.nextZ&&(o.nextZ.prevZ=o.prevZ)}function m_(o,r,s){return{i:o,x:r,y:s,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class Pc{constructor(r,s){if(s>r)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=r,this._minGranularity=s}getGranularityForZoomLevel(r){return Math.max(Math.floor(this._baseZoomGranularity/(1<<r)),this._minGranularity,1)}}class tf{constructor(r){this.fill=r.fill,this.line=r.line,this.tile=r.tile,this.stencil=r.stencil,this.circle=r.circle}}tf.noSubdivision=new tf({fill:new Pc(0,0),line:new Pc(0,0),tile:new Pc(0,0),stencil:new Pc(0,0),circle:1}),nt("SubdivisionGranularityExpression",Pc),nt("SubdivisionGranularitySetting",tf);const Cc=-32768,Fh=32767;class EP{constructor(r,s){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=r,this._granularityCellSize=St/r,this._canonical=s}_getKey(r,s){return(r+=32768)<<16|(s+=32768)<<0}_vertexToIndex(r,s){if(r<-32768||s<-32768||r>32767||s>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const l=0|Math.round(r),d=0|Math.round(s),_=this._getKey(l,d);if(this._vertexDictionary.has(_))return this._vertexDictionary.get(_);const y=this._vertexBuffer.length/2;return this._vertexDictionary.set(_,y),this._vertexBuffer.push(l,d),y}_subdivideTrianglesScanline(r){if(this._granularity<2)return function(d,_){const y=[];for(let w=0;w<_.length;w+=3){const T=_[w],C=_[w+1],M=_[w+2],I=d[2*T],D=d[2*T+1];(d[2*C]-I)*(d[2*M+1]-D)-(d[2*C+1]-D)*(d[2*M]-I)>0?(y.push(T),y.push(M),y.push(C)):(y.push(T),y.push(C),y.push(M))}return y}(this._vertexBuffer,r);const s=[],l=r.length;for(let d=0;d<l;d+=3){const _=[r[d+0],r[d+1],r[d+2]],y=[this._vertexBuffer[2*r[d+0]+0],this._vertexBuffer[2*r[d+0]+1],this._vertexBuffer[2*r[d+1]+0],this._vertexBuffer[2*r[d+1]+1],this._vertexBuffer[2*r[d+2]+0],this._vertexBuffer[2*r[d+2]+1]];let w=1/0,T=1/0,C=-1/0,M=-1/0;for(let $=0;$<3;$++){const q=y[2*$],ne=y[2*$+1];w=Math.min(w,q),C=Math.max(C,q),T=Math.min(T,ne),M=Math.max(M,ne)}if(w===C||T===M)continue;const I=Math.floor(w/this._granularityCellSize),D=Math.ceil(C/this._granularityCellSize),B=Math.floor(T/this._granularityCellSize),O=Math.ceil(M/this._granularityCellSize);if(I!==D||B!==O)for(let $=B;$<O;$++){const q=this._scanlineGenerateVertexRingForCellRow($,y,_);MP(this._vertexBuffer,q,s)}else s.push(..._)}return s}_scanlineGenerateVertexRingForCellRow(r,s,l){const d=r*this._granularityCellSize,_=d+this._granularityCellSize,y=[];for(let w=0;w<3;w++){const T=s[2*w],C=s[2*w+1],M=s[2*(w+1)%6],I=s[(2*(w+1)+1)%6],D=s[2*(w+2)%6],B=s[(2*(w+2)+1)%6],O=M-T,$=I-C,q=O===0,ne=$===0,me=(d-C)/$,ae=(_-C)/$,F=Math.min(me,ae),Z=Math.max(me,ae);if(!ne&&(F>=1||Z<=0)||ne&&(C<d||C>_)){I>=d&&I<=_&&y.push(l[(w+1)%3]);continue}!ne&&F>0&&y.push(this._vertexToIndex(T+O*F,C+$*F));const ce=T+O*Math.max(F,0),Ce=T+O*Math.min(Z,1);q||this._generateIntraEdgeVertices(y,T,C,M,I,ce,Ce),!ne&&Z<1&&y.push(this._vertexToIndex(T+O*Z,C+$*Z)),(ne||I>=d&&I<=_)&&y.push(l[(w+1)%3]),!ne&&(I<=d||I>=_)&&this._generateInterEdgeVertices(y,T,C,M,I,D,B,Ce,d,_)}return y}_generateIntraEdgeVertices(r,s,l,d,_,y,w){const T=d-s,C=_-l,M=C===0,I=M?Math.min(s,d):Math.min(y,w),D=M?Math.max(s,d):Math.max(y,w),B=Math.floor(I/this._granularityCellSize)+1,O=Math.ceil(D/this._granularityCellSize)-1;if(M?s<d:y<w)for(let $=B;$<=O;$++){const q=$*this._granularityCellSize;r.push(this._vertexToIndex(q,l+C*(q-s)/T))}else for(let $=O;$>=B;$--){const q=$*this._granularityCellSize;r.push(this._vertexToIndex(q,l+C*(q-s)/T))}}_generateInterEdgeVertices(r,s,l,d,_,y,w,T,C,M){const I=_-l,D=y-d,B=w-_,O=(C-_)/B,$=(M-_)/B,q=Math.min(O,$),ne=Math.max(O,$),me=d+D*q;let ae=Math.floor(Math.min(me,T)/this._granularityCellSize)+1,F=Math.ceil(Math.max(me,T)/this._granularityCellSize)-1,Z=T<me;const ce=B===0;if(ce&&(w===C||w===M))return;if(ce||q>=1||ne<=0){const Ze=l-w,Ie=y+(s-y)*Math.min((C-w)/Ze,(M-w)/Ze);ae=Math.floor(Math.min(Ie,T)/this._granularityCellSize)+1,F=Math.ceil(Math.max(Ie,T)/this._granularityCellSize)-1,Z=T<Ie}const Ce=I>0?M:C;if(Z)for(let Ze=ae;Ze<=F;Ze++)r.push(this._vertexToIndex(Ze*this._granularityCellSize,Ce));else for(let Ze=F;Ze>=ae;Ze--)r.push(this._vertexToIndex(Ze*this._granularityCellSize,Ce))}_generateOutline(r){const s=[];for(const l of r){const d=ll(l,this._granularity,!0),_=this._pointArrayToIndices(d),y=[];for(let w=1;w<_.length;w++)y.push(_[w-1]),y.push(_[w]);s.push(y)}return s}_handlePoles(r){let s=!1,l=!1;this._canonical&&(this._canonical.y===0&&(s=!0),this._canonical.y===(1<<this._canonical.z)-1&&(l=!0)),(s||l)&&this._fillPoles(r,s,l)}_ensureNoPoleVertices(){const r=this._vertexBuffer;for(let s=0;s<r.length;s+=2){const l=r[s+1];l===Cc&&(r[s+1]=-32767),l===Fh&&(r[s+1]=32766)}}_generatePoleQuad(r,s,l,d,_,y){d>_!=(y===Cc)?(r.push(s),r.push(l),r.push(this._vertexToIndex(d,y)),r.push(l),r.push(this._vertexToIndex(_,y)),r.push(this._vertexToIndex(d,y))):(r.push(l),r.push(s),r.push(this._vertexToIndex(d,y)),r.push(this._vertexToIndex(_,y)),r.push(l),r.push(this._vertexToIndex(d,y)))}_fillPoles(r,s,l){const d=this._vertexBuffer,_=St,y=r.length;for(let w=2;w<y;w+=3){const T=r[w-2],C=r[w-1],M=r[w],I=d[2*T],D=d[2*T+1],B=d[2*C],O=d[2*C+1],$=d[2*M],q=d[2*M+1];s&&(D===0&&O===0&&this._generatePoleQuad(r,T,C,I,B,Cc),O===0&&q===0&&this._generatePoleQuad(r,C,M,B,$,Cc),q===0&&D===0&&this._generatePoleQuad(r,M,T,$,I,Cc)),l&&(D===_&&O===_&&this._generatePoleQuad(r,T,C,I,B,Fh),O===_&&q===_&&this._generatePoleQuad(r,C,M,B,$,Fh),q===_&&D===_&&this._generatePoleQuad(r,M,T,$,I,Fh))}}_initializeVertices(r){for(let s=0;s<r.length;s+=2)this._vertexToIndex(r[s],r[s+1])}subdividePolygonInternal(r,s){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:l,holeIndices:d}=function(w){const T=[],C=[];for(const M of w)if(M.length!==0){M!==w[0]&&T.push(C.length/2);for(let I=0;I<M.length;I++)C.push(M[I].x),C.push(M[I].y)}return{flattened:C,holeIndices:T}}(r);let _;this._initializeVertices(l);try{const w=function(C,M,I=2){const D=M&&M.length,B=D?M[0]*I:C.length;let O=gx(C,0,B,I,!0);const $=[];if(!O||O.next===O.prev)return $;let q,ne,me;if(D&&(O=function(ae,F,Z,ce){const Ce=[];for(let Ze=0,Ie=F.length;Ze<Ie;Ze++){const Re=gx(ae,F[Ze]*ce,Ze<Ie-1?F[Ze+1]*ce:ae.length,ce,!1);Re===Re.next&&(Re.steiner=!0),Ce.push(PP(Re))}Ce.sort(wP);for(let Ze=0;Ze<Ce.length;Ze++)Z=SP(Ce[Ze],Z);return Z}(C,M,O,I)),C.length>80*I){q=1/0,ne=1/0;let ae=-1/0,F=-1/0;for(let Z=I;Z<B;Z+=I){const ce=C[Z],Ce=C[Z+1];ce<q&&(q=ce),Ce<ne&&(ne=Ce),ce>ae&&(ae=ce),Ce>F&&(F=Ce)}me=Math.max(ae-q,F-ne),me=me!==0?32767/me:0}return zh(O,$,I,q,ne,me,0),$}(l,d),T=this._convertIndices(l,w);_=this._subdivideTrianglesScanline(T)}catch(w){console.error(w)}let y=[];return s&&(y=this._generateOutline(r)),this._ensureNoPoleVertices(),this._handlePoles(_),{verticesFlattened:this._vertexBuffer,indicesTriangles:_,indicesLineList:y}}_convertIndices(r,s){const l=[];for(let d=0;d<s.length;d++)l.push(this._vertexToIndex(r[2*s[d]],r[2*s[d]+1]));return l}_pointArrayToIndices(r){const s=[];for(let l=0;l<r.length;l++){const d=r[l];s.push(this._vertexToIndex(d.x,d.y))}return s}}function bx(o,r,s,l=!0){return new EP(s,r).subdividePolygonInternal(o,l)}function ll(o,r,s=!1){if(!o||o.length<1)return[];if(o.length<2)return[];const l=o[0],d=o[o.length-1],_=s&&(l.x!==d.x||l.y!==d.y);if(r<2)return _?[...o,o[0]]:[...o];const y=Math.floor(St/r),w=[];w.push(new le(o[0].x,o[0].y));const T=o.length,C=_?T:T-1;for(let M=0;M<C;M++){const I=o[M],D=M<T-1?o[M+1]:o[0],B=I.x,O=I.y,$=D.x,q=D.y,ne=B!==$,me=O!==q;if(!ne&&!me)continue;const ae=$-B,F=q-O,Z=Math.abs(ae),ce=Math.abs(F);let Ce=B,Ze=O;for(;;){const Re=ae>0?(Math.floor(Ce/y)+1)*y:(Math.ceil(Ce/y)-1)*y,He=F>0?(Math.floor(Ze/y)+1)*y:(Math.ceil(Ze/y)-1)*y,qe=Math.abs(Ce-Re),Xe=Math.abs(Ze-He),Ne=Math.abs(Ce-$),it=Math.abs(Ze-q),vt=ne?qe/Z:Number.POSITIVE_INFINITY,yt=me?Xe/ce:Number.POSITIVE_INFINITY;if((Ne<=qe||!ne)&&(it<=Xe||!me))break;if(vt<yt&&ne||!me){Ce=Re,Ze+=F*vt;const ct=new le(Ce,Math.round(Ze));w[w.length-1].x===ct.x&&w[w.length-1].y===ct.y||w.push(ct)}else{Ce+=ae*yt,Ze=He;const ct=new le(Math.round(Ce),Ze);w[w.length-1].x===ct.x&&w[w.length-1].y===ct.y||w.push(ct)}}const Ie=new le($,q);w[w.length-1].x===Ie.x&&w[w.length-1].y===Ie.y||w.push(Ie)}return w}function MP(o,r,s){if(r.length===0)throw new Error("Subdivision vertex ring is empty.");let l=0,d=o[2*r[0]];for(let T=1;T<r.length;T++){const C=o[2*r[T]];C<d&&(d=C,l=T)}const _=r.length;let y=l,w=(y+1)%_;for(;;){const T=y-1>=0?y-1:_-1,C=(w+1)%_,M=o[2*r[T]],I=o[2*r[C]],D=o[2*r[y]],B=o[2*r[y]+1],O=o[2*r[w]+1];let $=!1;if(M<I)$=!0;else if(M>I)$=!1;else{const q=O-B,ne=-(o[2*r[w]]-D),me=B<O?1:-1;((M-D)*q+(o[2*r[T]+1]-B)*ne)*me>((I-D)*q+(o[2*r[C]+1]-B)*ne)*me&&($=!0)}if($){const q=r[T],ne=r[y],me=r[w];q!==ne&&q!==me&&ne!==me&&s.push(me,ne,q),y--,y<0&&(y=_-1)}else{const q=r[C],ne=r[y],me=r[w];q!==ne&&q!==me&&ne!==me&&s.push(me,ne,q),w++,w>=_&&(w=0)}if(T===C)break}}function wx(o,r,s,l,d,_,y,w,T){const C=d.length/2,M=y&&w&&T;if(C<mt.MAX_VERTEX_ARRAY_LENGTH){const I=r.prepareSegment(C,s,l),D=I.vertexLength;for(let $=0;$<_.length;$+=3)l.emplaceBack(D+_[$],D+_[$+1],D+_[$+2]);let B,O;I.vertexLength+=C,I.primitiveLength+=_.length/3,M&&(O=y.prepareSegment(C,s,w),B=O.vertexLength,O.vertexLength+=C);for(let $=0;$<d.length;$+=2)o(d[$],d[$+1]);if(M)for(let $=0;$<T.length;$++){const q=T[$];for(let ne=1;ne<q.length;ne+=2)w.emplaceBack(B+q[ne-1],B+q[ne]);O.primitiveLength+=q.length/2}}else(function(I,D,B,O,$,q){const ne=[];for(let ce=0;ce<O.length/2;ce++)ne.push(-1);const me={count:0};let ae=0,F=I.getOrCreateLatestSegment(D,B),Z=F.vertexLength;for(let ce=2;ce<$.length;ce+=3){const Ce=$[ce-2],Ze=$[ce-1],Ie=$[ce];let Re=ne[Ce]<ae,He=ne[Ze]<ae,qe=ne[Ie]<ae;F.vertexLength+((Re?1:0)+(He?1:0)+(qe?1:0))>mt.MAX_VERTEX_ARRAY_LENGTH&&(F=I.createNewSegment(D,B),ae=me.count,Re=!0,He=!0,qe=!0,Z=0);const Xe=Bh(ne,O,q,me,Ce,Re,F),Ne=Bh(ne,O,q,me,Ze,He,F),it=Bh(ne,O,q,me,Ie,qe,F);B.emplaceBack(Z+Xe-ae,Z+Ne-ae,Z+it-ae),F.primitiveLength++}})(r,s,l,d,_,o),M&&function(I,D,B,O,$,q){const ne=[];for(let ce=0;ce<O.length/2;ce++)ne.push(-1);const me={count:0};let ae=0,F=I.getOrCreateLatestSegment(D,B),Z=F.vertexLength;for(let ce=0;ce<$.length;ce++){const Ce=$[ce];for(let Ze=1;Ze<$[ce].length;Ze+=2){const Ie=Ce[Ze-1],Re=Ce[Ze];let He=ne[Ie]<ae,qe=ne[Re]<ae;F.vertexLength+((He?1:0)+(qe?1:0))>mt.MAX_VERTEX_ARRAY_LENGTH&&(F=I.createNewSegment(D,B),ae=me.count,He=!0,qe=!0,Z=0);const Xe=Bh(ne,O,q,me,Ie,He,F),Ne=Bh(ne,O,q,me,Re,qe,F);B.emplaceBack(Z+Xe-ae,Z+Ne-ae),F.primitiveLength++}}}(y,s,w,d,T,o),r.forceNewSegmentOnNextPrepare(),y==null||y.forceNewSegmentOnNextPrepare()}function Bh(o,r,s,l,d,_,y){if(_){const w=l.count;return s(r[2*d],r[2*d+1]),o[d]=l.count,l.count++,y.vertexLength++,w}return o[d]}class g_{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(s=>s.id),this.index=r.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new ue,this.indexArray=new Qe,this.indexArray2=new Ke,this.programConfigurations=new ws(r.layers,r.zoom),this.segments=new mt,this.segments2=new mt,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(r,s,l){this.hasPattern=d_("fill",this.layers,s);const d=this.layers[0].layout.get("fill-sort-key"),_=!d.isConstant(),y=[];for(const{feature:w,id:T,index:C,sourceLayerIndex:M}of r){const I=this.layers[0]._featureFilter.needGeometry,D=Kn(w,I);if(!this.layers[0]._featureFilter.filter(new ar(this.zoom),D,l))continue;const B=_?d.evaluate(D,{},l,s.availableImages):void 0,O={id:T,properties:w.properties,type:w.type,sourceLayerIndex:M,index:C,geometry:I?D.geometry:Ss(w),patterns:{},sortKey:B};y.push(O)}_&&y.sort((w,T)=>w.sortKey-T.sortKey);for(const w of y){const{geometry:T,index:C,sourceLayerIndex:M}=w;if(this.hasPattern){const I=p_("fill",this.layers,w,this.zoom,s);this.patternFeatures.push(I)}else this.addFeature(w,T,C,l,{},s.subdivisionGranularity);s.featureIndex.insert(r[C].feature,T,C,M,this.index)}}update(r,s,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,s,this.stateDependentLayers,l)}addFeatures(r,s,l){for(const d of this.patternFeatures)this.addFeature(d,d.geometry,d.index,s,l,r.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,_P),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.indexBuffer2=r.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(r,s,l,d,_,y){for(const w of Ul(s,500)){const T=bx(w,d,y.fill.getGranularityForZoomLevel(d.z)),C=this.layoutVertexArray;wx((M,I)=>{C.emplaceBack(M,I)},this.segments,this.layoutVertexArray,this.indexArray,T.verticesFlattened,T.indicesTriangles,this.segments2,this.indexArray2,T.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,l,_,d)}}let Sx,Tx;nt("FillBucket",g_,{omit:["layers","patternFeatures"]});var IP={get paint(){return Tx=Tx||new On({"fill-antialias":new pt(z.paint_fill["fill-antialias"]),"fill-opacity":new xt(z.paint_fill["fill-opacity"]),"fill-color":new xt(z.paint_fill["fill-color"]),"fill-outline-color":new xt(z.paint_fill["fill-outline-color"]),"fill-translate":new pt(z.paint_fill["fill-translate"]),"fill-translate-anchor":new pt(z.paint_fill["fill-translate-anchor"]),"fill-pattern":new il(z.paint_fill["fill-pattern"])})},get layout(){return Sx=Sx||new On({"fill-sort-key":new xt(z.layout_fill["fill-sort-key"])})}};class kP extends Gi{constructor(r){super(r,IP)}recalculate(r,s){super.recalculate(r,s);const l=this.paint._values["fill-outline-color"];l.value.kind==="constant"&&l.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(r){return new g_(r)}queryRadius(){return Yp(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:r,geometry:s,transform:l,pixelsToTileUnits:d}){return wc(Qp(r,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-l.bearingInRadians,d),s)}isTileClipped(){return!0}}const AP=Mr([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),zP=Mr([{name:"a_centroid",components:2,type:"Int16"}],4),{members:RP}=AP;var __,Px,y_,Cx,v_,Ex,Mx,rf={};function Ix(){if(Px)return __;Px=1;var o=Q();function r(d,_,y,w,T){this.properties={},this.extent=y,this.type=0,this._pbf=d,this._geometry=-1,this._keys=w,this._values=T,d.readFields(s,this,_)}function s(d,_,y){d==1?_.id=y.readVarint():d==2?function(w,T){for(var C=w.readVarint()+w.pos;w.pos<C;){var M=T._keys[w.readVarint()],I=T._values[w.readVarint()];T.properties[M]=I}}(y,_):d==3?_.type=y.readVarint():d==4&&(_._geometry=y.pos)}function l(d){for(var _,y,w=0,T=0,C=d.length,M=C-1;T<C;M=T++)w+=((y=d[M]).x-(_=d[T]).x)*(_.y+y.y);return w}return __=r,r.types=["Unknown","Point","LineString","Polygon"],r.prototype.loadGeometry=function(){var d=this._pbf;d.pos=this._geometry;for(var _,y=d.readVarint()+d.pos,w=1,T=0,C=0,M=0,I=[];d.pos<y;){if(T<=0){var D=d.readVarint();w=7&D,T=D>>3}if(T--,w===1||w===2)C+=d.readSVarint(),M+=d.readSVarint(),w===1&&(_&&I.push(_),_=[]),_.push(new o(C,M));else{if(w!==7)throw new Error("unknown command "+w);_&&_.push(_[0].clone())}}return _&&I.push(_),I},r.prototype.bbox=function(){var d=this._pbf;d.pos=this._geometry;for(var _=d.readVarint()+d.pos,y=1,w=0,T=0,C=0,M=1/0,I=-1/0,D=1/0,B=-1/0;d.pos<_;){if(w<=0){var O=d.readVarint();y=7&O,w=O>>3}if(w--,y===1||y===2)(T+=d.readSVarint())<M&&(M=T),T>I&&(I=T),(C+=d.readSVarint())<D&&(D=C),C>B&&(B=C);else if(y!==7)throw new Error("unknown command "+y)}return[M,D,I,B]},r.prototype.toGeoJSON=function(d,_,y){var w,T,C=this.extent*Math.pow(2,y),M=this.extent*d,I=this.extent*_,D=this.loadGeometry(),B=r.types[this.type];function O(ne){for(var me=0;me<ne.length;me++){var ae=ne[me];ne[me]=[360*(ae.x+M)/C-180,360/Math.PI*Math.atan(Math.exp((180-360*(ae.y+I)/C)*Math.PI/180))-90]}}switch(this.type){case 1:var $=[];for(w=0;w<D.length;w++)$[w]=D[w][0];O(D=$);break;case 2:for(w=0;w<D.length;w++)O(D[w]);break;case 3:for(D=function(ne){var me=ne.length;if(me<=1)return[ne];for(var ae,F,Z=[],ce=0;ce<me;ce++){var Ce=l(ne[ce]);Ce!==0&&(F===void 0&&(F=Ce<0),F===Ce<0?(ae&&Z.push(ae),ae=[ne[ce]]):ae.push(ne[ce]))}return ae&&Z.push(ae),Z}(D),w=0;w<D.length;w++)for(T=0;T<D[w].length;T++)O(D[w][T])}D.length===1?D=D[0]:B="Multi"+B;var q={type:"Feature",geometry:{type:B,coordinates:D},properties:this.properties};return"id"in this&&(q.id=this.id),q},__}function kx(){if(Cx)return y_;Cx=1;var o=Ix();function r(l,d){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=l,this._keys=[],this._values=[],this._features=[],l.readFields(s,this,d),this.length=this._features.length}function s(l,d,_){l===15?d.version=_.readVarint():l===1?d.name=_.readString():l===5?d.extent=_.readVarint():l===2?d._features.push(_.pos):l===3?d._keys.push(_.readString()):l===4&&d._values.push(function(y){for(var w=null,T=y.readVarint()+y.pos;y.pos<T;){var C=y.readVarint()>>3;w=C===1?y.readString():C===2?y.readFloat():C===3?y.readDouble():C===4?y.readVarint64():C===5?y.readVarint():C===6?y.readSVarint():C===7?y.readBoolean():null}return w}(_))}return y_=r,r.prototype.feature=function(l){if(l<0||l>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[l];var d=this._pbf.readVarint()+this._pbf.pos;return new o(this._pbf,d,this.extent,this._keys,this._values)},y_}function Ax(){return Mx||(Mx=1,rf.VectorTile=function(){if(Ex)return v_;Ex=1;var o=kx();function r(s,l,d){if(s===3){var _=new o(d,d.readVarint()+d.pos);_.length&&(l[_.name]=_)}}return v_=function(s,l){this.layers=s.readFields(r,{},l)},v_}(),rf.VectorTileFeature=Ix(),rf.VectorTileLayer=kx()),rf}var Oh=A(Ax());const LP=Oh.VectorTileFeature.types,x_=Math.pow(2,13);function jh(o,r,s,l,d,_,y,w){o.emplaceBack(r,s,2*Math.floor(l*x_)+y,d*x_*2,_*x_*2,Math.round(w))}class b_{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(s=>s.id),this.index=r.index,this.hasPattern=!1,this.layoutVertexArray=new he,this.centroidVertexArray=new te,this.indexArray=new Qe,this.programConfigurations=new ws(r.layers,r.zoom),this.segments=new mt,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(r,s,l){this.features=[],this.hasPattern=d_("fill-extrusion",this.layers,s);for(const{feature:d,id:_,index:y,sourceLayerIndex:w}of r){const T=this.layers[0]._featureFilter.needGeometry,C=Kn(d,T);if(!this.layers[0]._featureFilter.filter(new ar(this.zoom),C,l))continue;const M={id:_,sourceLayerIndex:w,index:y,geometry:T?C.geometry:Ss(d),properties:d.properties,type:d.type,patterns:{}};this.hasPattern?this.features.push(p_("fill-extrusion",this.layers,M,this.zoom,s)):this.addFeature(M,M.geometry,y,l,{},s.subdivisionGranularity),s.featureIndex.insert(d,M.geometry,y,w,this.index,!0)}}addFeatures(r,s,l){for(const d of this.features){const{geometry:_}=d;this.addFeature(d,_,d.index,s,l,r.subdivisionGranularity)}}update(r,s,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,s,this.stateDependentLayers,l)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,RP),this.centroidVertexBuffer=r.createVertexBuffer(this.centroidVertexArray,zP.members,!0),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(r,s,l,d,_,y){for(const w of Ul(s,500)){const T={x:0,y:0,sampleCount:0},C=this.layoutVertexArray.length;this.processPolygon(T,d,r,w,y);const M=this.layoutVertexArray.length-C,I=Math.floor(T.x/T.sampleCount),D=Math.floor(T.y/T.sampleCount);for(let B=0;B<M;B++)this.centroidVertexArray.emplaceBack(I,D)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,l,_,d)}processPolygon(r,s,l,d,_){if(d.length<1||zx(d[0]))return;for(const I of d)I.length!==0&&DP(r,I);const y={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},w=_.fill.getGranularityForZoomLevel(s.z),T=LP[l.type]==="Polygon";for(const I of d){if(I.length===0||zx(I))continue;const D=ll(I,w,T);this._generateSideFaces(D,y)}if(!T)return;const C=bx(d,s,w,!1),M=this.layoutVertexArray;wx((I,D)=>{jh(M,I,D,0,0,1,1,0)},this.segments,this.layoutVertexArray,this.indexArray,C.verticesFlattened,C.indicesTriangles)}_generateSideFaces(r,s){let l=0;for(let d=1;d<r.length;d++){const _=r[d],y=r[d-1];if(FP(_,y))continue;s.segment.vertexLength+4>mt.MAX_VERTEX_ARRAY_LENGTH&&(s.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const w=_.sub(y)._perp()._unit(),T=y.dist(_);l+T>32768&&(l=0),jh(this.layoutVertexArray,_.x,_.y,w.x,w.y,0,0,l),jh(this.layoutVertexArray,_.x,_.y,w.x,w.y,0,1,l),l+=T,jh(this.layoutVertexArray,y.x,y.y,w.x,w.y,0,0,l),jh(this.layoutVertexArray,y.x,y.y,w.x,w.y,0,1,l);const C=s.segment.vertexLength;this.indexArray.emplaceBack(C,C+2,C+1),this.indexArray.emplaceBack(C+1,C+2,C+3),s.segment.vertexLength+=4,s.segment.primitiveLength+=2}}}function DP(o,r){for(let s=0;s<r.length;s++){const l=r[s];s===r.length-1&&r[0].x===l.x&&r[0].y===l.y||(o.x+=l.x,o.y+=l.y,o.sampleCount++)}}function FP(o,r){return o.x===r.x&&(o.x<0||o.x>St)||o.y===r.y&&(o.y<0||o.y>St)}function zx(o){return o.every(r=>r.x<0)||o.every(r=>r.x>St)||o.every(r=>r.y<0)||o.every(r=>r.y>St)}let Rx;nt("FillExtrusionBucket",b_,{omit:["layers","features"]});var BP={get paint(){return Rx=Rx||new On({"fill-extrusion-opacity":new pt(z["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new xt(z["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new pt(z["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new pt(z["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new il(z["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new xt(z["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new xt(z["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new pt(z["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class OP extends Gi{constructor(r){super(r,BP)}createBucket(r){return new b_(r)}queryRadius(){return Yp(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:r,feature:s,featureState:l,geometry:d,transform:_,pixelsToTileUnits:y,pixelPosMatrix:w}){const T=Qp(r,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-_.bearingInRadians,y),C=this.paint.get("fill-extrusion-height").evaluate(s,l),M=this.paint.get("fill-extrusion-base").evaluate(s,l),I=function(B,O,$){const q=[];for(const ne of B){const me=[ne.x,ne.y,0,1];at(me,me,O),q.push(new le(me[0]/me[3],me[1]/me[3]))}return q}(T,w),D=function(B,O,$,q){const ne=[],me=[],ae=q[8]*O,F=q[9]*O,Z=q[10]*O,ce=q[11]*O,Ce=q[8]*$,Ze=q[9]*$,Ie=q[10]*$,Re=q[11]*$;for(const He of B){const qe=[],Xe=[];for(const Ne of He){const it=Ne.x,vt=Ne.y,yt=q[0]*it+q[4]*vt+q[12],ct=q[1]*it+q[5]*vt+q[13],zt=q[2]*it+q[6]*vt+q[14],yr=q[3]*it+q[7]*vt+q[15],Gr=zt+Z,xn=yr+ce,Ei=yt+Ce,Qn=ct+Ze,hn=zt+Ie,dr=yr+Re,tn=new le((yt+ae)/xn,(ct+F)/xn);tn.z=Gr/xn,qe.push(tn);const dn=new le(Ei/dr,Qn/dr);dn.z=hn/dr,Xe.push(dn)}ne.push(qe),me.push(Xe)}return[ne,me]}(d,M,C,w);return function(B,O,$){let q=1/0;wc($,O)&&(q=Lx($,O[0]));for(let ne=0;ne<O.length;ne++){const me=O[ne],ae=B[ne];for(let F=0;F<me.length-1;F++){const Z=me[F],ce=[Z,me[F+1],ae[F+1],ae[F],Z];bc($,ce)&&(q=Math.min(q,Lx($,ce)))}}return q!==1/0&&q}(D[0],D[1],I)}}function Nh(o,r){return o.x*r.x+o.y*r.y}function Lx(o,r){if(o.length===1){let s=0;const l=r[s++];let d;for(;!d||l.equals(d);)if(d=r[s++],!d)return 1/0;for(;s<r.length;s++){const _=r[s],y=o[0],w=d.sub(l),T=_.sub(l),C=y.sub(l),M=Nh(w,w),I=Nh(w,T),D=Nh(T,T),B=Nh(C,w),O=Nh(C,T),$=M*D-I*I,q=(D*B-I*O)/$,ne=(M*O-I*B)/$,me=l.z*(1-q-ne)+d.z*q+_.z*ne;if(isFinite(me))return me}return 1/0}{let s=1/0;for(const l of r)s=Math.min(s,l.z);return s}}const jP=Mr([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:NP}=jP,$P=Mr([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:VP}=$P,UP=Oh.VectorTileFeature.types,ZP=Math.cos(Math.PI/180*37.5),Dx=Math.pow(2,14)/.5;class w_{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(s=>s.id),this.index=r.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(s=>{this.gradients[s.id]={}}),this.layoutVertexArray=new pe,this.layoutVertexArray2=new ge,this.indexArray=new Qe,this.programConfigurations=new ws(r.layers,r.zoom),this.segments=new mt,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(r,s,l){this.hasPattern=d_("line",this.layers,s);const d=this.layers[0].layout.get("line-sort-key"),_=!d.isConstant(),y=[];for(const{feature:w,id:T,index:C,sourceLayerIndex:M}of r){const I=this.layers[0]._featureFilter.needGeometry,D=Kn(w,I);if(!this.layers[0]._featureFilter.filter(new ar(this.zoom),D,l))continue;const B=_?d.evaluate(D,{},l):void 0,O={id:T,properties:w.properties,type:w.type,sourceLayerIndex:M,index:C,geometry:I?D.geometry:Ss(w),patterns:{},sortKey:B};y.push(O)}_&&y.sort((w,T)=>w.sortKey-T.sortKey);for(const w of y){const{geometry:T,index:C,sourceLayerIndex:M}=w;if(this.hasPattern){const I=p_("line",this.layers,w,this.zoom,s);this.patternFeatures.push(I)}else this.addFeature(w,T,C,l,{},s.subdivisionGranularity);s.featureIndex.insert(r[C].feature,T,C,M,this.index)}}update(r,s,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,s,this.stateDependentLayers,l)}addFeatures(r,s,l){for(const d of this.patternFeatures)this.addFeature(d,d.geometry,d.index,s,l,r.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=r.createVertexBuffer(this.layoutVertexArray2,VP)),this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,NP),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(r){if(r.properties&&Object.prototype.hasOwnProperty.call(r.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(r.properties,"mapbox_clip_end"))return{start:+r.properties.mapbox_clip_start,end:+r.properties.mapbox_clip_end}}addFeature(r,s,l,d,_,y){const w=this.layers[0].layout,T=w.get("line-join").evaluate(r,{}),C=w.get("line-cap"),M=w.get("line-miter-limit"),I=w.get("line-round-limit");this.lineClips=this.lineFeatureClips(r);for(const D of s)this.addLine(D,r,T,C,M,I,d,y);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,l,_,d)}addLine(r,s,l,d,_,y,w,T){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,r=ll(r,w?T.line.getGranularityForZoomLevel(w.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ae=0;ae<r.length-1;ae++)this.totalDistance+=r[ae].dist(r[ae+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const C=UP[s.type]==="Polygon";let M=r.length;for(;M>=2&&r[M-1].equals(r[M-2]);)M--;let I=0;for(;I<M-1&&r[I].equals(r[I+1]);)I++;if(M<(C?3:2))return;l==="bevel"&&(_=1.05);const D=this.overscaling<=16?15*St/(512*this.overscaling):0,B=this.segments.prepareSegment(10*M,this.layoutVertexArray,this.indexArray);let O,$,q,ne,me;this.e1=this.e2=-1,C&&(O=r[M-2],me=r[I].sub(O)._unit()._perp());for(let ae=I;ae<M;ae++){if(q=ae===M-1?C?r[I+1]:void 0:r[ae+1],q&&r[ae].equals(q))continue;me&&(ne=me),O&&($=O),O=r[ae],me=q?q.sub(O)._unit()._perp():ne,ne=ne||me;let F=ne.add(me);F.x===0&&F.y===0||F._unit();const Z=ne.x*me.x+ne.y*me.y,ce=F.x*me.x+F.y*me.y,Ce=ce!==0?1/ce:1/0,Ze=2*Math.sqrt(2-2*ce),Ie=ce<ZP&&$&&q,Re=ne.x*me.y-ne.y*me.x>0;if(Ie&&ae>I){const Xe=O.dist($);if(Xe>2*D){const Ne=O.sub(O.sub($)._mult(D/Xe)._round());this.updateDistance($,Ne),this.addCurrentVertex(Ne,ne,0,0,B),$=Ne}}const He=$&&q;let qe=He?l:C?"butt":d;if(He&&qe==="round"&&(Ce<y?qe="miter":Ce<=2&&(qe="fakeround")),qe==="miter"&&Ce>_&&(qe="bevel"),qe==="bevel"&&(Ce>2&&(qe="flipbevel"),Ce<_&&(qe="miter")),$&&this.updateDistance($,O),qe==="miter")F._mult(Ce),this.addCurrentVertex(O,F,0,0,B);else if(qe==="flipbevel"){if(Ce>100)F=me.mult(-1);else{const Xe=Ce*ne.add(me).mag()/ne.sub(me).mag();F._perp()._mult(Xe*(Re?-1:1))}this.addCurrentVertex(O,F,0,0,B),this.addCurrentVertex(O,F.mult(-1),0,0,B)}else if(qe==="bevel"||qe==="fakeround"){const Xe=-Math.sqrt(Ce*Ce-1),Ne=Re?Xe:0,it=Re?0:Xe;if($&&this.addCurrentVertex(O,ne,Ne,it,B),qe==="fakeround"){const vt=Math.round(180*Ze/Math.PI/20);for(let yt=1;yt<vt;yt++){let ct=yt/vt;if(ct!==.5){const yr=ct-.5;ct+=ct*yr*(ct-1)*((1.0904+Z*(Z*(3.55645-1.43519*Z)-3.2452))*yr*yr+(.848013+Z*(.215638*Z-1.06021)))}const zt=me.sub(ne)._mult(ct)._add(ne)._unit()._mult(Re?-1:1);this.addHalfVertex(O,zt.x,zt.y,!1,Re,0,B)}}q&&this.addCurrentVertex(O,me,-Ne,-it,B)}else if(qe==="butt")this.addCurrentVertex(O,F,0,0,B);else if(qe==="square"){const Xe=$?1:-1;this.addCurrentVertex(O,F,Xe,Xe,B)}else qe==="round"&&($&&(this.addCurrentVertex(O,ne,0,0,B),this.addCurrentVertex(O,ne,1,1,B,!0)),q&&(this.addCurrentVertex(O,me,-1,-1,B,!0),this.addCurrentVertex(O,me,0,0,B)));if(Ie&&ae<M-1){const Xe=O.dist(q);if(Xe>2*D){const Ne=O.add(q.sub(O)._mult(D/Xe)._round());this.updateDistance(O,Ne),this.addCurrentVertex(Ne,me,0,0,B),O=Ne}}}}addCurrentVertex(r,s,l,d,_,y=!1){const w=s.y*d-s.x,T=-s.y-s.x*d;this.addHalfVertex(r,s.x+s.y*l,s.y-s.x*l,y,!1,l,_),this.addHalfVertex(r,w,T,y,!0,-d,_),this.distance>Dx/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(r,s,l,d,_,y))}addHalfVertex({x:r,y:s},l,d,_,y,w,T){const C=.5*(this.lineClips?this.scaledDistance*(Dx-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((r<<1)+(_?1:0),(s<<1)+(y?1:0),Math.round(63*l)+128,Math.round(63*d)+128,1+(w===0?0:w<0?-1:1)|(63&C)<<2,C>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const M=T.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,M,this.e2),T.primitiveLength++),y?this.e2=M:this.e1=M}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(r,s){this.distance+=r.dist(s),this.updateScaledDistance()}}let Fx,Bx;nt("LineBucket",w_,{omit:["layers","patternFeatures"]});var Ox={get paint(){return Bx=Bx||new On({"line-opacity":new xt(z.paint_line["line-opacity"]),"line-color":new xt(z.paint_line["line-color"]),"line-translate":new pt(z.paint_line["line-translate"]),"line-translate-anchor":new pt(z.paint_line["line-translate-anchor"]),"line-width":new xt(z.paint_line["line-width"]),"line-gap-width":new xt(z.paint_line["line-gap-width"]),"line-offset":new xt(z.paint_line["line-offset"]),"line-blur":new xt(z.paint_line["line-blur"]),"line-dasharray":new dc(z.paint_line["line-dasharray"]),"line-pattern":new il(z.paint_line["line-pattern"]),"line-gradient":new Sh(z.paint_line["line-gradient"])})},get layout(){return Fx=Fx||new On({"line-cap":new pt(z.layout_line["line-cap"]),"line-join":new xt(z.layout_line["line-join"]),"line-miter-limit":new pt(z.layout_line["line-miter-limit"]),"line-round-limit":new pt(z.layout_line["line-round-limit"]),"line-sort-key":new xt(z.layout_line["line-sort-key"])})}};class GP extends xt{possiblyEvaluate(r,s){return s=new ar(Math.floor(s.zoom),{now:s.now,fadeDuration:s.fadeDuration,zoomHistory:s.zoomHistory,transition:s.transition}),super.possiblyEvaluate(r,s)}evaluate(r,s,l,d){return s=fr({},s,{zoom:Math.floor(s.zoom)}),super.evaluate(r,s,l,d)}}let nf;class qP extends Gi{constructor(r){super(r,Ox),this.gradientVersion=0,nf||(nf=new GP(Ox.paint.properties["line-width"].specification),nf.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(r){if(r==="line-gradient"){const s=this.gradientExpression();this.stepInterpolant=!!function(l){return l._styleExpression!==void 0}(s)&&s._styleExpression.expression instanceof Ks,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(r,s){super.recalculate(r,s),this.paint._values["line-floorwidth"]=nf.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,r)}createBucket(r){return new w_(r)}queryRadius(r){const s=r,l=jx(kh("line-width",this,s),kh("line-gap-width",this,s)),d=kh("line-offset",this,s);return l/2+Math.abs(d)+Yp(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:r,feature:s,featureState:l,geometry:d,transform:_,pixelsToTileUnits:y}){const w=Qp(r,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-_.bearingInRadians,y),T=y/2*jx(this.paint.get("line-width").evaluate(s,l),this.paint.get("line-gap-width").evaluate(s,l)),C=this.paint.get("line-offset").evaluate(s,l);return C&&(d=function(M,I){const D=[];for(let B=0;B<M.length;B++){const O=M[B],$=[];for(let q=0;q<O.length;q++){const ne=O[q-1],me=O[q],ae=O[q+1],F=q===0?new le(0,0):me.sub(ne)._unit()._perp(),Z=q===O.length-1?new le(0,0):ae.sub(me)._unit()._perp(),ce=F._add(Z)._unit(),Ce=ce.x*Z.x+ce.y*Z.y;Ce!==0&&ce._mult(1/Ce),$.push(ce._mult(I)._add(me))}D.push($)}return D}(d,C*y)),function(M,I,D){for(let B=0;B<I.length;B++){const O=I[B];if(M.length>=3){for(let $=0;$<O.length;$++)if(Sc(M,O[$]))return!0}if(aP(M,O,D))return!0}return!1}(w,d,T)}isTileClipped(){return!0}}function jx(o,r){return r>0?r+2*o:o}const WP=Mr([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),HP=Mr([{name:"a_projected_pos",components:3,type:"Float32"}],4);Mr([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const XP=Mr([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);Mr([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Nx=Mr([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),KP=Mr([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function YP(o,r,s){return o.sections.forEach(l=>{l.text=function(d,_,y){const w=_.layout.get("text-transform").evaluate(y,{});return w==="uppercase"?d=d.toLocaleUpperCase():w==="lowercase"&&(d=d.toLocaleLowerCase()),Bo.applyArabicShaping&&(d=Bo.applyArabicShaping(d)),d}(l.text,r,s)}),o}Mr([{name:"triangle",components:3,type:"Uint16"}]),Mr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Mr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),Mr([{type:"Float32",name:"offsetX"}]),Mr([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),Mr([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const $h={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var $x,S_,Vx,Zr=24,T_={};function QP(){return $x||($x=1,T_.read=function(o,r,s,l,d){var _,y,w=8*d-l-1,T=(1<<w)-1,C=T>>1,M=-7,I=s?d-1:0,D=s?-1:1,B=o[r+I];for(I+=D,_=B&(1<<-M)-1,B>>=-M,M+=w;M>0;_=256*_+o[r+I],I+=D,M-=8);for(y=_&(1<<-M)-1,_>>=-M,M+=l;M>0;y=256*y+o[r+I],I+=D,M-=8);if(_===0)_=1-C;else{if(_===T)return y?NaN:1/0*(B?-1:1);y+=Math.pow(2,l),_-=C}return(B?-1:1)*y*Math.pow(2,_-l)},T_.write=function(o,r,s,l,d,_){var y,w,T,C=8*_-d-1,M=(1<<C)-1,I=M>>1,D=d===23?Math.pow(2,-24)-Math.pow(2,-77):0,B=l?0:_-1,O=l?1:-1,$=r<0||r===0&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(w=isNaN(r)?1:0,y=M):(y=Math.floor(Math.log(r)/Math.LN2),r*(T=Math.pow(2,-y))<1&&(y--,T*=2),(r+=y+I>=1?D/T:D*Math.pow(2,1-I))*T>=2&&(y++,T/=2),y+I>=M?(w=0,y=M):y+I>=1?(w=(r*T-1)*Math.pow(2,d),y+=I):(w=r*Math.pow(2,I-1)*Math.pow(2,d),y=0));d>=8;o[s+B]=255&w,B+=O,w/=256,d-=8);for(y=y<<d|w,C+=d;C>0;o[s+B]=255&y,B+=O,y/=256,C-=8);o[s+B-O]|=128*$}),T_}function Ux(){if(Vx)return S_;Vx=1,S_=r;var o=QP();function r(F){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(F)?F:new Uint8Array(F||0),this.pos=0,this.type=0,this.length=this.buf.length}r.Varint=0,r.Fixed64=1,r.Bytes=2,r.Fixed32=5;var s=4294967296,l=1/s,d=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function _(F){return F.type===r.Bytes?F.readVarint()+F.pos:F.pos+1}function y(F,Z,ce){return ce?4294967296*Z+(F>>>0):4294967296*(Z>>>0)+(F>>>0)}function w(F,Z,ce){var Ce=Z<=16383?1:Z<=2097151?2:Z<=268435455?3:Math.floor(Math.log(Z)/(7*Math.LN2));ce.realloc(Ce);for(var Ze=ce.pos-1;Ze>=F;Ze--)ce.buf[Ze+Ce]=ce.buf[Ze]}function T(F,Z){for(var ce=0;ce<F.length;ce++)Z.writeVarint(F[ce])}function C(F,Z){for(var ce=0;ce<F.length;ce++)Z.writeSVarint(F[ce])}function M(F,Z){for(var ce=0;ce<F.length;ce++)Z.writeFloat(F[ce])}function I(F,Z){for(var ce=0;ce<F.length;ce++)Z.writeDouble(F[ce])}function D(F,Z){for(var ce=0;ce<F.length;ce++)Z.writeBoolean(F[ce])}function B(F,Z){for(var ce=0;ce<F.length;ce++)Z.writeFixed32(F[ce])}function O(F,Z){for(var ce=0;ce<F.length;ce++)Z.writeSFixed32(F[ce])}function $(F,Z){for(var ce=0;ce<F.length;ce++)Z.writeFixed64(F[ce])}function q(F,Z){for(var ce=0;ce<F.length;ce++)Z.writeSFixed64(F[ce])}function ne(F,Z){return(F[Z]|F[Z+1]<<8|F[Z+2]<<16)+16777216*F[Z+3]}function me(F,Z,ce){F[ce]=Z,F[ce+1]=Z>>>8,F[ce+2]=Z>>>16,F[ce+3]=Z>>>24}function ae(F,Z){return(F[Z]|F[Z+1]<<8|F[Z+2]<<16)+(F[Z+3]<<24)}return r.prototype={destroy:function(){this.buf=null},readFields:function(F,Z,ce){for(ce=ce||this.length;this.pos<ce;){var Ce=this.readVarint(),Ze=Ce>>3,Ie=this.pos;this.type=7&Ce,F(Ze,Z,this),this.pos===Ie&&this.skip(Ce)}return Z},readMessage:function(F,Z){return this.readFields(F,Z,this.readVarint()+this.pos)},readFixed32:function(){var F=ne(this.buf,this.pos);return this.pos+=4,F},readSFixed32:function(){var F=ae(this.buf,this.pos);return this.pos+=4,F},readFixed64:function(){var F=ne(this.buf,this.pos)+ne(this.buf,this.pos+4)*s;return this.pos+=8,F},readSFixed64:function(){var F=ne(this.buf,this.pos)+ae(this.buf,this.pos+4)*s;return this.pos+=8,F},readFloat:function(){var F=o.read(this.buf,this.pos,!0,23,4);return this.pos+=4,F},readDouble:function(){var F=o.read(this.buf,this.pos,!0,52,8);return this.pos+=8,F},readVarint:function(F){var Z,ce,Ce=this.buf;return Z=127&(ce=Ce[this.pos++]),ce<128?Z:(Z|=(127&(ce=Ce[this.pos++]))<<7,ce<128?Z:(Z|=(127&(ce=Ce[this.pos++]))<<14,ce<128?Z:(Z|=(127&(ce=Ce[this.pos++]))<<21,ce<128?Z:function(Ze,Ie,Re){var He,qe,Xe=Re.buf;if(He=(112&(qe=Xe[Re.pos++]))>>4,qe<128||(He|=(127&(qe=Xe[Re.pos++]))<<3,qe<128)||(He|=(127&(qe=Xe[Re.pos++]))<<10,qe<128)||(He|=(127&(qe=Xe[Re.pos++]))<<17,qe<128)||(He|=(127&(qe=Xe[Re.pos++]))<<24,qe<128)||(He|=(1&(qe=Xe[Re.pos++]))<<31,qe<128))return y(Ze,He,Ie);throw new Error("Expected varint not more than 10 bytes")}(Z|=(15&(ce=Ce[this.pos]))<<28,F,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var F=this.readVarint();return F%2==1?(F+1)/-2:F/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var F=this.readVarint()+this.pos,Z=this.pos;return this.pos=F,F-Z>=12&&d?function(ce,Ce,Ze){return d.decode(ce.subarray(Ce,Ze))}(this.buf,Z,F):function(ce,Ce,Ze){for(var Ie="",Re=Ce;Re<Ze;){var He,qe,Xe,Ne=ce[Re],it=null,vt=Ne>239?4:Ne>223?3:Ne>191?2:1;if(Re+vt>Ze)break;vt===1?Ne<128&&(it=Ne):vt===2?(192&(He=ce[Re+1]))==128&&(it=(31&Ne)<<6|63&He)<=127&&(it=null):vt===3?(qe=ce[Re+2],(192&(He=ce[Re+1]))==128&&(192&qe)==128&&((it=(15&Ne)<<12|(63&He)<<6|63&qe)<=2047||it>=55296&&it<=57343)&&(it=null)):vt===4&&(qe=ce[Re+2],Xe=ce[Re+3],(192&(He=ce[Re+1]))==128&&(192&qe)==128&&(192&Xe)==128&&((it=(15&Ne)<<18|(63&He)<<12|(63&qe)<<6|63&Xe)<=65535||it>=1114112)&&(it=null)),it===null?(it=65533,vt=1):it>65535&&(it-=65536,Ie+=String.fromCharCode(it>>>10&1023|55296),it=56320|1023&it),Ie+=String.fromCharCode(it),Re+=vt}return Ie}(this.buf,Z,F)},readBytes:function(){var F=this.readVarint()+this.pos,Z=this.buf.subarray(this.pos,F);return this.pos=F,Z},readPackedVarint:function(F,Z){if(this.type!==r.Bytes)return F.push(this.readVarint(Z));var ce=_(this);for(F=F||[];this.pos<ce;)F.push(this.readVarint(Z));return F},readPackedSVarint:function(F){if(this.type!==r.Bytes)return F.push(this.readSVarint());var Z=_(this);for(F=F||[];this.pos<Z;)F.push(this.readSVarint());return F},readPackedBoolean:function(F){if(this.type!==r.Bytes)return F.push(this.readBoolean());var Z=_(this);for(F=F||[];this.pos<Z;)F.push(this.readBoolean());return F},readPackedFloat:function(F){if(this.type!==r.Bytes)return F.push(this.readFloat());var Z=_(this);for(F=F||[];this.pos<Z;)F.push(this.readFloat());return F},readPackedDouble:function(F){if(this.type!==r.Bytes)return F.push(this.readDouble());var Z=_(this);for(F=F||[];this.pos<Z;)F.push(this.readDouble());return F},readPackedFixed32:function(F){if(this.type!==r.Bytes)return F.push(this.readFixed32());var Z=_(this);for(F=F||[];this.pos<Z;)F.push(this.readFixed32());return F},readPackedSFixed32:function(F){if(this.type!==r.Bytes)return F.push(this.readSFixed32());var Z=_(this);for(F=F||[];this.pos<Z;)F.push(this.readSFixed32());return F},readPackedFixed64:function(F){if(this.type!==r.Bytes)return F.push(this.readFixed64());var Z=_(this);for(F=F||[];this.pos<Z;)F.push(this.readFixed64());return F},readPackedSFixed64:function(F){if(this.type!==r.Bytes)return F.push(this.readSFixed64());var Z=_(this);for(F=F||[];this.pos<Z;)F.push(this.readSFixed64());return F},skip:function(F){var Z=7&F;if(Z===r.Varint)for(;this.buf[this.pos++]>127;);else if(Z===r.Bytes)this.pos=this.readVarint()+this.pos;else if(Z===r.Fixed32)this.pos+=4;else{if(Z!==r.Fixed64)throw new Error("Unimplemented type: "+Z);this.pos+=8}},writeTag:function(F,Z){this.writeVarint(F<<3|Z)},realloc:function(F){for(var Z=this.length||16;Z<this.pos+F;)Z*=2;if(Z!==this.length){var ce=new Uint8Array(Z);ce.set(this.buf),this.buf=ce,this.length=Z}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(F){this.realloc(4),me(this.buf,F,this.pos),this.pos+=4},writeSFixed32:function(F){this.realloc(4),me(this.buf,F,this.pos),this.pos+=4},writeFixed64:function(F){this.realloc(8),me(this.buf,-1&F,this.pos),me(this.buf,Math.floor(F*l),this.pos+4),this.pos+=8},writeSFixed64:function(F){this.realloc(8),me(this.buf,-1&F,this.pos),me(this.buf,Math.floor(F*l),this.pos+4),this.pos+=8},writeVarint:function(F){(F=+F||0)>268435455||F<0?function(Z,ce){var Ce,Ze;if(Z>=0?(Ce=Z%4294967296|0,Ze=Z/4294967296|0):(Ze=~(-Z/4294967296),4294967295^(Ce=~(-Z%4294967296))?Ce=Ce+1|0:(Ce=0,Ze=Ze+1|0)),Z>=18446744073709552e3||Z<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");ce.realloc(10),function(Ie,Re,He){He.buf[He.pos++]=127&Ie|128,Ie>>>=7,He.buf[He.pos++]=127&Ie|128,Ie>>>=7,He.buf[He.pos++]=127&Ie|128,Ie>>>=7,He.buf[He.pos++]=127&Ie|128,He.buf[He.pos]=127&(Ie>>>=7)}(Ce,0,ce),function(Ie,Re){var He=(7&Ie)<<4;Re.buf[Re.pos++]|=He|((Ie>>>=3)?128:0),Ie&&(Re.buf[Re.pos++]=127&Ie|((Ie>>>=7)?128:0),Ie&&(Re.buf[Re.pos++]=127&Ie|((Ie>>>=7)?128:0),Ie&&(Re.buf[Re.pos++]=127&Ie|((Ie>>>=7)?128:0),Ie&&(Re.buf[Re.pos++]=127&Ie|((Ie>>>=7)?128:0),Ie&&(Re.buf[Re.pos++]=127&Ie)))))}(Ze,ce)}(F,this):(this.realloc(4),this.buf[this.pos++]=127&F|(F>127?128:0),F<=127||(this.buf[this.pos++]=127&(F>>>=7)|(F>127?128:0),F<=127||(this.buf[this.pos++]=127&(F>>>=7)|(F>127?128:0),F<=127||(this.buf[this.pos++]=F>>>7&127))))},writeSVarint:function(F){this.writeVarint(F<0?2*-F-1:2*F)},writeBoolean:function(F){this.writeVarint(!!F)},writeString:function(F){F=String(F),this.realloc(4*F.length),this.pos++;var Z=this.pos;this.pos=function(Ce,Ze,Ie){for(var Re,He,qe=0;qe<Ze.length;qe++){if((Re=Ze.charCodeAt(qe))>55295&&Re<57344){if(!He){Re>56319||qe+1===Ze.length?(Ce[Ie++]=239,Ce[Ie++]=191,Ce[Ie++]=189):He=Re;continue}if(Re<56320){Ce[Ie++]=239,Ce[Ie++]=191,Ce[Ie++]=189,He=Re;continue}Re=He-55296<<10|Re-56320|65536,He=null}else He&&(Ce[Ie++]=239,Ce[Ie++]=191,Ce[Ie++]=189,He=null);Re<128?Ce[Ie++]=Re:(Re<2048?Ce[Ie++]=Re>>6|192:(Re<65536?Ce[Ie++]=Re>>12|224:(Ce[Ie++]=Re>>18|240,Ce[Ie++]=Re>>12&63|128),Ce[Ie++]=Re>>6&63|128),Ce[Ie++]=63&Re|128)}return Ie}(this.buf,F,this.pos);var ce=this.pos-Z;ce>=128&&w(Z,ce,this),this.pos=Z-1,this.writeVarint(ce),this.pos+=ce},writeFloat:function(F){this.realloc(4),o.write(this.buf,F,this.pos,!0,23,4),this.pos+=4},writeDouble:function(F){this.realloc(8),o.write(this.buf,F,this.pos,!0,52,8),this.pos+=8},writeBytes:function(F){var Z=F.length;this.writeVarint(Z),this.realloc(Z);for(var ce=0;ce<Z;ce++)this.buf[this.pos++]=F[ce]},writeRawMessage:function(F,Z){this.pos++;var ce=this.pos;F(Z,this);var Ce=this.pos-ce;Ce>=128&&w(ce,Ce,this),this.pos=ce-1,this.writeVarint(Ce),this.pos+=Ce},writeMessage:function(F,Z,ce){this.writeTag(F,r.Bytes),this.writeRawMessage(Z,ce)},writePackedVarint:function(F,Z){Z.length&&this.writeMessage(F,T,Z)},writePackedSVarint:function(F,Z){Z.length&&this.writeMessage(F,C,Z)},writePackedBoolean:function(F,Z){Z.length&&this.writeMessage(F,D,Z)},writePackedFloat:function(F,Z){Z.length&&this.writeMessage(F,M,Z)},writePackedDouble:function(F,Z){Z.length&&this.writeMessage(F,I,Z)},writePackedFixed32:function(F,Z){Z.length&&this.writeMessage(F,B,Z)},writePackedSFixed32:function(F,Z){Z.length&&this.writeMessage(F,O,Z)},writePackedFixed64:function(F,Z){Z.length&&this.writeMessage(F,$,Z)},writePackedSFixed64:function(F,Z){Z.length&&this.writeMessage(F,q,Z)},writeBytesField:function(F,Z){this.writeTag(F,r.Bytes),this.writeBytes(Z)},writeFixed32Field:function(F,Z){this.writeTag(F,r.Fixed32),this.writeFixed32(Z)},writeSFixed32Field:function(F,Z){this.writeTag(F,r.Fixed32),this.writeSFixed32(Z)},writeFixed64Field:function(F,Z){this.writeTag(F,r.Fixed64),this.writeFixed64(Z)},writeSFixed64Field:function(F,Z){this.writeTag(F,r.Fixed64),this.writeSFixed64(Z)},writeVarintField:function(F,Z){this.writeTag(F,r.Varint),this.writeVarint(Z)},writeSVarintField:function(F,Z){this.writeTag(F,r.Varint),this.writeSVarint(Z)},writeStringField:function(F,Z){this.writeTag(F,r.Bytes),this.writeString(Z)},writeFloatField:function(F,Z){this.writeTag(F,r.Fixed32),this.writeFloat(Z)},writeDoubleField:function(F,Z){this.writeTag(F,r.Fixed64),this.writeDouble(Z)},writeBooleanField:function(F,Z){this.writeVarintField(F,!!Z)}},S_}var P_=A(Ux());const C_=3;function JP(o,r,s){o===1&&s.readMessage(eC,r)}function eC(o,r,s){if(o===3){const{id:l,bitmap:d,width:_,height:y,left:w,top:T,advance:C}=s.readMessage(tC,{});r.push({id:l,bitmap:new Ah({width:_+2*C_,height:y+2*C_},d),metrics:{width:_,height:y,left:w,top:T,advance:C}})}}function tC(o,r,s){o===1?r.id=s.readVarint():o===2?r.bitmap=s.readBytes():o===3?r.width=s.readVarint():o===4?r.height=s.readVarint():o===5?r.left=s.readSVarint():o===6?r.top=s.readSVarint():o===7&&(r.advance=s.readVarint())}const rC=C_;function Zx(o){let r=0,s=0;for(const y of o)r+=y.w*y.h,s=Math.max(s,y.w);o.sort((y,w)=>w.h-y.h);const l=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(r/.95)),s),h:1/0}];let d=0,_=0;for(const y of o)for(let w=l.length-1;w>=0;w--){const T=l[w];if(!(y.w>T.w||y.h>T.h)){if(y.x=T.x,y.y=T.y,_=Math.max(_,y.y+y.h),d=Math.max(d,y.x+y.w),y.w===T.w&&y.h===T.h){const C=l.pop();w<l.length&&(l[w]=C)}else y.h===T.h?(T.x+=y.w,T.w-=y.w):y.w===T.w?(T.y+=y.h,T.h-=y.h):(l.push({x:T.x+y.w,y:T.y,w:T.w-y.w,h:y.h}),T.y+=y.h,T.h-=y.h);break}}return{w:d,h:_,fill:r/(d*_)||0}}const Yn=1;class E_{constructor(r,{pixelRatio:s,version:l,stretchX:d,stretchY:_,content:y,textFitWidth:w,textFitHeight:T}){this.paddedRect=r,this.pixelRatio=s,this.stretchX=d,this.stretchY=_,this.content=y,this.version=l,this.textFitWidth=w,this.textFitHeight=T}get tl(){return[this.paddedRect.x+Yn,this.paddedRect.y+Yn]}get br(){return[this.paddedRect.x+this.paddedRect.w-Yn,this.paddedRect.y+this.paddedRect.h-Yn]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*Yn)/this.pixelRatio,(this.paddedRect.h-2*Yn)/this.pixelRatio]}}class Gx{constructor(r,s){const l={},d={};this.haveRenderCallbacks=[];const _=[];this.addImages(r,l,_),this.addImages(s,d,_);const{w:y,h:w}=Zx(_),T=new Pi({width:y||1,height:w||1});for(const C in r){const M=r[C],I=l[C].paddedRect;Pi.copy(M.data,T,{x:0,y:0},{x:I.x+Yn,y:I.y+Yn},M.data)}for(const C in s){const M=s[C],I=d[C].paddedRect,D=I.x+Yn,B=I.y+Yn,O=M.data.width,$=M.data.height;Pi.copy(M.data,T,{x:0,y:0},{x:D,y:B},M.data),Pi.copy(M.data,T,{x:0,y:$-1},{x:D,y:B-1},{width:O,height:1}),Pi.copy(M.data,T,{x:0,y:0},{x:D,y:B+$},{width:O,height:1}),Pi.copy(M.data,T,{x:O-1,y:0},{x:D-1,y:B},{width:1,height:$}),Pi.copy(M.data,T,{x:0,y:0},{x:D+O,y:B},{width:1,height:$})}this.image=T,this.iconPositions=l,this.patternPositions=d}addImages(r,s,l){for(const d in r){const _=r[d],y={x:0,y:0,w:_.data.width+2*Yn,h:_.data.height+2*Yn};l.push(y),s[d]=new E_(y,_),_.hasRenderCallback&&this.haveRenderCallbacks.push(d)}}patchUpdatedImages(r,s){r.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const l in r.updatedImages)this.patchUpdatedImage(this.iconPositions[l],r.getImage(l),s),this.patchUpdatedImage(this.patternPositions[l],r.getImage(l),s)}patchUpdatedImage(r,s,l){if(!r||!s||r.version===s.version)return;r.version=s.version;const[d,_]=r.tl;l.update(s.data,void 0,{x:d,y:_})}}var ua;nt("ImagePosition",E_),nt("ImageAtlas",Gx),x.ag=void 0,(ua=x.ag||(x.ag={}))[ua.none=0]="none",ua[ua.horizontal=1]="horizontal",ua[ua.vertical=2]="vertical",ua[ua.horizontalOnly=3]="horizontalOnly";const of=-17;class Vh{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(r,s,l){const d=new Vh;return d.scale=r||1,d.fontStack=s,d.verticalAlign=l||"bottom",d}static forImage(r,s){const l=new Vh;return l.imageName=r,l.verticalAlign=s||"bottom",l}}class Ec{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(r,s){const l=new Ec;for(let d=0;d<r.sections.length;d++){const _=r.sections[d];_.image?l.addImageSection(_):l.addTextSection(_,s)}return l}length(){return this.text.length}getSection(r){return this.sections[this.sectionIndex[r]]}getSectionIndex(r){return this.sectionIndex[r]}getCharCode(r){return this.text.charCodeAt(r)}verticalizePunctuation(){this.text=function(r){let s="";for(let l=0;l<r.length;l++){const d=r.charCodeAt(l+1)||null,_=r.charCodeAt(l-1)||null;s+=d&&vh(d)&&!$h[r[l+1]]||_&&vh(_)&&!$h[r[l-1]]||!$h[r[l]]?r[l]:$h[r[l]]}return s}(this.text)}trim(){let r=0;for(let l=0;l<this.text.length&&af[this.text.charCodeAt(l)];l++)r++;let s=this.text.length;for(let l=this.text.length-1;l>=0&&l>=r&&af[this.text.charCodeAt(l)];l--)s--;this.text=this.text.substring(r,s),this.sectionIndex=this.sectionIndex.slice(r,s)}substring(r,s){const l=new Ec;return l.text=this.text.substring(r,s),l.sectionIndex=this.sectionIndex.slice(r,s),l.sections=this.sections,l}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((r,s)=>Math.max(r,this.sections[s].scale),0)}getMaxImageSize(r){let s=0,l=0;for(let d=0;d<this.length();d++){const _=this.getSection(d);if(_.imageName){const y=r[_.imageName];if(!y)continue;const w=y.displaySize;s=Math.max(s,w[0]),l=Math.max(l,w[1])}}return{maxImageWidth:s,maxImageHeight:l}}addTextSection(r,s){this.text+=r.text,this.sections.push(Vh.forText(r.scale,r.fontStack||s,r.verticalAlign));const l=this.sections.length-1;for(let d=0;d<r.text.length;++d)this.sectionIndex.push(l)}addImageSection(r){const s=r.image?r.image.name:"";if(s.length===0)return void Kr("Can't add FormattedSection with an empty image.");const l=this.getNextImageSectionCharCode();l?(this.text+=String.fromCharCode(l),this.sections.push(Vh.forImage(s,r.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):Kr("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function sf(o,r,s,l,d,_,y,w,T,C,M,I,D,B,O){const $=Ec.fromFeature(o,d);let q;I===x.ag.vertical&&$.verticalizePunctuation();const{processBidirectionalText:ne,processStyledBidirectionalText:me}=Bo;if(ne&&$.sections.length===1){q=[];const Z=ne($.toString(),M_($,C,_,r,l,B));for(const ce of Z){const Ce=new Ec;Ce.text=ce,Ce.sections=$.sections;for(let Ze=0;Ze<ce.length;Ze++)Ce.sectionIndex.push(0);q.push(Ce)}}else if(me){q=[];const Z=me($.text,$.sectionIndex,M_($,C,_,r,l,B));for(const ce of Z){const Ce=new Ec;Ce.text=ce[0],Ce.sectionIndex=ce[1],Ce.sections=$.sections,q.push(Ce)}}else q=function(Z,ce){const Ce=[],Ze=Z.text;let Ie=0;for(const Re of ce)Ce.push(Z.substring(Ie,Re)),Ie=Re;return Ie<Ze.length&&Ce.push(Z.substring(Ie,Ze.length)),Ce}($,M_($,C,_,r,l,B));const ae=[],F={positionedLines:ae,text:$.toString(),top:M[1],bottom:M[1],left:M[0],right:M[0],writingMode:I,iconsInText:!1,verticalizable:!1};return function(Z,ce,Ce,Ze,Ie,Re,He,qe,Xe,Ne,it,vt){let yt=0,ct=0,zt=0,yr=0;const Gr=qe==="right"?1:qe==="left"?0:.5,xn=Zr/vt;let Ei=0;for(const dr of Ie){dr.trim();const tn=dr.getMaxScale(),dn={positionedGlyphs:[],lineOffset:0};Z.positionedLines[Ei]=dn;const pn=dn.positionedGlyphs;let jn=0;if(!dr.length()){ct+=Re,++Ei;continue}const Mi=sC(Ze,dr,xn);for(let Jn=0;Jn<dr.length();Jn++){const qr=dr.getSection(Jn),nn=dr.getSectionIndex(Jn),on=dr.getCharCode(Jn),Fr=aC(Xe,it,on);let ir;if(qr.imageName){if(Z.iconsInText=!0,qr.scale=qr.scale*xn,ir=cC(qr,Fr,tn,Mi,Ze),!ir)continue;jn=Math.max(jn,ir.imageOffset)}else if(ir=lC(qr,on,Fr,Mi,ce,Ce),!ir)continue;const{rect:go,metrics:Ac,baselineOffset:_o}=ir;pn.push({glyph:on,imageName:qr.imageName,x:yt,y:ct+_o+of,vertical:Fr,scale:qr.scale,fontStack:qr.fontStack,sectionIndex:nn,metrics:Ac,rect:go}),Fr?(Z.verticalizable=!0,yt+=(qr.imageName?Ac.advance:Zr)*qr.scale+Ne):yt+=Ac.advance*qr.scale+Ne}pn.length!==0&&(zt=Math.max(yt-Ne,zt),uC(pn,0,pn.length-1,Gr)),yt=0,dn.lineOffset=Math.max(jn,(tn-1)*Zr);const rn=Re*tn+jn;ct+=rn,yr=Math.max(rn,yr),++Ei}const{horizontalAlign:Qn,verticalAlign:hn}=I_(He);(function(dr,tn,dn,pn,jn,Mi,rn,Jn,qr){const nn=(tn-dn)*jn;let on=0;on=Mi!==rn?-Jn*pn-of:-pn*qr*rn+.5*rn;for(const Fr of dr)for(const ir of Fr.positionedGlyphs)ir.x+=nn,ir.y+=on})(Z.positionedLines,Gr,Qn,hn,zt,yr,Re,ct,Ie.length),Z.top+=-hn*ct,Z.bottom=Z.top+ct,Z.left+=-Qn*zt,Z.right=Z.left+zt}(F,r,s,l,q,y,w,T,I,C,D,O),!function(Z){for(const ce of Z)if(ce.positionedGlyphs.length!==0)return!1;return!0}(ae)&&F}const af={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},nC={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},iC={40:!0};function qx(o,r,s,l,d,_){if(r.imageName){const y=l[r.imageName];return y?y.displaySize[0]*r.scale*Zr/_+d:0}{const y=s[r.fontStack],w=y&&y[o];return w?w.metrics.advance*r.scale+d:0}}function Wx(o,r,s,l){const d=Math.pow(o-r,2);return l?o<r?d/2:2*d:d+Math.abs(s)*s}function oC(o,r,s){let l=0;return o===10&&(l-=1e4),s&&(l+=150),o!==40&&o!==65288||(l+=50),r!==41&&r!==65289||(l+=50),l}function Hx(o,r,s,l,d,_){let y=null,w=Wx(r,s,d,_);for(const T of l){const C=Wx(r-T.x,s,d,_)+T.badness;C<=w&&(y=T,w=C)}return{index:o,x:r,priorBreak:y,badness:w}}function Xx(o){return o?Xx(o.priorBreak).concat(o.index):[]}function M_(o,r,s,l,d,_){if(!o)return[];const y=[],w=function(I,D,B,O,$,q){let ne=0;for(let me=0;me<I.length();me++){const ae=I.getSection(me);ne+=qx(I.getCharCode(me),ae,O,$,D,q)}return ne/Math.max(1,Math.ceil(ne/B))}(o,r,s,l,d,_),T=o.text.indexOf("")>=0;let C=0;for(let I=0;I<o.length();I++){const D=o.getSection(I),B=o.getCharCode(I);if(af[B]||(C+=qx(B,D,l,d,r,_)),I<o.length()-1){const O=!((M=B)<11904)&&(!!At["CJK Compatibility Forms"](M)||!!At["CJK Compatibility"](M)||!!At["CJK Strokes"](M)||!!At["CJK Symbols and Punctuation"](M)||!!At["Enclosed CJK Letters and Months"](M)||!!At["Halfwidth and Fullwidth Forms"](M)||!!At["Ideographic Description Characters"](M)||!!At["Vertical Forms"](M)||_h.test(String.fromCodePoint(M)));(nC[B]||O||D.imageName||I!==o.length()-2&&iC[o.getCharCode(I+1)])&&y.push(Hx(I+1,C,w,y,oC(B,o.getCharCode(I+1),O&&T),!1))}}var M;return Xx(Hx(o.length(),C,w,y,0,!0))}function I_(o){let r=.5,s=.5;switch(o){case"right":case"top-right":case"bottom-right":r=1;break;case"left":case"top-left":case"bottom-left":r=0}switch(o){case"bottom":case"bottom-right":case"bottom-left":s=1;break;case"top":case"top-right":case"top-left":s=0}return{horizontalAlign:r,verticalAlign:s}}function sC(o,r,s){const l=r.getMaxScale()*Zr,{maxImageWidth:d,maxImageHeight:_}=r.getMaxImageSize(o),y=Math.max(l,_*s);return{verticalLineContentWidth:Math.max(l,d*s),horizontalLineContentHeight:y}}function Kx(o){switch(o){case"top":return 0;case"center":return .5;default:return 1}}function aC(o,r,s){return!(o===x.ag.horizontal||!r&&!yh(s)||r&&(af[s]||(l=s,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(l)))));var l}function lC(o,r,s,l,d,_){const y=_[o.fontStack],w=function(C,M,I,D){if(C&&C.rect)return C;const B=M[I.fontStack],O=B&&B[D];return O?{rect:null,metrics:O.metrics}:null}(y&&y[r],d,o,r);if(w===null)return null;let T;if(s)T=l.verticalLineContentWidth-o.scale*Zr;else{const C=Kx(o.verticalAlign);T=(l.horizontalLineContentHeight-o.scale*Zr)*C}return{rect:w.rect,metrics:w.metrics,baselineOffset:T}}function cC(o,r,s,l,d){const _=d[o.imageName];if(!_)return null;const y=_.paddedRect,w=_.displaySize,T={width:w[0],height:w[1],left:Yn,top:-3,advance:r?w[1]:w[0]};let C;if(r)C=l.verticalLineContentWidth-w[1]*o.scale;else{const M=Kx(o.verticalAlign);C=(l.horizontalLineContentHeight-w[1]*o.scale)*M}return{rect:y,metrics:T,baselineOffset:C,imageOffset:(r?w[0]:w[1])*o.scale-Zr*s}}function uC(o,r,s,l){if(l===0)return;const d=o[s],_=(o[s].x+d.metrics.advance*d.scale)*l;for(let y=r;y<=s;y++)o[y].x-=_}function hC(o,r,s){const{horizontalAlign:l,verticalAlign:d}=I_(s),_=r[0]-o.displaySize[0]*l,y=r[1]-o.displaySize[1]*d;return{image:o,top:y,bottom:y+o.displaySize[1],left:_,right:_+o.displaySize[0]}}function Yx(o){var r,s;let l=o.left,d=o.top,_=o.right-l,y=o.bottom-d;const w=(r=o.image.textFitWidth)!==null&&r!==void 0?r:"stretchOrShrink",T=(s=o.image.textFitHeight)!==null&&s!==void 0?s:"stretchOrShrink",C=(o.image.content[2]-o.image.content[0])/(o.image.content[3]-o.image.content[1]);if(T==="proportional"){if(w==="stretchOnly"&&_/y<C||w==="proportional"){const M=Math.ceil(y*C);l*=M/_,_=M}}else if(w==="proportional"&&T==="stretchOnly"&&C!==0&&_/y>C){const M=Math.ceil(_/C);d*=M/y,y=M}return{x1:l,y1:d,x2:l+_,y2:d+y}}function Qx(o,r,s,l,d,_){const y=o.image;let w;if(y.content){const q=y.content,ne=y.pixelRatio||1;w=[q[0]/ne,q[1]/ne,y.displaySize[0]-q[2]/ne,y.displaySize[1]-q[3]/ne]}const T=r.left*_,C=r.right*_;let M,I,D,B;s==="width"||s==="both"?(B=d[0]+T-l[3],I=d[0]+C+l[1]):(B=d[0]+(T+C-y.displaySize[0])/2,I=B+y.displaySize[0]);const O=r.top*_,$=r.bottom*_;return s==="height"||s==="both"?(M=d[1]+O-l[0],D=d[1]+$+l[2]):(M=d[1]+(O+$-y.displaySize[1])/2,D=M+y.displaySize[1]),{image:y,top:M,right:I,bottom:D,left:B,collisionPadding:w}}const Uh=255,jo=128,ha=Uh*jo;function Jx(o,r){const{expression:s}=r;if(s.kind==="constant")return{kind:"constant",layoutSize:s.evaluate(new ar(o+1))};if(s.kind==="source")return{kind:"source"};{const{zoomStops:l,interpolationType:d}=s;let _=0;for(;_<l.length&&l[_]<=o;)_++;_=Math.max(0,_-1);let y=_;for(;y<l.length&&l[y]<o+1;)y++;y=Math.min(l.length-1,y);const w=l[_],T=l[y];return s.kind==="composite"?{kind:"composite",minZoom:w,maxZoom:T,interpolationType:d}:{kind:"camera",minZoom:w,maxZoom:T,minSize:s.evaluate(new ar(w)),maxSize:s.evaluate(new ar(T)),interpolationType:d}}}function k_(o,r,s){let l="never";const d=o.get(r);return d?l=d:o.get(s)&&(l="always"),l}const dC=Oh.VectorTileFeature.types,pC=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function lf(o,r,s,l,d,_,y,w,T,C,M,I,D){const B=w?Math.min(ha,Math.round(w[0])):0,O=w?Math.min(ha,Math.round(w[1])):0;o.emplaceBack(r,s,Math.round(32*l),Math.round(32*d),_,y,(B<<1)+(T?1:0),O,16*C,16*M,256*I,256*D)}function A_(o,r,s){o.emplaceBack(r.x,r.y,s),o.emplaceBack(r.x,r.y,s),o.emplaceBack(r.x,r.y,s),o.emplaceBack(r.x,r.y,s)}function fC(o){for(const r of o.sections)if(Zp(r.text))return!0;return!1}class z_{constructor(r){this.layoutVertexArray=new Pe,this.indexArray=new Qe,this.programConfigurations=r,this.segments=new mt,this.dynamicLayoutVertexArray=new Ee,this.opacityVertexArray=new Be,this.hasVisibleVertices=!1,this.placedSymbolArray=new P}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(r,s,l,d){this.isEmpty()||(l&&(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,WP.members),this.indexBuffer=r.createIndexBuffer(this.indexArray,s),this.dynamicLayoutVertexBuffer=r.createVertexBuffer(this.dynamicLayoutVertexArray,HP.members,!0),this.opacityVertexBuffer=r.createVertexBuffer(this.opacityVertexArray,pC,!0),this.opacityVertexBuffer.itemSize=1),(l||d)&&this.programConfigurations.upload(r))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}nt("SymbolBuffers",z_);class R_{constructor(r,s,l){this.layoutVertexArray=new r,this.layoutAttributes=s,this.indexArray=new l,this.segments=new mt,this.collisionVertexArray=new Le}upload(r){this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=r.createVertexBuffer(this.collisionVertexArray,XP.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}nt("CollisionBuffers",R_);class Mc{constructor(r){this.collisionBoxArray=r.collisionBoxArray,this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(y=>y.id),this.index=r.index,this.pixelRatio=r.pixelRatio,this.sourceLayerIndex=r.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const s=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Jx(this.zoom,s["text-size"]),this.iconSizeData=Jx(this.zoom,s["icon-size"]);const l=this.layers[0].layout,d=l.get("symbol-sort-key"),_=l.get("symbol-z-order");this.canOverlap=k_(l,"text-overlap","text-allow-overlap")!=="never"||k_(l,"icon-overlap","icon-allow-overlap")!=="never"||l.get("text-ignore-placement")||l.get("icon-ignore-placement"),this.sortFeaturesByKey=_!=="viewport-y"&&!d.isConstant(),this.sortFeaturesByY=(_==="viewport-y"||_==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,l.get("symbol-placement")==="point"&&(this.writingModes=l.get("text-writing-mode").map(y=>x.ag[y])),this.stateDependentLayerIds=this.layers.filter(y=>y.isStateDependent()).map(y=>y.id),this.sourceID=r.sourceID}createArrays(){this.text=new z_(new ws(this.layers,this.zoom,r=>/^text/.test(r))),this.icon=new z_(new ws(this.layers,this.zoom,r=>/^icon/.test(r))),this.glyphOffsetArray=new R,this.lineVertexArray=new L,this.symbolInstances=new k,this.textAnchorOffsets=new V}calculateGlyphDependencies(r,s,l,d,_){for(let y=0;y<r.length;y++)if(s[r.charCodeAt(y)]=!0,(l||d)&&_){const w=$h[r.charAt(y)];w&&(s[w.charCodeAt(0)]=!0)}}populate(r,s,l){const d=this.layers[0],_=d.layout,y=_.get("text-font"),w=_.get("text-field"),T=_.get("icon-image"),C=(w.value.kind!=="constant"||w.value.value instanceof cn&&!w.value.value.isEmpty()||w.value.value.toString().length>0)&&(y.value.kind!=="constant"||y.value.value.length>0),M=T.value.kind!=="constant"||!!T.value.value||Object.keys(T.parameters).length>0,I=_.get("symbol-sort-key");if(this.features=[],!C&&!M)return;const D=s.iconDependencies,B=s.glyphDependencies,O=s.availableImages,$=new ar(this.zoom);for(const{feature:q,id:ne,index:me,sourceLayerIndex:ae}of r){const F=d._featureFilter.needGeometry,Z=Kn(q,F);if(!d._featureFilter.filter($,Z,l))continue;let ce,Ce;if(F||(Z.geometry=Ss(q)),C){const Ie=d.getValueAndResolveTokens("text-field",Z,l,O),Re=cn.factory(Ie),He=this.hasRTLText=this.hasRTLText||fC(Re);(!He||Bo.getRTLTextPluginStatus()==="unavailable"||He&&Bo.isParsed())&&(ce=YP(Re,d,Z))}if(M){const Ie=d.getValueAndResolveTokens("icon-image",Z,l,O);Ce=Ie instanceof Cn?Ie:Cn.fromString(Ie)}if(!ce&&!Ce)continue;const Ze=this.sortFeaturesByKey?I.evaluate(Z,{},l):void 0;if(this.features.push({id:ne,text:ce,icon:Ce,index:me,sourceLayerIndex:ae,geometry:Z.geometry,properties:q.properties,type:dC[q.type],sortKey:Ze}),Ce&&(D[Ce.name]=!0),ce){const Ie=y.evaluate(Z,{},l).join(","),Re=_.get("text-rotation-alignment")!=="viewport"&&_.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(x.ag.vertical)>=0;for(const He of ce.sections)if(He.image)D[He.image.name]=!0;else{const qe=lc(ce.toString()),Xe=He.fontStack||Ie,Ne=B[Xe]=B[Xe]||{};this.calculateGlyphDependencies(He.text,Ne,Re,this.allowVerticalPlacement,qe)}}}_.get("symbol-placement")==="line"&&(this.features=function(q){const ne={},me={},ae=[];let F=0;function Z(Ie){ae.push(q[Ie]),F++}function ce(Ie,Re,He){const qe=me[Ie];return delete me[Ie],me[Re]=qe,ae[qe].geometry[0].pop(),ae[qe].geometry[0]=ae[qe].geometry[0].concat(He[0]),qe}function Ce(Ie,Re,He){const qe=ne[Re];return delete ne[Re],ne[Ie]=qe,ae[qe].geometry[0].shift(),ae[qe].geometry[0]=He[0].concat(ae[qe].geometry[0]),qe}function Ze(Ie,Re,He){const qe=He?Re[0][Re[0].length-1]:Re[0][0];return`${Ie}:${qe.x}:${qe.y}`}for(let Ie=0;Ie<q.length;Ie++){const Re=q[Ie],He=Re.geometry,qe=Re.text?Re.text.toString():null;if(!qe){Z(Ie);continue}const Xe=Ze(qe,He),Ne=Ze(qe,He,!0);if(Xe in me&&Ne in ne&&me[Xe]!==ne[Ne]){const it=Ce(Xe,Ne,He),vt=ce(Xe,Ne,ae[it].geometry);delete ne[Xe],delete me[Ne],me[Ze(qe,ae[vt].geometry,!0)]=vt,ae[it].geometry=null}else Xe in me?ce(Xe,Ne,He):Ne in ne?Ce(Xe,Ne,He):(Z(Ie),ne[Xe]=F-1,me[Ne]=F-1)}return ae.filter(Ie=>Ie.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((q,ne)=>q.sortKey-ne.sortKey)}update(r,s,l){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(r,s,this.layers,l),this.icon.programConfigurations.updatePaintArrays(r,s,this.layers,l))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(r){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(r),this.iconCollisionBox.upload(r)),this.text.upload(r,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(r,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(r,s){const l=this.lineVertexArray.length;if(r.segment!==void 0){let d=r.dist(s[r.segment+1]),_=r.dist(s[r.segment]);const y={};for(let w=r.segment+1;w<s.length;w++)y[w]={x:s[w].x,y:s[w].y,tileUnitDistanceFromAnchor:d},w<s.length-1&&(d+=s[w+1].dist(s[w]));for(let w=r.segment||0;w>=0;w--)y[w]={x:s[w].x,y:s[w].y,tileUnitDistanceFromAnchor:_},w>0&&(_+=s[w-1].dist(s[w]));for(let w=0;w<s.length;w++){const T=y[w];this.lineVertexArray.emplaceBack(T.x,T.y,T.tileUnitDistanceFromAnchor)}}return{lineStartIndex:l,lineLength:this.lineVertexArray.length-l}}addSymbols(r,s,l,d,_,y,w,T,C,M,I,D){const B=r.indexArray,O=r.layoutVertexArray,$=r.segments.prepareSegment(4*s.length,O,B,this.canOverlap?y.sortKey:void 0),q=this.glyphOffsetArray.length,ne=$.vertexLength,me=this.allowVerticalPlacement&&w===x.ag.vertical?Math.PI/2:0,ae=y.text&&y.text.sections;for(let F=0;F<s.length;F++){const{tl:Z,tr:ce,bl:Ce,br:Ze,tex:Ie,pixelOffsetTL:Re,pixelOffsetBR:He,minFontScaleX:qe,minFontScaleY:Xe,glyphOffset:Ne,isSDF:it,sectionIndex:vt}=s[F],yt=$.vertexLength,ct=Ne[1];lf(O,T.x,T.y,Z.x,ct+Z.y,Ie.x,Ie.y,l,it,Re.x,Re.y,qe,Xe),lf(O,T.x,T.y,ce.x,ct+ce.y,Ie.x+Ie.w,Ie.y,l,it,He.x,Re.y,qe,Xe),lf(O,T.x,T.y,Ce.x,ct+Ce.y,Ie.x,Ie.y+Ie.h,l,it,Re.x,He.y,qe,Xe),lf(O,T.x,T.y,Ze.x,ct+Ze.y,Ie.x+Ie.w,Ie.y+Ie.h,l,it,He.x,He.y,qe,Xe),A_(r.dynamicLayoutVertexArray,T,me),B.emplaceBack(yt,yt+2,yt+1),B.emplaceBack(yt+1,yt+2,yt+3),$.vertexLength+=4,$.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Ne[0]),F!==s.length-1&&vt===s[F+1].sectionIndex||r.programConfigurations.populatePaintArrays(O.length,y,y.index,{},D,ae&&ae[vt])}r.placedSymbolArray.emplaceBack(T.x,T.y,q,this.glyphOffsetArray.length-q,ne,C,M,T.segment,l?l[0]:0,l?l[1]:0,d[0],d[1],w,0,!1,0,I)}_addCollisionDebugVertex(r,s,l,d,_,y){return s.emplaceBack(0,0),r.emplaceBack(l.x,l.y,d,_,Math.round(y.x),Math.round(y.y))}addCollisionDebugVertices(r,s,l,d,_,y,w){const T=_.segments.prepareSegment(4,_.layoutVertexArray,_.indexArray),C=T.vertexLength,M=_.layoutVertexArray,I=_.collisionVertexArray,D=w.anchorX,B=w.anchorY;this._addCollisionDebugVertex(M,I,y,D,B,new le(r,s)),this._addCollisionDebugVertex(M,I,y,D,B,new le(l,s)),this._addCollisionDebugVertex(M,I,y,D,B,new le(l,d)),this._addCollisionDebugVertex(M,I,y,D,B,new le(r,d)),T.vertexLength+=4;const O=_.indexArray;O.emplaceBack(C,C+1),O.emplaceBack(C+1,C+2),O.emplaceBack(C+2,C+3),O.emplaceBack(C+3,C),T.primitiveLength+=4}addDebugCollisionBoxes(r,s,l,d){for(let _=r;_<s;_++){const y=this.collisionBoxArray.get(_);this.addCollisionDebugVertices(y.x1,y.y1,y.x2,y.y2,d?this.textCollisionBox:this.iconCollisionBox,y.anchorPoint,l)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new R_(je,Nx.members,Ke),this.iconCollisionBox=new R_(je,Nx.members,Ke);for(let r=0;r<this.symbolInstances.length;r++){const s=this.symbolInstances.get(r);this.addDebugCollisionBoxes(s.textBoxStartIndex,s.textBoxEndIndex,s,!0),this.addDebugCollisionBoxes(s.verticalTextBoxStartIndex,s.verticalTextBoxEndIndex,s,!0),this.addDebugCollisionBoxes(s.iconBoxStartIndex,s.iconBoxEndIndex,s,!1),this.addDebugCollisionBoxes(s.verticalIconBoxStartIndex,s.verticalIconBoxEndIndex,s,!1)}}_deserializeCollisionBoxesForSymbol(r,s,l,d,_,y,w,T,C){const M={};for(let I=s;I<l;I++){const D=r.get(I);M.textBox={x1:D.x1,y1:D.y1,x2:D.x2,y2:D.y2,anchorPointX:D.anchorPointX,anchorPointY:D.anchorPointY},M.textFeatureIndex=D.featureIndex;break}for(let I=d;I<_;I++){const D=r.get(I);M.verticalTextBox={x1:D.x1,y1:D.y1,x2:D.x2,y2:D.y2,anchorPointX:D.anchorPointX,anchorPointY:D.anchorPointY},M.verticalTextFeatureIndex=D.featureIndex;break}for(let I=y;I<w;I++){const D=r.get(I);M.iconBox={x1:D.x1,y1:D.y1,x2:D.x2,y2:D.y2,anchorPointX:D.anchorPointX,anchorPointY:D.anchorPointY},M.iconFeatureIndex=D.featureIndex;break}for(let I=T;I<C;I++){const D=r.get(I);M.verticalIconBox={x1:D.x1,y1:D.y1,x2:D.x2,y2:D.y2,anchorPointX:D.anchorPointX,anchorPointY:D.anchorPointY},M.verticalIconFeatureIndex=D.featureIndex;break}return M}deserializeCollisionBoxes(r){this.collisionArrays=[];for(let s=0;s<this.symbolInstances.length;s++){const l=this.symbolInstances.get(s);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(r,l.textBoxStartIndex,l.textBoxEndIndex,l.verticalTextBoxStartIndex,l.verticalTextBoxEndIndex,l.iconBoxStartIndex,l.iconBoxEndIndex,l.verticalIconBoxStartIndex,l.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(r,s){const l=r.placedSymbolArray.get(s),d=l.vertexStartIndex+4*l.numGlyphs;for(let _=l.vertexStartIndex;_<d;_+=4)r.indexArray.emplaceBack(_,_+2,_+1),r.indexArray.emplaceBack(_+1,_+2,_+3)}getSortedSymbolIndexes(r){if(this.sortedAngle===r&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const s=Math.sin(r),l=Math.cos(r),d=[],_=[],y=[];for(let w=0;w<this.symbolInstances.length;++w){y.push(w);const T=this.symbolInstances.get(w);d.push(0|Math.round(s*T.anchorX+l*T.anchorY)),_.push(T.featureIndex)}return y.sort((w,T)=>d[w]-d[T]||_[T]-_[w]),y}addToSortKeyRanges(r,s){const l=this.sortKeyRanges[this.sortKeyRanges.length-1];l&&l.sortKey===s?l.symbolInstanceEnd=r+1:this.sortKeyRanges.push({sortKey:s,symbolInstanceStart:r,symbolInstanceEnd:r+1})}sortFeatures(r){if(this.sortFeaturesByY&&this.sortedAngle!==r&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(r),this.sortedAngle=r,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const s of this.symbolInstanceIndexes){const l=this.symbolInstances.get(s);this.featureSortOrder.push(l.featureIndex),[l.rightJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.leftJustifiedTextSymbolIndex].forEach((d,_,y)=>{d>=0&&y.indexOf(d)===_&&this.addIndicesForPlacedSymbol(this.text,d)}),l.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,l.verticalPlacedTextSymbolIndex),l.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,l.placedIconSymbolIndex),l.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,l.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let e1,t1;nt("SymbolBucket",Mc,{omit:["layers","collisionBoxArray","features","compareText"]}),Mc.MAX_GLYPHS=65535,Mc.addDynamicAttributes=A_;var L_={get paint(){return t1=t1||new On({"icon-opacity":new xt(z.paint_symbol["icon-opacity"]),"icon-color":new xt(z.paint_symbol["icon-color"]),"icon-halo-color":new xt(z.paint_symbol["icon-halo-color"]),"icon-halo-width":new xt(z.paint_symbol["icon-halo-width"]),"icon-halo-blur":new xt(z.paint_symbol["icon-halo-blur"]),"icon-translate":new pt(z.paint_symbol["icon-translate"]),"icon-translate-anchor":new pt(z.paint_symbol["icon-translate-anchor"]),"text-opacity":new xt(z.paint_symbol["text-opacity"]),"text-color":new xt(z.paint_symbol["text-color"],{runtimeType:It,getOverride:o=>o.textColor,hasOverride:o=>!!o.textColor}),"text-halo-color":new xt(z.paint_symbol["text-halo-color"]),"text-halo-width":new xt(z.paint_symbol["text-halo-width"]),"text-halo-blur":new xt(z.paint_symbol["text-halo-blur"]),"text-translate":new pt(z.paint_symbol["text-translate"]),"text-translate-anchor":new pt(z.paint_symbol["text-translate-anchor"])})},get layout(){return e1=e1||new On({"symbol-placement":new pt(z.layout_symbol["symbol-placement"]),"symbol-spacing":new pt(z.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new pt(z.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new xt(z.layout_symbol["symbol-sort-key"]),"symbol-z-order":new pt(z.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new pt(z.layout_symbol["icon-allow-overlap"]),"icon-overlap":new pt(z.layout_symbol["icon-overlap"]),"icon-ignore-placement":new pt(z.layout_symbol["icon-ignore-placement"]),"icon-optional":new pt(z.layout_symbol["icon-optional"]),"icon-rotation-alignment":new pt(z.layout_symbol["icon-rotation-alignment"]),"icon-size":new xt(z.layout_symbol["icon-size"]),"icon-text-fit":new pt(z.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new pt(z.layout_symbol["icon-text-fit-padding"]),"icon-image":new xt(z.layout_symbol["icon-image"]),"icon-rotate":new xt(z.layout_symbol["icon-rotate"]),"icon-padding":new xt(z.layout_symbol["icon-padding"]),"icon-keep-upright":new pt(z.layout_symbol["icon-keep-upright"]),"icon-offset":new xt(z.layout_symbol["icon-offset"]),"icon-anchor":new xt(z.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new pt(z.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new pt(z.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new pt(z.layout_symbol["text-rotation-alignment"]),"text-field":new xt(z.layout_symbol["text-field"]),"text-font":new xt(z.layout_symbol["text-font"]),"text-size":new xt(z.layout_symbol["text-size"]),"text-max-width":new xt(z.layout_symbol["text-max-width"]),"text-line-height":new pt(z.layout_symbol["text-line-height"]),"text-letter-spacing":new xt(z.layout_symbol["text-letter-spacing"]),"text-justify":new xt(z.layout_symbol["text-justify"]),"text-radial-offset":new xt(z.layout_symbol["text-radial-offset"]),"text-variable-anchor":new pt(z.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new xt(z.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new xt(z.layout_symbol["text-anchor"]),"text-max-angle":new pt(z.layout_symbol["text-max-angle"]),"text-writing-mode":new pt(z.layout_symbol["text-writing-mode"]),"text-rotate":new xt(z.layout_symbol["text-rotate"]),"text-padding":new pt(z.layout_symbol["text-padding"]),"text-keep-upright":new pt(z.layout_symbol["text-keep-upright"]),"text-transform":new xt(z.layout_symbol["text-transform"]),"text-offset":new xt(z.layout_symbol["text-offset"]),"text-allow-overlap":new pt(z.layout_symbol["text-allow-overlap"]),"text-overlap":new pt(z.layout_symbol["text-overlap"]),"text-ignore-placement":new pt(z.layout_symbol["text-ignore-placement"]),"text-optional":new pt(z.layout_symbol["text-optional"])})}};class r1{constructor(r){if(r.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=r.property.overrides?r.property.overrides.runtimeType:bt,this.defaultValue=r}evaluate(r){if(r.formattedSection){const s=this.defaultValue.property.overrides;if(s&&s.hasOverride(r.formattedSection))return s.getOverride(r.formattedSection)}return r.feature&&r.featureState?this.defaultValue.evaluate(r.feature,r.featureState):this.defaultValue.property.specification.default}eachChild(r){this.defaultValue.isConstant()||r(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}nt("FormatSectionOverride",r1,{omit:["defaultValue"]});class cf extends Gi{constructor(r){super(r,L_)}recalculate(r,s){if(super.recalculate(r,s),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const l=this.layout.get("text-writing-mode");if(l){const d=[];for(const _ of l)d.indexOf(_)<0&&d.push(_);this.layout._values["text-writing-mode"]=d}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(r,s,l,d){const _=this.layout.get(r).evaluate(s,{},l,d),y=this._unevaluatedLayout._values[r];return y.isDataDriven()||ec(y.value)||!_?_:function(w,T){return T.replace(/{([^{}]+)}/g,(C,M)=>w&&M in w?String(w[M]):"")}(s.properties,_)}createBucket(r){return new Mc(r)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const r of L_.paint.overridableProperties){if(!cf.hasPaintOverride(this.layout,r))continue;const s=this.paint.get(r),l=new r1(s),d=new rh(l,s.property.specification);let _=null;_=s.value.kind==="constant"||s.value.kind==="source"?new tc("source",d):new nh("composite",d,s.value.zoomStops),this.paint._values[r]=new hi(s.property,_,s.parameters)}}_handleOverridablePaintPropertyUpdate(r,s,l){return!(!this.layout||s.isDataDriven()||l.isDataDriven())&&cf.hasPaintOverride(this.layout,r)}static hasPaintOverride(r,s){const l=r.get("text-field"),d=L_.paint.properties[s];let _=!1;const y=w=>{for(const T of w)if(d.overrides&&d.overrides.hasOverride(T))return void(_=!0)};if(l.value.kind==="constant"&&l.value.value instanceof cn)y(l.value.value.sections);else if(l.value.kind==="source"){const w=C=>{_||(C instanceof si&&Dr(C.value)===Lr?y(C.value.sections):C instanceof as?y(C.sections):C.eachChild(w))},T=l.value;T._styleExpression&&w(T._styleExpression.expression)}return _}}let n1;var mC={get paint(){return n1=n1||new On({"background-color":new pt(z.paint_background["background-color"]),"background-pattern":new dc(z.paint_background["background-pattern"]),"background-opacity":new pt(z.paint_background["background-opacity"])})}};class gC extends Gi{constructor(r){super(r,mC)}}let i1;var _C={get paint(){return i1=i1||new On({"raster-opacity":new pt(z.paint_raster["raster-opacity"]),"raster-hue-rotate":new pt(z.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new pt(z.paint_raster["raster-brightness-min"]),"raster-brightness-max":new pt(z.paint_raster["raster-brightness-max"]),"raster-saturation":new pt(z.paint_raster["raster-saturation"]),"raster-contrast":new pt(z.paint_raster["raster-contrast"]),"raster-resampling":new pt(z.paint_raster["raster-resampling"]),"raster-fade-duration":new pt(z.paint_raster["raster-fade-duration"])})}};class yC extends Gi{constructor(r){super(r,_C)}}class vC extends Gi{constructor(r){super(r,{}),this.onAdd=s=>{this.implementation.onAdd&&this.implementation.onAdd(s,s.painter.context.gl)},this.onRemove=s=>{this.implementation.onRemove&&this.implementation.onRemove(s,s.painter.context.gl)},this.implementation=r}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class xC{constructor(r){this._methodToThrottle=r,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const bC={once:!0},D_=63710088e-1;class da{constructor(r,s){if(isNaN(r)||isNaN(s))throw new Error(`Invalid LngLat object: (${r}, ${s})`);if(this.lng=+r,this.lat=+s,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new da(wr(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(r){const s=Math.PI/180,l=this.lat*s,d=r.lat*s,_=Math.sin(l)*Math.sin(d)+Math.cos(l)*Math.cos(d)*Math.cos((r.lng-this.lng)*s);return D_*Math.acos(Math.min(_,1))}static convert(r){if(r instanceof da)return r;if(Array.isArray(r)&&(r.length===2||r.length===3))return new da(Number(r[0]),Number(r[1]));if(!Array.isArray(r)&&typeof r=="object"&&r!==null)return new da(Number("lng"in r?r.lng:r.lon),Number(r.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const o1=2*Math.PI*D_;function s1(o){return o1*Math.cos(o*Math.PI/180)}function a1(o){return(180+o)/360}function l1(o){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+o*Math.PI/360)))/360}function c1(o,r){return o/s1(r)}function F_(o){return 360/Math.PI*Math.atan(Math.exp((180-360*o)*Math.PI/180))-90}function u1(o,r){return o*s1(F_(r))}class Zh{constructor(r,s,l=0){this.x=+r,this.y=+s,this.z=+l}static fromLngLat(r,s=0){const l=da.convert(r);return new Zh(a1(l.lng),l1(l.lat),c1(s,l.lat))}toLngLat(){return new da(360*this.x-180,F_(this.y))}toAltitude(){return u1(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/o1*(r=F_(this.y),1/Math.cos(r*Math.PI/180));var r}}function h1(o,r,s){var l=2*Math.PI*6378137/256/Math.pow(2,s);return[o*l-2*Math.PI*6378137/2,r*l-2*Math.PI*6378137/2]}class B_{constructor(r,s,l){if(!function(d,_,y){return!(d<0||d>25||y<0||y>=Math.pow(2,d)||_<0||_>=Math.pow(2,d))}(r,s,l))throw new Error(`x=${s}, y=${l}, z=${r} outside of bounds. 0<=x<${Math.pow(2,r)}, 0<=y<${Math.pow(2,r)} 0<=z<=25 `);this.z=r,this.x=s,this.y=l,this.key=Ic(0,r,r,s,l)}equals(r){return this.z===r.z&&this.x===r.x&&this.y===r.y}url(r,s,l){const d=(y=this.y,w=this.z,T=h1(256*(_=this.x),256*(y=Math.pow(2,w)-y-1),w),C=h1(256*(_+1),256*(y+1),w),T[0]+","+T[1]+","+C[0]+","+C[1]);var _,y,w,T,C;const M=function(I,D,B){let O,$="";for(let q=I;q>0;q--)O=1<<q-1,$+=(D&O?1:0)+(B&O?2:0);return $}(this.z,this.x,this.y);return r[(this.x+this.y)%r.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(l==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,s>1?"@2x":"").replace(/{quadkey}/g,M).replace(/{bbox-epsg-3857}/g,d)}isChildOf(r){const s=this.z-r.z;return s>0&&r.x===this.x>>s&&r.y===this.y>>s}getTilePoint(r){const s=Math.pow(2,this.z);return new le((r.x*s-this.x)*St,(r.y*s-this.y)*St)}toString(){return`${this.z}/${this.x}/${this.y}`}}class d1{constructor(r,s){this.wrap=r,this.canonical=s,this.key=Ic(r,s.z,s.z,s.x,s.y)}}class Ci{constructor(r,s,l,d,_){if(this.terrainRttPosMatrix32f=null,r<l)throw new Error(`overscaledZ should be >= z; overscaledZ = ${r}; z = ${l}`);this.overscaledZ=r,this.wrap=s,this.canonical=new B_(l,+d,+_),this.key=Ic(s,r,l,d,_)}clone(){return new Ci(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(r){return this.overscaledZ===r.overscaledZ&&this.wrap===r.wrap&&this.canonical.equals(r.canonical)}scaledTo(r){if(r>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${r}; overscaledZ = ${this.overscaledZ}`);const s=this.canonical.z-r;return r>this.canonical.z?new Ci(r,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ci(r,this.wrap,r,this.canonical.x>>s,this.canonical.y>>s)}calculateScaledKey(r,s){if(r>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${r}; overscaledZ = ${this.overscaledZ}`);const l=this.canonical.z-r;return r>this.canonical.z?Ic(this.wrap*+s,r,this.canonical.z,this.canonical.x,this.canonical.y):Ic(this.wrap*+s,r,r,this.canonical.x>>l,this.canonical.y>>l)}isChildOf(r){if(r.wrap!==this.wrap)return!1;const s=this.canonical.z-r.canonical.z;return r.overscaledZ===0||r.overscaledZ<this.overscaledZ&&r.canonical.x===this.canonical.x>>s&&r.canonical.y===this.canonical.y>>s}children(r){if(this.overscaledZ>=r)return[new Ci(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const s=this.canonical.z+1,l=2*this.canonical.x,d=2*this.canonical.y;return[new Ci(s,this.wrap,s,l,d),new Ci(s,this.wrap,s,l+1,d),new Ci(s,this.wrap,s,l,d+1),new Ci(s,this.wrap,s,l+1,d+1)]}isLessThan(r){return this.wrap<r.wrap||!(this.wrap>r.wrap)&&(this.overscaledZ<r.overscaledZ||!(this.overscaledZ>r.overscaledZ)&&(this.canonical.x<r.canonical.x||!(this.canonical.x>r.canonical.x)&&this.canonical.y<r.canonical.y))}wrapped(){return new Ci(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(r){return new Ci(this.overscaledZ,r,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new d1(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(r){return this.canonical.getTilePoint(new Zh(r.x-this.wrap,r.y))}}function Ic(o,r,s,l,d){(o*=2)<0&&(o=-1*o-1);const _=1<<s;return(_*_*o+_*d+l).toString(36)+s.toString(36)+r.toString(36)}nt("CanonicalTileID",B_),nt("OverscaledTileID",Ci,{omit:["terrainRttPosMatrix32f"]});class p1{constructor(r,s,l,d=1,_=1,y=1,w=0){if(this.uid=r,s.height!==s.width)throw new RangeError("DEM tiles must be square");if(l&&!["mapbox","terrarium","custom"].includes(l))return void Kr(`"${l}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=s.height;const T=this.dim=s.height-2;switch(this.data=new Uint32Array(s.data.buffer),l){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=d,this.greenFactor=_,this.blueFactor=y,this.baseShift=w;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let C=0;C<T;C++)this.data[this._idx(-1,C)]=this.data[this._idx(0,C)],this.data[this._idx(T,C)]=this.data[this._idx(T-1,C)],this.data[this._idx(C,-1)]=this.data[this._idx(C,0)],this.data[this._idx(C,T)]=this.data[this._idx(C,T-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(T,-1)]=this.data[this._idx(T-1,0)],this.data[this._idx(-1,T)]=this.data[this._idx(0,T-1)],this.data[this._idx(T,T)]=this.data[this._idx(T-1,T-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let C=0;C<T;C++)for(let M=0;M<T;M++){const I=this.get(C,M);I>this.max&&(this.max=I),I<this.min&&(this.min=I)}}get(r,s){const l=new Uint8Array(this.data.buffer),d=4*this._idx(r,s);return this.unpack(l[d],l[d+1],l[d+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(r,s){if(r<-1||r>=this.dim+1||s<-1||s>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(s+1)*this.stride+(r+1)}unpack(r,s,l){return r*this.redFactor+s*this.greenFactor+l*this.blueFactor-this.baseShift}getPixels(){return new Pi({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(r,s,l){if(this.dim!==r.dim)throw new Error("dem dimension mismatch");let d=s*this.dim,_=s*this.dim+this.dim,y=l*this.dim,w=l*this.dim+this.dim;switch(s){case-1:d=_-1;break;case 1:_=d+1}switch(l){case-1:y=w-1;break;case 1:w=y+1}const T=-s*this.dim,C=-l*this.dim;for(let M=y;M<w;M++)for(let I=d;I<_;I++)this.data[this._idx(I,M)]=r.data[this._idx(I+T,M+C)]}}nt("DEMData",p1);class f1{constructor(r){this._stringToNumber={},this._numberToString=[];for(let s=0;s<r.length;s++){const l=r[s];this._stringToNumber[l]=s,this._numberToString[s]=l}}encode(r){return this._stringToNumber[r]}decode(r){if(r>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${r} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[r]}}class m1{constructor(r,s,l,d,_){this.type="Feature",this._vectorTileFeature=r,r._z=s,r._x=l,r._y=d,this.properties=r.properties,this.id=_}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(r){this._geometry=r}toJSON(){const r={geometry:this.geometry};for(const s in this)s!=="_geometry"&&s!=="_vectorTileFeature"&&(r[s]=this[s]);return r}}class g1{constructor(r,s){this.tileID=r,this.x=r.canonical.x,this.y=r.canonical.y,this.z=r.canonical.z,this.grid=new el(St,16,0),this.grid3D=new el(St,16,0),this.featureIndexArray=new K,this.promoteId=s}insert(r,s,l,d,_,y){const w=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(l,d,_);const T=y?this.grid3D:this.grid;for(let C=0;C<s.length;C++){const M=s[C],I=[1/0,1/0,-1/0,-1/0];for(let D=0;D<M.length;D++){const B=M[D];I[0]=Math.min(I[0],B.x),I[1]=Math.min(I[1],B.y),I[2]=Math.max(I[2],B.x),I[3]=Math.max(I[3],B.y)}I[0]<St&&I[1]<St&&I[2]>=0&&I[3]>=0&&T.insert(w,I[0],I[1],I[2],I[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Oh.VectorTile(new P_(this.rawTileData)).layers,this.sourceLayerCoder=new f1(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(r,s,l,d){this.loadVTLayers();const _=r.params,y=St/r.tileSize/r.scale,w=ic(_.filter),T=r.queryGeometry,C=r.queryPadding*y,M=y1(T),I=this.grid.query(M.minX-C,M.minY-C,M.maxX+C,M.maxY+C),D=y1(r.cameraQueryGeometry),B=this.grid3D.query(D.minX-C,D.minY-C,D.maxX+C,D.maxY+C,(q,ne,me,ae)=>function(F,Z,ce,Ce,Ze){for(const Re of F)if(Z<=Re.x&&ce<=Re.y&&Ce>=Re.x&&Ze>=Re.y)return!0;const Ie=[new le(Z,ce),new le(Z,Ze),new le(Ce,Ze),new le(Ce,ce)];if(F.length>2){for(const Re of Ie)if(Sc(F,Re))return!0}for(let Re=0;Re<F.length-1;Re++)if(cP(F[Re],F[Re+1],Ie))return!0;return!1}(r.cameraQueryGeometry,q-C,ne-C,me+C,ae+C));for(const q of B)I.push(q);I.sort(wC);const O={};let $;for(let q=0;q<I.length;q++){const ne=I[q];if(ne===$)continue;$=ne;const me=this.featureIndexArray.get(ne);let ae=null;this.loadMatchingFeature(O,me.bucketIndex,me.sourceLayerIndex,me.featureIndex,w,_.layers,_.availableImages,s,l,d,(F,Z,ce)=>(ae||(ae=Ss(F)),Z.queryIntersectsFeature({queryGeometry:T,feature:F,featureState:ce,geometry:ae,zoom:this.z,transform:r.transform,pixelsToTileUnits:y,pixelPosMatrix:r.pixelPosMatrix})))}return O}loadMatchingFeature(r,s,l,d,_,y,w,T,C,M,I){const D=this.bucketLayerIDs[s];if(y&&!D.some(q=>y.has(q)))return;const B=this.sourceLayerCoder.decode(l),O=this.vtLayers[B].feature(d);if(_.needGeometry){const q=Kn(O,!0);if(!_.filter(new ar(this.tileID.overscaledZ),q,this.tileID.canonical))return}else if(!_.filter(new ar(this.tileID.overscaledZ),O))return;const $=this.getId(O,B);for(let q=0;q<D.length;q++){const ne=D[q];if(y&&!y.has(ne))continue;const me=T[ne];if(!me)continue;let ae={};$&&M&&(ae=M.getState(me.sourceLayer||"_geojsonTileLayer",$));const F=fr({},C[ne]);F.paint=_1(F.paint,me.paint,O,ae,w),F.layout=_1(F.layout,me.layout,O,ae,w);const Z=!I||I(O,me,ae);if(!Z)continue;const ce=new m1(O,this.z,this.x,this.y,$);ce.layer=F;let Ce=r[ne];Ce===void 0&&(Ce=r[ne]=[]),Ce.push({featureIndex:d,feature:ce,intersectionZ:Z})}}lookupSymbolFeatures(r,s,l,d,_,y,w,T){const C={};this.loadVTLayers();const M=ic(_);for(const I of r)this.loadMatchingFeature(C,l,d,I,M,y,w,T,s);return C}hasLayer(r){for(const s of this.bucketLayerIDs)for(const l of s)if(r===l)return!0;return!1}getId(r,s){var l;let d=r.id;return this.promoteId&&(d=r.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[s]],typeof d=="boolean"&&(d=Number(d)),d===void 0&&(!((l=r.properties)===null||l===void 0)&&l.cluster)&&this.promoteId&&(d=Number(r.properties.cluster_id))),d}}function _1(o,r,s,l,d){return zn(o,(_,y)=>{const w=r instanceof hc?r.get(y):null;return w&&w.evaluate?w.evaluate(s,l,d):w})}function y1(o){let r=1/0,s=1/0,l=-1/0,d=-1/0;for(const _ of o)r=Math.min(r,_.x),s=Math.min(s,_.y),l=Math.max(l,_.x),d=Math.max(d,_.y);return{minX:r,minY:s,maxX:l,maxY:d}}function wC(o,r){return r-o}function v1(o,r,s,l,d){const _=[];for(let y=0;y<o.length;y++){const w=o[y];let T;for(let C=0;C<w.length-1;C++){let M=w[C],I=w[C+1];M.x<r&&I.x<r||(M.x<r?M=new le(r,M.y+(r-M.x)/(I.x-M.x)*(I.y-M.y))._round():I.x<r&&(I=new le(r,M.y+(r-M.x)/(I.x-M.x)*(I.y-M.y))._round()),M.y<s&&I.y<s||(M.y<s?M=new le(M.x+(s-M.y)/(I.y-M.y)*(I.x-M.x),s)._round():I.y<s&&(I=new le(M.x+(s-M.y)/(I.y-M.y)*(I.x-M.x),s)._round()),M.x>=l&&I.x>=l||(M.x>=l?M=new le(l,M.y+(l-M.x)/(I.x-M.x)*(I.y-M.y))._round():I.x>=l&&(I=new le(l,M.y+(l-M.x)/(I.x-M.x)*(I.y-M.y))._round()),M.y>=d&&I.y>=d||(M.y>=d?M=new le(M.x+(d-M.y)/(I.y-M.y)*(I.x-M.x),d)._round():I.y>=d&&(I=new le(M.x+(d-M.y)/(I.y-M.y)*(I.x-M.x),d)._round()),T&&M.equals(T[T.length-1])||(T=[M],_.push(T)),T.push(I)))))}}return _}nt("FeatureIndex",g1,{omit:["rawTileData","sourceLayerCoder"]});class pa extends le{constructor(r,s,l,d){super(r,s),this.angle=l,d!==void 0&&(this.segment=d)}clone(){return new pa(this.x,this.y,this.angle,this.segment)}}function x1(o,r,s,l,d){if(r.segment===void 0||s===0)return!0;let _=r,y=r.segment+1,w=0;for(;w>-s/2;){if(y--,y<0)return!1;w-=o[y].dist(_),_=o[y]}w+=o[y].dist(o[y+1]),y++;const T=[];let C=0;for(;w<s/2;){const M=o[y],I=o[y+1];if(!I)return!1;let D=o[y-1].angleTo(M)-M.angleTo(I);for(D=Math.abs((D+3*Math.PI)%(2*Math.PI)-Math.PI),T.push({distance:w,angleDelta:D}),C+=D;w-T[0].distance>l;)C-=T.shift().angleDelta;if(C>d)return!1;y++,w+=M.dist(I)}return!0}function b1(o){let r=0;for(let s=0;s<o.length-1;s++)r+=o[s].dist(o[s+1]);return r}function w1(o,r,s){return o?.6*r*s:0}function S1(o,r){return Math.max(o?o.right-o.left:0,r?r.right-r.left:0)}function SC(o,r,s,l,d,_){const y=w1(s,d,_),w=S1(s,l)*_;let T=0;const C=b1(o)/2;for(let M=0;M<o.length-1;M++){const I=o[M],D=o[M+1],B=I.dist(D);if(T+B>C){const O=(C-T)/B,$=Hn.number(I.x,D.x,O),q=Hn.number(I.y,D.y,O),ne=new pa($,q,D.angleTo(I),M);return ne._round(),!y||x1(o,ne,w,y,r)?ne:void 0}T+=B}}function TC(o,r,s,l,d,_,y,w,T){const C=w1(l,_,y),M=S1(l,d),I=M*y,D=o[0].x===0||o[0].x===T||o[0].y===0||o[0].y===T;return r-I<r/4&&(r=I+r/4),T1(o,D?r/2*w%r:(M/2+2*_)*y*w%r,r,C,s,I,D,!1,T)}function T1(o,r,s,l,d,_,y,w,T){const C=_/2,M=b1(o);let I=0,D=r-s,B=[];for(let O=0;O<o.length-1;O++){const $=o[O],q=o[O+1],ne=$.dist(q),me=q.angleTo($);for(;D+s<I+ne;){D+=s;const ae=(D-I)/ne,F=Hn.number($.x,q.x,ae),Z=Hn.number($.y,q.y,ae);if(F>=0&&F<T&&Z>=0&&Z<T&&D-C>=0&&D+C<=M){const ce=new pa(F,Z,me,O);ce._round(),l&&!x1(o,ce,_,l,d)||B.push(ce)}}I+=ne}return w||B.length||y||(B=T1(o,I/2,s,l,d,_,y,!0,T)),B}nt("Anchor",pa);const Gh=Yn;function P1(o,r,s,l){const d=[],_=o.image,y=_.pixelRatio,w=_.paddedRect.w-2*Gh,T=_.paddedRect.h-2*Gh;let C={x1:o.left,y1:o.top,x2:o.right,y2:o.bottom};const M=_.stretchX||[[0,w]],I=_.stretchY||[[0,T]],D=(Ne,it)=>Ne+it[1]-it[0],B=M.reduce(D,0),O=I.reduce(D,0),$=w-B,q=T-O;let ne=0,me=B,ae=0,F=O,Z=0,ce=$,Ce=0,Ze=q;if(_.content&&l){const Ne=_.content,it=Ne[2]-Ne[0],vt=Ne[3]-Ne[1];(_.textFitWidth||_.textFitHeight)&&(C=Yx(o)),ne=uf(M,0,Ne[0]),ae=uf(I,0,Ne[1]),me=uf(M,Ne[0],Ne[2]),F=uf(I,Ne[1],Ne[3]),Z=Ne[0]-ne,Ce=Ne[1]-ae,ce=it-me,Ze=vt-F}const Ie=C.x1,Re=C.y1,He=C.x2-Ie,qe=C.y2-Re,Xe=(Ne,it,vt,yt)=>{const ct=hf(Ne.stretch-ne,me,He,Ie),zt=df(Ne.fixed-Z,ce,Ne.stretch,B),yr=hf(it.stretch-ae,F,qe,Re),Gr=df(it.fixed-Ce,Ze,it.stretch,O),xn=hf(vt.stretch-ne,me,He,Ie),Ei=df(vt.fixed-Z,ce,vt.stretch,B),Qn=hf(yt.stretch-ae,F,qe,Re),hn=df(yt.fixed-Ce,Ze,yt.stretch,O),dr=new le(ct,yr),tn=new le(xn,yr),dn=new le(xn,Qn),pn=new le(ct,Qn),jn=new le(zt/y,Gr/y),Mi=new le(Ei/y,hn/y),rn=r*Math.PI/180;if(rn){const nn=Math.sin(rn),on=Math.cos(rn),Fr=[on,-nn,nn,on];dr._matMult(Fr),tn._matMult(Fr),pn._matMult(Fr),dn._matMult(Fr)}const Jn=Ne.stretch+Ne.fixed,qr=it.stretch+it.fixed;return{tl:dr,tr:tn,bl:pn,br:dn,tex:{x:_.paddedRect.x+Gh+Jn,y:_.paddedRect.y+Gh+qr,w:vt.stretch+vt.fixed-Jn,h:yt.stretch+yt.fixed-qr},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:jn,pixelOffsetBR:Mi,minFontScaleX:ce/y/He,minFontScaleY:Ze/y/qe,isSDF:s}};if(l&&(_.stretchX||_.stretchY)){const Ne=C1(M,$,B),it=C1(I,q,O);for(let vt=0;vt<Ne.length-1;vt++){const yt=Ne[vt],ct=Ne[vt+1];for(let zt=0;zt<it.length-1;zt++)d.push(Xe(yt,it[zt],ct,it[zt+1]))}}else d.push(Xe({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:w+1},{fixed:0,stretch:T+1}));return d}function uf(o,r,s){let l=0;for(const d of o)l+=Math.max(r,Math.min(s,d[1]))-Math.max(r,Math.min(s,d[0]));return l}function C1(o,r,s){const l=[{fixed:-1,stretch:0}];for(const[d,_]of o){const y=l[l.length-1];l.push({fixed:d-y.stretch,stretch:y.stretch}),l.push({fixed:d-y.stretch,stretch:y.stretch+(_-d)})}return l.push({fixed:r+Gh,stretch:s}),l}function hf(o,r,s,l){return o/r*s+l}function df(o,r,s,l){return o-r*s/l}class pf{constructor(r,s,l,d,_,y,w,T,C,M){var I;if(this.boxStartIndex=r.length,C){let D=y.top,B=y.bottom;const O=y.collisionPadding;O&&(D-=O[1],B+=O[3]);let $=B-D;$>0&&($=Math.max(10,$),this.circleDiameter=$)}else{const D=!((I=y.image)===null||I===void 0)&&I.content&&(y.image.textFitWidth||y.image.textFitHeight)?Yx(y):{x1:y.left,y1:y.top,x2:y.right,y2:y.bottom};D.y1=D.y1*w-T[0],D.y2=D.y2*w+T[2],D.x1=D.x1*w-T[3],D.x2=D.x2*w+T[1];const B=y.collisionPadding;if(B&&(D.x1-=B[0]*w,D.y1-=B[1]*w,D.x2+=B[2]*w,D.y2+=B[3]*w),M){const O=new le(D.x1,D.y1),$=new le(D.x2,D.y1),q=new le(D.x1,D.y2),ne=new le(D.x2,D.y2),me=M*Math.PI/180;O._rotate(me),$._rotate(me),q._rotate(me),ne._rotate(me),D.x1=Math.min(O.x,$.x,q.x,ne.x),D.x2=Math.max(O.x,$.x,q.x,ne.x),D.y1=Math.min(O.y,$.y,q.y,ne.y),D.y2=Math.max(O.y,$.y,q.y,ne.y)}r.emplaceBack(s.x,s.y,D.x1,D.y1,D.x2,D.y2,l,d,_)}this.boxEndIndex=r.length}}class PC{constructor(r=[],s=(l,d)=>l<d?-1:l>d?1:0){if(this.data=r,this.length=this.data.length,this.compare=s,this.length>0)for(let l=(this.length>>1)-1;l>=0;l--)this._down(l)}push(r){this.data.push(r),this._up(this.length++)}pop(){if(this.length===0)return;const r=this.data[0],s=this.data.pop();return--this.length>0&&(this.data[0]=s,this._down(0)),r}peek(){return this.data[0]}_up(r){const{data:s,compare:l}=this,d=s[r];for(;r>0;){const _=r-1>>1,y=s[_];if(l(d,y)>=0)break;s[r]=y,r=_}s[r]=d}_down(r){const{data:s,compare:l}=this,d=this.length>>1,_=s[r];for(;r<d;){let y=1+(r<<1);const w=y+1;if(w<this.length&&l(s[w],s[y])<0&&(y=w),l(s[y],_)>=0)break;s[r]=s[y],r=y}s[r]=_}}function CC(o,r=1,s=!1){let l=1/0,d=1/0,_=-1/0,y=-1/0;const w=o[0];for(let B=0;B<w.length;B++){const O=w[B];(!B||O.x<l)&&(l=O.x),(!B||O.y<d)&&(d=O.y),(!B||O.x>_)&&(_=O.x),(!B||O.y>y)&&(y=O.y)}const T=Math.min(_-l,y-d);let C=T/2;const M=new PC([],EC);if(T===0)return new le(l,d);for(let B=l;B<_;B+=T)for(let O=d;O<y;O+=T)M.push(new kc(B+C,O+C,C,o));let I=function(B){let O=0,$=0,q=0;const ne=B[0];for(let me=0,ae=ne.length,F=ae-1;me<ae;F=me++){const Z=ne[me],ce=ne[F],Ce=Z.x*ce.y-ce.x*Z.y;$+=(Z.x+ce.x)*Ce,q+=(Z.y+ce.y)*Ce,O+=3*Ce}return new kc($/O,q/O,0,B)}(o),D=M.length;for(;M.length;){const B=M.pop();(B.d>I.d||!I.d)&&(I=B,s&&console.log("found best %d after %d probes",Math.round(1e4*B.d)/1e4,D)),B.max-I.d<=r||(C=B.h/2,M.push(new kc(B.p.x-C,B.p.y-C,C,o)),M.push(new kc(B.p.x+C,B.p.y-C,C,o)),M.push(new kc(B.p.x-C,B.p.y+C,C,o)),M.push(new kc(B.p.x+C,B.p.y+C,C,o)),D+=4)}return s&&(console.log(`num probes: ${D}`),console.log(`best distance: ${I.d}`)),I.p}function EC(o,r){return r.max-o.max}function kc(o,r,s,l){this.p=new le(o,r),this.h=s,this.d=function(d,_){let y=!1,w=1/0;for(let T=0;T<_.length;T++){const C=_[T];for(let M=0,I=C.length,D=I-1;M<I;D=M++){const B=C[M],O=C[D];B.y>d.y!=O.y>d.y&&d.x<(O.x-B.x)*(d.y-B.y)/(O.y-B.y)+B.x&&(y=!y),w=Math.min(w,sx(d,B,O))}}return(y?1:-1)*Math.sqrt(w)}(this.p,l),this.max=this.d+this.h*Math.SQRT2}var vn;x.ax=void 0,(vn=x.ax||(x.ax={}))[vn.center=1]="center",vn[vn.left=2]="left",vn[vn.right=3]="right",vn[vn.top=4]="top",vn[vn.bottom=5]="bottom",vn[vn["top-left"]=6]="top-left",vn[vn["top-right"]=7]="top-right",vn[vn["bottom-left"]=8]="bottom-left",vn[vn["bottom-right"]=9]="bottom-right";const fa=7,O_=Number.POSITIVE_INFINITY;function E1(o,r){return r[1]!==O_?function(s,l,d){let _=0,y=0;switch(l=Math.abs(l),d=Math.abs(d),s){case"top-right":case"top-left":case"top":y=d-fa;break;case"bottom-right":case"bottom-left":case"bottom":y=-d+fa}switch(s){case"top-right":case"bottom-right":case"right":_=-l;break;case"top-left":case"bottom-left":case"left":_=l}return[_,y]}(o,r[0],r[1]):function(s,l){let d=0,_=0;l<0&&(l=0);const y=l/Math.SQRT2;switch(s){case"top-right":case"top-left":_=y-fa;break;case"bottom-right":case"bottom-left":_=-y+fa;break;case"bottom":_=-l+fa;break;case"top":_=l-fa}switch(s){case"top-right":case"bottom-right":d=-y;break;case"top-left":case"bottom-left":d=y;break;case"left":d=l;break;case"right":d=-l}return[d,_]}(o,r[0])}function M1(o,r,s){var l;const d=o.layout,_=(l=d.get("text-variable-anchor-offset"))===null||l===void 0?void 0:l.evaluate(r,{},s);if(_){const w=_.values,T=[];for(let C=0;C<w.length;C+=2){const M=T[C]=w[C],I=w[C+1].map(D=>D*Zr);M.startsWith("top")?I[1]-=fa:M.startsWith("bottom")&&(I[1]+=fa),T[C+1]=I}return new Qr(T)}const y=d.get("text-variable-anchor");if(y){let w;w=o._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[d.get("text-radial-offset").evaluate(r,{},s)*Zr,O_]:d.get("text-offset").evaluate(r,{},s).map(C=>C*Zr);const T=[];for(const C of y)T.push(C,E1(C,w));return new Qr(T)}return null}function j_(o){switch(o){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function MC(o,r,s,l,d,_,y,w,T,C,M,I){let D=_.textMaxSize.evaluate(r,{});D===void 0&&(D=y);const B=o.layers[0].layout,O=B.get("icon-offset").evaluate(r,{},M),$=k1(s.horizontal),q=y/24,ne=o.tilePixelRatio*q,me=o.tilePixelRatio*D/24,ae=o.tilePixelRatio*w,F=o.tilePixelRatio*B.get("symbol-spacing"),Z=B.get("text-padding")*o.tilePixelRatio,ce=function(vt,yt,ct,zt=1){const yr=vt.get("icon-padding").evaluate(yt,{},ct),Gr=yr&&yr.values;return[Gr[0]*zt,Gr[1]*zt,Gr[2]*zt,Gr[3]*zt]}(B,r,M,o.tilePixelRatio),Ce=B.get("text-max-angle")/180*Math.PI,Ze=B.get("text-rotation-alignment")!=="viewport"&&B.get("symbol-placement")!=="point",Ie=B.get("icon-rotation-alignment")==="map"&&B.get("symbol-placement")!=="point",Re=B.get("symbol-placement"),He=F/2,qe=B.get("icon-text-fit");let Xe;l&&qe!=="none"&&(o.allowVerticalPlacement&&s.vertical&&(Xe=Qx(l,s.vertical,qe,B.get("icon-text-fit-padding"),O,q)),$&&(l=Qx(l,$,qe,B.get("icon-text-fit-padding"),O,q)));const Ne=M?I.line.getGranularityForZoomLevel(M.z):1,it=(vt,yt)=>{yt.x<0||yt.x>=St||yt.y<0||yt.y>=St||function(ct,zt,yr,Gr,xn,Ei,Qn,hn,dr,tn,dn,pn,jn,Mi,rn,Jn,qr,nn,on,Fr,ir,go,Ac,_o,AC){const zc=ct.addToLineVertexArray(zt,yr);let cl,Rc,Lc,Dc,L1=0,D1=0,F1=0,B1=0,W_=-1,H_=-1;const Ts={};let O1=$r("");if(ct.allowVerticalPlacement&&Gr.vertical){const En=hn.layout.get("text-rotate").evaluate(ir,{},_o)+90;Lc=new pf(dr,zt,tn,dn,pn,Gr.vertical,jn,Mi,rn,En),Qn&&(Dc=new pf(dr,zt,tn,dn,pn,Qn,qr,nn,rn,En))}if(xn){const En=hn.layout.get("icon-rotate").evaluate(ir,{}),Ii=hn.layout.get("icon-text-fit")!=="none",ul=P1(xn,En,Ac,Ii),vo=Qn?P1(Qn,En,Ac,Ii):void 0;Rc=new pf(dr,zt,tn,dn,pn,xn,qr,nn,!1,En),L1=4*ul.length;const hl=ct.iconSizeData;let No=null;hl.kind==="source"?(No=[jo*hn.layout.get("icon-size").evaluate(ir,{})],No[0]>ha&&Kr(`${ct.layerIds[0]}: Value for "icon-size" is >= ${Uh}. Reduce your "icon-size".`)):hl.kind==="composite"&&(No=[jo*go.compositeIconSizes[0].evaluate(ir,{},_o),jo*go.compositeIconSizes[1].evaluate(ir,{},_o)],(No[0]>ha||No[1]>ha)&&Kr(`${ct.layerIds[0]}: Value for "icon-size" is >= ${Uh}. Reduce your "icon-size".`)),ct.addSymbols(ct.icon,ul,No,Fr,on,ir,x.ag.none,zt,zc.lineStartIndex,zc.lineLength,-1,_o),W_=ct.icon.placedSymbolArray.length-1,vo&&(D1=4*vo.length,ct.addSymbols(ct.icon,vo,No,Fr,on,ir,x.ag.vertical,zt,zc.lineStartIndex,zc.lineLength,-1,_o),H_=ct.icon.placedSymbolArray.length-1)}const j1=Object.keys(Gr.horizontal);for(const En of j1){const Ii=Gr.horizontal[En];if(!cl){O1=$r(Ii.text);const vo=hn.layout.get("text-rotate").evaluate(ir,{},_o);cl=new pf(dr,zt,tn,dn,pn,Ii,jn,Mi,rn,vo)}const ul=Ii.positionedLines.length===1;if(F1+=I1(ct,zt,Ii,Ei,hn,rn,ir,Jn,zc,Gr.vertical?x.ag.horizontal:x.ag.horizontalOnly,ul?j1:[En],Ts,W_,go,_o),ul)break}Gr.vertical&&(B1+=I1(ct,zt,Gr.vertical,Ei,hn,rn,ir,Jn,zc,x.ag.vertical,["vertical"],Ts,H_,go,_o));const zC=cl?cl.boxStartIndex:ct.collisionBoxArray.length,RC=cl?cl.boxEndIndex:ct.collisionBoxArray.length,LC=Lc?Lc.boxStartIndex:ct.collisionBoxArray.length,DC=Lc?Lc.boxEndIndex:ct.collisionBoxArray.length,FC=Rc?Rc.boxStartIndex:ct.collisionBoxArray.length,BC=Rc?Rc.boxEndIndex:ct.collisionBoxArray.length,OC=Dc?Dc.boxStartIndex:ct.collisionBoxArray.length,jC=Dc?Dc.boxEndIndex:ct.collisionBoxArray.length;let yo=-1;const mf=(En,Ii)=>En&&En.circleDiameter?Math.max(En.circleDiameter,Ii):Ii;yo=mf(cl,yo),yo=mf(Lc,yo),yo=mf(Rc,yo),yo=mf(Dc,yo);const N1=yo>-1?1:0;N1&&(yo*=AC/Zr),ct.glyphOffsetArray.length>=Mc.MAX_GLYPHS&&Kr("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),ir.sortKey!==void 0&&ct.addToSortKeyRanges(ct.symbolInstances.length,ir.sortKey);const NC=M1(hn,ir,_o),[$C,VC]=function(En,Ii){const ul=En.length,vo=Ii==null?void 0:Ii.values;if((vo==null?void 0:vo.length)>0)for(let hl=0;hl<vo.length;hl+=2){const No=vo[hl+1];En.emplaceBack(x.ax[vo[hl]],No[0],No[1])}return[ul,En.length]}(ct.textAnchorOffsets,NC);ct.symbolInstances.emplaceBack(zt.x,zt.y,Ts.right>=0?Ts.right:-1,Ts.center>=0?Ts.center:-1,Ts.left>=0?Ts.left:-1,Ts.vertical||-1,W_,H_,O1,zC,RC,LC,DC,FC,BC,OC,jC,tn,F1,B1,L1,D1,N1,0,jn,yo,$C,VC)}(o,yt,vt,s,l,d,Xe,o.layers[0],o.collisionBoxArray,r.index,r.sourceLayerIndex,o.index,ne,[Z,Z,Z,Z],Ze,T,ae,ce,Ie,O,r,_,C,M,y)};if(Re==="line")for(const vt of v1(r.geometry,0,0,St,St)){const yt=ll(vt,Ne),ct=TC(yt,F,Ce,s.vertical||$,l,24,me,o.overscaling,St);for(const zt of ct)$&&IC(o,$.text,He,zt)||it(yt,zt)}else if(Re==="line-center"){for(const vt of r.geometry)if(vt.length>1){const yt=ll(vt,Ne),ct=SC(yt,Ce,s.vertical||$,l,24,me);ct&&it(yt,ct)}}else if(r.type==="Polygon")for(const vt of Ul(r.geometry,0)){const yt=CC(vt,16);it(ll(vt[0],Ne,!0),new pa(yt.x,yt.y,0))}else if(r.type==="LineString")for(const vt of r.geometry){const yt=ll(vt,Ne);it(yt,new pa(yt[0].x,yt[0].y,0))}else if(r.type==="Point")for(const vt of r.geometry)for(const yt of vt)it([yt],new pa(yt.x,yt.y,0))}function I1(o,r,s,l,d,_,y,w,T,C,M,I,D,B,O){const $=function(me,ae,F,Z,ce,Ce,Ze,Ie){const Re=Z.layout.get("text-rotate").evaluate(Ce,{})*Math.PI/180,He=[];for(const qe of ae.positionedLines)for(const Xe of qe.positionedGlyphs){if(!Xe.rect)continue;const Ne=Xe.rect||{};let it=rC+1,vt=!0,yt=1,ct=0;const zt=(ce||Ie)&&Xe.vertical,yr=Xe.metrics.advance*Xe.scale/2;if(Ie&&ae.verticalizable&&(ct=qe.lineOffset/2-(Xe.imageName?-(Zr-Xe.metrics.width*Xe.scale)/2:(Xe.scale-1)*Zr)),Xe.imageName){const nn=Ze[Xe.imageName];vt=nn.sdf,yt=nn.pixelRatio,it=Yn/yt}const Gr=ce?[Xe.x+yr,Xe.y]:[0,0];let xn=ce?[0,0]:[Xe.x+yr+F[0],Xe.y+F[1]-ct],Ei=[0,0];zt&&(Ei=xn,xn=[0,0]);const Qn=Xe.metrics.isDoubleResolution?2:1,hn=(Xe.metrics.left-it)*Xe.scale-yr+xn[0],dr=(-Xe.metrics.top-it)*Xe.scale+xn[1],tn=hn+Ne.w/Qn*Xe.scale/yt,dn=dr+Ne.h/Qn*Xe.scale/yt,pn=new le(hn,dr),jn=new le(tn,dr),Mi=new le(hn,dn),rn=new le(tn,dn);if(zt){const nn=new le(-yr,yr-of),on=-Math.PI/2,Fr=Zr/2-yr,ir=new le(5-of-Fr,-(Xe.imageName?Fr:0)),go=new le(...Ei);pn._rotateAround(on,nn)._add(ir)._add(go),jn._rotateAround(on,nn)._add(ir)._add(go),Mi._rotateAround(on,nn)._add(ir)._add(go),rn._rotateAround(on,nn)._add(ir)._add(go)}if(Re){const nn=Math.sin(Re),on=Math.cos(Re),Fr=[on,-nn,nn,on];pn._matMult(Fr),jn._matMult(Fr),Mi._matMult(Fr),rn._matMult(Fr)}const Jn=new le(0,0),qr=new le(0,0);He.push({tl:pn,tr:jn,bl:Mi,br:rn,tex:Ne,writingMode:ae.writingMode,glyphOffset:Gr,sectionIndex:Xe.sectionIndex,isSDF:vt,pixelOffsetTL:Jn,pixelOffsetBR:qr,minFontScaleX:0,minFontScaleY:0})}return He}(0,s,w,d,_,y,l,o.allowVerticalPlacement),q=o.textSizeData;let ne=null;q.kind==="source"?(ne=[jo*d.layout.get("text-size").evaluate(y,{})],ne[0]>ha&&Kr(`${o.layerIds[0]}: Value for "text-size" is >= ${Uh}. Reduce your "text-size".`)):q.kind==="composite"&&(ne=[jo*B.compositeTextSizes[0].evaluate(y,{},O),jo*B.compositeTextSizes[1].evaluate(y,{},O)],(ne[0]>ha||ne[1]>ha)&&Kr(`${o.layerIds[0]}: Value for "text-size" is >= ${Uh}. Reduce your "text-size".`)),o.addSymbols(o.text,$,ne,w,_,y,C,r,T.lineStartIndex,T.lineLength,D,O);for(const me of M)I[me]=o.text.placedSymbolArray.length-1;return 4*$.length}function k1(o){for(const r in o)return o[r];return null}function IC(o,r,s,l){const d=o.compareText;if(r in d){const _=d[r];for(let y=_.length-1;y>=0;y--)if(l.dist(_[y])<s)return!0}else d[r]=[];return d[r].push(l),!1}const A1=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class N_{static from(r){if(!(r instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[s,l]=new Uint8Array(r,0,2);if(s!==219)throw new Error("Data does not appear to be in a KDBush format.");const d=l>>4;if(d!==1)throw new Error(`Got v${d} data when expected v1.`);const _=A1[15&l];if(!_)throw new Error("Unrecognized array type.");const[y]=new Uint16Array(r,2,1),[w]=new Uint32Array(r,4,1);return new N_(w,y,_,r)}constructor(r,s=64,l=Float64Array,d){if(isNaN(r)||r<0)throw new Error(`Unpexpected numItems value: ${r}.`);this.numItems=+r,this.nodeSize=Math.min(Math.max(+s,2),65535),this.ArrayType=l,this.IndexArrayType=r<65536?Uint16Array:Uint32Array;const _=A1.indexOf(this.ArrayType),y=2*r*this.ArrayType.BYTES_PER_ELEMENT,w=r*this.IndexArrayType.BYTES_PER_ELEMENT,T=(8-w%8)%8;if(_<0)throw new Error(`Unexpected typed array class: ${l}.`);d&&d instanceof ArrayBuffer?(this.data=d,this.ids=new this.IndexArrayType(this.data,8,r),this.coords=new this.ArrayType(this.data,8+w+T,2*r),this._pos=2*r,this._finished=!0):(this.data=new ArrayBuffer(8+y+w+T),this.ids=new this.IndexArrayType(this.data,8,r),this.coords=new this.ArrayType(this.data,8+w+T,2*r),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+_]),new Uint16Array(this.data,2,1)[0]=s,new Uint32Array(this.data,4,1)[0]=r)}add(r,s){const l=this._pos>>1;return this.ids[l]=l,this.coords[this._pos++]=r,this.coords[this._pos++]=s,l}finish(){const r=this._pos>>1;if(r!==this.numItems)throw new Error(`Added ${r} items when expected ${this.numItems}.`);return $_(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(r,s,l,d){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:_,coords:y,nodeSize:w}=this,T=[0,_.length-1,0],C=[];for(;T.length;){const M=T.pop()||0,I=T.pop()||0,D=T.pop()||0;if(I-D<=w){for(let q=D;q<=I;q++){const ne=y[2*q],me=y[2*q+1];ne>=r&&ne<=l&&me>=s&&me<=d&&C.push(_[q])}continue}const B=D+I>>1,O=y[2*B],$=y[2*B+1];O>=r&&O<=l&&$>=s&&$<=d&&C.push(_[B]),(M===0?r<=O:s<=$)&&(T.push(D),T.push(B-1),T.push(1-M)),(M===0?l>=O:d>=$)&&(T.push(B+1),T.push(I),T.push(1-M))}return C}within(r,s,l){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:d,coords:_,nodeSize:y}=this,w=[0,d.length-1,0],T=[],C=l*l;for(;w.length;){const M=w.pop()||0,I=w.pop()||0,D=w.pop()||0;if(I-D<=y){for(let q=D;q<=I;q++)R1(_[2*q],_[2*q+1],r,s)<=C&&T.push(d[q]);continue}const B=D+I>>1,O=_[2*B],$=_[2*B+1];R1(O,$,r,s)<=C&&T.push(d[B]),(M===0?r-l<=O:s-l<=$)&&(w.push(D),w.push(B-1),w.push(1-M)),(M===0?r+l>=O:s+l>=$)&&(w.push(B+1),w.push(I),w.push(1-M))}return T}}function $_(o,r,s,l,d,_){if(d-l<=s)return;const y=l+d>>1;z1(o,r,y,l,d,_),$_(o,r,s,l,y-1,1-_),$_(o,r,s,y+1,d,1-_)}function z1(o,r,s,l,d,_){for(;d>l;){if(d-l>600){const C=d-l+1,M=s-l+1,I=Math.log(C),D=.5*Math.exp(2*I/3),B=.5*Math.sqrt(I*D*(C-D)/C)*(M-C/2<0?-1:1);z1(o,r,s,Math.max(l,Math.floor(s-M*D/C+B)),Math.min(d,Math.floor(s+(C-M)*D/C+B)),_)}const y=r[2*s+_];let w=l,T=d;for(qh(o,r,l,s),r[2*d+_]>y&&qh(o,r,l,d);w<T;){for(qh(o,r,w,T),w++,T--;r[2*w+_]<y;)w++;for(;r[2*T+_]>y;)T--}r[2*l+_]===y?qh(o,r,l,T):(T++,qh(o,r,T,d)),T<=s&&(l=T+1),s<=T&&(d=T-1)}}function qh(o,r,s,l){V_(o,s,l),V_(r,2*s,2*l),V_(r,2*s+1,2*l+1)}function V_(o,r,s){const l=o[r];o[r]=o[s],o[s]=l}function R1(o,r,s,l){const d=o-s,_=r-l;return d*d+_*_}var U_;x.cg=void 0,(U_=x.cg||(x.cg={})).create="create",U_.load="load",U_.fullLoad="fullLoad";let ff=null,Wh=[];const Z_=1e3/60,G_="loadTime",q_="fullLoadTime",kC={mark(o){performance.mark(o)},frame(o){const r=o;ff!=null&&Wh.push(r-ff),ff=r},clearMetrics(){ff=null,Wh=[],performance.clearMeasures(G_),performance.clearMeasures(q_);for(const o in x.cg)performance.clearMarks(x.cg[o])},getPerformanceMetrics(){performance.measure(G_,x.cg.create,x.cg.load),performance.measure(q_,x.cg.create,x.cg.fullLoad);const o=performance.getEntriesByName(G_)[0].duration,r=performance.getEntriesByName(q_)[0].duration,s=Wh.length,l=1/(Wh.reduce((_,y)=>_+y,0)/s/1e3),d=Wh.filter(_=>_>Z_).reduce((_,y)=>_+(y-Z_)/Z_,0);return{loadTime:o,fullLoadTime:r,fps:l,percentDroppedFrames:d/(s+d)*100,totalFrames:s}}};x.$=Zh,x.A=ze,x.B=Hn,x.C=ar,x.D=pt,x.E=be,x.F=jp,x.G=function(o){if(or==null){const r=o.navigator?o.navigator.userAgent:null;or=!!o.safari||!(!r||!(/\b(iPad|iPhone|iPod)\b/.test(r)||r.match("Safari")&&!r.match("Chrome")))}return or},x.H=class{constructor(o,r){this.target=o,this.mapId=r,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new xC(()=>this.process()),this.subscription=Gn(this.target,"message",s=>this.receive(s),!1),this.globalScope=xi(self)?o:window}registerMessageHandler(o,r){this.messageHandlers[o]=r}sendAsync(o,r){return new Promise((s,l)=>{const d=Math.round(1e18*Math.random()).toString(36).substring(0,10),_=r?Gn(r.signal,"abort",()=>{_==null||_.unsubscribe(),delete this.resolveRejects[d];const T={id:d,type:"<cancel>",origin:location.origin,targetMapId:o.targetMapId,sourceMapId:this.mapId};this.target.postMessage(T)},bC):null;this.resolveRejects[d]={resolve:T=>{_==null||_.unsubscribe(),s(T)},reject:T=>{_==null||_.unsubscribe(),l(T)}};const y=[],w=Object.assign(Object.assign({},o),{id:d,sourceMapId:this.mapId,origin:location.origin,data:Fo(o.data,y)});this.target.postMessage(w,{transfer:y})})}receive(o){const r=o.data,s=r.id;if(!(r.origin!=="file://"&&location.origin!=="file://"&&r.origin!=="resource://android"&&location.origin!=="resource://android"&&r.origin!==location.origin||r.targetMapId&&this.mapId!==r.targetMapId)){if(r.type==="<cancel>"){delete this.tasks[s];const l=this.abortControllers[s];return delete this.abortControllers[s],void(l&&l.abort())}if(xi(self)||r.mustQueue)return this.tasks[s]=r,this.taskQueue.push(s),void this.invoker.trigger();this.processTask(s,r)}}process(){if(this.taskQueue.length===0)return;const o=this.taskQueue.shift(),r=this.tasks[o];delete this.tasks[o],this.taskQueue.length>0&&this.invoker.trigger(),r&&this.processTask(o,r)}processTask(o,r){return c(this,void 0,void 0,function*(){if(r.type==="<response>"){const d=this.resolveRejects[o];return delete this.resolveRejects[o],d?void(r.error?d.reject(tl(r.error)):d.resolve(tl(r.data))):void 0}if(!this.messageHandlers[r.type])return void this.completeTask(o,new Error(`Could not find a registered handler for ${r.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const s=tl(r.data),l=new AbortController;this.abortControllers[o]=l;try{const d=yield this.messageHandlers[r.type](r.sourceMapId,s,l);this.completeTask(o,null,d)}catch(d){this.completeTask(o,d)}})}completeTask(o,r,s){const l=[];delete this.abortControllers[o];const d={id:o,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:r?Fo(r):null,data:Fo(s,l)};this.target.postMessage(d,{transfer:l})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},x.I=E_,x.J=ns,x.K=function(){var o=new ze(16);return ze!=Float32Array&&(o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[11]=0,o[12]=0,o[13]=0,o[14]=0),o[0]=1,o[5]=1,o[10]=1,o[15]=1,o},x.L=function(o,r,s){var l,d,_,y,w,T,C,M,I,D,B,O,$=s[0],q=s[1],ne=s[2];return r===o?(o[12]=r[0]*$+r[4]*q+r[8]*ne+r[12],o[13]=r[1]*$+r[5]*q+r[9]*ne+r[13],o[14]=r[2]*$+r[6]*q+r[10]*ne+r[14],o[15]=r[3]*$+r[7]*q+r[11]*ne+r[15]):(d=r[1],_=r[2],y=r[3],w=r[4],T=r[5],C=r[6],M=r[7],I=r[8],D=r[9],B=r[10],O=r[11],o[0]=l=r[0],o[1]=d,o[2]=_,o[3]=y,o[4]=w,o[5]=T,o[6]=C,o[7]=M,o[8]=I,o[9]=D,o[10]=B,o[11]=O,o[12]=l*$+w*q+I*ne+r[12],o[13]=d*$+T*q+D*ne+r[13],o[14]=_*$+C*q+B*ne+r[14],o[15]=y*$+M*q+O*ne+r[15]),o},x.M=function(o,r,s){var l=s[0],d=s[1],_=s[2];return o[0]=r[0]*l,o[1]=r[1]*l,o[2]=r[2]*l,o[3]=r[3]*l,o[4]=r[4]*d,o[5]=r[5]*d,o[6]=r[6]*d,o[7]=r[7]*d,o[8]=r[8]*_,o[9]=r[9]*_,o[10]=r[10]*_,o[11]=r[11]*_,o[12]=r[12],o[13]=r[13],o[14]=r[14],o[15]=r[15],o},x.N=function(o,r,s){var l=r[0],d=r[1],_=r[2],y=r[3],w=r[4],T=r[5],C=r[6],M=r[7],I=r[8],D=r[9],B=r[10],O=r[11],$=r[12],q=r[13],ne=r[14],me=r[15],ae=s[0],F=s[1],Z=s[2],ce=s[3];return o[0]=ae*l+F*w+Z*I+ce*$,o[1]=ae*d+F*T+Z*D+ce*q,o[2]=ae*_+F*C+Z*B+ce*ne,o[3]=ae*y+F*M+Z*O+ce*me,o[4]=(ae=s[4])*l+(F=s[5])*w+(Z=s[6])*I+(ce=s[7])*$,o[5]=ae*d+F*T+Z*D+ce*q,o[6]=ae*_+F*C+Z*B+ce*ne,o[7]=ae*y+F*M+Z*O+ce*me,o[8]=(ae=s[8])*l+(F=s[9])*w+(Z=s[10])*I+(ce=s[11])*$,o[9]=ae*d+F*T+Z*D+ce*q,o[10]=ae*_+F*C+Z*B+ce*ne,o[11]=ae*y+F*M+Z*O+ce*me,o[12]=(ae=s[12])*l+(F=s[13])*w+(Z=s[14])*I+(ce=s[15])*$,o[13]=ae*d+F*T+Z*D+ce*q,o[14]=ae*_+F*C+Z*B+ce*ne,o[15]=ae*y+F*M+Z*O+ce*me,o},x.O=function(o,r){const s={};for(let l=0;l<r.length;l++){const d=r[l];d in o&&(s[d]=o[d])}return s},x.P=le,x.Q=da,x.R=Pi,x.S=l1,x.T=bh,x.U=a1,x.V=se,x.W=_e,x.X=gn,x.Y=Ci,x.Z=St,x._=c,x.a=rs,x.a$=function(){const o=new Float32Array(16);return gt(o),o},x.a0=B_,x.a1=o=>{const r=window.document.createElement("video");return r.muted=!0,new Promise(s=>{r.onloadstart=()=>{s(r)};for(const l of o){const d=window.document.createElement("source");ko(l)||(r.crossOrigin="Anonymous"),d.src=l,r.appendChild(d)}})},x.a2=Te,x.a3=function(){return ln++},x.a4=v,x.a5=Mc,x.a6=ic,x.a7=Kn,x.a8=m1,x.a9=function(o){const r={};if(o.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(s,l,d,_)=>{const y=d||_;return r[l]=!y||y.toLowerCase(),""}),r["max-age"]){const s=parseInt(r["max-age"],10);isNaN(s)?delete r["max-age"]:r["max-age"]=s}return r},x.aA=I_,x.aB=N_,x.aC=Mr,x.aD=tf,x.aE=te,x.aF=mt,x.aG=Qe,x.aH=function(o){return Math.pow(2,o)},x.aI=85.051129,x.aJ=c1,x.aK=wr,x.aL=qn,x.aM=u1,x.aN=function(o,r,s){return o[0]=r[0]*s,o[1]=r[1]*s,o[2]=r[2]*s,o},x.aO=function(o,r,s){return o[0]=r[0]+s[0],o[1]=r[1]+s[1],o[2]=r[2]+s[2],o},x.aP=function(o){var r=new ze(3);return r[0]=o[0],r[1]=o[1],r[2]=o[2],r},x.aQ=function(o,r,s){return o[0]=r[0]*s[0],o[1]=r[1]*s[1],o[2]=r[2]*s[2],o[3]=r[3]*s[3],o},x.aR=function(o,r,s){return o[0]=r[0]-s[0],o[1]=r[1]-s[1],o[2]=r[2]-s[2],o},x.aS=function(o,r){var s=r[0],l=r[1],d=r[2],_=s*s+l*l+d*d;return _>0&&(_=1/Math.sqrt(_)),o[0]=r[0]*_,o[1]=r[1]*_,o[2]=r[2]*_,o},x.aT=function(o,r,s){var l=r[0],d=r[1],_=r[2],y=s[0],w=s[1],T=s[2];return o[0]=d*T-_*w,o[1]=_*y-l*T,o[2]=l*w-d*y,o},x.aU=function(o,r){return o[0]*r[0]+o[1]*r[1]+o[2]*r[2]},x.aV=d1,x.aW=Ic,x.aX=function(o,r,s,l,d){var _,y=1/Math.tan(r/2);return o[0]=y/s,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=y,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[11]=-1,o[12]=0,o[13]=0,o[15]=0,d!=null&&d!==1/0?(o[10]=(d+l)*(_=1/(l-d)),o[14]=2*d*l*_):(o[10]=-1,o[14]=-2*l),o},x.aY=function(o){var r=new ze(16);return r[0]=o[0],r[1]=o[1],r[2]=o[2],r[3]=o[3],r[4]=o[4],r[5]=o[5],r[6]=o[6],r[7]=o[7],r[8]=o[8],r[9]=o[9],r[10]=o[10],r[11]=o[11],r[12]=o[12],r[13]=o[13],r[14]=o[14],r[15]=o[15],r},x.aZ=function(o,r,s){var l=Math.sin(s),d=Math.cos(s),_=r[0],y=r[1],w=r[2],T=r[3],C=r[4],M=r[5],I=r[6],D=r[7];return r!==o&&(o[8]=r[8],o[9]=r[9],o[10]=r[10],o[11]=r[11],o[12]=r[12],o[13]=r[13],o[14]=r[14],o[15]=r[15]),o[0]=_*d+C*l,o[1]=y*d+M*l,o[2]=w*d+I*l,o[3]=T*d+D*l,o[4]=C*d-_*l,o[5]=M*d-y*l,o[6]=I*d-w*l,o[7]=D*d-T*l,o},x.a_=function(o,r,s){var l=Math.sin(s),d=Math.cos(s),_=r[4],y=r[5],w=r[6],T=r[7],C=r[8],M=r[9],I=r[10],D=r[11];return r!==o&&(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3],o[12]=r[12],o[13]=r[13],o[14]=r[14],o[15]=r[15]),o[4]=_*d+C*l,o[5]=y*d+M*l,o[6]=w*d+I*l,o[7]=T*d+D*l,o[8]=C*d-_*l,o[9]=M*d-y*l,o[10]=I*d-w*l,o[11]=D*d-T*l,o},x.aa=function(o){return Math.log(o)/Math.LN2},x.ab=function(o){var r=o[0],s=o[1];return r*r+s*s},x.ac=function(o){return o*Math.PI/180},x.ad=Xr,x.ae=function(o,r){const s=[];for(const l in o)l in r||s.push(l);return s},x.af=function(o,r){let s=0,l=0;if(o.kind==="constant")l=o.layoutSize;else if(o.kind!=="source"){const{interpolationType:d,minZoom:_,maxZoom:y}=o,w=d?Xr(yn.interpolationFactor(d,r,_,y),0,1):0;o.kind==="camera"?l=Hn.number(o.minSize,o.maxSize,w):s=w}return{uSizeT:s,uSize:l}},x.ah=function(o,{uSize:r,uSizeT:s},{lowerSize:l,upperSize:d}){return o.kind==="source"?l/jo:o.kind==="composite"?Hn.number(l/jo,d/jo,s):r},x.ai=function(o,r){var s=r[0],l=r[1],d=r[2],_=r[3],y=r[4],w=r[5],T=r[6],C=r[7],M=r[8],I=r[9],D=r[10],B=r[11],O=r[12],$=r[13],q=r[14],ne=r[15],me=s*w-l*y,ae=s*T-d*y,F=s*C-_*y,Z=l*T-d*w,ce=l*C-_*w,Ce=d*C-_*T,Ze=M*$-I*O,Ie=M*q-D*O,Re=M*ne-B*O,He=I*q-D*$,qe=I*ne-B*$,Xe=D*ne-B*q,Ne=me*Xe-ae*qe+F*He+Z*Re-ce*Ie+Ce*Ze;return Ne?(o[0]=(w*Xe-T*qe+C*He)*(Ne=1/Ne),o[1]=(d*qe-l*Xe-_*He)*Ne,o[2]=($*Ce-q*ce+ne*Z)*Ne,o[3]=(D*ce-I*Ce-B*Z)*Ne,o[4]=(T*Re-y*Xe-C*Ie)*Ne,o[5]=(s*Xe-d*Re+_*Ie)*Ne,o[6]=(q*F-O*Ce-ne*ae)*Ne,o[7]=(M*Ce-D*F+B*ae)*Ne,o[8]=(y*qe-w*Re+C*Ze)*Ne,o[9]=(l*Re-s*qe-_*Ze)*Ne,o[10]=(O*ce-$*F+ne*me)*Ne,o[11]=(I*F-M*ce-B*me)*Ne,o[12]=(w*Ie-y*He-T*Ze)*Ne,o[13]=(s*He-l*Ie+d*Ze)*Ne,o[14]=($*ae-O*Z-q*me)*Ne,o[15]=(M*Z-I*ae+D*me)*Ne,o):null},x.aj=Ct,x.ak=function(o){return Math.hypot(o[0],o[1])},x.al=function(o){return o[0]=0,o[1]=0,o},x.am=function(o,r,s){return o[0]=r[0]*s,o[1]=r[1]*s,o},x.an=A_,x.ao=at,x.ap=function(o,r,s,l){const d=r.y-o.y,_=r.x-o.x,y=l.y-s.y,w=l.x-s.x,T=y*_-w*d;if(T===0)return null;const C=(w*(o.y-s.y)-y*(o.x-s.x))/T;return new le(o.x+C*_,o.y+C*d)},x.aq=v1,x.ar=bc,x.as=gt,x.at=function(o){let r=1/0,s=1/0,l=-1/0,d=-1/0;for(const _ of o)r=Math.min(r,_.x),s=Math.min(s,_.y),l=Math.max(l,_.x),d=Math.max(d,_.y);return[r,s,l,d]},x.au=Zr,x.av=br,x.aw=function(o,r,s,l,d=!1){if(!s[0]&&!s[1])return[0,0];const _=d?l==="map"?-o.bearingInRadians:0:l==="viewport"?o.bearingInRadians:0;if(_){const y=Math.sin(_),w=Math.cos(_);s=[s[0]*w-s[1]*y,s[0]*y+s[1]*w]}return[d?s[0]:br(r,s[0],o.zoom),d?s[1]:br(r,s[1],o.zoom)]},x.ay=k_,x.az=j_,x.b=ao,x.b$=o=>o.type==="circle",x.b0=function(){const o=new Float64Array(16);return gt(o),o},x.b1=function(){return new Float64Array(16)},x.b2=function(o,r,s){const l=new Float64Array(4);return function(d,_,y,w){var T=.5*Math.PI/180;_*=T,y*=T,w*=T;var C=Math.sin(_),M=Math.cos(_),I=Math.sin(y),D=Math.cos(y),B=Math.sin(w),O=Math.cos(w);d[0]=C*D*O-M*I*B,d[1]=M*I*O+C*D*B,d[2]=M*D*B-C*I*O,d[3]=M*D*O+C*I*B}(l,o,r-90,s),l},x.b3=function(o,r,s,l){var d,_,y,w,T,C=r[0],M=r[1],I=r[2],D=r[3],B=s[0],O=s[1],$=s[2],q=s[3];return(_=C*B+M*O+I*$+D*q)<0&&(_=-_,B=-B,O=-O,$=-$,q=-q),1-_>Fe?(d=Math.acos(_),y=Math.sin(d),w=Math.sin((1-l)*d)/y,T=Math.sin(l*d)/y):(w=1-l,T=l),o[0]=w*C+T*B,o[1]=w*M+T*O,o[2]=w*I+T*$,o[3]=w*D+T*q,o},x.b4=function(o){const r=new Float64Array(9);var s,l,d,_,y,w,T,C,M,I,D,B,O,$,q,ne,me,ae;I=(d=(l=o)[0])*(T=d+d),D=(_=l[1])*T,O=(y=l[2])*T,$=y*(C=_+_),ne=(w=l[3])*T,me=w*C,ae=w*(M=y+y),(s=r)[0]=1-(B=_*C)-(q=y*M),s[3]=D-ae,s[6]=O+me,s[1]=D+ae,s[4]=1-I-q,s[7]=$-ne,s[2]=O-me,s[5]=$+ne,s[8]=1-I-B;const F=qn(-Math.asin(Xr(r[2],-1,1)));let Z,ce;return Math.hypot(r[5],r[8])<.001?(Z=0,ce=-qn(Math.atan2(r[3],r[4]))):(Z=qn(r[5]===0&&r[8]===0?0:Math.atan2(r[5],r[8])),ce=qn(r[1]===0&&r[0]===0?0:Math.atan2(r[1],r[0]))),{roll:Z,pitch:F+90,bearing:ce}},x.b5=function(o,r){return o.roll==r.roll&&o.pitch==r.pitch&&o.bearing==r.bearing},x.b6=Bt,x.b7=xs,x.b8=Cc,x.b9=Fh,x.bA=function(o){const r=[],s=o.id;return s===void 0&&r.push({message:`layers.${s}: missing required property "id"`}),o.render===void 0&&r.push({message:`layers.${s}: missing required method "render"`}),o.renderingMode&&o.renderingMode!=="2d"&&o.renderingMode!=="3d"&&r.push({message:`layers.${s}: property "renderingMode" must be either "2d" or "3d"`}),r},x.bB=function o(r,s){if(Array.isArray(r)){if(!Array.isArray(s)||r.length!==s.length)return!1;for(let l=0;l<r.length;l++)if(!o(r[l],s[l]))return!1;return!0}if(typeof r=="object"&&r!==null&&s!==null){if(typeof s!="object"||Object.keys(r).length!==Object.keys(s).length)return!1;for(const l in r)if(!o(r[l],s[l]))return!1;return!0}return r===s},x.bC=zn,x.bD=so,x.bE=class extends di{constructor(o,r){super(o,r),this.current=0}set(o){this.current!==o&&(this.current=o,this.gl.uniform1i(this.location,o))}},x.bF=bs,x.bG=class extends di{constructor(o,r){super(o,r),this.current=pi}set(o){if(o[12]!==this.current[12]||o[0]!==this.current[0])return this.current=o,void this.gl.uniformMatrix4fv(this.location,!1,o);for(let r=1;r<16;r++)if(o[r]!==this.current[r]){this.current=o,this.gl.uniformMatrix4fv(this.location,!1,o);break}}},x.bH=sl,x.bI=class extends di{constructor(o,r){super(o,r),this.current=[0,0,0]}set(o){o[0]===this.current[0]&&o[1]===this.current[1]&&o[2]===this.current[2]||(this.current=o,this.gl.uniform3f(this.location,o[0],o[1],o[2]))}},x.bJ=class extends di{constructor(o,r){super(o,r),this.current=[0,0]}set(o){o[0]===this.current[0]&&o[1]===this.current[1]||(this.current=o,this.gl.uniform2f(this.location,o[0],o[1]))}},x.bK=We,x.bL=function(o,r){var s=Math.sin(r),l=Math.cos(r);return o[0]=l,o[1]=s,o[2]=0,o[3]=-s,o[4]=l,o[5]=0,o[6]=0,o[7]=0,o[8]=1,o},x.bM=function(o,r,s){var l=r[0],d=r[1],_=r[2];return o[0]=l*s[0]+d*s[3]+_*s[6],o[1]=l*s[1]+d*s[4]+_*s[7],o[2]=l*s[2]+d*s[5]+_*s[8],o},x.bN=function(o,r,s,l,d,_,y){var w=1/(r-s),T=1/(l-d),C=1/(_-y);return o[0]=-2*w,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=-2*T,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=2*C,o[11]=0,o[12]=(r+s)*w,o[13]=(d+l)*T,o[14]=(y+_)*C,o[15]=1,o},x.bO=class extends gc{},x.bP=KP,x.bQ=class extends _c{},x.bR=h_,x.bS=function(o){return o<=1?1:Math.pow(2,Math.ceil(Math.log(o)/Math.LN2))},x.bT=fx,x.bU=function(o,r,s){var l=r[0],d=r[1],_=r[2],y=s[3]*l+s[7]*d+s[11]*_+s[15];return o[0]=(s[0]*l+s[4]*d+s[8]*_+s[12])/(y=y||1),o[1]=(s[1]*l+s[5]*d+s[9]*_+s[13])/y,o[2]=(s[2]*l+s[6]*d+s[10]*_+s[14])/y,o},x.bV=class extends Th{},x.bW=class extends u{},x.bX=function(o,r){return o[0]===r[0]&&o[1]===r[1]&&o[2]===r[2]&&o[3]===r[3]&&o[4]===r[4]&&o[5]===r[5]&&o[6]===r[6]&&o[7]===r[7]&&o[8]===r[8]&&o[9]===r[9]&&o[10]===r[10]&&o[11]===r[11]&&o[12]===r[12]&&o[13]===r[13]&&o[14]===r[14]&&o[15]===r[15]},x.bY=function(o,r){var s=o[0],l=o[1],d=o[2],_=o[3],y=o[4],w=o[5],T=o[6],C=o[7],M=o[8],I=o[9],D=o[10],B=o[11],O=o[12],$=o[13],q=o[14],ne=o[15],me=r[0],ae=r[1],F=r[2],Z=r[3],ce=r[4],Ce=r[5],Ze=r[6],Ie=r[7],Re=r[8],He=r[9],qe=r[10],Xe=r[11],Ne=r[12],it=r[13],vt=r[14],yt=r[15];return Math.abs(s-me)<=Fe*Math.max(1,Math.abs(s),Math.abs(me))&&Math.abs(l-ae)<=Fe*Math.max(1,Math.abs(l),Math.abs(ae))&&Math.abs(d-F)<=Fe*Math.max(1,Math.abs(d),Math.abs(F))&&Math.abs(_-Z)<=Fe*Math.max(1,Math.abs(_),Math.abs(Z))&&Math.abs(y-ce)<=Fe*Math.max(1,Math.abs(y),Math.abs(ce))&&Math.abs(w-Ce)<=Fe*Math.max(1,Math.abs(w),Math.abs(Ce))&&Math.abs(T-Ze)<=Fe*Math.max(1,Math.abs(T),Math.abs(Ze))&&Math.abs(C-Ie)<=Fe*Math.max(1,Math.abs(C),Math.abs(Ie))&&Math.abs(M-Re)<=Fe*Math.max(1,Math.abs(M),Math.abs(Re))&&Math.abs(I-He)<=Fe*Math.max(1,Math.abs(I),Math.abs(He))&&Math.abs(D-qe)<=Fe*Math.max(1,Math.abs(D),Math.abs(qe))&&Math.abs(B-Xe)<=Fe*Math.max(1,Math.abs(B),Math.abs(Xe))&&Math.abs(O-Ne)<=Fe*Math.max(1,Math.abs(O),Math.abs(Ne))&&Math.abs($-it)<=Fe*Math.max(1,Math.abs($),Math.abs(it))&&Math.abs(q-vt)<=Fe*Math.max(1,Math.abs(q),Math.abs(vt))&&Math.abs(ne-yt)<=Fe*Math.max(1,Math.abs(ne),Math.abs(yt))},x.bZ=function(o,r){return o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3],o[4]=r[4],o[5]=r[5],o[6]=r[6],o[7]=r[7],o[8]=r[8],o[9]=r[9],o[10]=r[10],o[11]=r[11],o[12]=r[12],o[13]=r[13],o[14]=r[14],o[15]=r[15],o},x.b_=o=>o.type==="symbol",x.ba=Pc,x.bb=ut,x.bc=Tt,x.bd=Dn,x.be=function(o,r,s,l,d){return ut(l,d,Xr((o-r)/(s-r),0,1))},x.bf=rt,x.bg=function(){return new Float64Array(4)},x.bh=function(){return new Float64Array(3)},x.bi=function(o,r,s,l){var d=[],_=[];return d[0]=r[0]-s[0],d[1]=r[1]-s[1],d[2]=r[2]-s[2],_[0]=d[0]*Math.cos(l)-d[1]*Math.sin(l),_[1]=d[0]*Math.sin(l)+d[1]*Math.cos(l),_[2]=d[2],o[0]=_[0]+s[0],o[1]=_[1]+s[1],o[2]=_[2]+s[2],o},x.bj=function(o,r,s,l){var d=[],_=[];return d[0]=r[0]-s[0],d[1]=r[1]-s[1],d[2]=r[2]-s[2],_[0]=d[0],_[1]=d[1]*Math.cos(l)-d[2]*Math.sin(l),_[2]=d[1]*Math.sin(l)+d[2]*Math.cos(l),o[0]=_[0]+s[0],o[1]=_[1]+s[1],o[2]=_[2]+s[2],o},x.bk=function(o,r,s,l){var d=[],_=[];return d[0]=r[0]-s[0],d[1]=r[1]-s[1],d[2]=r[2]-s[2],_[0]=d[2]*Math.sin(l)+d[0]*Math.cos(l),_[1]=d[1],_[2]=d[2]*Math.cos(l)-d[0]*Math.sin(l),o[0]=_[0]+s[0],o[1]=_[1]+s[1],o[2]=_[2]+s[2],o},x.bl=function(o,r,s){var l=Math.sin(s),d=Math.cos(s),_=r[0],y=r[1],w=r[2],T=r[3],C=r[8],M=r[9],I=r[10],D=r[11];return r!==o&&(o[4]=r[4],o[5]=r[5],o[6]=r[6],o[7]=r[7],o[12]=r[12],o[13]=r[13],o[14]=r[14],o[15]=r[15]),o[0]=_*d-C*l,o[1]=y*d-M*l,o[2]=w*d-I*l,o[3]=T*d-D*l,o[8]=_*l+C*d,o[9]=y*l+M*d,o[10]=w*l+I*d,o[11]=T*l+D*d,o},x.bm=function(o,r){const s=rt(o,360),l=rt(r,360),d=l-s,_=l>s?d-360:d+360;return Math.abs(d)<Math.abs(_)?d:_},x.bn=function(o){return o[0]=0,o[1]=0,o[2]=0,o},x.bo=function(o,r,s,l){const d=Math.sqrt(o*o+r*r),_=Math.sqrt(s*s+l*l);o/=d,r/=d,s/=_,l/=_;const y=Math.acos(o*s+r*l);return-r*s+o*l>0?y:-y},x.bp=function(o,r){return o[0]*r[0]+o[1]*r[1]+o[2]*r[2]+o[3]},x.bq=D_,x.br=function(o,r){const s=rt(o,2*Math.PI),l=rt(r,2*Math.PI);return Math.min(Math.abs(s-l),Math.abs(s-l+2*Math.PI),Math.abs(s-l-2*Math.PI))},x.bs=function(o){return Math.hypot(o[0],o[1],o[2])},x.bt=function(){const o={},r=z.$version;for(const s in z.$root){const l=z.$root[s];if(l.required){let d=null;d=s==="version"?r:l.type==="array"?[]:{},d!=null&&(o[s]=d)}}return o},x.bu=ac,x.bv=uo,x.bw=function(o){o=o.slice();const r=Object.create(null);for(let s=0;s<o.length;s++)r[o[s].id]=o[s];for(let s=0;s<o.length;s++)"ref"in o[s]&&(o[s]=W(o[s],r[o[s].ref]));return o},x.bx=function(o){if(o.type==="custom")return new vC(o);switch(o.type){case"background":return new gC(o);case"circle":return new hP(o);case"fill":return new kP(o);case"fill-extrusion":return new OP(o);case"heatmap":return new pP(o);case"hillshade":return new mP(o);case"line":return new qP(o);case"raster":return new yC(o);case"symbol":return new cf(o)}},x.by=Pn,x.bz=function(o,r){if(!o)return[{command:"setStyle",args:[r]}];let s=[];try{if(!ie(o.version,r.version))return[{command:"setStyle",args:[r]}];ie(o.center,r.center)||s.push({command:"setCenter",args:[r.center]}),ie(o.centerAltitude,r.centerAltitude)||s.push({command:"setCenterAltitude",args:[r.centerAltitude]}),ie(o.zoom,r.zoom)||s.push({command:"setZoom",args:[r.zoom]}),ie(o.bearing,r.bearing)||s.push({command:"setBearing",args:[r.bearing]}),ie(o.pitch,r.pitch)||s.push({command:"setPitch",args:[r.pitch]}),ie(o.roll,r.roll)||s.push({command:"setRoll",args:[r.roll]}),ie(o.sprite,r.sprite)||s.push({command:"setSprite",args:[r.sprite]}),ie(o.glyphs,r.glyphs)||s.push({command:"setGlyphs",args:[r.glyphs]}),ie(o.transition,r.transition)||s.push({command:"setTransition",args:[r.transition]}),ie(o.light,r.light)||s.push({command:"setLight",args:[r.light]}),ie(o.terrain,r.terrain)||s.push({command:"setTerrain",args:[r.terrain]}),ie(o.sky,r.sky)||s.push({command:"setSky",args:[r.sky]}),ie(o.projection,r.projection)||s.push({command:"setProjection",args:[r.projection]});const l={},d=[];(function(y,w,T,C){let M;for(M in w=w||{},y=y||{})Object.prototype.hasOwnProperty.call(y,M)&&(Object.prototype.hasOwnProperty.call(w,M)||Me(M,T,C));for(M in w)Object.prototype.hasOwnProperty.call(w,M)&&(Object.prototype.hasOwnProperty.call(y,M)?ie(y[M],w[M])||(y[M].type==="geojson"&&w[M].type==="geojson"&&Oe(y,w,M)?de(T,{command:"setGeoJSONSourceData",args:[M,w[M].data]}):ye(M,w,T,C)):xe(M,w,T))})(o.sources,r.sources,d,l);const _=[];o.layers&&o.layers.forEach(y=>{"source"in y&&l[y.source]?s.push({command:"removeLayer",args:[y.id]}):_.push(y)}),s=s.concat(d),function(y,w,T){w=w||[];const C=(y=y||[]).map(Se),M=w.map(Se),I=y.reduce(Ue,{}),D=w.reduce(Ue,{}),B=C.slice(),O=Object.create(null);let $,q,ne,me,ae;for(let F=0,Z=0;F<C.length;F++)$=C[F],Object.prototype.hasOwnProperty.call(D,$)?Z++:(de(T,{command:"removeLayer",args:[$]}),B.splice(B.indexOf($,Z),1));for(let F=0,Z=0;F<M.length;F++)$=M[M.length-1-F],B[B.length-1-F]!==$&&(Object.prototype.hasOwnProperty.call(I,$)?(de(T,{command:"removeLayer",args:[$]}),B.splice(B.lastIndexOf($,B.length-Z),1)):Z++,me=B[B.length-F],de(T,{command:"addLayer",args:[D[$],me]}),B.splice(B.length-F,0,$),O[$]=!0);for(let F=0;F<M.length;F++)if($=M[F],q=I[$],ne=D[$],!O[$]&&!ie(q,ne))if(ie(q.source,ne.source)&&ie(q["source-layer"],ne["source-layer"])&&ie(q.type,ne.type)){for(ae in ke(q.layout,ne.layout,T,$,null,"setLayoutProperty"),ke(q.paint,ne.paint,T,$,null,"setPaintProperty"),ie(q.filter,ne.filter)||de(T,{command:"setFilter",args:[$,ne.filter]}),ie(q.minzoom,ne.minzoom)&&ie(q.maxzoom,ne.maxzoom)||de(T,{command:"setLayerZoomRange",args:[$,ne.minzoom,ne.maxzoom]}),q)Object.prototype.hasOwnProperty.call(q,ae)&&ae!=="layout"&&ae!=="paint"&&ae!=="filter"&&ae!=="metadata"&&ae!=="minzoom"&&ae!=="maxzoom"&&(ae.indexOf("paint.")===0?ke(q[ae],ne[ae],T,$,ae.slice(6),"setPaintProperty"):ie(q[ae],ne[ae])||de(T,{command:"setLayerProperty",args:[$,ae,ne[ae]]}));for(ae in ne)Object.prototype.hasOwnProperty.call(ne,ae)&&!Object.prototype.hasOwnProperty.call(q,ae)&&ae!=="layout"&&ae!=="paint"&&ae!=="filter"&&ae!=="metadata"&&ae!=="minzoom"&&ae!=="maxzoom"&&(ae.indexOf("paint.")===0?ke(q[ae],ne[ae],T,$,ae.slice(6),"setPaintProperty"):ie(q[ae],ne[ae])||de(T,{command:"setLayerProperty",args:[$,ae,ne[ae]]}))}else de(T,{command:"removeLayer",args:[$]}),me=B[B.lastIndexOf($)+1],de(T,{command:"addLayer",args:[ne,me]})}(_,r.layers,s)}catch(l){console.warn("Unable to compute style diff:",l),s=[{command:"setStyle",args:[r]}]}return s},x.c=ts,x.c0=o=>o.type==="heatmap",x.c1=o=>o.type==="line",x.c2=o=>o.type==="fill",x.c3=o=>o.type==="fill-extrusion",x.c4=o=>o.type==="hillshade",x.c5=o=>o.type==="raster",x.c6=o=>o.type==="background",x.c7=o=>o.type==="custom",x.c8=Lt,x.c9=function(o,r,s){const l=tr(r.x-s.x,r.y-s.y),d=tr(o.x-s.x,o.y-s.y);var _,y;return qn(Math.atan2(l[0]*d[1]-l[1]*d[0],(_=l)[0]*(y=d)[0]+_[1]*y[1]))},x.cA=Q,x.cB=Ax,x.cC=Ux,x.cD=fs,x.cE=Bo,x.ca=Nt,x.cb=function(o,r,s){var l=r[0],d=r[1];return o[0]=s[0]*l+s[4]*d+s[12],o[1]=s[1]*l+s[5]*d+s[13],o},x.cc=function(o,r){const{x:s,y:l}=Zh.fromLngLat(r);return!(o<0||o>25||l<0||l>=1||s<0||s>=1)},x.cd=function(o,r){return o[0]=r[0],o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=r[1],o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=r[2],o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o},x.ce=class extends pc{},x.cf=kC,x.ch=function(o){return o.message===Et},x.ci=co,x.cj=function(o,r){rs.REGISTERED_PROTOCOLS[o]=r},x.ck=function(o){delete rs.REGISTERED_PROTOCOLS[o]},x.cl=function(o,r){const s={};for(let d=0;d<o.length;d++){const _=r&&r[o[d].id]||ah(o[d]);r&&(r[o[d].id]=_);let y=s[_];y||(y=s[_]=[]),y.push(o[d])}const l=[];for(const d in s)l.push(s[d]);return l},x.cm=nt,x.cn=f1,x.co=g1,x.cp=Gx,x.cq=function(o){o.bucket.createArrays(),o.bucket.tilePixelRatio=St/(512*o.bucket.overscaling),o.bucket.compareText={},o.bucket.iconsNeedLinear=!1;const r=o.bucket.layers[0],s=r.layout,l=r._unevaluatedLayout._values,d={layoutIconSize:l["icon-size"].possiblyEvaluate(new ar(o.bucket.zoom+1),o.canonical),layoutTextSize:l["text-size"].possiblyEvaluate(new ar(o.bucket.zoom+1),o.canonical),textMaxSize:l["text-size"].possiblyEvaluate(new ar(18))};if(o.bucket.textSizeData.kind==="composite"){const{minZoom:C,maxZoom:M}=o.bucket.textSizeData;d.compositeTextSizes=[l["text-size"].possiblyEvaluate(new ar(C),o.canonical),l["text-size"].possiblyEvaluate(new ar(M),o.canonical)]}if(o.bucket.iconSizeData.kind==="composite"){const{minZoom:C,maxZoom:M}=o.bucket.iconSizeData;d.compositeIconSizes=[l["icon-size"].possiblyEvaluate(new ar(C),o.canonical),l["icon-size"].possiblyEvaluate(new ar(M),o.canonical)]}const _=s.get("text-line-height")*Zr,y=s.get("text-rotation-alignment")!=="viewport"&&s.get("symbol-placement")!=="point",w=s.get("text-keep-upright"),T=s.get("text-size");for(const C of o.bucket.features){const M=s.get("text-font").evaluate(C,{},o.canonical).join(","),I=T.evaluate(C,{},o.canonical),D=d.layoutTextSize.evaluate(C,{},o.canonical),B=d.layoutIconSize.evaluate(C,{},o.canonical),O={horizontal:{},vertical:void 0},$=C.text;let q,ne=[0,0];if($){const F=$.toString(),Z=s.get("text-letter-spacing").evaluate(C,{},o.canonical)*Zr,ce=$p(F)?Z:0,Ce=s.get("text-anchor").evaluate(C,{},o.canonical),Ze=M1(r,C,o.canonical);if(!Ze){const qe=s.get("text-radial-offset").evaluate(C,{},o.canonical);ne=qe?E1(Ce,[qe*Zr,O_]):s.get("text-offset").evaluate(C,{},o.canonical).map(Xe=>Xe*Zr)}let Ie=y?"center":s.get("text-justify").evaluate(C,{},o.canonical);const Re=s.get("symbol-placement")==="point"?s.get("text-max-width").evaluate(C,{},o.canonical)*Zr:1/0,He=()=>{o.bucket.allowVerticalPlacement&&lc(F)&&(O.vertical=sf($,o.glyphMap,o.glyphPositions,o.imagePositions,M,Re,_,Ce,"left",ce,ne,x.ag.vertical,!0,D,I))};if(!y&&Ze){const qe=new Set;if(Ie==="auto")for(let Ne=0;Ne<Ze.values.length;Ne+=2)qe.add(j_(Ze.values[Ne]));else qe.add(Ie);let Xe=!1;for(const Ne of qe)if(!O.horizontal[Ne])if(Xe)O.horizontal[Ne]=O.horizontal[0];else{const it=sf($,o.glyphMap,o.glyphPositions,o.imagePositions,M,Re,_,"center",Ne,ce,ne,x.ag.horizontal,!1,D,I);it&&(O.horizontal[Ne]=it,Xe=it.positionedLines.length===1)}He()}else{Ie==="auto"&&(Ie=j_(Ce));const qe=sf($,o.glyphMap,o.glyphPositions,o.imagePositions,M,Re,_,Ce,Ie,ce,ne,x.ag.horizontal,!1,D,I);qe&&(O.horizontal[Ie]=qe),He(),lc(F)&&y&&w&&(O.vertical=sf($,o.glyphMap,o.glyphPositions,o.imagePositions,M,Re,_,Ce,Ie,ce,ne,x.ag.vertical,!1,D,I))}}let me=!1;if(C.icon&&C.icon.name){const F=o.imageMap[C.icon.name];F&&(q=hC(o.imagePositions[C.icon.name],s.get("icon-offset").evaluate(C,{},o.canonical),s.get("icon-anchor").evaluate(C,{},o.canonical)),me=!!F.sdf,o.bucket.sdfIcons===void 0?o.bucket.sdfIcons=me:o.bucket.sdfIcons!==me&&Kr("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(F.pixelRatio!==o.bucket.pixelRatio||s.get("icon-rotate").constantOr(1)!==0)&&(o.bucket.iconsNeedLinear=!0))}const ae=k1(O.horizontal)||O.vertical;o.bucket.iconsInText=!!ae&&ae.iconsInText,(ae||q)&&MC(o.bucket,C,O,q,o.imageMap,d,D,B,ne,me,o.canonical,o.subdivisionGranularity)}o.showCollisionBoxes&&o.bucket.generateCollisionDebugBuffers()},x.cr=w_,x.cs=g_,x.ct=b_,x.cu=Oh,x.cv=P_,x.cw=class{constructor(o){this._marks={start:[o.url,"start"].join("#"),end:[o.url,"end"].join("#"),measure:o.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let o=performance.getEntriesByName(this._marks.measure);return o.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),o=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),o}},x.cx=function(o,r,s,l,d){return c(this,void 0,void 0,function*(){if(_e())try{return yield gn(o,r,s,l,d)}catch{}return function(_,y,w,T,C){const M=_.width,I=_.height;Rn&&Vi||(Rn=new OffscreenCanvas(M,I),Vi=Rn.getContext("2d",{willReadFrequently:!0})),Rn.width=M,Rn.height=I,Vi.drawImage(_,0,0,M,I);const D=Vi.getImageData(y,w,T,C);return Vi.clearRect(0,0,M,I),D.data}(o,r,s,l,d)})},x.cy=p1,x.cz=A,x.d=ko,x.e=fr,x.f=o=>c(void 0,void 0,void 0,function*(){if(o.byteLength===0)return createImageBitmap(new ImageData(1,1));const r=new Blob([new Uint8Array(o)],{type:"image/png"});try{return createImageBitmap(r)}catch(s){throw new Error(`Could not load image because of ${s.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),x.g=Vs,x.h=o=>new Promise((r,s)=>{const l=new Image;l.onload=()=>{r(l),URL.revokeObjectURL(l.src),l.onload=null,window.requestAnimationFrame(()=>{l.src=lo})},l.onerror=()=>s(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const d=new Blob([new Uint8Array(o)],{type:"image/png"});l.src=o.byteLength?URL.createObjectURL(d):lo}),x.i=xi,x.j=(o,r)=>Io(fr(o,{type:"json"}),r),x.k=ho,x.l=ja,x.m=Io,x.n=(o,r)=>Io(fr(o,{type:"arrayBuffer"}),r),x.o=function(o){return new P_(o).readFields(JP,[])},x.p=Zx,x.q=Ah,x.r=On,x.s=Gn,x.t=Ja,x.u=At,x.v=z,x.w=Kr,x.x=sc,x.y=sa,x.z=function([o,r,s]){return r+=90,r*=Math.PI/180,s*=Math.PI/180,{x:o*Math.cos(r)*Math.sin(s),y:o*Math.sin(r)*Math.sin(s),z:o*Math.cos(s)}}}),m("worker",["./shared"],function(x){class c{constructor(z){this.keyCache={},z&&this.replace(z)}replace(z){this._layerConfigs={},this._layers={},this.update(z,[])}update(z,U){for(const ie of z){this._layerConfigs[ie.id]=ie;const de=this._layers[ie.id]=x.bx(ie);de._featureFilter=x.a6(de.filter),this.keyCache[ie.id]&&delete this.keyCache[ie.id]}for(const ie of U)delete this.keyCache[ie],delete this._layerConfigs[ie],delete this._layers[ie];this.familiesBySource={};const W=x.cl(Object.values(this._layerConfigs),this.keyCache);for(const ie of W){const de=ie.map(Se=>this._layers[Se.id]),xe=de[0];if(xe.visibility==="none")continue;const Me=xe.source||"";let ye=this.familiesBySource[Me];ye||(ye=this.familiesBySource[Me]={});const Oe=xe.sourceLayer||"_geojsonTileLayer";let ke=ye[Oe];ke||(ke=ye[Oe]=[]),ke.push(de)}}}class A{constructor(z){const U={},W=[];for(const Me in z){const ye=z[Me],Oe=U[Me]={};for(const ke in ye){const Se=ye[+ke];if(!Se||Se.bitmap.width===0||Se.bitmap.height===0)continue;const Ue={x:0,y:0,w:Se.bitmap.width+2,h:Se.bitmap.height+2};W.push(Ue),Oe[ke]={rect:Ue,metrics:Se.metrics}}}const{w:ie,h:de}=x.p(W),xe=new x.q({width:ie||1,height:de||1});for(const Me in z){const ye=z[Me];for(const Oe in ye){const ke=ye[+Oe];if(!ke||ke.bitmap.width===0||ke.bitmap.height===0)continue;const Se=U[Me][Oe].rect;x.q.copy(ke.bitmap,xe,{x:0,y:0},{x:Se.x+1,y:Se.y+1},ke.bitmap)}}this.image=xe,this.positions=U}}x.cm("GlyphAtlas",A);class j{constructor(z){this.tileID=new x.Y(z.tileID.overscaledZ,z.tileID.wrap,z.tileID.canonical.z,z.tileID.canonical.x,z.tileID.canonical.y),this.uid=z.uid,this.zoom=z.zoom,this.pixelRatio=z.pixelRatio,this.tileSize=z.tileSize,this.source=z.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=z.showCollisionBoxes,this.collectResourceTiming=!!z.collectResourceTiming,this.returnDependencies=!!z.returnDependencies,this.promoteId=z.promoteId,this.inFlightDependencies=[]}parse(z,U,W,ie,de){return x._(this,void 0,void 0,function*(){this.status="parsing",this.data=z,this.collisionBoxArray=new x.a4;const xe=new x.cn(Object.keys(z.layers).sort()),Me=new x.co(this.tileID,this.promoteId);Me.bucketLayerIDs=[];const ye={},Oe={featureIndex:Me,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:W,subdivisionGranularity:de},ke=U.familiesBySource[this.source];for(const wt in ke){const kt=z.layers[wt];if(!kt)continue;kt.version===1&&x.w(`Vector tile source "${this.source}" layer "${wt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const _t=xe.encode(wt),is=[];for(let Lr=0;Lr<kt.length;Lr++){const Nr=kt.feature(Lr),rr=Me.getId(Nr,wt);is.push({feature:Nr,id:rr,index:Lr,sourceLayerIndex:_t})}for(const Lr of ke[wt]){const Nr=Lr[0];Nr.source!==this.source&&x.w(`layer.source = ${Nr.source} does not equal this.source = ${this.source}`),Nr.minzoom&&this.zoom<Math.floor(Nr.minzoom)||Nr.maxzoom&&this.zoom>=Nr.maxzoom||Nr.visibility!=="none"&&(Y(Lr,this.zoom,W),(ye[Nr.id]=Nr.createBucket({index:Me.bucketLayerIDs.length,layers:Lr,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:_t,sourceID:this.source})).populate(is,Oe,this.tileID.canonical),Me.bucketLayerIDs.push(Lr.map(rr=>rr.id)))}}const Se=x.bC(Oe.glyphDependencies,wt=>Object.keys(wt).map(Number));this.inFlightDependencies.forEach(wt=>wt==null?void 0:wt.abort()),this.inFlightDependencies=[];let Ue=Promise.resolve({});if(Object.keys(Se).length){const wt=new AbortController;this.inFlightDependencies.push(wt),Ue=ie.sendAsync({type:"GG",data:{stacks:Se,source:this.source,tileID:this.tileID,type:"glyphs"}},wt)}const Te=Object.keys(Oe.iconDependencies);let et=Promise.resolve({});if(Te.length){const wt=new AbortController;this.inFlightDependencies.push(wt),et=ie.sendAsync({type:"GI",data:{icons:Te,source:this.source,tileID:this.tileID,type:"icons"}},wt)}const dt=Object.keys(Oe.patternDependencies);let Pt=Promise.resolve({});if(dt.length){const wt=new AbortController;this.inFlightDependencies.push(wt),Pt=ie.sendAsync({type:"GI",data:{icons:dt,source:this.source,tileID:this.tileID,type:"patterns"}},wt)}const[bt,$e,st]=yield Promise.all([Ue,et,Pt]),ot=new A(bt),It=new x.cp($e,st);for(const wt in ye){const kt=ye[wt];kt instanceof x.a5?(Y(kt.layers,this.zoom,W),x.cq({bucket:kt,glyphMap:bt,glyphPositions:ot.positions,imageMap:$e,imagePositions:It.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:Oe.subdivisionGranularity})):kt.hasPattern&&(kt instanceof x.cr||kt instanceof x.cs||kt instanceof x.ct)&&(Y(kt.layers,this.zoom,W),kt.addFeatures(Oe,this.tileID.canonical,It.patternPositions))}return this.status="done",{buckets:Object.values(ye).filter(wt=>!wt.isEmpty()),featureIndex:Me,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:ot.image,imageAtlas:It,glyphMap:this.returnDependencies?bt:null,iconMap:this.returnDependencies?$e:null,glyphPositions:this.returnDependencies?ot.positions:null}})}}function Y(be,z,U){const W=new x.C(z);for(const ie of be)ie.recalculate(W,U)}class Q{constructor(z,U,W){this.actor=z,this.layerIndex=U,this.availableImages=W,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(z,U){return x._(this,void 0,void 0,function*(){const W=yield x.n(z.request,U);try{return{vectorTile:new x.cu.VectorTile(new x.cv(W.data)),rawData:W.data,cacheControl:W.cacheControl,expires:W.expires}}catch(ie){const de=new Uint8Array(W.data);let xe=`Unable to parse the tile at ${z.request.url}, `;throw xe+=de[0]===31&&de[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${ie.message}`,new Error(xe)}})}loadTile(z){return x._(this,void 0,void 0,function*(){const U=z.uid,W=!!(z&&z.request&&z.request.collectResourceTiming)&&new x.cw(z.request),ie=new j(z);this.loading[U]=ie;const de=new AbortController;ie.abort=de;try{const xe=yield this.loadVectorTile(z,de);if(delete this.loading[U],!xe)return null;const Me=xe.rawData,ye={};xe.expires&&(ye.expires=xe.expires),xe.cacheControl&&(ye.cacheControl=xe.cacheControl);const Oe={};if(W){const Se=W.finish();Se&&(Oe.resourceTiming=JSON.parse(JSON.stringify(Se)))}ie.vectorTile=xe.vectorTile;const ke=ie.parse(xe.vectorTile,this.layerIndex,this.availableImages,this.actor,z.subdivisionGranularity);this.loaded[U]=ie,this.fetching[U]={rawTileData:Me,cacheControl:ye,resourceTiming:Oe};try{const Se=yield ke;return x.e({rawTileData:Me.slice(0)},Se,ye,Oe)}finally{delete this.fetching[U]}}catch(xe){throw delete this.loading[U],ie.status="done",this.loaded[U]=ie,xe}})}reloadTile(z){return x._(this,void 0,void 0,function*(){const U=z.uid;if(!this.loaded||!this.loaded[U])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const W=this.loaded[U];if(W.showCollisionBoxes=z.showCollisionBoxes,W.status==="parsing"){const ie=yield W.parse(W.vectorTile,this.layerIndex,this.availableImages,this.actor,z.subdivisionGranularity);let de;if(this.fetching[U]){const{rawTileData:xe,cacheControl:Me,resourceTiming:ye}=this.fetching[U];delete this.fetching[U],de=x.e({rawTileData:xe.slice(0)},ie,Me,ye)}else de=ie;return de}if(W.status==="done"&&W.vectorTile)return W.parse(W.vectorTile,this.layerIndex,this.availableImages,this.actor,z.subdivisionGranularity)})}abortTile(z){return x._(this,void 0,void 0,function*(){const U=this.loading,W=z.uid;U&&U[W]&&U[W].abort&&(U[W].abort.abort(),delete U[W])})}removeTile(z){return x._(this,void 0,void 0,function*(){this.loaded&&this.loaded[z.uid]&&delete this.loaded[z.uid]})}}class H{constructor(){this.loaded={}}loadTile(z){return x._(this,void 0,void 0,function*(){const{uid:U,encoding:W,rawImageData:ie,redFactor:de,greenFactor:xe,blueFactor:Me,baseShift:ye}=z,Oe=ie.width+2,ke=ie.height+2,Se=x.b(ie)?new x.R({width:Oe,height:ke},yield x.cx(ie,-1,-1,Oe,ke)):ie,Ue=new x.cy(U,Se,W,de,xe,Me,ye);return this.loaded=this.loaded||{},this.loaded[U]=Ue,Ue})}removeTile(z){const U=this.loaded,W=z.uid;U&&U[W]&&delete U[W]}}var G,le,ve=function(){if(le)return G;function be(U,W){if(U.length!==0){z(U[0],W);for(var ie=1;ie<U.length;ie++)z(U[ie],!W)}}function z(U,W){for(var ie=0,de=0,xe=0,Me=U.length,ye=Me-1;xe<Me;ye=xe++){var Oe=(U[xe][0]-U[ye][0])*(U[ye][1]+U[xe][1]),ke=ie+Oe;de+=Math.abs(ie)>=Math.abs(Oe)?ie-ke+Oe:Oe-ke+ie,ie=ke}ie+de>=0!=!!W&&U.reverse()}return le=1,G=function U(W,ie){var de,xe=W&&W.type;if(xe==="FeatureCollection")for(de=0;de<W.features.length;de++)U(W.features[de],ie);else if(xe==="GeometryCollection")for(de=0;de<W.geometries.length;de++)U(W.geometries[de],ie);else if(xe==="Feature")U(W.geometry,ie);else if(xe==="Polygon")be(W.coordinates,ie);else if(xe==="MultiPolygon")for(de=0;de<W.coordinates.length;de++)be(W.coordinates[de],ie);return W}}(),Ae=x.cz(ve);const ee=x.cu.VectorTileFeature.prototype.toGeoJSON;class re{constructor(z){this._feature=z,this.extent=x.Z,this.type=z.type,this.properties=z.tags,"id"in z&&!isNaN(z.id)&&(this.id=parseInt(z.id,10))}loadGeometry(){if(this._feature.type===1){const z=[];for(const U of this._feature.geometry)z.push([new x.P(U[0],U[1])]);return z}{const z=[];for(const U of this._feature.geometry){const W=[];for(const ie of U)W.push(new x.P(ie[0],ie[1]));z.push(W)}return z}}toGeoJSON(z,U,W){return ee.call(this,z,U,W)}}class se{constructor(z){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=x.Z,this.length=z.length,this._features=z}feature(z){return new re(this._features[z])}}var _e,De,Fe,ze={exports:{}},We=function(){if(Fe)return ze.exports;Fe=1;var be=x.cC(),z=function(){if(De)return _e;De=1;var ke=x.cA(),Se=x.cB().VectorTileFeature;function Ue(et,dt){this.options=dt||{},this.features=et,this.length=et.length}function Te(et,dt){this.id=typeof et.id=="number"?et.id:void 0,this.type=et.type,this.rawGeometry=et.type===1?[et.geometry]:et.geometry,this.properties=et.tags,this.extent=dt||4096}return _e=Ue,Ue.prototype.feature=function(et){return new Te(this.features[et],this.options.extent)},Te.prototype.loadGeometry=function(){var et=this.rawGeometry;this.geometry=[];for(var dt=0;dt<et.length;dt++){for(var Pt=et[dt],bt=[],$e=0;$e<Pt.length;$e++)bt.push(new ke(Pt[$e][0],Pt[$e][1]));this.geometry.push(bt)}return this.geometry},Te.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var et=this.geometry,dt=1/0,Pt=-1/0,bt=1/0,$e=-1/0,st=0;st<et.length;st++)for(var ot=et[st],It=0;It<ot.length;It++){var wt=ot[It];dt=Math.min(dt,wt.x),Pt=Math.max(Pt,wt.x),bt=Math.min(bt,wt.y),$e=Math.max($e,wt.y)}return[dt,bt,Pt,$e]},Te.prototype.toGeoJSON=Se.prototype.toGeoJSON,_e}();function U(ke){var Se=new be;return function(Ue,Te){for(var et in Ue.layers)Te.writeMessage(3,W,Ue.layers[et])}(ke,Se),Se.finish()}function W(ke,Se){var Ue;Se.writeVarintField(15,ke.version||1),Se.writeStringField(1,ke.name||""),Se.writeVarintField(5,ke.extent||4096);var Te={keys:[],values:[],keycache:{},valuecache:{}};for(Ue=0;Ue<ke.length;Ue++)Te.feature=ke.feature(Ue),Se.writeMessage(2,ie,Te);var et=Te.keys;for(Ue=0;Ue<et.length;Ue++)Se.writeStringField(3,et[Ue]);var dt=Te.values;for(Ue=0;Ue<dt.length;Ue++)Se.writeMessage(4,Oe,dt[Ue])}function ie(ke,Se){var Ue=ke.feature;Ue.id!==void 0&&Se.writeVarintField(1,Ue.id),Se.writeMessage(2,de,ke),Se.writeVarintField(3,Ue.type),Se.writeMessage(4,ye,Ue)}function de(ke,Se){var Ue=ke.feature,Te=ke.keys,et=ke.values,dt=ke.keycache,Pt=ke.valuecache;for(var bt in Ue.properties){var $e=Ue.properties[bt],st=dt[bt];if($e!==null){st===void 0&&(Te.push(bt),dt[bt]=st=Te.length-1),Se.writeVarint(st);var ot=typeof $e;ot!=="string"&&ot!=="boolean"&&ot!=="number"&&($e=JSON.stringify($e));var It=ot+":"+$e,wt=Pt[It];wt===void 0&&(et.push($e),Pt[It]=wt=et.length-1),Se.writeVarint(wt)}}}function xe(ke,Se){return(Se<<3)+(7&ke)}function Me(ke){return ke<<1^ke>>31}function ye(ke,Se){for(var Ue=ke.loadGeometry(),Te=ke.type,et=0,dt=0,Pt=Ue.length,bt=0;bt<Pt;bt++){var $e=Ue[bt],st=1;Te===1&&(st=$e.length),Se.writeVarint(xe(1,st));for(var ot=Te===3?$e.length-1:$e.length,It=0;It<ot;It++){It===1&&Te!==1&&Se.writeVarint(xe(2,ot-1));var wt=$e[It].x-et,kt=$e[It].y-dt;Se.writeVarint(Me(wt)),Se.writeVarint(Me(kt)),et+=wt,dt+=kt}Te===3&&Se.writeVarint(xe(7,1))}}function Oe(ke,Se){var Ue=typeof ke;Ue==="string"?Se.writeStringField(1,ke):Ue==="boolean"?Se.writeBooleanField(7,ke):Ue==="number"&&(ke%1!=0?Se.writeDoubleField(3,ke):ke<0?Se.writeSVarintField(6,ke):Se.writeVarintField(5,ke))}return ze.exports=U,ze.exports.fromVectorTileJs=U,ze.exports.fromGeojsonVt=function(ke,Se){Se=Se||{};var Ue={};for(var Te in ke)Ue[Te]=new z(ke[Te].features,Se),Ue[Te].name=Te,Ue[Te].version=Se.version,Ue[Te].extent=Se.extent;return U({layers:Ue})},ze.exports.GeoJSONWrapper=z,ze.exports}(),gt=x.cz(We);const X={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:be=>be},Ye=Math.fround||(at=new Float32Array(1),be=>(at[0]=+be,at[0]));var at;const ht=3,Ct=5,tr=6;class St{constructor(z){this.options=Object.assign(Object.create(X),z),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(z){const{log:U,minZoom:W,maxZoom:ie}=this.options;U&&console.time("total time");const de=`prepare ${z.length} points`;U&&console.time(de),this.points=z;const xe=[];for(let ye=0;ye<z.length;ye++){const Oe=z[ye];if(!Oe.geometry)continue;const[ke,Se]=Oe.geometry.coordinates,Ue=Ye(ut(ke)),Te=Ye(Tt(Se));xe.push(Ue,Te,1/0,ye,-1,1),this.options.reduce&&xe.push(0)}let Me=this.trees[ie+1]=this._createTree(xe);U&&console.timeEnd(de);for(let ye=ie;ye>=W;ye--){const Oe=+Date.now();Me=this.trees[ye]=this._createTree(this._cluster(Me,ye)),U&&console.log("z%d: %d clusters in %dms",ye,Me.numItems,+Date.now()-Oe)}return U&&console.timeEnd("total time"),this}getClusters(z,U){let W=((z[0]+180)%360+360)%360-180;const ie=Math.max(-90,Math.min(90,z[1]));let de=z[2]===180?180:((z[2]+180)%360+360)%360-180;const xe=Math.max(-90,Math.min(90,z[3]));if(z[2]-z[0]>=360)W=-180,de=180;else if(W>de){const Se=this.getClusters([W,ie,180,xe],U),Ue=this.getClusters([-180,ie,de,xe],U);return Se.concat(Ue)}const Me=this.trees[this._limitZoom(U)],ye=Me.range(ut(W),Tt(xe),ut(de),Tt(ie)),Oe=Me.data,ke=[];for(const Se of ye){const Ue=this.stride*Se;ke.push(Oe[Ue+Ct]>1?br(Oe,Ue,this.clusterProps):this.points[Oe[Ue+ht]])}return ke}getChildren(z){const U=this._getOriginId(z),W=this._getOriginZoom(z),ie="No cluster with the specified id.",de=this.trees[W];if(!de)throw new Error(ie);const xe=de.data;if(U*this.stride>=xe.length)throw new Error(ie);const Me=this.options.radius/(this.options.extent*Math.pow(2,W-1)),ye=de.within(xe[U*this.stride],xe[U*this.stride+1],Me),Oe=[];for(const ke of ye){const Se=ke*this.stride;xe[Se+4]===z&&Oe.push(xe[Se+Ct]>1?br(xe,Se,this.clusterProps):this.points[xe[Se+ht]])}if(Oe.length===0)throw new Error(ie);return Oe}getLeaves(z,U,W){const ie=[];return this._appendLeaves(ie,z,U=U||10,W=W||0,0),ie}getTile(z,U,W){const ie=this.trees[this._limitZoom(z)],de=Math.pow(2,z),{extent:xe,radius:Me}=this.options,ye=Me/xe,Oe=(W-ye)/de,ke=(W+1+ye)/de,Se={features:[]};return this._addTileFeatures(ie.range((U-ye)/de,Oe,(U+1+ye)/de,ke),ie.data,U,W,de,Se),U===0&&this._addTileFeatures(ie.range(1-ye/de,Oe,1,ke),ie.data,de,W,de,Se),U===de-1&&this._addTileFeatures(ie.range(0,Oe,ye/de,ke),ie.data,-1,W,de,Se),Se.features.length?Se:null}getClusterExpansionZoom(z){let U=this._getOriginZoom(z)-1;for(;U<=this.options.maxZoom;){const W=this.getChildren(z);if(U++,W.length!==1)break;z=W[0].properties.cluster_id}return U}_appendLeaves(z,U,W,ie,de){const xe=this.getChildren(U);for(const Me of xe){const ye=Me.properties;if(ye&&ye.cluster?de+ye.point_count<=ie?de+=ye.point_count:de=this._appendLeaves(z,ye.cluster_id,W,ie,de):de<ie?de++:z.push(Me),z.length===W)break}return de}_createTree(z){const U=new x.aB(z.length/this.stride|0,this.options.nodeSize,Float32Array);for(let W=0;W<z.length;W+=this.stride)U.add(z[W],z[W+1]);return U.finish(),U.data=z,U}_addTileFeatures(z,U,W,ie,de,xe){for(const Me of z){const ye=Me*this.stride,Oe=U[ye+Ct]>1;let ke,Se,Ue;if(Oe)ke=rt(U,ye,this.clusterProps),Se=U[ye],Ue=U[ye+1];else{const dt=this.points[U[ye+ht]];ke=dt.properties;const[Pt,bt]=dt.geometry.coordinates;Se=ut(Pt),Ue=Tt(bt)}const Te={type:1,geometry:[[Math.round(this.options.extent*(Se*de-W)),Math.round(this.options.extent*(Ue*de-ie))]],tags:ke};let et;et=Oe||this.options.generateId?U[ye+ht]:this.points[U[ye+ht]].id,et!==void 0&&(Te.id=et),xe.features.push(Te)}}_limitZoom(z){return Math.max(this.options.minZoom,Math.min(Math.floor(+z),this.options.maxZoom+1))}_cluster(z,U){const{radius:W,extent:ie,reduce:de,minPoints:xe}=this.options,Me=W/(ie*Math.pow(2,U)),ye=z.data,Oe=[],ke=this.stride;for(let Se=0;Se<ye.length;Se+=ke){if(ye[Se+2]<=U)continue;ye[Se+2]=U;const Ue=ye[Se],Te=ye[Se+1],et=z.within(ye[Se],ye[Se+1],Me),dt=ye[Se+Ct];let Pt=dt;for(const bt of et){const $e=bt*ke;ye[$e+2]>U&&(Pt+=ye[$e+Ct])}if(Pt>dt&&Pt>=xe){let bt,$e=Ue*dt,st=Te*dt,ot=-1;const It=((Se/ke|0)<<5)+(U+1)+this.points.length;for(const wt of et){const kt=wt*ke;if(ye[kt+2]<=U)continue;ye[kt+2]=U;const _t=ye[kt+Ct];$e+=ye[kt]*_t,st+=ye[kt+1]*_t,ye[kt+4]=It,de&&(bt||(bt=this._map(ye,Se,!0),ot=this.clusterProps.length,this.clusterProps.push(bt)),de(bt,this._map(ye,kt)))}ye[Se+4]=It,Oe.push($e/Pt,st/Pt,1/0,It,-1,Pt),de&&Oe.push(ot)}else{for(let bt=0;bt<ke;bt++)Oe.push(ye[Se+bt]);if(Pt>1)for(const bt of et){const $e=bt*ke;if(!(ye[$e+2]<=U)){ye[$e+2]=U;for(let st=0;st<ke;st++)Oe.push(ye[$e+st])}}}}return Oe}_getOriginId(z){return z-this.points.length>>5}_getOriginZoom(z){return(z-this.points.length)%32}_map(z,U,W){if(z[U+Ct]>1){const xe=this.clusterProps[z[U+tr]];return W?Object.assign({},xe):xe}const ie=this.points[z[U+ht]].properties,de=this.options.map(ie);return W&&de===ie?Object.assign({},de):de}}function br(be,z,U){return{type:"Feature",id:be[z+ht],properties:rt(be,z,U),geometry:{type:"Point",coordinates:[(W=be[z],360*(W-.5)),Lt(be[z+1])]}};var W}function rt(be,z,U){const W=be[z+Ct],ie=W>=1e4?`${Math.round(W/1e3)}k`:W>=1e3?Math.round(W/100)/10+"k":W,de=be[z+tr],xe=de===-1?{}:Object.assign({},U[de]);return Object.assign(xe,{cluster:!0,cluster_id:be[z+ht],point_count:W,point_count_abbreviated:ie})}function ut(be){return be/360+.5}function Tt(be){const z=Math.sin(be*Math.PI/180),U=.5-.25*Math.log((1+z)/(1-z))/Math.PI;return U<0?0:U>1?1:U}function Lt(be){const z=(180-360*be)*Math.PI/180;return 360*Math.atan(Math.exp(z))/Math.PI-90}function Nt(be,z,U,W){let ie=W;const de=z+(U-z>>1);let xe,Me=U-z;const ye=be[z],Oe=be[z+1],ke=be[U],Se=be[U+1];for(let Ue=z+3;Ue<U;Ue+=3){const Te=Xr(be[Ue],be[Ue+1],ye,Oe,ke,Se);if(Te>ie)xe=Ue,ie=Te;else if(Te===ie){const et=Math.abs(Ue-de);et<Me&&(xe=Ue,Me=et)}}ie>W&&(xe-z>3&&Nt(be,z,xe,W),be[xe+2]=ie,U-xe>3&&Nt(be,xe,U,W))}function Xr(be,z,U,W,ie,de){let xe=ie-U,Me=de-W;if(xe!==0||Me!==0){const ye=((be-U)*xe+(z-W)*Me)/(xe*xe+Me*Me);ye>1?(U=ie,W=de):ye>0&&(U+=xe*ye,W+=Me*ye)}return xe=be-U,Me=z-W,xe*xe+Me*Me}function wr(be,z,U,W){const ie={id:be??null,type:z,geometry:U,tags:W,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(z==="Point"||z==="MultiPoint"||z==="LineString")fr(ie,U);else if(z==="Polygon")fr(ie,U[0]);else if(z==="MultiLineString")for(const de of U)fr(ie,de);else if(z==="MultiPolygon")for(const de of U)fr(ie,de[0]);return ie}function fr(be,z){for(let U=0;U<z.length;U+=3)be.minX=Math.min(be.minX,z[U]),be.minY=Math.min(be.minY,z[U+1]),be.maxX=Math.max(be.maxX,z[U]),be.maxY=Math.max(be.maxY,z[U+1])}function ln(be,z,U,W){if(!z.geometry)return;const ie=z.geometry.coordinates;if(ie&&ie.length===0)return;const de=z.geometry.type,xe=Math.pow(U.tolerance/((1<<U.maxZoom)*U.extent),2);let Me=[],ye=z.id;if(U.promoteId?ye=z.properties[U.promoteId]:U.generateId&&(ye=W||0),de==="Point")zn(ie,Me);else if(de==="MultiPoint")for(const Oe of ie)zn(Oe,Me);else if(de==="LineString")so(ie,Me,xe,!1);else if(de==="MultiLineString"){if(U.lineMetrics){for(const Oe of ie)Me=[],so(Oe,Me,xe,!1),be.push(wr(ye,"LineString",Me,z.properties));return}Pn(ie,Me,xe,!1)}else if(de==="Polygon")Pn(ie,Me,xe,!0);else{if(de!=="MultiPolygon"){if(de==="GeometryCollection"){for(const Oe of z.geometry.geometries)ln(be,{id:ye,geometry:Oe,properties:z.properties},U,W);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Oe of ie){const ke=[];Pn(Oe,ke,xe,!0),Me.push(ke)}}be.push(wr(ye,de,Me,z.properties))}function zn(be,z){z.push(es(be[0]),Kr(be[1]),0)}function so(be,z,U,W){let ie,de,xe=0;for(let ye=0;ye<be.length;ye++){const Oe=es(be[ye][0]),ke=Kr(be[ye][1]);z.push(Oe,ke,0),ye>0&&(xe+=W?(ie*ke-Oe*de)/2:Math.sqrt(Math.pow(Oe-ie,2)+Math.pow(ke-de,2))),ie=Oe,de=ke}const Me=z.length-3;z[2]=1,Nt(z,0,Me,U),z[Me+2]=1,z.size=Math.abs(xe),z.start=0,z.end=z.size}function Pn(be,z,U,W){for(let ie=0;ie<be.length;ie++){const de=[];so(be[ie],de,U,W),z.push(de)}}function es(be){return be/360+.5}function Kr(be){const z=Math.sin(be*Math.PI/180),U=.5-.25*Math.log((1+z)/(1-z))/Math.PI;return U<0?0:U>1?1:U}function Cr(be,z,U,W,ie,de,xe,Me){if(W/=z,de>=(U/=z)&&xe<W)return be;if(xe<U||de>=W)return null;const ye=[];for(const Oe of be){const ke=Oe.geometry;let Se=Oe.type;const Ue=ie===0?Oe.minX:Oe.minY,Te=ie===0?Oe.maxX:Oe.maxY;if(Ue>=U&&Te<W){ye.push(Oe);continue}if(Te<U||Ue>=W)continue;let et=[];if(Se==="Point"||Se==="MultiPoint")xi(ke,et,U,W,ie);else if(Se==="LineString")or(ke,et,U,W,ie,!1,Me.lineMetrics);else if(Se==="MultiLineString")lo(ke,et,U,W,ie,!1);else if(Se==="Polygon")lo(ke,et,U,W,ie,!0);else if(Se==="MultiPolygon")for(const dt of ke){const Pt=[];lo(dt,Pt,U,W,ie,!0),Pt.length&&et.push(Pt)}if(et.length){if(Me.lineMetrics&&Se==="LineString"){for(const dt of et)ye.push(wr(Oe.id,Se,dt,Oe.tags));continue}Se!=="LineString"&&Se!=="MultiLineString"||(et.length===1?(Se="LineString",et=et[0]):Se="MultiLineString"),Se!=="Point"&&Se!=="MultiPoint"||(Se=et.length===3?"Point":"MultiPoint"),ye.push(wr(Oe.id,Se,et,Oe.tags))}}return ye.length?ye:null}function xi(be,z,U,W,ie){for(let de=0;de<be.length;de+=3){const xe=be[de+ie];xe>=U&&xe<=W&&gn(z,be[de],be[de+1],be[de+2])}}function or(be,z,U,W,ie,de,xe){let Me=ao(be);const ye=ie===0?Rn:Vi;let Oe,ke,Se=be.start;for(let Pt=0;Pt<be.length-3;Pt+=3){const bt=be[Pt],$e=be[Pt+1],st=be[Pt+2],ot=be[Pt+3],It=be[Pt+4],wt=ie===0?bt:$e,kt=ie===0?ot:It;let _t=!1;xe&&(Oe=Math.sqrt(Math.pow(bt-ot,2)+Math.pow($e-It,2))),wt<U?kt>U&&(ke=ye(Me,bt,$e,ot,It,U),xe&&(Me.start=Se+Oe*ke)):wt>W?kt<W&&(ke=ye(Me,bt,$e,ot,It,W),xe&&(Me.start=Se+Oe*ke)):gn(Me,bt,$e,st),kt<U&&wt>=U&&(ke=ye(Me,bt,$e,ot,It,U),_t=!0),kt>W&&wt<=W&&(ke=ye(Me,bt,$e,ot,It,W),_t=!0),!de&&_t&&(xe&&(Me.end=Se+Oe*ke),z.push(Me),Me=ao(be)),xe&&(Se+=Oe)}let Ue=be.length-3;const Te=be[Ue],et=be[Ue+1],dt=ie===0?Te:et;dt>=U&&dt<=W&&gn(Me,Te,et,be[Ue+2]),Ue=Me.length-3,de&&Ue>=3&&(Me[Ue]!==Me[0]||Me[Ue+1]!==Me[1])&&gn(Me,Me[0],Me[1],Me[2]),Me.length&&z.push(Me)}function ao(be){const z=[];return z.size=be.size,z.start=be.start,z.end=be.end,z}function lo(be,z,U,W,ie,de){for(const xe of be)or(xe,z,U,W,ie,de,!1)}function gn(be,z,U,W){be.push(z,U,W)}function Rn(be,z,U,W,ie,de){const xe=(de-z)/(W-z);return gn(be,de,U+(ie-U)*xe,1),xe}function Vi(be,z,U,W,ie,de){const xe=(de-U)/(ie-U);return gn(be,z+(W-z)*xe,de,1),xe}function Gn(be,z){const U=[];for(let W=0;W<be.length;W++){const ie=be[W],de=ie.type;let xe;if(de==="Point"||de==="MultiPoint"||de==="LineString")xe=qn(ie.geometry,z);else if(de==="MultiLineString"||de==="Polygon"){xe=[];for(const Me of ie.geometry)xe.push(qn(Me,z))}else if(de==="MultiPolygon"){xe=[];for(const Me of ie.geometry){const ye=[];for(const Oe of Me)ye.push(qn(Oe,z));xe.push(ye)}}U.push(wr(ie.id,de,xe,ie.tags))}return U}function qn(be,z){const U=[];U.size=be.size,be.start!==void 0&&(U.start=be.start,U.end=be.end);for(let W=0;W<be.length;W+=3)U.push(be[W]+z,be[W+1],be[W+2]);return U}function Et(be,z){if(be.transformed)return be;const U=1<<be.z,W=be.x,ie=be.y;for(const de of be.features){const xe=de.geometry,Me=de.type;if(de.geometry=[],Me===1)for(let ye=0;ye<xe.length;ye+=2)de.geometry.push(ts(xe[ye],xe[ye+1],z,U,W,ie));else for(let ye=0;ye<xe.length;ye++){const Oe=[];for(let ke=0;ke<xe[ye].length;ke+=2)Oe.push(ts(xe[ye][ke],xe[ye][ke+1],z,U,W,ie));de.geometry.push(Oe)}}return be.transformed=!0,be}function ts(be,z,U,W,ie,de){return[Math.round(U*(be*W-ie)),Math.round(U*(z*W-de))]}function rs(be,z,U,W,ie){const de=z===ie.maxZoom?0:ie.tolerance/((1<<z)*ie.extent),xe={features:[],numPoints:0,numSimplified:0,numFeatures:be.length,source:null,x:U,y:W,z,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Me of be)Vs(xe,Me,de,ie);return xe}function Vs(be,z,U,W){const ie=z.geometry,de=z.type,xe=[];if(be.minX=Math.min(be.minX,z.minX),be.minY=Math.min(be.minY,z.minY),be.maxX=Math.max(be.maxX,z.maxX),be.maxY=Math.max(be.maxY,z.maxY),de==="Point"||de==="MultiPoint")for(let Me=0;Me<ie.length;Me+=3)xe.push(ie[Me],ie[Me+1]),be.numPoints++,be.numSimplified++;else if(de==="LineString")ns(xe,ie,be,U,!1,!1);else if(de==="MultiLineString"||de==="Polygon")for(let Me=0;Me<ie.length;Me++)ns(xe,ie[Me],be,U,de==="Polygon",Me===0);else if(de==="MultiPolygon")for(let Me=0;Me<ie.length;Me++){const ye=ie[Me];for(let Oe=0;Oe<ye.length;Oe++)ns(xe,ye[Oe],be,U,!0,Oe===0)}if(xe.length){let Me=z.tags||null;if(de==="LineString"&&W.lineMetrics){Me={};for(const Oe in z.tags)Me[Oe]=z.tags[Oe];Me.mapbox_clip_start=ie.start/ie.size,Me.mapbox_clip_end=ie.end/ie.size}const ye={geometry:xe,type:de==="Polygon"||de==="MultiPolygon"?3:de==="LineString"||de==="MultiLineString"?2:1,tags:Me};z.id!==null&&(ye.id=z.id),be.features.push(ye)}}function ns(be,z,U,W,ie,de){const xe=W*W;if(W>0&&z.size<(ie?xe:W))return void(U.numPoints+=z.length/3);const Me=[];for(let ye=0;ye<z.length;ye+=3)(W===0||z[ye+2]>xe)&&(U.numSimplified++,Me.push(z[ye],z[ye+1])),U.numPoints++;ie&&function(ye,Oe){let ke=0;for(let Se=0,Ue=ye.length,Te=Ue-2;Se<Ue;Te=Se,Se+=2)ke+=(ye[Se]-ye[Te])*(ye[Se+1]+ye[Te+1]);if(ke>0===Oe)for(let Se=0,Ue=ye.length;Se<Ue/2;Se+=2){const Te=ye[Se],et=ye[Se+1];ye[Se]=ye[Ue-2-Se],ye[Se+1]=ye[Ue-1-Se],ye[Ue-2-Se]=Te,ye[Ue-1-Se]=et}}(Me,de),be.push(Me)}const co={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class uo{constructor(z,U){const W=(U=this.options=function(de,xe){for(const Me in xe)de[Me]=xe[Me];return de}(Object.create(co),U)).debug;if(W&&console.time("preprocess data"),U.maxZoom<0||U.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(U.promoteId&&U.generateId)throw new Error("promoteId and generateId cannot be used together.");let ie=function(de,xe){const Me=[];if(de.type==="FeatureCollection")for(let ye=0;ye<de.features.length;ye++)ln(Me,de.features[ye],xe,ye);else ln(Me,de.type==="Feature"?de:{geometry:de},xe);return Me}(z,U);this.tiles={},this.tileCoords=[],W&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",U.indexMaxZoom,U.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),ie=function(de,xe){const Me=xe.buffer/xe.extent;let ye=de;const Oe=Cr(de,1,-1-Me,Me,0,-1,2,xe),ke=Cr(de,1,1-Me,2+Me,0,-1,2,xe);return(Oe||ke)&&(ye=Cr(de,1,-Me,1+Me,0,-1,2,xe)||[],Oe&&(ye=Gn(Oe,1).concat(ye)),ke&&(ye=ye.concat(Gn(ke,-1)))),ye}(ie,U),ie.length&&this.splitTile(ie,0,0,0),W&&(ie.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(z,U,W,ie,de,xe,Me){const ye=[z,U,W,ie],Oe=this.options,ke=Oe.debug;for(;ye.length;){ie=ye.pop(),W=ye.pop(),U=ye.pop(),z=ye.pop();const Se=1<<U,Ue=Io(U,W,ie);let Te=this.tiles[Ue];if(!Te&&(ke>1&&console.time("creation"),Te=this.tiles[Ue]=rs(z,U,W,ie,Oe),this.tileCoords.push({z:U,x:W,y:ie}),ke)){ke>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",U,W,ie,Te.numFeatures,Te.numPoints,Te.numSimplified),console.timeEnd("creation"));const _t=`z${U}`;this.stats[_t]=(this.stats[_t]||0)+1,this.total++}if(Te.source=z,de==null){if(U===Oe.indexMaxZoom||Te.numPoints<=Oe.indexMaxPoints)continue}else{if(U===Oe.maxZoom||U===de)continue;if(de!=null){const _t=de-U;if(W!==xe>>_t||ie!==Me>>_t)continue}}if(Te.source=null,z.length===0)continue;ke>1&&console.time("clipping");const et=.5*Oe.buffer/Oe.extent,dt=.5-et,Pt=.5+et,bt=1+et;let $e=null,st=null,ot=null,It=null,wt=Cr(z,Se,W-et,W+Pt,0,Te.minX,Te.maxX,Oe),kt=Cr(z,Se,W+dt,W+bt,0,Te.minX,Te.maxX,Oe);z=null,wt&&($e=Cr(wt,Se,ie-et,ie+Pt,1,Te.minY,Te.maxY,Oe),st=Cr(wt,Se,ie+dt,ie+bt,1,Te.minY,Te.maxY,Oe),wt=null),kt&&(ot=Cr(kt,Se,ie-et,ie+Pt,1,Te.minY,Te.maxY,Oe),It=Cr(kt,Se,ie+dt,ie+bt,1,Te.minY,Te.maxY,Oe),kt=null),ke>1&&console.timeEnd("clipping"),ye.push($e||[],U+1,2*W,2*ie),ye.push(st||[],U+1,2*W,2*ie+1),ye.push(ot||[],U+1,2*W+1,2*ie),ye.push(It||[],U+1,2*W+1,2*ie+1)}}getTile(z,U,W){z=+z,U=+U,W=+W;const ie=this.options,{extent:de,debug:xe}=ie;if(z<0||z>24)return null;const Me=1<<z,ye=Io(z,U=U+Me&Me-1,W);if(this.tiles[ye])return Et(this.tiles[ye],de);xe>1&&console.log("drilling down to z%d-%d-%d",z,U,W);let Oe,ke=z,Se=U,Ue=W;for(;!Oe&&ke>0;)ke--,Se>>=1,Ue>>=1,Oe=this.tiles[Io(ke,Se,Ue)];return Oe&&Oe.source?(xe>1&&(console.log("found parent tile z%d-%d-%d",ke,Se,Ue),console.time("drilling down")),this.splitTile(Oe.source,ke,Se,Ue,z,U,W),xe>1&&console.timeEnd("drilling down"),this.tiles[ye]?Et(this.tiles[ye],de):null):null}}function Io(be,z,U){return 32*((1<<be)*U+z)+be}function ko(be,z){return z?be.properties[z]:be.id}function Oa(be,z){if(be==null)return!0;if(be.type==="Feature")return ko(be,z)!=null;if(be.type==="FeatureCollection"){const U=new Set;for(const W of be.features){const ie=ko(W,z);if(ie==null||U.has(ie))return!1;U.add(ie)}return!0}return!1}function Us(be,z){const U=new Map;if(be!=null)if(be.type==="Feature")U.set(ko(be,z),be);else for(const W of be.features)U.set(ko(W,z),W);return U}class ja extends Q{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(z,U){return x._(this,void 0,void 0,function*(){const W=z.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const ie=this._geoJSONIndex.getTile(W.z,W.x,W.y);if(!ie)return null;const de=new se(ie.features);let xe=gt(de);return xe.byteOffset===0&&xe.byteLength===xe.buffer.byteLength||(xe=new Uint8Array(xe)),{vectorTile:de,rawData:xe.buffer}})}loadData(z){return x._(this,void 0,void 0,function*(){var U;(U=this._pendingRequest)===null||U===void 0||U.abort();const W=!!(z&&z.request&&z.request.collectResourceTiming)&&new x.cw(z.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(z,this._pendingRequest),this._geoJSONIndex=z.cluster?new St(function({superclusterOptions:xe,clusterProperties:Me}){if(!Me||!xe)return xe;const ye={},Oe={},ke={accumulated:null,zoom:0},Se={properties:null},Ue=Object.keys(Me);for(const Te of Ue){const[et,dt]=Me[Te],Pt=x.cD(dt),bt=x.cD(typeof et=="string"?[et,["accumulated"],["get",Te]]:et);ye[Te]=Pt.value,Oe[Te]=bt.value}return xe.map=Te=>{Se.properties=Te;const et={};for(const dt of Ue)et[dt]=ye[dt].evaluate(ke,Se);return et},xe.reduce=(Te,et)=>{Se.properties=et;for(const dt of Ue)ke.accumulated=Te[dt],Te[dt]=Oe[dt].evaluate(ke,Se)},xe}(z)).load((yield this._pendingData).features):(ie=yield this._pendingData,new uo(ie,z.geojsonVtOptions)),this.loaded={};const de={};if(W){const xe=W.finish();xe&&(de.resourceTiming={},de.resourceTiming[z.source]=JSON.parse(JSON.stringify(xe)))}return de}catch(de){if(delete this._pendingRequest,x.ch(de))return{abandoned:!0};throw de}var ie})}getData(){return x._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(z){const U=this.loaded;return U&&U[z.uid]?super.reloadTile(z):this.loadTile(z)}loadAndProcessGeoJSON(z,U){return x._(this,void 0,void 0,function*(){let W=yield this.loadGeoJSON(z,U);if(delete this._pendingRequest,typeof W!="object")throw new Error(`Input data given to '${z.source}' is not a valid GeoJSON object.`);if(Ae(W,!0),z.filter){const ie=x.cD(z.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ie.result==="error")throw new Error(ie.value.map(xe=>`${xe.key}: ${xe.message}`).join(", "));W={type:"FeatureCollection",features:W.features.filter(xe=>ie.value.evaluate({zoom:0},xe))}}return W})}loadGeoJSON(z,U){return x._(this,void 0,void 0,function*(){const{promoteId:W}=z;if(z.request){const ie=yield x.j(z.request,U);return this._dataUpdateable=Oa(ie.data,W)?Us(ie.data,W):void 0,ie.data}if(typeof z.data=="string")try{const ie=JSON.parse(z.data);return this._dataUpdateable=Oa(ie,W)?Us(ie,W):void 0,ie}catch{throw new Error(`Input data given to '${z.source}' is not a valid GeoJSON object.`)}if(!z.dataDiff)throw new Error(`Input data given to '${z.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${z.source}`);return function(ie,de,xe){var Me,ye,Oe,ke;if(de.removeAll&&ie.clear(),de.remove)for(const Se of de.remove)ie.delete(Se);if(de.add)for(const Se of de.add){const Ue=ko(Se,xe);Ue!=null&&ie.set(Ue,Se)}if(de.update)for(const Se of de.update){let Ue=ie.get(Se.id);if(Ue==null)continue;const Te=!Se.removeAllProperties&&(((Me=Se.removeProperties)===null||Me===void 0?void 0:Me.length)>0||((ye=Se.addOrUpdateProperties)===null||ye===void 0?void 0:ye.length)>0);if((Se.newGeometry||Se.removeAllProperties||Te)&&(Ue=Object.assign({},Ue),ie.set(Se.id,Ue),Te&&(Ue.properties=Object.assign({},Ue.properties))),Se.newGeometry&&(Ue.geometry=Se.newGeometry),Se.removeAllProperties)Ue.properties={};else if(((Oe=Se.removeProperties)===null||Oe===void 0?void 0:Oe.length)>0)for(const et of Se.removeProperties)Object.prototype.hasOwnProperty.call(Ue.properties,et)&&delete Ue.properties[et];if(((ke=Se.addOrUpdateProperties)===null||ke===void 0?void 0:ke.length)>0)for(const{key:et,value:dt}of Se.addOrUpdateProperties)Ue.properties[et]=dt}}(this._dataUpdateable,z.dataDiff,W),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(z){return x._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(z){return this._geoJSONIndex.getClusterExpansionZoom(z.clusterId)}getClusterChildren(z){return this._geoJSONIndex.getChildren(z.clusterId)}getClusterLeaves(z){return this._geoJSONIndex.getLeaves(z.clusterId,z.limit,z.offset)}}class ho{constructor(z){this.self=z,this.actor=new x.H(z),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(U,W)=>{if(this.externalWorkerSourceTypes[U])throw new Error(`Worker source with name "${U}" already registered.`);this.externalWorkerSourceTypes[U]=W},this.self.addProtocol=x.cj,this.self.removeProtocol=x.ck,this.self.registerRTLTextPlugin=U=>{x.cE.setMethods(U)},this.actor.registerMessageHandler("LDT",(U,W)=>this._getDEMWorkerSource(U,W.source).loadTile(W)),this.actor.registerMessageHandler("RDT",(U,W)=>x._(this,void 0,void 0,function*(){this._getDEMWorkerSource(U,W.source).removeTile(W)})),this.actor.registerMessageHandler("GCEZ",(U,W)=>x._(this,void 0,void 0,function*(){return this._getWorkerSource(U,W.type,W.source).getClusterExpansionZoom(W)})),this.actor.registerMessageHandler("GCC",(U,W)=>x._(this,void 0,void 0,function*(){return this._getWorkerSource(U,W.type,W.source).getClusterChildren(W)})),this.actor.registerMessageHandler("GCL",(U,W)=>x._(this,void 0,void 0,function*(){return this._getWorkerSource(U,W.type,W.source).getClusterLeaves(W)})),this.actor.registerMessageHandler("LD",(U,W)=>this._getWorkerSource(U,W.type,W.source).loadData(W)),this.actor.registerMessageHandler("GD",(U,W)=>this._getWorkerSource(U,W.type,W.source).getData()),this.actor.registerMessageHandler("LT",(U,W)=>this._getWorkerSource(U,W.type,W.source).loadTile(W)),this.actor.registerMessageHandler("RT",(U,W)=>this._getWorkerSource(U,W.type,W.source).reloadTile(W)),this.actor.registerMessageHandler("AT",(U,W)=>this._getWorkerSource(U,W.type,W.source).abortTile(W)),this.actor.registerMessageHandler("RMT",(U,W)=>this._getWorkerSource(U,W.type,W.source).removeTile(W)),this.actor.registerMessageHandler("RS",(U,W)=>x._(this,void 0,void 0,function*(){if(!this.workerSources[U]||!this.workerSources[U][W.type]||!this.workerSources[U][W.type][W.source])return;const ie=this.workerSources[U][W.type][W.source];delete this.workerSources[U][W.type][W.source],ie.removeSource!==void 0&&ie.removeSource(W)})),this.actor.registerMessageHandler("RM",U=>x._(this,void 0,void 0,function*(){delete this.layerIndexes[U],delete this.availableImages[U],delete this.workerSources[U],delete this.demWorkerSources[U]})),this.actor.registerMessageHandler("SR",(U,W)=>x._(this,void 0,void 0,function*(){this.referrer=W})),this.actor.registerMessageHandler("SRPS",(U,W)=>this._syncRTLPluginState(U,W)),this.actor.registerMessageHandler("IS",(U,W)=>x._(this,void 0,void 0,function*(){this.self.importScripts(W)})),this.actor.registerMessageHandler("SI",(U,W)=>this._setImages(U,W)),this.actor.registerMessageHandler("UL",(U,W)=>x._(this,void 0,void 0,function*(){this._getLayerIndex(U).update(W.layers,W.removedIds)})),this.actor.registerMessageHandler("SL",(U,W)=>x._(this,void 0,void 0,function*(){this._getLayerIndex(U).replace(W)}))}_setImages(z,U){return x._(this,void 0,void 0,function*(){this.availableImages[z]=U;for(const W in this.workerSources[z]){const ie=this.workerSources[z][W];for(const de in ie)ie[de].availableImages=U}})}_syncRTLPluginState(z,U){return x._(this,void 0,void 0,function*(){return yield x.cE.syncState(U,this.self.importScripts)})}_getAvailableImages(z){let U=this.availableImages[z];return U||(U=[]),U}_getLayerIndex(z){let U=this.layerIndexes[z];return U||(U=this.layerIndexes[z]=new c),U}_getWorkerSource(z,U,W){if(this.workerSources[z]||(this.workerSources[z]={}),this.workerSources[z][U]||(this.workerSources[z][U]={}),!this.workerSources[z][U][W]){const ie={sendAsync:(de,xe)=>(de.targetMapId=z,this.actor.sendAsync(de,xe))};switch(U){case"vector":this.workerSources[z][U][W]=new Q(ie,this._getLayerIndex(z),this._getAvailableImages(z));break;case"geojson":this.workerSources[z][U][W]=new ja(ie,this._getLayerIndex(z),this._getAvailableImages(z));break;default:this.workerSources[z][U][W]=new this.externalWorkerSourceTypes[U](ie,this._getLayerIndex(z),this._getAvailableImages(z))}}return this.workerSources[z][U][W]}_getDEMWorkerSource(z,U){return this.demWorkerSources[z]||(this.demWorkerSources[z]={}),this.demWorkerSources[z][U]||(this.demWorkerSources[z][U]=new H),this.demWorkerSources[z][U]}}return x.i(self)&&(self.worker=new ho(self)),ho}),m("index",["exports","./shared"],function(x,c){var A="5.2.0";function j(){var f=new c.A(4);return c.A!=Float32Array&&(f[1]=0,f[2]=0),f[0]=1,f[3]=1,f}let Y,Q;const H={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(f,e,i){const u=requestAnimationFrame(g=>{h(),e(g)}),{unsubscribe:h}=c.s(f.signal,"abort",()=>{h(),cancelAnimationFrame(u),i(c.c())},!1)},frameAsync(f){return new Promise((e,i)=>{this.frame(f,e,i)})},getImageData(f,e=0){return this.getImageCanvasContext(f).getImageData(-e,-e,f.width+2*e,f.height+2*e)},getImageCanvasContext(f){const e=window.document.createElement("canvas"),i=e.getContext("2d",{willReadFrequently:!0});if(!i)throw new Error("failed to create canvas 2d context");return e.width=f.width,e.height=f.height,i.drawImage(f,0,0,f.width,f.height),i},resolveURL:f=>(Y||(Y=document.createElement("a")),Y.href=f,Y.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(Q==null&&(Q=matchMedia("(prefers-reduced-motion: reduce)")),Q.matches)}};class G{static testProp(e){if(!G.docStyle)return e[0];for(let i=0;i<e.length;i++)if(e[i]in G.docStyle)return e[i];return e[0]}static create(e,i,u){const h=window.document.createElement(e);return i!==void 0&&(h.className=i),u&&u.appendChild(h),h}static createNS(e,i){return window.document.createElementNS(e,i)}static disableDrag(){G.docStyle&&G.selectProp&&(G.userSelect=G.docStyle[G.selectProp],G.docStyle[G.selectProp]="none")}static enableDrag(){G.docStyle&&G.selectProp&&(G.docStyle[G.selectProp]=G.userSelect)}static setTransform(e,i){e.style[G.transformProp]=i}static addEventListener(e,i,u,h={}){e.addEventListener(i,u,"passive"in h?h:h.capture)}static removeEventListener(e,i,u,h={}){e.removeEventListener(i,u,"passive"in h?h:h.capture)}static suppressClickInternal(e){e.preventDefault(),e.stopPropagation(),window.removeEventListener("click",G.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",G.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",G.suppressClickInternal,!0)},0)}static getScale(e){const i=e.getBoundingClientRect();return{x:i.width/e.offsetWidth||1,y:i.height/e.offsetHeight||1,boundingClientRect:i}}static getPoint(e,i,u){const h=i.boundingClientRect;return new c.P((u.clientX-h.left)/i.x-e.clientLeft,(u.clientY-h.top)/i.y-e.clientTop)}static mousePos(e,i){const u=G.getScale(e);return G.getPoint(e,u,i)}static touchPos(e,i){const u=[],h=G.getScale(e);for(let g=0;g<i.length;g++)u.push(G.getPoint(e,h,i[g]));return u}static mouseButton(e){return e.button}static remove(e){e.parentNode&&e.parentNode.removeChild(e)}static sanitize(e){const i=new DOMParser().parseFromString(e,"text/html").body||document.createElement("body"),u=i.querySelectorAll("script");for(const h of u)h.remove();return G.clean(i),i.innerHTML}static isPossiblyDangerous(e,i){const u=i.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(e)||!u.includes("javascript:")&&!u.includes("data:"))||!!e.startsWith("on")||void 0}static clean(e){const i=e.children;for(const u of i)G.removeAttributes(u),G.clean(u)}static removeAttributes(e){for(const{name:i,value:u}of e.attributes)G.isPossiblyDangerous(i,u)&&e.removeAttribute(i)}}G.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,G.selectProp=G.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),G.transformProp=G.testProp(["transform","WebkitTransform"]);const le={supported:!1,testSupport:function(f){!ee&&Ae&&(re?se(f):ve=f)}};let ve,Ae,ee=!1,re=!1;function se(f){const e=f.createTexture();f.bindTexture(f.TEXTURE_2D,e);try{if(f.texImage2D(f.TEXTURE_2D,0,f.RGBA,f.RGBA,f.UNSIGNED_BYTE,Ae),f.isContextLost())return;le.supported=!0}catch{}f.deleteTexture(e),ee=!0}var _e;typeof document<"u"&&(Ae=document.createElement("img"),Ae.onload=()=>{ve&&se(ve),ve=null,re=!0},Ae.onerror=()=>{ee=!0,ve=null},Ae.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(f){let e,i,u,h;f.resetRequestQueue=()=>{e=[],i=0,u=0,h={}},f.addThrottleControl=P=>{const E=u++;return h[E]=P,E},f.removeThrottleControl=P=>{delete h[P],v()},f.getImage=(P,E,k=!0)=>new Promise((R,L)=>{le.supported&&(P.headers||(P.headers={}),P.headers.accept="image/webp,*/*"),c.e(P,{type:"image"}),e.push({abortController:E,requestParameters:P,supportImageRefresh:k,state:"queued",onError:N=>{L(N)},onSuccess:N=>{R(N)}}),v()});const g=P=>c._(this,void 0,void 0,function*(){P.state="running";const{requestParameters:E,supportImageRefresh:k,onError:R,onSuccess:L,abortController:N}=P,V=k===!1&&!c.i(self)&&!c.g(E.url)&&(!E.headers||Object.keys(E.headers).reduce((te,oe)=>te&&oe==="accept",!0));i++;const J=V?S(E,N):c.m(E,N);try{const te=yield J;delete P.abortController,P.state="completed",te.data instanceof HTMLImageElement||c.b(te.data)?L(te):te.data&&L({data:yield(K=te.data,typeof createImageBitmap=="function"?c.f(K):c.h(K)),cacheControl:te.cacheControl,expires:te.expires})}catch(te){delete P.abortController,R(te)}finally{i--,v()}var K}),v=()=>{const P=(()=>{for(const E of Object.keys(h))if(h[E]())return!0;return!1})()?c.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:c.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let E=i;E<P&&e.length>0;E++){const k=e.shift();k.abortController.signal.aborted?E--:g(k)}},S=(P,E)=>new Promise((k,R)=>{const L=new Image,N=P.url,V=P.credentials;V&&V==="include"?L.crossOrigin="use-credentials":(V&&V==="same-origin"||!c.d(N))&&(L.crossOrigin="anonymous"),E.signal.addEventListener("abort",()=>{L.src="",R(c.c())}),L.fetchPriority="high",L.onload=()=>{L.onerror=L.onload=null,k({data:L})},L.onerror=()=>{L.onerror=L.onload=null,E.signal.aborted||R(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},L.src=N})}(_e||(_e={})),_e.resetRequestQueue();class De{constructor(e){this._transformRequestFn=e}transformRequest(e,i){return this._transformRequestFn&&this._transformRequestFn(e,i)||{url:e}}setTransformRequest(e){this._transformRequestFn=e}}function Fe(f){const e=[];if(typeof f=="string")e.push({id:"default",url:f});else if(f&&f.length>0){const i=[];for(const{id:u,url:h}of f){const g=`${u}${h}`;i.indexOf(g)===-1&&(i.push(g),e.push({id:u,url:h}))}}return e}function ze(f,e,i){try{const u=new URL(f);return u.pathname+=`${e}${i}`,u.toString()}catch{throw new Error(`Invalid sprite URL "${f}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}class We{constructor(e,i,u,h){this.context=e,this.format=u,this.texture=e.gl.createTexture(),this.update(i,h)}update(e,i,u){const{width:h,height:g}=e,v=!(this.size&&this.size[0]===h&&this.size[1]===g||u),{context:S}=this,{gl:P}=S;if(this.useMipmap=!!(i&&i.useMipmap),P.bindTexture(P.TEXTURE_2D,this.texture),S.pixelStoreUnpackFlipY.set(!1),S.pixelStoreUnpack.set(1),S.pixelStoreUnpackPremultiplyAlpha.set(this.format===P.RGBA&&(!i||i.premultiply!==!1)),v)this.size=[h,g],e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||c.b(e)?P.texImage2D(P.TEXTURE_2D,0,this.format,this.format,P.UNSIGNED_BYTE,e):P.texImage2D(P.TEXTURE_2D,0,this.format,h,g,0,this.format,P.UNSIGNED_BYTE,e.data);else{const{x:E,y:k}=u||{x:0,y:0};e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||c.b(e)?P.texSubImage2D(P.TEXTURE_2D,0,E,k,P.RGBA,P.UNSIGNED_BYTE,e):P.texSubImage2D(P.TEXTURE_2D,0,E,k,h,g,P.RGBA,P.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&P.generateMipmap(P.TEXTURE_2D)}bind(e,i,u){const{context:h}=this,{gl:g}=h;g.bindTexture(g.TEXTURE_2D,this.texture),u!==g.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(u=g.LINEAR),e!==this.filter&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,e),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,u||e),this.filter=e),i!==this.wrap&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,i),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,i),this.wrap=i)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}function gt(f){const{userImage:e}=f;return!!(e&&e.render&&e.render())&&(f.data.replace(new Uint8Array(e.data.buffer)),!0)}class X extends c.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new c.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(e){if(this.loaded!==e&&(this.loaded=e,e)){for(const{ids:i,promiseResolve:u}of this.requestors)u(this._getImagesForIds(i));this.requestors=[]}}getImage(e){const i=this.images[e];if(i&&!i.data&&i.spriteData){const u=i.spriteData;i.data=new c.R({width:u.width,height:u.height},u.context.getImageData(u.x,u.y,u.width,u.height).data),i.spriteData=null}return i}addImage(e,i){if(this.images[e])throw new Error(`Image id ${e} already exist, use updateImage instead`);this._validate(e,i)&&(this.images[e]=i)}_validate(e,i){let u=!0;const h=i.data||i.spriteData;return this._validateStretch(i.stretchX,h&&h.width)||(this.fire(new c.k(new Error(`Image "${e}" has invalid "stretchX" value`))),u=!1),this._validateStretch(i.stretchY,h&&h.height)||(this.fire(new c.k(new Error(`Image "${e}" has invalid "stretchY" value`))),u=!1),this._validateContent(i.content,i)||(this.fire(new c.k(new Error(`Image "${e}" has invalid "content" value`))),u=!1),u}_validateStretch(e,i){if(!e)return!0;let u=0;for(const h of e){if(h[0]<u||h[1]<h[0]||i<h[1])return!1;u=h[1]}return!0}_validateContent(e,i){if(!e)return!0;if(e.length!==4)return!1;const u=i.spriteData,h=u&&u.width||i.data.width,g=u&&u.height||i.data.height;return!(e[0]<0||h<e[0]||e[1]<0||g<e[1]||e[2]<0||h<e[2]||e[3]<0||g<e[3]||e[2]<e[0]||e[3]<e[1])}updateImage(e,i,u=!0){const h=this.getImage(e);if(u&&(h.data.width!==i.data.width||h.data.height!==i.data.height))throw new Error(`size mismatch between old image (${h.data.width}x${h.data.height}) and new image (${i.data.width}x${i.data.height}).`);i.version=h.version+1,this.images[e]=i,this.updatedImages[e]=!0}removeImage(e){const i=this.images[e];delete this.images[e],delete this.patterns[e],i.userImage&&i.userImage.onRemove&&i.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(e){return new Promise((i,u)=>{let h=!0;if(!this.isLoaded())for(const g of e)this.images[g]||(h=!1);this.isLoaded()||h?i(this._getImagesForIds(e)):this.requestors.push({ids:e,promiseResolve:i})})}_getImagesForIds(e){const i={};for(const u of e){let h=this.getImage(u);h||(this.fire(new c.l("styleimagemissing",{id:u})),h=this.getImage(u)),h?i[u]={data:h.data.clone(),pixelRatio:h.pixelRatio,sdf:h.sdf,version:h.version,stretchX:h.stretchX,stretchY:h.stretchY,content:h.content,textFitWidth:h.textFitWidth,textFitHeight:h.textFitHeight,hasRenderCallback:!!(h.userImage&&h.userImage.render)}:c.w(`Image "${u}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return i}getPixelSize(){const{width:e,height:i}=this.atlasImage;return{width:e,height:i}}getPattern(e){const i=this.patterns[e],u=this.getImage(e);if(!u)return null;if(i&&i.position.version===u.version)return i.position;if(i)i.position.version=u.version;else{const h={w:u.data.width+2,h:u.data.height+2,x:0,y:0},g=new c.I(h,u);this.patterns[e]={bin:h,position:g}}return this._updatePatternAtlas(),this.patterns[e].position}bind(e){const i=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new We(e,this.atlasImage,i.RGBA),this.atlasTexture.bind(i.LINEAR,i.CLAMP_TO_EDGE)}_updatePatternAtlas(){const e=[];for(const g in this.patterns)e.push(this.patterns[g].bin);const{w:i,h:u}=c.p(e),h=this.atlasImage;h.resize({width:i||1,height:u||1});for(const g in this.patterns){const{bin:v}=this.patterns[g],S=v.x+1,P=v.y+1,E=this.getImage(g).data,k=E.width,R=E.height;c.R.copy(E,h,{x:0,y:0},{x:S,y:P},{width:k,height:R}),c.R.copy(E,h,{x:0,y:R-1},{x:S,y:P-1},{width:k,height:1}),c.R.copy(E,h,{x:0,y:0},{x:S,y:P+R},{width:k,height:1}),c.R.copy(E,h,{x:k-1,y:0},{x:S-1,y:P},{width:1,height:R}),c.R.copy(E,h,{x:0,y:0},{x:S+k,y:P},{width:1,height:R})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(e){for(const i of e){if(this.callbackDispatchedThisFrame[i])continue;this.callbackDispatchedThisFrame[i]=!0;const u=this.getImage(i);u||c.w(`Image with ID: "${i}" was not found`),gt(u)&&this.updateImage(i,u)}}}const Ye=1e20;function at(f,e,i,u,h,g,v,S,P){for(let E=e;E<e+u;E++)ht(f,i*g+E,g,h,v,S,P);for(let E=i;E<i+h;E++)ht(f,E*g+e,1,u,v,S,P)}function ht(f,e,i,u,h,g,v){g[0]=0,v[0]=-1e20,v[1]=Ye,h[0]=f[e];for(let S=1,P=0,E=0;S<u;S++){h[S]=f[e+S*i];const k=S*S;do{const R=g[P];E=(h[S]-h[R]+k-R*R)/(S-R)/2}while(E<=v[P]&&--P>-1);P++,g[P]=S,v[P]=E,v[P+1]=Ye}for(let S=0,P=0;S<u;S++){for(;v[P+1]<S;)P++;const E=g[P],k=S-E;f[e+S*i]=h[E]+k*k}}class Ct{constructor(e,i){this.requestManager=e,this.localIdeographFontFamily=i,this.entries={}}setURL(e){this.url=e}getGlyphs(e){return c._(this,void 0,void 0,function*(){const i=[];for(const g in e)for(const v of e[g])i.push(this._getAndCacheGlyphsPromise(g,v));const u=yield Promise.all(i),h={};for(const{stack:g,id:v,glyph:S}of u)h[g]||(h[g]={}),h[g][v]=S&&{id:S.id,bitmap:S.bitmap.clone(),metrics:S.metrics};return h})}_getAndCacheGlyphsPromise(e,i){return c._(this,void 0,void 0,function*(){let u=this.entries[e];u||(u=this.entries[e]={glyphs:{},requests:{},ranges:{}});let h=u.glyphs[i];if(h!==void 0)return{stack:e,id:i,glyph:h};if(h=this._tinySDF(u,e,i),h)return u.glyphs[i]=h,{stack:e,id:i,glyph:h};const g=Math.floor(i/256);if(256*g>65535)throw new Error("glyphs > 65535 not supported");if(u.ranges[g])return{stack:e,id:i,glyph:h};if(!this.url)throw new Error("glyphsUrl is not set");if(!u.requests[g]){const S=Ct.loadGlyphRange(e,g,this.url,this.requestManager);u.requests[g]=S}const v=yield u.requests[g];for(const S in v)this._doesCharSupportLocalGlyph(+S)||(u.glyphs[+S]=v[+S]);return u.ranges[g]=!0,{stack:e,id:i,glyph:v[i]||null}})}_doesCharSupportLocalGlyph(e){return!!this.localIdeographFontFamily&&(new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(e))||c.u["CJK Unified Ideographs"](e)||c.u["Hangul Syllables"](e)||c.u.Hiragana(e)||c.u.Katakana(e)||c.u["CJK Symbols and Punctuation"](e)||c.u["Halfwidth and Fullwidth Forms"](e))}_tinySDF(e,i,u){const h=this.localIdeographFontFamily;if(!h||!this._doesCharSupportLocalGlyph(u))return;let g=e.tinySDF;if(!g){let S="400";/bold/i.test(i)?S="900":/medium/i.test(i)?S="500":/light/i.test(i)&&(S="200"),g=e.tinySDF=new Ct.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:h,fontWeight:S})}const v=g.draw(String.fromCharCode(u));return{id:u,bitmap:new c.q({width:v.width||60,height:v.height||60},v.data),metrics:{width:v.glyphWidth/2||24,height:v.glyphHeight/2||24,left:v.glyphLeft/2+.5||0,top:v.glyphTop/2-27.5||-8,advance:v.glyphAdvance/2||24,isDoubleResolution:!0}}}}Ct.loadGlyphRange=function(f,e,i,u){return c._(this,void 0,void 0,function*(){const h=256*e,g=h+255,v=u.transformRequest(i.replace("{fontstack}",f).replace("{range}",`${h}-${g}`),"Glyphs"),S=yield c.n(v,new AbortController);if(!S||!S.data)throw new Error(`Could not load glyph range. range: ${e}, ${h}-${g}`);const P={};for(const E of c.o(S.data))P[E.id]=E;return P})},Ct.TinySDF=class{constructor({fontSize:f=24,buffer:e=3,radius:i=8,cutoff:u=.25,fontFamily:h="sans-serif",fontWeight:g="normal",fontStyle:v="normal"}={}){this.buffer=e,this.cutoff=u,this.radius=i;const S=this.size=f+4*e,P=this._createCanvas(S),E=this.ctx=P.getContext("2d",{willReadFrequently:!0});E.font=`${v} ${g} ${f}px ${h}`,E.textBaseline="alphabetic",E.textAlign="left",E.fillStyle="black",this.gridOuter=new Float64Array(S*S),this.gridInner=new Float64Array(S*S),this.f=new Float64Array(S),this.z=new Float64Array(S+1),this.v=new Uint16Array(S)}_createCanvas(f){const e=document.createElement("canvas");return e.width=e.height=f,e}draw(f){const{width:e,actualBoundingBoxAscent:i,actualBoundingBoxDescent:u,actualBoundingBoxLeft:h,actualBoundingBoxRight:g}=this.ctx.measureText(f),v=Math.ceil(i),S=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(g-h))),P=Math.min(this.size-this.buffer,v+Math.ceil(u)),E=S+2*this.buffer,k=P+2*this.buffer,R=Math.max(E*k,0),L=new Uint8ClampedArray(R),N={data:L,width:E,height:k,glyphWidth:S,glyphHeight:P,glyphTop:v,glyphLeft:0,glyphAdvance:e};if(S===0||P===0)return N;const{ctx:V,buffer:J,gridInner:K,gridOuter:te}=this;V.clearRect(J,J,S,P),V.fillText(f,J,J+v);const oe=V.getImageData(J,J,S,P);te.fill(Ye,0,R),K.fill(0,0,R);for(let ue=0;ue<P;ue++)for(let he=0;he<S;he++){const pe=oe.data[4*(ue*S+he)+3]/255;if(pe===0)continue;const ge=(ue+J)*E+he+J;if(pe===1)te[ge]=0,K[ge]=Ye;else{const fe=.5-pe;te[ge]=fe>0?fe*fe:0,K[ge]=fe<0?fe*fe:0}}at(te,0,0,E,k,E,this.f,this.v,this.z),at(K,J,J,S,P,E,this.f,this.v,this.z);for(let ue=0;ue<R;ue++){const he=Math.sqrt(te[ue])-Math.sqrt(K[ue]);L[ue]=Math.round(255-255*(he/this.radius+this.cutoff))}return N}};class tr{constructor(){this.specification=c.v.light.position}possiblyEvaluate(e,i){return c.z(e.expression.evaluate(i))}interpolate(e,i,u){return{x:c.B.number(e.x,i.x,u),y:c.B.number(e.y,i.y,u),z:c.B.number(e.z,i.z,u)}}}let St;class br extends c.E{constructor(e){super(),St=St||new c.r({anchor:new c.D(c.v.light.anchor),position:new tr,color:new c.D(c.v.light.color),intensity:new c.D(c.v.light.intensity)}),this._transitionable=new c.T(St),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e,i={}){if(!this._validate(c.t,e,i))for(const u in e){const h=e[u];u.endsWith("-transition")?this._transitionable.setTransition(u.slice(0,-11),h):this._transitionable.setValue(u,h)}}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,i,u){return(!u||u.validate!==!1)&&c.x(this,e.call(c.y,{value:i,style:{glyphs:!0,sprite:!0},styleSpec:c.v}))}}const rt=new c.r({"sky-color":new c.D(c.v.sky["sky-color"]),"horizon-color":new c.D(c.v.sky["horizon-color"]),"fog-color":new c.D(c.v.sky["fog-color"]),"fog-ground-blend":new c.D(c.v.sky["fog-ground-blend"]),"horizon-fog-blend":new c.D(c.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new c.D(c.v.sky["sky-horizon-blend"]),"atmosphere-blend":new c.D(c.v.sky["atmosphere-blend"])});class ut extends c.E{constructor(e){super(),this._transitionable=new c.T(rt),this.setSky(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new c.C(0))}setSky(e,i={}){if(!this._validate(c.F,e,i)){e||(e={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const u in e){const h=e[u];u.endsWith("-transition")?this._transitionable.setTransition(u.slice(0,-11),h):this._transitionable.setValue(u,h)}}}getSky(){return this._transitionable.serialize()}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,i,u={}){return(u==null?void 0:u.validate)!==!1&&c.x(this,e.call(c.y,c.e({value:i,style:{glyphs:!0,sprite:!0},styleSpec:c.v})))}calculateFogBlendOpacity(e){return e<60?0:e<70?(e-60)/10:1}}class Tt{constructor(e,i){this.width=e,this.height=i,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(e,i){const u=e.join(",")+String(i);return this.dashEntry[u]||(this.dashEntry[u]=this.addDash(e,i)),this.dashEntry[u]}getDashRanges(e,i,u){const h=[];let g=e.length%2==1?-e[e.length-1]*u:0,v=e[0]*u,S=!0;h.push({left:g,right:v,isDash:S,zeroLength:e[0]===0});let P=e[0];for(let E=1;E<e.length;E++){S=!S;const k=e[E];g=P*u,P+=k,v=P*u,h.push({left:g,right:v,isDash:S,zeroLength:k===0})}return h}addRoundDash(e,i,u){const h=i/2;for(let g=-u;g<=u;g++){const v=this.width*(this.nextRow+u+g);let S=0,P=e[S];for(let E=0;E<this.width;E++){E/P.right>1&&(P=e[++S]);const k=Math.abs(E-P.left),R=Math.abs(E-P.right),L=Math.min(k,R);let N;const V=g/u*(h+1);if(P.isDash){const J=h-Math.abs(V);N=Math.sqrt(L*L+J*J)}else N=h-Math.sqrt(L*L+V*V);this.data[v+E]=Math.max(0,Math.min(255,N+128))}}}addRegularDash(e){for(let S=e.length-1;S>=0;--S){const P=e[S],E=e[S+1];P.zeroLength?e.splice(S,1):E&&E.isDash===P.isDash&&(E.left=P.left,e.splice(S,1))}const i=e[0],u=e[e.length-1];i.isDash===u.isDash&&(i.left=u.left-this.width,u.right=i.right+this.width);const h=this.width*this.nextRow;let g=0,v=e[g];for(let S=0;S<this.width;S++){S/v.right>1&&(v=e[++g]);const P=Math.abs(S-v.left),E=Math.abs(S-v.right),k=Math.min(P,E);this.data[h+S]=Math.max(0,Math.min(255,(v.isDash?k:-k)+128))}}addDash(e,i){const u=i?7:0,h=2*u+1;if(this.nextRow+h>this.height)return c.w("LineAtlas out of space"),null;let g=0;for(let S=0;S<e.length;S++)g+=e[S];if(g!==0){const S=this.width/g,P=this.getDashRanges(e,this.width,S);i?this.addRoundDash(P,S,u):this.addRegularDash(P)}const v={y:(this.nextRow+u+.5)/this.height,height:2*u/this.height,width:g};return this.nextRow+=h,this.dirty=!0,v}bind(e){const i=e.gl;this.texture?(i.bindTexture(i.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,i.texSubImage2D(i.TEXTURE_2D,0,0,0,this.width,this.height,i.ALPHA,i.UNSIGNED_BYTE,this.data))):(this.texture=i.createTexture(),i.bindTexture(i.TEXTURE_2D,this.texture),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.REPEAT),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.REPEAT),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texImage2D(i.TEXTURE_2D,0,i.ALPHA,this.width,this.height,0,i.ALPHA,i.UNSIGNED_BYTE,this.data))}}const Lt="maplibre_preloaded_worker_pool";class Nt{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<Nt.workerCount;)this.workers.push(new Worker(c.a.WORKER_URL));return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],this.numActive()===0&&(this.workers.forEach(i=>{i.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Lt]}numActive(){return Object.keys(this.active).length}}const Xr=Math.floor(H.hardwareConcurrency/2);let wr,fr;function ln(){return wr||(wr=new Nt),wr}Nt.workerCount=c.G(globalThis)?Math.max(Math.min(Xr,3),1):1;class zn{constructor(e,i){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=i;const u=this.workerPool.acquire(i);for(let h=0;h<u.length;h++){const g=new c.H(u[h],i);g.name=`Worker ${h}`,this.actors.push(g)}if(!this.actors.length)throw new Error("No actors found")}broadcast(e,i){const u=[];for(const h of this.actors)u.push(h.sendAsync({type:e,data:i}));return Promise.all(u)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(e=!0){this.actors.forEach(i=>{i.remove()}),this.actors=[],e&&this.workerPool.release(this.id)}registerMessageHandler(e,i){for(const u of this.actors)u.registerMessageHandler(e,i)}}function so(){return fr||(fr=new zn(ln(),c.J),fr.registerMessageHandler("GR",(f,e,i)=>c.m(e,i))),fr}function Pn(f,e){const i=c.K();return c.L(i,i,[1,1,0]),c.M(i,i,[.5*f.width,.5*f.height,1]),f.calculatePosMatrix?c.N(i,i,f.calculatePosMatrix(e.toUnwrapped())):i}function es(f,e,i,u,h,g){var v;const S=function(R,L,N){if(R)for(const V of R){const J=L[V];if(J&&J.source===N&&J.type==="fill-extrusion")return!0}else for(const V in L){const J=L[V];if(J.source===N&&J.type==="fill-extrusion")return!0}return!1}((v=h==null?void 0:h.layers)!==null&&v!==void 0?v:null,e,f.id),P=g.maxPitchScaleFactor(),E=f.tilesIn(u,P,S);E.sort(Kr);const k=[];for(const R of E)k.push({wrappedTileID:R.tileID.wrapped().key,queryResults:R.tile.queryRenderedFeatures(e,i,f._state,R.queryGeometry,R.cameraQueryGeometry,R.scale,h,g,P,Pn(f.transform,R.tileID))});return function(R,L){for(const N in R)for(const V of R[N])Cr(V,L);return R}(function(R){const L={},N={};for(const V of R){const J=V.queryResults,K=V.wrappedTileID,te=N[K]=N[K]||{};for(const oe in J){const ue=J[oe],he=te[oe]=te[oe]||{},pe=L[oe]=L[oe]||[];for(const ge of ue)he[ge.featureIndex]||(he[ge.featureIndex]=!0,pe.push(ge))}}return L}(k),f)}function Kr(f,e){const i=f.tileID,u=e.tileID;return i.overscaledZ-u.overscaledZ||i.canonical.y-u.canonical.y||i.wrap-u.wrap||i.canonical.x-u.canonical.x}function Cr(f,e){const i=f.feature,u=e.getFeatureState(i.layer["source-layer"],i.id);i.source=i.layer.source,i.layer["source-layer"]&&(i.sourceLayer=i.layer["source-layer"]),i.state=u}function xi(f,e,i){return c._(this,void 0,void 0,function*(){let u=f;if(f.url?u=(yield c.j(e.transformRequest(f.url,"Source"),i)).data:yield H.frameAsync(i),!u)return null;const h=c.O(c.e(u,f),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in u&&u.vector_layers&&(h.vectorLayerIds=u.vector_layers.map(g=>g.id)),h})}class or{constructor(e,i){e&&(i?this.setSouthWest(e).setNorthEast(i):Array.isArray(e)&&(e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1])))}setNorthEast(e){return this._ne=e instanceof c.Q?new c.Q(e.lng,e.lat):c.Q.convert(e),this}setSouthWest(e){return this._sw=e instanceof c.Q?new c.Q(e.lng,e.lat):c.Q.convert(e),this}extend(e){const i=this._sw,u=this._ne;let h,g;if(e instanceof c.Q)h=e,g=e;else{if(!(e instanceof or))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(or.convert(e)):this.extend(c.Q.convert(e)):e&&("lng"in e||"lon"in e)&&"lat"in e?this.extend(c.Q.convert(e)):this;if(h=e._sw,g=e._ne,!h||!g)return this}return i||u?(i.lng=Math.min(h.lng,i.lng),i.lat=Math.min(h.lat,i.lat),u.lng=Math.max(g.lng,u.lng),u.lat=Math.max(g.lat,u.lat)):(this._sw=new c.Q(h.lng,h.lat),this._ne=new c.Q(g.lng,g.lat)),this}getCenter(){return new c.Q((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new c.Q(this.getWest(),this.getNorth())}getSouthEast(){return new c.Q(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:i,lat:u}=c.Q.convert(e);let h=this._sw.lng<=i&&i<=this._ne.lng;return this._sw.lng>this._ne.lng&&(h=this._sw.lng>=i&&i>=this._ne.lng),this._sw.lat<=u&&u<=this._ne.lat&&h}static convert(e){return e instanceof or?e:e&&new or(e)}static fromLngLat(e,i=0){const u=360*i/40075017,h=u/Math.cos(Math.PI/180*e.lat);return new or(new c.Q(e.lng-h,e.lat-u),new c.Q(e.lng+h,e.lat+u))}adjustAntiMeridian(){const e=new c.Q(this._sw.lng,this._sw.lat),i=new c.Q(this._ne.lng,this._ne.lat);return new or(e,e.lng>i.lng?new c.Q(i.lng+360,i.lat):i)}}class ao{constructor(e,i,u){this.bounds=or.convert(this.validateBounds(e)),this.minzoom=i||0,this.maxzoom=u||24}validateBounds(e){return Array.isArray(e)&&e.length===4?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]}contains(e){const i=Math.pow(2,e.z),u=Math.floor(c.U(this.bounds.getWest())*i),h=Math.floor(c.S(this.bounds.getNorth())*i),g=Math.ceil(c.U(this.bounds.getEast())*i),v=Math.ceil(c.S(this.bounds.getSouth())*i);return e.x>=u&&e.x<g&&e.y>=h&&e.y<v}}class lo extends c.E{constructor(e,i,u,h){if(super(),this.id=e,this.dispatcher=u,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,c.e(this,c.O(i,["url","scheme","tileSize","promoteId"])),this._options=c.e({type:"vector"},i),this._collectResourceTiming=i.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(h)}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const e=yield xi(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),e&&(c.e(this,e),e.bounds&&(this.tileBounds=new ao(e.bounds,this.minzoom,this.maxzoom)),this.fire(new c.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.l("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this.fire(new c.k(e))}})}loaded(){return this._loaded}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}onAdd(e){this.map=e,this.load()}setSourceProperty(e){this._tileJSONRequest&&this._tileJSONRequest.abort(),e(),this.load()}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return c.e({},this._options)}loadTile(e){return c._(this,void 0,void 0,function*(){const i=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),u={request:this.map._requestManager.transformRequest(i,"Tile"),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};u.request.collectResourceTiming=this._collectResourceTiming;let h="RT";if(e.actor&&e.state!=="expired"){if(e.state==="loading")return new Promise((g,v)=>{e.reloadPromise={resolve:g,reject:v}})}else e.actor=this.dispatcher.getActor(),h="LT";e.abortController=new AbortController;try{const g=yield e.actor.sendAsync({type:h,data:u},e.abortController);if(delete e.abortController,e.aborted)return;this._afterTileLoadWorkerResponse(e,g)}catch(g){if(delete e.abortController,e.aborted)return;if(g&&g.status!==404)throw g;this._afterTileLoadWorkerResponse(e,null)}})}_afterTileLoadWorkerResponse(e,i){if(i&&i.resourceTiming&&(e.resourceTiming=i.resourceTiming),i&&this.map._refreshExpiredTiles&&e.setExpiryData(i),e.loadVectorData(i,this.map.painter),e.reloadPromise){const u=e.reloadPromise;e.reloadPromise=null,this.loadTile(e).then(u.resolve).catch(u.reject)}}abortTile(e){return c._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.actor&&(yield e.actor.sendAsync({type:"AT",data:{uid:e.uid,type:this.type,source:this.id}}))})}unloadTile(e){return c._(this,void 0,void 0,function*(){e.unloadVectorData(),e.actor&&(yield e.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class gn extends c.E{constructor(e,i,u,h){super(),this.id=e,this.dispatcher=u,this.setEventedParent(h),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=c.e({type:"raster"},i),c.e(this,c.O(i,["url","scheme","tileSize"]))}load(){return c._(this,arguments,void 0,function*(e=!1){this._loaded=!1,this.fire(new c.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const i=yield xi(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,i&&(c.e(this,i),i.bounds&&(this.tileBounds=new ao(i.bounds,this.minzoom,this.maxzoom)),this.fire(new c.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:e})))}catch(i){this._tileJSONRequest=null,this.fire(new c.k(i))}})}loaded(){return this._loaded}onAdd(e){this.map=e,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(e){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),e(),this.load(!0)}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}serialize(){return c.e({},this._options)}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(e){return c._(this,void 0,void 0,function*(){const i=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);e.abortController=new AbortController;try{const u=yield _e.getImage(this.map._requestManager.transformRequest(i,"Tile"),e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(u&&u.data){this.map._refreshExpiredTiles&&u.cacheControl&&u.expires&&e.setExpiryData({cacheControl:u.cacheControl,expires:u.expires});const h=this.map.painter.context,g=h.gl,v=u.data;e.texture=this.map.painter.getTileTexture(v.width),e.texture?e.texture.update(v,{useMipmap:!0}):(e.texture=new We(h,v,g.RGBA,{useMipmap:!0}),e.texture.bind(g.LINEAR,g.CLAMP_TO_EDGE,g.LINEAR_MIPMAP_NEAREST)),e.state="loaded"}}catch(u){if(delete e.abortController,e.aborted)e.state="unloaded";else if(u)throw e.state="errored",u}})}abortTile(e){return c._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController)})}unloadTile(e){return c._(this,void 0,void 0,function*(){e.texture&&this.map.painter.saveTileTexture(e.texture)})}hasTransition(){return!1}}class Rn extends gn{constructor(e,i,u,h){super(e,i,u,h),this.type="raster-dem",this.maxzoom=22,this._options=c.e({type:"raster-dem"},i),this.encoding=i.encoding||"mapbox",this.redFactor=i.redFactor,this.greenFactor=i.greenFactor,this.blueFactor=i.blueFactor,this.baseShift=i.baseShift}loadTile(e){return c._(this,void 0,void 0,function*(){const i=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),u=this.map._requestManager.transformRequest(i,"Tile");e.neighboringTiles=this._getNeighboringTiles(e.tileID),e.abortController=new AbortController;try{const h=yield _e.getImage(u,e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(h&&h.data){const g=h.data;this.map._refreshExpiredTiles&&h.cacheControl&&h.expires&&e.setExpiryData({cacheControl:h.cacheControl,expires:h.expires});const v=c.b(g)&&c.V()?g:yield this.readImageNow(g),S={type:this.type,uid:e.uid,source:this.id,rawImageData:v,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!e.actor||e.state==="expired"){e.actor=this.dispatcher.getActor();const P=yield e.actor.sendAsync({type:"LDT",data:S});e.dem=P,e.needsHillshadePrepare=!0,e.needsTerrainPrepare=!0,e.state="loaded"}}}catch(h){if(delete e.abortController,e.aborted)e.state="unloaded";else if(h)throw e.state="errored",h}})}readImageNow(e){return c._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&c.W()){const i=e.width+2,u=e.height+2;try{return new c.R({width:i,height:u},yield c.X(e,-1,-1,i,u))}catch{}}return H.getImageData(e,1)})}_getNeighboringTiles(e){const i=e.canonical,u=Math.pow(2,i.z),h=(i.x-1+u)%u,g=i.x===0?e.wrap-1:e.wrap,v=(i.x+1+u)%u,S=i.x+1===u?e.wrap+1:e.wrap,P={};return P[new c.Y(e.overscaledZ,g,i.z,h,i.y).key]={backfilled:!1},P[new c.Y(e.overscaledZ,S,i.z,v,i.y).key]={backfilled:!1},i.y>0&&(P[new c.Y(e.overscaledZ,g,i.z,h,i.y-1).key]={backfilled:!1},P[new c.Y(e.overscaledZ,e.wrap,i.z,i.x,i.y-1).key]={backfilled:!1},P[new c.Y(e.overscaledZ,S,i.z,v,i.y-1).key]={backfilled:!1}),i.y+1<u&&(P[new c.Y(e.overscaledZ,g,i.z,h,i.y+1).key]={backfilled:!1},P[new c.Y(e.overscaledZ,e.wrap,i.z,i.x,i.y+1).key]={backfilled:!1},P[new c.Y(e.overscaledZ,S,i.z,v,i.y+1).key]={backfilled:!1}),P}unloadTile(e){return c._(this,void 0,void 0,function*(){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded",e.actor&&(yield e.actor.sendAsync({type:"RDT",data:{type:this.type,uid:e.uid,source:this.id}}))})}}class Vi extends c.E{constructor(e,i,u,h){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=u.getActor(),this.setEventedParent(h),this._data=i.data,this._options=c.e({},i),this._collectResourceTiming=i.collectResourceTiming,i.maxzoom!==void 0&&(this.maxzoom=i.maxzoom),i.type&&(this.type=i.type),i.attribution&&(this.attribution=i.attribution),this.promoteId=i.promoteId,i.clusterMaxZoom!==void 0&&this.maxzoom<=i.clusterMaxZoom&&c.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${i.clusterMaxZoom}".`),this.workerOptions=c.e({source:this.id,cluster:i.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(i.buffer!==void 0?i.buffer:128),tolerance:this._pixelsToTileUnits(i.tolerance!==void 0?i.tolerance:.375),extent:c.Z,maxZoom:this.maxzoom,lineMetrics:i.lineMetrics||!1,generateId:i.generateId||!1},superclusterOptions:{maxZoom:i.clusterMaxZoom!==void 0?i.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,i.clusterMinPoints||2),extent:c.Z,radius:this._pixelsToTileUnits(i.clusterRadius||50),log:!1,generateId:i.generateId||!1},clusterProperties:i.clusterProperties,filter:i.filter},i.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_pixelsToTileUnits(e){return e*(c.Z/this.tileSize)}load(){return c._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(e){this.map=e,this.load()}setData(e){return this._data=e,this._updateWorkerData(),this}updateData(e){return this._updateWorkerData(e),this}getData(){return c._(this,void 0,void 0,function*(){const e=c.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:e})})}setClusterOptions(e){return this.workerOptions.cluster=e.cluster,e&&(e.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(e.clusterRadius)),e.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=e.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(e){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:e,source:this.id}})}getClusterChildren(e){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:e,source:this.id}})}getClusterLeaves(e,i,u){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:e,limit:i,offset:u}})}_updateWorkerData(e){return c._(this,void 0,void 0,function*(){const i=c.e({type:this.type},this.workerOptions);e?i.dataDiff=e:typeof this._data=="string"?(i.request=this.map._requestManager.transformRequest(H.resolveURL(this._data),"Source"),i.request.collectResourceTiming=this._collectResourceTiming):i.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new c.l("dataloading",{dataType:"source"}));try{const u=yield this.actor.sendAsync({type:"LD",data:i});if(this._pendingLoads--,this._removed||u.abandoned)return void this.fire(new c.l("dataabort",{dataType:"source"}));let h=null;u.resourceTiming&&u.resourceTiming[this.id]&&(h=u.resourceTiming[this.id].slice(0));const g={dataType:"source"};this._collectResourceTiming&&h&&h.length>0&&c.e(g,{resourceTiming:h}),this.fire(new c.l("data",Object.assign(Object.assign({},g),{sourceDataType:"metadata"}))),this.fire(new c.l("data",Object.assign(Object.assign({},g),{sourceDataType:"content"})))}catch(u){if(this._pendingLoads--,this._removed)return void this.fire(new c.l("dataabort",{dataType:"source"}));this.fire(new c.k(u))}})}loaded(){return this._pendingLoads===0}loadTile(e){return c._(this,void 0,void 0,function*(){const i=e.actor?"RT":"LT";e.actor=this.actor;const u={type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};e.abortController=new AbortController;const h=yield this.actor.sendAsync({type:i,data:u},e.abortController);delete e.abortController,e.unloadVectorData(),e.aborted||e.loadVectorData(h,this.map.painter,i==="RT")})}abortTile(e){return c._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.aborted=!0})}unloadTile(e){return c._(this,void 0,void 0,function*(){e.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return c.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class Gn extends c.E{constructor(e,i,u,h){super(),this.flippedWindingOrder=!1,this.id=e,this.dispatcher=u,this.coordinates=i.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(h),this.options=i}load(e){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const i=yield _e.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,i&&i.data&&(this.image=i.data,e&&(this.coordinates=e),this._finishLoading())}catch(i){this._request=null,this._loaded=!0,this.fire(new c.k(i))}})}loaded(){return this._loaded}updateImage(e){return e.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=e.url,this.load(e.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new c.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(e){this.coordinates=e;const i=e.map(c.$.fromLngLat);var u;return this.tileID=function(h){let g=1/0,v=1/0,S=-1/0,P=-1/0;for(const L of h)g=Math.min(g,L.x),v=Math.min(v,L.y),S=Math.max(S,L.x),P=Math.max(P,L.y);const E=Math.max(S-g,P-v),k=Math.max(0,Math.floor(-Math.log(E)/Math.LN2)),R=Math.pow(2,k);return new c.a0(k,Math.floor((g+S)/2*R),Math.floor((v+P)/2*R))}(i),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=i.map(h=>this.tileID.getTilePoint(h)._round()),this.flippedWindingOrder=((u=this.tileCoords)[1].x-u[0].x)*(u[2].y-u[0].y)-(u[1].y-u[0].y)*(u[2].x-u[0].x)<0,this.fire(new c.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const e=this.map.painter.context,i=e.gl;this.texture||(this.texture=new We(e,this.image,i.RGBA),this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE));let u=!1;for(const h in this.tiles){const g=this.tiles[h];g.state!=="loaded"&&(g.state="loaded",g.texture=this.texture,u=!0)}u&&this.fire(new c.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(e){return c._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={}):e.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class qn extends Gn{constructor(e,i,u,h){super(e,i,u,h),this.roundZoom=!0,this.type="video",this.options=i}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1;const e=this.options;this.urls=[];for(const i of e.urls)this.urls.push(this.map._requestManager.transformRequest(i,"Source").url);try{const i=yield c.a1(this.urls);if(this._loaded=!0,!i)return;this.video=i,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(i){this.fire(new c.k(i))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){if(this.video){const i=this.video.seekable;e<i.start(0)||e>i.end(0)?this.fire(new c.k(new c.a2(`sources.${this.id}`,null,`Playback for this video can be set only between the ${i.start(0)} and ${i.end(0)}-second mark.`))):this.video.currentTime=e}}getVideo(){return this.video}onAdd(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const e=this.map.painter.context,i=e.gl;this.texture?this.video.paused||(this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE),i.texSubImage2D(i.TEXTURE_2D,0,0,0,i.RGBA,i.UNSIGNED_BYTE,this.video)):(this.texture=new We(e,this.video,i.RGBA),this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE));let u=!1;for(const h in this.tiles){const g=this.tiles[h];g.state!=="loaded"&&(g.state="loaded",g.texture=this.texture,u=!0)}u&&this.fire(new c.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Et extends Gn{constructor(e,i,u,h){super(e,i,u,h),i.coordinates?Array.isArray(i.coordinates)&&i.coordinates.length===4&&!i.coordinates.some(g=>!Array.isArray(g)||g.length!==2||g.some(v=>typeof v!="number"))||this.fire(new c.k(new c.a2(`sources.${e}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new c.k(new c.a2(`sources.${e}`,null,'missing required property "coordinates"'))),i.animate&&typeof i.animate!="boolean"&&this.fire(new c.k(new c.a2(`sources.${e}`,null,'optional "animate" property must be a boolean value'))),i.canvas?typeof i.canvas=="string"||i.canvas instanceof HTMLCanvasElement||this.fire(new c.k(new c.a2(`sources.${e}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new c.k(new c.a2(`sources.${e}`,null,'missing required property "canvas"'))),this.options=i,this.animate=i.animate===void 0||i.animate}load(){return c._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new c.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const i=this.map.painter.context,u=i.gl;this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new We(i,this.canvas,u.RGBA,{premultiply:!0});let h=!1;for(const g in this.tiles){const v=this.tiles[g];v.state!=="loaded"&&(v.state="loaded",v.texture=this.texture,h=!0)}h&&this.fire(new c.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const e of[this.canvas.width,this.canvas.height])if(isNaN(e)||e<=0)return!0;return!1}}const ts={},rs=f=>{switch(f){case"geojson":return Vi;case"image":return Gn;case"raster":return gn;case"raster-dem":return Rn;case"vector":return lo;case"video":return qn;case"canvas":return Et}return ts[f]},Vs="RTLPluginLoaded";class ns extends c.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=so()}_syncState(e){return this.status=e,this.dispatcher.broadcast("SRPS",{pluginStatus:e,pluginURL:this.url}).catch(i=>{throw this.status="error",i})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(e){return c._(this,arguments,void 0,function*(i,u=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=H.resolveURL(i),!this.url)throw new Error(`requested url ${i} is invalid`);if(this.status==="unavailable"){if(!u)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return c._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new c.l(Vs))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let co=null;function uo(){return co||(co=new ns),co}class Io{constructor(e,i){this.timeAdded=0,this.fadeEndTime=0,this.tileID=e,this.uid=c.a3(),this.uses=0,this.tileSize=i,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(e){const i=e+this.timeAdded;i<this.fadeEndTime||(this.fadeEndTime=i)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(e){this.demTexture&&e.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(e,i,u){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(h,g){const v={};if(!g)return v;for(const S of h){const P=S.layerIds.map(E=>g.getLayer(E)).filter(Boolean);if(P.length!==0){S.layers=P,S.stateDependentLayerIds&&(S.stateDependentLayers=S.stateDependentLayerIds.map(E=>P.filter(k=>k.id===E)[0]));for(const E of P)v[E.id]=S}}return v}(e.buckets,i==null?void 0:i.style),this.hasSymbolBuckets=!1;for(const h in this.buckets){const g=this.buckets[h];if(g instanceof c.a5){if(this.hasSymbolBuckets=!0,!u)break;g.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const h in this.buckets){const g=this.buckets[h];if(g instanceof c.a5&&g.hasRTLText){this.hasRTLText=!0,uo().lazyLoad();break}}this.queryPadding=0;for(const h in this.buckets){const g=this.buckets[h];this.queryPadding=Math.max(this.queryPadding,i.style.getLayer(h).queryRadius(g))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new c.a4}unloadVectorData(){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(e){return this.buckets[e.id]}upload(e){for(const u in this.buckets){const h=this.buckets[u];h.uploadPending()&&h.upload(e)}const i=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new We(e,this.imageAtlas.image,i.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new We(e,this.glyphAtlasImage,i.ALPHA),this.glyphAtlasImage=null)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,i,u,h,g,v,S,P,E,k){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:h,cameraQueryGeometry:g,scale:v,tileSize:this.tileSize,pixelPosMatrix:k,transform:P,params:S,queryPadding:this.queryPadding*E},e,i,u):{}}querySourceFeatures(e,i){const u=this.latestFeatureIndex;if(!u||!u.rawTileData)return;const h=u.loadVTLayers(),g=i&&i.sourceLayer?i.sourceLayer:"",v=h._geojsonTileLayer||h[g];if(!v)return;const S=c.a6(i&&i.filter),{z:P,x:E,y:k}=this.tileID.canonical,R={z:P,x:E,y:k};for(let L=0;L<v.length;L++){const N=v.feature(L);if(S.needGeometry){const K=c.a7(N,!0);if(!S.filter(new c.C(this.tileID.overscaledZ),K,this.tileID.canonical))continue}else if(!S.filter(new c.C(this.tileID.overscaledZ),N))continue;const V=u.getId(N,g),J=new c.a8(N,P,E,k,V);J.tile=R,e.push(J)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const i=this.expirationTime;if(e.cacheControl){const u=c.a9(e.cacheControl);u["max-age"]&&(this.expirationTime=Date.now()+1e3*u["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const u=Date.now();let h=!1;if(this.expirationTime>u)h=!1;else if(i)if(this.expirationTime<i)h=!0;else{const g=this.expirationTime-i;g?this.expirationTime=u+Math.max(g,3e4):h=!0}else h=!0;h?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,i){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0)return;const u=this.latestFeatureIndex.loadVTLayers();for(const h in this.buckets){if(!i.style.hasLayer(h))continue;const g=this.buckets[h],v=g.layers[0].sourceLayer||"_geojsonTileLayer",S=u[v],P=e[v];if(!S||!P||Object.keys(P).length===0)continue;g.update(P,S,this.imageAtlas&&this.imageAtlas.patternPositions||{});const E=i&&i.style&&i.style.getLayer(h);E&&(this.queryPadding=Math.max(this.queryPadding,E.queryRadius(g)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<H.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=H.now()+e}setDependencies(e,i){const u={};for(const h of i)u[h]=!0;this.dependencies[e]=u}hasDependency(e,i){for(const u of e){const h=this.dependencies[u];if(h){for(const g of i)if(h[g])return!0}}return!1}}class ko{constructor(e,i){this.max=e,this.onRemove=i,this.reset()}reset(){for(const e in this.data)for(const i of this.data[e])i.timeout&&clearTimeout(i.timeout),this.onRemove(i.value);return this.data={},this.order=[],this}add(e,i,u){const h=e.wrapped().key;this.data[h]===void 0&&(this.data[h]=[]);const g={value:i,timeout:void 0};if(u!==void 0&&(g.timeout=setTimeout(()=>{this.remove(e,g)},u)),this.data[h].push(g),this.order.push(h),this.order.length>this.max){const v=this._getAndRemoveByKey(this.order[0]);v&&this.onRemove(v)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const i=this.data[e].shift();return i.timeout&&clearTimeout(i.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),i.value}getByKey(e){const i=this.data[e];return i?i[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,i){if(!this.has(e))return this;const u=e.wrapped().key,h=i===void 0?0:this.data[u].indexOf(i),g=this.data[u][h];return this.data[u].splice(h,1),g.timeout&&clearTimeout(g.timeout),this.data[u].length===0&&delete this.data[u],this.onRemove(g.value),this.order.splice(this.order.indexOf(u),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const i=this._getAndRemoveByKey(this.order[0]);i&&this.onRemove(i)}return this}filter(e){const i=[];for(const u in this.data)for(const h of this.data[u])e(h.value)||i.push(h);for(const u of i)this.remove(u.value.tileID,u)}}class Oa{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,i,u){const h=String(i);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][h]=this.stateChanges[e][h]||{},c.e(this.stateChanges[e][h],u),this.deletedStates[e]===null){this.deletedStates[e]={};for(const g in this.state[e])g!==h&&(this.deletedStates[e][g]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][h]===null){this.deletedStates[e][h]={};for(const g in this.state[e][h])u[g]||(this.deletedStates[e][h][g]=null)}else for(const g in u)this.deletedStates[e]&&this.deletedStates[e][h]&&this.deletedStates[e][h][g]===null&&delete this.deletedStates[e][h][g]}removeFeatureState(e,i,u){if(this.deletedStates[e]===null)return;const h=String(i);if(this.deletedStates[e]=this.deletedStates[e]||{},u&&i!==void 0)this.deletedStates[e][h]!==null&&(this.deletedStates[e][h]=this.deletedStates[e][h]||{},this.deletedStates[e][h][u]=null);else if(i!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][h])for(u in this.deletedStates[e][h]={},this.stateChanges[e][h])this.deletedStates[e][h][u]=null;else this.deletedStates[e][h]=null;else this.deletedStates[e]=null}getState(e,i){const u=String(i),h=c.e({},(this.state[e]||{})[u],(this.stateChanges[e]||{})[u]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){const g=this.deletedStates[e][i];if(g===null)return{};for(const v in g)delete h[v]}return h}initializeTileState(e,i){e.setFeatureState(this.state,i)}coalesceChanges(e,i){const u={};for(const h in this.stateChanges){this.state[h]=this.state[h]||{};const g={};for(const v in this.stateChanges[h])this.state[h][v]||(this.state[h][v]={}),c.e(this.state[h][v],this.stateChanges[h][v]),g[v]=this.state[h][v];u[h]=g}for(const h in this.deletedStates){this.state[h]=this.state[h]||{};const g={};if(this.deletedStates[h]===null)for(const v in this.state[h])g[v]={},this.state[h][v]={};else for(const v in this.deletedStates[h]){if(this.deletedStates[h][v]===null)this.state[h][v]={};else for(const S of Object.keys(this.deletedStates[h][v]))delete this.state[h][v][S];g[v]=this.state[h][v]}u[h]=u[h]||{},c.e(u[h],g)}if(this.stateChanges={},this.deletedStates={},Object.keys(u).length!==0)for(const h in e)e[h].setFeatureState(u,i)}}function Us(f,e,i){const u=e.intersectsFrustum(f);if(!i)return u;const h=e.intersectsPlane(i);return u===0||h===0?0:u===2&&h===2?2:1}function ja(f,e,i,u,h){let g=f;const v=Math.atan(e/i),S=Math.hypot(e,i);return g=f+c.aa(u/S/Math.max(.5,Math.cos(c.ac(h/2)))),g+=1*c.aa(Math.cos(v))/2,g+=c.ad(f-g,-0,0),g}function ho(f,e){const i=(e.roundZoom?Math.round:Math.floor)(f.zoom+c.aa(f.tileSize/e.tileSize));return Math.max(0,i)}function be(f,e){const i=f.getCameraFrustum(),u=f.getClippingPlane(),h=f.screenPointToMercatorCoordinate(f.getCameraPoint()),g=c.$.fromLngLat(f.center,f.elevation);h.z=g.z+Math.cos(f.pitchInRadians)*f.cameraToCenterDistance/f.worldSize;const v=f.getCoveringTilesDetailsProvider(),S=v.allowVariableZoom(f,e),P=ho(f,e),E=e.minzoom||0,k=e.maxzoom!==void 0?e.maxzoom:f.maxZoom,R=Math.min(Math.max(0,P),k),L=Math.pow(2,R),N=[L*h.x,L*h.y,0],V=[L*g.x,L*g.y,0],J=Math.hypot(g.x-h.x,g.y-h.y),K=Math.abs(g.z-h.z),te=Math.hypot(J,K),oe=pe=>({zoom:0,x:0,y:0,wrap:pe,fullyVisible:!1}),ue=[],he=[];if(f.renderWorldCopies&&v.allowWorldCopies())for(let pe=1;pe<=3;pe++)ue.push(oe(-pe)),ue.push(oe(pe));for(ue.push(oe(0));ue.length>0;){const pe=ue.pop(),ge=pe.x,fe=pe.y;let Pe=pe.fullyVisible;const Ee={x:ge,y:fe,z:pe.zoom},Be=v.getTileAABB(Ee,pe.wrap,f.elevation,e);if(!Pe){const Ke=Us(i,Be,u);if(Ke===0)continue;Pe=Ke===2}const je=v.distanceToTile2d(h.x,h.y,Ee,Be);let Le=P;S&&(Le=(e.calculateTileZoom||ja)(f.zoom+c.aa(f.tileSize/e.tileSize),je,K,te,f.fov)),Le=(e.roundZoom?Math.round:Math.floor)(Le),Le=Math.max(0,Le);const Qe=Math.min(Le,k);if(pe.wrap=v.getWrap(g,Ee,pe.wrap),pe.zoom>=Qe){if(pe.zoom<E)continue;const Ke=R-pe.zoom,Ge=N[0]-.5-(ge<<Ke),lt=N[1]-.5-(fe<<Ke),mt=e.reparseOverscaled?Math.max(pe.zoom,Le):pe.zoom;he.push({tileID:new c.Y(pe.zoom===k?mt:pe.zoom,pe.wrap,pe.zoom,ge,fe),distanceSq:c.ab([V[0]-.5-ge,V[1]-.5-fe]),tileDistanceToCamera:Math.sqrt(Ge*Ge+lt*lt)})}else for(let Ke=0;Ke<4;Ke++)ue.push({zoom:pe.zoom+1,x:(ge<<1)+Ke%2,y:(fe<<1)+(Ke>>1),wrap:pe.wrap,fullyVisible:Pe})}return he.sort((pe,ge)=>pe.distanceSq-ge.distanceSq).map(pe=>pe.tileID)}class z extends c.E{constructor(e,i,u){super(),this.id=e,this.dispatcher=u,this.on("data",h=>this._dataHandler(h)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((h,g,v,S)=>{const P=new(rs(g.type))(h,g,v,S);if(P.id!==h)throw new Error(`Expected Source id to be ${h} instead of ${P.id}`);return P})(e,i,u,this),this._tiles={},this._cache=new ko(0,h=>this._unloadTile(h)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Oa,this._didEmitContent=!1,this._updated=!1}onAdd(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null,this._maxTileCacheZoomLevels=e?e._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(e)}onRemove(e){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(e)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const e in this._tiles){const i=this._tiles[e];if(i.state!=="loaded"&&i.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(e,i,u){return c._(this,void 0,void 0,function*(){try{yield this._source.loadTile(e),this._tileLoaded(e,i,u)}catch(h){e.state="errored",h.status!==404?this._source.fire(new c.k(h,{tile:e})):this.update(this.transform,this.terrain)}})}_unloadTile(e){this._source.unloadTile&&this._source.unloadTile(e)}_abortTile(e){this._source.abortTile&&this._source.abortTile(e),this._source.fire(new c.l("dataabort",{tile:e,coord:e.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const i in this._tiles){const u=this._tiles[i];u.upload(e),u.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(e=>e.tileID).sort(U).map(e=>e.key)}getRenderableIds(e){const i=[];for(const u in this._tiles)this._isIdRenderable(u,e)&&i.push(this._tiles[u]);return e?i.sort((u,h)=>{const g=u.tileID,v=h.tileID,S=new c.P(g.canonical.x,g.canonical.y)._rotate(-this.transform.bearingInRadians),P=new c.P(v.canonical.x,v.canonical.y)._rotate(-this.transform.bearingInRadians);return g.overscaledZ-v.overscaledZ||P.y-S.y||P.x-S.x}).map(u=>u.tileID.key):i.map(u=>u.tileID).sort(U).map(u=>u.key)}hasRenderableParent(e){const i=this.findLoadedParent(e,0);return!!i&&this._isIdRenderable(i.tileID.key)}_isIdRenderable(e,i){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(i||!this._tiles[e].holdingForFade())}reload(e){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const i in this._tiles)(e||this._tiles[i].state!=="errored")&&this._reloadTile(i,"reloading")}}_reloadTile(e,i){return c._(this,void 0,void 0,function*(){const u=this._tiles[e];u&&(u.state!=="loading"&&(u.state=i),yield this._loadTile(u,e,i))})}_tileLoaded(e,i,u){e.timeAdded=H.now(),u==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(i,e),this.getSource().type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),e.aborted||this._source.fire(new c.l("data",{dataType:"source",tile:e,coord:e.tileID}))}_backfillDEM(e){const i=this.getRenderableIds();for(let h=0;h<i.length;h++){const g=i[h];if(e.neighboringTiles&&e.neighboringTiles[g]){const v=this.getTileByID(g);u(e,v),u(v,e)}}function u(h,g){h.needsHillshadePrepare=!0,h.needsTerrainPrepare=!0;let v=g.tileID.canonical.x-h.tileID.canonical.x;const S=g.tileID.canonical.y-h.tileID.canonical.y,P=Math.pow(2,h.tileID.canonical.z),E=g.tileID.key;v===0&&S===0||Math.abs(S)>1||(Math.abs(v)>1&&(Math.abs(v+P)===1?v+=P:Math.abs(v-P)===1&&(v-=P)),g.dem&&h.dem&&(h.dem.backfillBorder(g.dem,v,S),h.neighboringTiles&&h.neighboringTiles[E]&&(h.neighboringTiles[E].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,i,u,h){for(const g in this._tiles){let v=this._tiles[g];if(h[g]||!v.hasData()||v.tileID.overscaledZ<=i||v.tileID.overscaledZ>u)continue;let S=v.tileID;for(;v&&v.tileID.overscaledZ>i+1;){const E=v.tileID.scaledTo(v.tileID.overscaledZ-1);v=this._tiles[E.key],v&&v.hasData()&&(S=E)}let P=S;for(;P.overscaledZ>i;)if(P=P.scaledTo(P.overscaledZ-1),e[P.key]||e[P.canonical.key]){h[S.key]=S;break}}}findLoadedParent(e,i){if(e.key in this._loadedParentTiles){const u=this._loadedParentTiles[e.key];return u&&u.tileID.overscaledZ>=i?u:null}for(let u=e.overscaledZ-1;u>=i;u--){const h=e.scaledTo(u),g=this._getLoadedTile(h);if(g)return g}}findLoadedSibling(e){return this._getLoadedTile(e)}_getLoadedTile(e){const i=this._tiles[e.key];return i&&i.hasData()?i:this._cache.getByKey(e.wrapped().key)}updateCacheSize(e){const i=Math.ceil(e.width/this._source.tileSize)+1,u=Math.ceil(e.height/this._source.tileSize)+1,h=Math.floor(i*u*(this._maxTileCacheZoomLevels===null?c.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),g=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,h):h;this._cache.setMaxSize(g)}handleWrapJump(e){const i=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,i){const u={};for(const h in this._tiles){const g=this._tiles[h];g.tileID=g.tileID.unwrapTo(g.tileID.wrap+i),u[g.tileID.key]=g}this._tiles=u;for(const h in this._timers)clearTimeout(this._timers[h]),delete this._timers[h];for(const h in this._tiles)this._setTileReloadTimer(h,this._tiles[h])}}_updateCoveredAndRetainedTiles(e,i,u,h,g,v){const S={},P={},E=Object.keys(e),k=H.now();for(const R of E){const L=e[R],N=this._tiles[R];if(!N||N.fadeEndTime!==0&&N.fadeEndTime<=k)continue;const V=this.findLoadedParent(L,i),J=this.findLoadedSibling(L),K=V||J||null;K&&(this._addTile(K.tileID),S[K.tileID.key]=K.tileID),P[R]=L}this._retainLoadedChildren(P,h,u,e);for(const R in S)e[R]||(this._coveredTiles[R]=!0,e[R]=S[R]);if(v){const R={},L={};for(const N of g)this._tiles[N.key].hasData()?R[N.key]=N:L[N.key]=N;for(const N in L){const V=L[N].children(this._source.maxzoom);this._tiles[V[0].key]&&this._tiles[V[1].key]&&this._tiles[V[2].key]&&this._tiles[V[3].key]&&(R[V[0].key]=e[V[0].key]=V[0],R[V[1].key]=e[V[1].key]=V[1],R[V[2].key]=e[V[2].key]=V[2],R[V[3].key]=e[V[3].key]=V[3],delete L[N])}for(const N in L){const V=L[N],J=this.findLoadedParent(V,this._source.minzoom),K=this.findLoadedSibling(V),te=J||K||null;if(te){R[te.tileID.key]=e[te.tileID.key]=te.tileID;for(const oe in R)R[oe].isChildOf(te.tileID)&&delete R[oe]}}for(const N in this._tiles)R[N]||(this._coveredTiles[N]=!0)}}update(e,i){if(!this._sourceLoaded||this._paused)return;let u;this.transform=e,this.terrain=i,this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?u=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(k=>new c.Y(k.canonical.z,k.wrap,k.canonical.z,k.canonical.x,k.canonical.y)):(u=be(e,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:i,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(u=u.filter(k=>this._source.hasTile(k)))):u=[];const h=ho(e,this._source),g=Math.max(h-z.maxOverzooming,this._source.minzoom),v=Math.max(h+z.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const k={};for(const R of u)if(R.canonical.z>this._source.minzoom){const L=R.scaledTo(R.canonical.z-1);k[L.key]=L;const N=R.scaledTo(Math.max(this._source.minzoom,Math.min(R.canonical.z,5)));k[N.key]=N}u=u.concat(Object.values(k))}const S=u.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,S&&this.fire(new c.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const P=this._updateRetainedTiles(u,h);W(this._source.type)&&this._updateCoveredAndRetainedTiles(P,g,v,h,u,i);for(const k in P)this._tiles[k].clearFadeHold();const E=c.ae(this._tiles,P);for(const k of E){const R=this._tiles[k];R.hasSymbolBuckets&&!R.holdingForFade()?R.setHoldDuration(this.map._fadeDuration):R.hasSymbolBuckets&&!R.symbolFadeFinished()||this._removeTile(k)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(e)}_updateRetainedTiles(e,i){var u;const h={},g={},v=Math.max(i-z.maxOverzooming,this._source.minzoom),S=Math.max(i+z.maxUnderzooming,this._source.minzoom),P={};for(const E of e){const k=this._addTile(E);h[E.key]=E,k.hasData()||i<this._source.maxzoom&&(P[E.key]=E)}this._retainLoadedChildren(P,i,S,h);for(const E of e){let k=this._tiles[E.key];if(k.hasData())continue;if(i+1>this._source.maxzoom){const L=E.children(this._source.maxzoom)[0],N=this.getTile(L);if(N&&N.hasData()){h[L.key]=L;continue}}else{const L=E.children(this._source.maxzoom);if(h[L[0].key]&&h[L[1].key]&&h[L[2].key]&&h[L[3].key])continue}let R=k.wasRequested();for(let L=E.overscaledZ-1;L>=v;--L){const N=E.scaledTo(L);if(g[N.key])break;if(g[N.key]=!0,k=this.getTile(N),!k&&R&&(k=this._addTile(N)),k){const V=k.hasData();if((V||!(!((u=this.map)===null||u===void 0)&&u.cancelPendingTileRequestsWhileZooming)||R)&&(h[N.key]=N),R=k.wasRequested(),V)break}}}return h}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const i=[];let u,h=this._tiles[e].tileID;for(;h.overscaledZ>0;){if(h.key in this._loadedParentTiles){u=this._loadedParentTiles[h.key];break}i.push(h.key);const g=h.scaledTo(h.overscaledZ-1);if(u=this._getLoadedTile(g),u)break;h=g}for(const g of i)this._loadedParentTiles[g]=u}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const e in this._tiles){const i=this._tiles[e].tileID,u=this._getLoadedTile(i);this._loadedSiblingTiles[i.key]=u}}_addTile(e){let i=this._tiles[e.key];if(i)return i;i=this._cache.getAndRemove(e),i&&(this._setTileReloadTimer(e.key,i),i.tileID=e,this._state.initializeTileState(i,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,i)));const u=i;return i||(i=new Io(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(i,e.key,i.state)),i.uses++,this._tiles[e.key]=i,u||this._source.fire(new c.l("dataloading",{tile:i,coord:i.tileID,dataType:"source"})),i}_setTileReloadTimer(e,i){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const u=i.getExpiryTimeout();u&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},u))}_removeTile(e){const i=this._tiles[e];i&&(i.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),i.uses>0||(i.hasData()&&i.state!=="reloading"?this._cache.add(i.tileID,i,i.getExpiryTimeout()):(i.aborted=!0,this._abortTile(i),this._unloadTile(i))))}_dataHandler(e){const i=e.sourceDataType;e.dataType==="source"&&i==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&e.dataType==="source"&&i==="content"&&(this.reload(e.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(e);this._cache.reset()}tilesIn(e,i,u){const h=[],g=this.transform;if(!g)return h;const v=u?g.getCameraQueryGeometry(e):e,S=e.map(V=>g.screenPointToMercatorCoordinate(V,this.terrain)),P=v.map(V=>g.screenPointToMercatorCoordinate(V,this.terrain)),E=this.getIds();let k=1/0,R=1/0,L=-1/0,N=-1/0;for(const V of P)k=Math.min(k,V.x),R=Math.min(R,V.y),L=Math.max(L,V.x),N=Math.max(N,V.y);for(let V=0;V<E.length;V++){const J=this._tiles[E[V]];if(J.holdingForFade())continue;const K=J.tileID,te=Math.pow(2,g.zoom-J.tileID.overscaledZ),oe=i*J.queryPadding*c.Z/J.tileSize/te,ue=[K.getTilePoint(new c.$(k,R)),K.getTilePoint(new c.$(L,N))];if(ue[0].x-oe<c.Z&&ue[0].y-oe<c.Z&&ue[1].x+oe>=0&&ue[1].y+oe>=0){const he=S.map(ge=>K.getTilePoint(ge)),pe=P.map(ge=>K.getTilePoint(ge));h.push({tile:J,tileID:K,queryGeometry:he,cameraQueryGeometry:pe,scale:te})}}return h}getVisibleCoordinates(e){const i=this.getRenderableIds(e).map(u=>this._tiles[u].tileID);return this.transform&&this.transform.populateCache(i),i}hasTransition(){if(this._source.hasTransition())return!0;if(W(this._source.type)){const e=H.now();for(const i in this._tiles)if(this._tiles[i].fadeEndTime>=e)return!0}return!1}setFeatureState(e,i,u){this._state.updateState(e=e||"_geojsonTileLayer",i,u)}removeFeatureState(e,i,u){this._state.removeFeatureState(e=e||"_geojsonTileLayer",i,u)}getFeatureState(e,i){return this._state.getState(e=e||"_geojsonTileLayer",i)}setDependencies(e,i,u){const h=this._tiles[e];h&&h.setDependencies(i,u)}reloadTilesForDependencies(e,i){for(const u in this._tiles)this._tiles[u].hasDependency(e,i)&&this._reloadTile(u,"reloading");this._cache.filter(u=>!u.hasDependency(e,i))}}function U(f,e){const i=Math.abs(2*f.wrap)-+(f.wrap<0),u=Math.abs(2*e.wrap)-+(e.wrap<0);return f.overscaledZ-e.overscaledZ||u-i||e.canonical.y-f.canonical.y||e.canonical.x-f.canonical.x}function W(f){return f==="raster"||f==="image"||f==="video"}z.maxOverzooming=10,z.maxUnderzooming=3;class ie{constructor(e,i){this.reset(e,i)}reset(e,i){this.points=e||[],this._distances=[0];for(let u=1;u<this.points.length;u++)this._distances[u]=this._distances[u-1]+this.points[u].dist(this.points[u-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(i||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(e){if(this.points.length===1)return this.points[0];e=c.ad(e,0,1);let i=1,u=this._distances[i];const h=e*this.paddedLength+this.padding;for(;u<h&&i<this._distances.length;)u=this._distances[++i];const g=i-1,v=this._distances[g],S=u-v,P=S>0?(h-v)/S:0;return this.points[g].mult(1-P).add(this.points[i].mult(P))}}function de(f,e){let i=!0;return f==="always"||f!=="never"&&e!=="never"||(i=!1),i}class xe{constructor(e,i,u){const h=this.boxCells=[],g=this.circleCells=[];this.xCellCount=Math.ceil(e/u),this.yCellCount=Math.ceil(i/u);for(let v=0;v<this.xCellCount*this.yCellCount;v++)h.push([]),g.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=i,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/i,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(e,i,u,h,g){this._forEachCell(i,u,h,g,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(i),this.bboxes.push(u),this.bboxes.push(h),this.bboxes.push(g)}insertCircle(e,i,u,h){this._forEachCell(i-h,u-h,i+h,u+h,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(i),this.circles.push(u),this.circles.push(h)}_insertBoxCell(e,i,u,h,g,v){this.boxCells[g].push(v)}_insertCircleCell(e,i,u,h,g,v){this.circleCells[g].push(v)}_query(e,i,u,h,g,v,S){if(u<0||e>this.width||h<0||i>this.height)return[];const P=[];if(e<=0&&i<=0&&this.width<=u&&this.height<=h){if(g)return[{key:null,x1:e,y1:i,x2:u,y2:h}];for(let E=0;E<this.boxKeys.length;E++)P.push({key:this.boxKeys[E],x1:this.bboxes[4*E],y1:this.bboxes[4*E+1],x2:this.bboxes[4*E+2],y2:this.bboxes[4*E+3]});for(let E=0;E<this.circleKeys.length;E++){const k=this.circles[3*E],R=this.circles[3*E+1],L=this.circles[3*E+2];P.push({key:this.circleKeys[E],x1:k-L,y1:R-L,x2:k+L,y2:R+L})}}else this._forEachCell(e,i,u,h,this._queryCell,P,{hitTest:g,overlapMode:v,seenUids:{box:{},circle:{}}},S);return P}query(e,i,u,h){return this._query(e,i,u,h,!1,null)}hitTest(e,i,u,h,g,v){return this._query(e,i,u,h,!0,g,v).length>0}hitTestCircle(e,i,u,h,g){const v=e-u,S=e+u,P=i-u,E=i+u;if(S<0||v>this.width||E<0||P>this.height)return!1;const k=[];return this._forEachCell(v,P,S,E,this._queryCellCircle,k,{hitTest:!0,overlapMode:h,circle:{x:e,y:i,radius:u},seenUids:{box:{},circle:{}}},g),k.length>0}_queryCell(e,i,u,h,g,v,S,P){const{seenUids:E,hitTest:k,overlapMode:R}=S,L=this.boxCells[g];if(L!==null){const V=this.bboxes;for(const J of L)if(!E.box[J]){E.box[J]=!0;const K=4*J,te=this.boxKeys[J];if(e<=V[K+2]&&i<=V[K+3]&&u>=V[K+0]&&h>=V[K+1]&&(!P||P(te))&&(!k||!de(R,te.overlapMode))&&(v.push({key:te,x1:V[K],y1:V[K+1],x2:V[K+2],y2:V[K+3]}),k))return!0}}const N=this.circleCells[g];if(N!==null){const V=this.circles;for(const J of N)if(!E.circle[J]){E.circle[J]=!0;const K=3*J,te=this.circleKeys[J];if(this._circleAndRectCollide(V[K],V[K+1],V[K+2],e,i,u,h)&&(!P||P(te))&&(!k||!de(R,te.overlapMode))){const oe=V[K],ue=V[K+1],he=V[K+2];if(v.push({key:te,x1:oe-he,y1:ue-he,x2:oe+he,y2:ue+he}),k)return!0}}}return!1}_queryCellCircle(e,i,u,h,g,v,S,P){const{circle:E,seenUids:k,overlapMode:R}=S,L=this.boxCells[g];if(L!==null){const V=this.bboxes;for(const J of L)if(!k.box[J]){k.box[J]=!0;const K=4*J,te=this.boxKeys[J];if(this._circleAndRectCollide(E.x,E.y,E.radius,V[K+0],V[K+1],V[K+2],V[K+3])&&(!P||P(te))&&!de(R,te.overlapMode))return v.push(!0),!0}}const N=this.circleCells[g];if(N!==null){const V=this.circles;for(const J of N)if(!k.circle[J]){k.circle[J]=!0;const K=3*J,te=this.circleKeys[J];if(this._circlesCollide(V[K],V[K+1],V[K+2],E.x,E.y,E.radius)&&(!P||P(te))&&!de(R,te.overlapMode))return v.push(!0),!0}}}_forEachCell(e,i,u,h,g,v,S,P){const E=this._convertToXCellCoord(e),k=this._convertToYCellCoord(i),R=this._convertToXCellCoord(u),L=this._convertToYCellCoord(h);for(let N=E;N<=R;N++)for(let V=k;V<=L;V++)if(g.call(this,e,i,u,h,this.xCellCount*V+N,v,S,P))return}_convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}_convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}_circlesCollide(e,i,u,h,g,v){const S=h-e,P=g-i,E=u+v;return E*E>S*S+P*P}_circleAndRectCollide(e,i,u,h,g,v,S){const P=(v-h)/2,E=Math.abs(e-(h+P));if(E>P+u)return!1;const k=(S-g)/2,R=Math.abs(i-(g+k));if(R>k+u)return!1;if(E<=P||R<=k)return!0;const L=E-P,N=R-k;return L*L+N*N<=u*u}}function Me(f,e,i){const u=c.K();if(!f){const{vecSouth:R,vecEast:L}=Oe(e),N=j();N[0]=L[0],N[1]=L[1],N[2]=R[0],N[3]=R[1],h=N,(k=(v=(g=N)[0])*(E=g[3])-(P=g[2])*(S=g[1]))&&(h[0]=E*(k=1/k),h[1]=-S*k,h[2]=-P*k,h[3]=v*k),u[0]=N[0],u[1]=N[1],u[4]=N[2],u[5]=N[3]}var h,g,v,S,P,E,k;return c.M(u,u,[1/i,1/i,1]),u}function ye(f,e,i,u){if(f){const h=c.K();if(!e){const{vecSouth:g,vecEast:v}=Oe(i);h[0]=v[0],h[1]=v[1],h[4]=g[0],h[5]=g[1]}return c.M(h,h,[u,u,1]),h}return i.pixelsToClipSpaceMatrix}function Oe(f){const e=Math.cos(f.rollInRadians),i=Math.sin(f.rollInRadians),u=Math.cos(f.pitchInRadians),h=Math.cos(f.bearingInRadians),g=Math.sin(f.bearingInRadians),v=c.aj();v[0]=-h*u*i-g*e,v[1]=-g*u*i+h*e;const S=c.ak(v);S<1e-9?c.al(v):c.am(v,v,1/S);const P=c.aj();P[0]=h*u*e-g*i,P[1]=g*u*e+h*i;const E=c.ak(P);return E<1e-9?c.al(P):c.am(P,P,1/E),{vecEast:P,vecSouth:v}}function ke(f,e,i,u){let h;u?(h=[f,e,u(f,e),1],c.ao(h,h,i)):(h=[f,e,0,1],Nr(h,h,i));const g=h[3];return{point:new c.P(h[0]/g,h[1]/g),signedDistanceFromCamera:g,isOccluded:!1}}function Se(f,e){return .5+f/e*.5}function Ue(f,e){return f.x>=-e[0]&&f.x<=e[0]&&f.y>=-e[1]&&f.y<=e[1]}function Te(f,e,i,u,h,g,v,S,P,E,k,R,L){const N=i?f.textSizeData:f.iconSizeData,V=c.af(N,e.transform.zoom),J=[256/e.width*2+1,256/e.height*2+1],K=i?f.text.dynamicLayoutVertexArray:f.icon.dynamicLayoutVertexArray;K.clear();const te=f.lineVertexArray,oe=i?f.text.placedSymbolArray:f.icon.placedSymbolArray,ue=e.transform.width/e.transform.height;let he=!1;for(let pe=0;pe<oe.length;pe++){const ge=oe.get(pe);if(ge.hidden||ge.writingMode===c.ag.vertical&&!he){Lr(ge.numGlyphs,K);continue}he=!1;const fe=new c.P(ge.anchorX,ge.anchorY),Pe={getElevation:L,pitchedLabelPlaneMatrix:u,lineVertexArray:te,pitchWithMap:g,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:e.transform,tileAnchorPoint:fe,unwrappedTileID:P,width:E,height:k,translation:R},Ee=It(ge.anchorX,ge.anchorY,Pe);if(!Ue(Ee.point,J)){Lr(ge.numGlyphs,K);continue}const Be=Se(e.transform.cameraToCenterDistance,Ee.signedDistanceFromCamera),je=c.ah(N,V,ge),Le=g?je*e.transform.getPitchedTextCorrection(ge.anchorX,ge.anchorY,P)/Be:je*Be,Qe=Pt({projectionContext:Pe,pitchedLabelPlaneMatrixInverse:h,symbol:ge,fontSize:Le,flip:!1,keepUpright:v,glyphOffsetArray:f.glyphOffsetArray,dynamicLayoutVertexArray:K,aspectRatio:ue,rotateToLine:S});he=Qe.useVertical,(Qe.notEnoughRoom||he||Qe.needsFlipping&&Pt({projectionContext:Pe,pitchedLabelPlaneMatrixInverse:h,symbol:ge,fontSize:Le,flip:!0,keepUpright:v,glyphOffsetArray:f.glyphOffsetArray,dynamicLayoutVertexArray:K,aspectRatio:ue,rotateToLine:S}).notEnoughRoom)&&Lr(ge.numGlyphs,K)}i?f.text.dynamicLayoutVertexBuffer.updateData(K):f.icon.dynamicLayoutVertexBuffer.updateData(K)}function et(f,e,i,u,h,g,v,S){const P=g.glyphStartIndex+g.numGlyphs,E=g.lineStartIndex,k=g.lineStartIndex+g.lineLength,R=e.getoffsetX(g.glyphStartIndex),L=e.getoffsetX(P-1),N=_t(f*R,i,u,h,g.segment,E,k,S,v);if(!N)return null;const V=_t(f*L,i,u,h,g.segment,E,k,S,v);return V?S.projectionCache.anyProjectionOccluded?null:{first:N,last:V}:null}function dt(f,e,i,u){return f===c.ag.horizontal&&Math.abs(i.y-e.y)>Math.abs(i.x-e.x)*u?{useVertical:!0}:(f===c.ag.vertical?e.y<i.y:e.x>i.x)?{needsFlipping:!0}:null}function Pt(f){const{projectionContext:e,pitchedLabelPlaneMatrixInverse:i,symbol:u,fontSize:h,flip:g,keepUpright:v,glyphOffsetArray:S,dynamicLayoutVertexArray:P,aspectRatio:E,rotateToLine:k}=f,R=h/24,L=u.lineOffsetX*R,N=u.lineOffsetY*R;let V;if(u.numGlyphs>1){const J=u.glyphStartIndex+u.numGlyphs,K=u.lineStartIndex,te=u.lineStartIndex+u.lineLength,oe=et(R,S,L,N,g,u,k,e);if(!oe)return{notEnoughRoom:!0};const ue=ot(oe.first.point.x,oe.first.point.y,e,i),he=ot(oe.last.point.x,oe.last.point.y,e,i);if(v&&!g){const pe=dt(u.writingMode,ue,he,E);if(pe)return pe}V=[oe.first];for(let pe=u.glyphStartIndex+1;pe<J-1;pe++)V.push(_t(R*S.getoffsetX(pe),L,N,g,u.segment,K,te,e,k));V.push(oe.last)}else{if(v&&!g){const K=st(e.tileAnchorPoint.x,e.tileAnchorPoint.y,e).point,te=u.lineStartIndex+u.segment+1,oe=new c.P(e.lineVertexArray.getx(te),e.lineVertexArray.gety(te)),ue=st(oe.x,oe.y,e),he=ue.signedDistanceFromCamera>0?ue.point:bt(e.tileAnchorPoint,oe,K,1,e),pe=ot(K.x,K.y,e,i),ge=ot(he.x,he.y,e,i),fe=dt(u.writingMode,pe,ge,E);if(fe)return fe}const J=_t(R*S.getoffsetX(u.glyphStartIndex),L,N,g,u.segment,u.lineStartIndex,u.lineStartIndex+u.lineLength,e,k);if(!J||e.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};V=[J]}for(const J of V)c.an(P,J.point,J.angle);return{}}function bt(f,e,i,u,h){const g=f.add(f.sub(e)._unit()),v=st(g.x,g.y,h).point,S=i.sub(v);return i.add(S._mult(u/S.mag()))}function $e(f,e,i){const u=e.projectionCache;if(u.projections[f])return u.projections[f];const h=new c.P(e.lineVertexArray.getx(f),e.lineVertexArray.gety(f)),g=st(h.x,h.y,e);if(g.signedDistanceFromCamera>0)return u.projections[f]=g.point,u.anyProjectionOccluded=u.anyProjectionOccluded||g.isOccluded,g.point;const v=f-i.direction;return bt(i.distanceFromAnchor===0?e.tileAnchorPoint:new c.P(e.lineVertexArray.getx(v),e.lineVertexArray.gety(v)),h,i.previousVertex,i.absOffsetX-i.distanceFromAnchor+1,e)}function st(f,e,i){const u=f+i.translation[0],h=e+i.translation[1];let g;return i.pitchWithMap?(g=ke(u,h,i.pitchedLabelPlaneMatrix,i.getElevation),g.isOccluded=!1):(g=i.transform.projectTileCoordinates(u,h,i.unwrappedTileID,i.getElevation),g.point.x=(.5*g.point.x+.5)*i.width,g.point.y=(.5*-g.point.y+.5)*i.height),g}function ot(f,e,i,u){if(i.pitchWithMap){const h=[f,e,0,1];return c.ao(h,h,u),i.transform.projectTileCoordinates(h[0]/h[3],h[1]/h[3],i.unwrappedTileID,i.getElevation).point}return{x:f/i.width*2-1,y:e/i.height*2-1}}function It(f,e,i){return i.transform.projectTileCoordinates(f,e,i.unwrappedTileID,i.getElevation)}function wt(f,e,i){return f._unit()._perp()._mult(e*i)}function kt(f,e,i,u,h,g,v,S,P){if(S.projectionCache.offsets[f])return S.projectionCache.offsets[f];const E=i.add(e);if(f+P.direction<u||f+P.direction>=h)return S.projectionCache.offsets[f]=E,E;const k=$e(f+P.direction,S,P),R=wt(k.sub(i),v,P.direction),L=i.add(R),N=k.add(R);return S.projectionCache.offsets[f]=c.ap(g,E,L,N)||E,S.projectionCache.offsets[f]}function _t(f,e,i,u,h,g,v,S,P){const E=u?f-e:f+e;let k=E>0?1:-1,R=0;u&&(k*=-1,R=Math.PI),k<0&&(R+=Math.PI);let L,N=k>0?g+h:g+h+1;S.projectionCache.cachedAnchorPoint?L=S.projectionCache.cachedAnchorPoint:(L=st(S.tileAnchorPoint.x,S.tileAnchorPoint.y,S).point,S.projectionCache.cachedAnchorPoint=L);let V,J,K=L,te=L,oe=0,ue=0;const he=Math.abs(E),pe=[];let ge;for(;oe+ue<=he;){if(N+=k,N<g||N>=v)return null;oe+=ue,te=K,J=V;const Ee={absOffsetX:he,direction:k,distanceFromAnchor:oe,previousVertex:te};if(K=$e(N,S,Ee),i===0)pe.push(te),ge=K.sub(te);else{let Be;const je=K.sub(te);Be=je.mag()===0?wt($e(N+k,S,Ee).sub(K),i,k):wt(je,i,k),J||(J=te.add(Be)),V=kt(N,Be,K,g,v,J,i,S,Ee),pe.push(J),ge=V.sub(J)}ue=ge.mag()}const fe=ge._mult((he-oe)/ue)._add(J||te),Pe=R+Math.atan2(K.y-te.y,K.x-te.x);return pe.push(fe),{point:fe,angle:P?Pe:0,path:pe}}const is=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Lr(f,e){for(let i=0;i<f;i++){const u=e.length;e.resize(u+4),e.float32.set(is,3*u)}}function Nr(f,e,i){const u=e[0],h=e[1];return f[0]=i[0]*u+i[4]*h+i[12],f[1]=i[1]*u+i[5]*h+i[13],f[3]=i[3]*u+i[7]*h+i[15],f}const rr=100;class kl{constructor(e,i=new xe(e.width+200,e.height+200,25),u=new xe(e.width+200,e.height+200,25)){this.transform=e,this.grid=i,this.ignoredGrid=u,this.pitchFactor=Math.cos(e.pitch*Math.PI/180)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+rr,this.screenBottomBoundary=e.height+rr,this.gridRightBoundary=e.width+200,this.gridBottomBoundary=e.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(e,i,u,h,g,v,S,P,E,k,R,L){const N=this.projectAndGetPerspectiveRatio(e.anchorPointX+P[0],e.anchorPointY+P[1],g,k,L),V=u*N.perspectiveRatio;let J;if(v||S)J=this._projectCollisionBox(e,V,h,g,v,S,P,N,k,R,L);else{const ge=N.x+(R?R.x*V:0),fe=N.y+(R?R.y*V:0);J={allPointsOccluded:!1,box:[ge+e.x1*V,fe+e.y1*V,ge+e.x2*V,fe+e.y2*V]}}const[K,te,oe,ue]=J.box,he=v?J.allPointsOccluded:N.isOccluded;let pe=he;return pe||(pe=N.perspectiveRatio<this.perspectiveRatioCutoff),pe||(pe=!this.isInsideGrid(K,te,oe,ue)),pe||i!=="always"&&this.grid.hitTest(K,te,oe,ue,i,E)?{box:[K,te,oe,ue],placeable:!1,offscreen:!1,occluded:he}:{box:[K,te,oe,ue],placeable:!0,offscreen:this.isOffscreen(K,te,oe,ue),occluded:he}}placeCollisionCircles(e,i,u,h,g,v,S,P,E,k,R,L,N,V){const J=[],K=new c.P(i.anchorX,i.anchorY),te=this.getPerspectiveRatio(K.x,K.y,v,V),oe=(E?g*this.transform.getPitchedTextCorrection(i.anchorX,i.anchorY,v)/te:g*te)/c.au,ue={getElevation:V,pitchedLabelPlaneMatrix:S,lineVertexArray:u,pitchWithMap:E,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:K,unwrappedTileID:v,width:this.transform.width,height:this.transform.height,translation:N},he=et(oe,h,i.lineOffsetX*oe,i.lineOffsetY*oe,!1,i,!1,ue);let pe=!1,ge=!1,fe=!0;if(he){const Pe=.5*R*te+L,Ee=new c.P(-100,-100),Be=new c.P(this.screenRightBoundary,this.screenBottomBoundary),je=new ie,Le=he.first,Qe=he.last;let Ke=[];for(let mt=Le.path.length-1;mt>=1;mt--)Ke.push(Le.path[mt]);for(let mt=1;mt<Qe.path.length;mt++)Ke.push(Qe.path[mt]);const Ge=2.5*Pe;if(E){const mt=this.projectPathToScreenSpace(Ke,ue);Ke=mt.some(Vt=>Vt.signedDistanceFromCamera<=0)?[]:mt.map(Vt=>Vt.point)}let lt=[];if(Ke.length>0){const mt=Ke[0].clone(),Vt=Ke[0].clone();for(let Yt=1;Yt<Ke.length;Yt++)mt.x=Math.min(mt.x,Ke[Yt].x),mt.y=Math.min(mt.y,Ke[Yt].y),Vt.x=Math.max(Vt.x,Ke[Yt].x),Vt.y=Math.max(Vt.y,Ke[Yt].y);lt=mt.x>=Ee.x&&Vt.x<=Be.x&&mt.y>=Ee.y&&Vt.y<=Be.y?[Ke]:Vt.x<Ee.x||mt.x>Be.x||Vt.y<Ee.y||mt.y>Be.y?[]:c.aq([Ke],Ee.x,Ee.y,Be.x,Be.y)}for(const mt of lt){je.reset(mt,.25*Pe);let Vt=0;Vt=je.length<=.5*Pe?1:Math.ceil(je.paddedLength/Ge)+1;for(let Yt=0;Yt<Vt;Yt++){const Gt=Yt/Math.max(Vt-1,1),lr=je.lerp(Gt),nr=lr.x+rr,Ut=lr.y+rr;J.push(nr,Ut,Pe,0);const qt=nr-Pe,Jr=Ut-Pe,en=nr+Pe,$r=Ut+Pe;if(fe=fe&&this.isOffscreen(qt,Jr,en,$r),ge=ge||this.isInsideGrid(qt,Jr,en,$r),e!=="always"&&this.grid.hitTestCircle(nr,Ut,Pe,e,k)&&(pe=!0,!P))return{circles:[],offscreen:!1,collisionDetected:pe}}}}return{circles:!P&&pe||!ge||te<this.perspectiveRatioCutoff?[]:J,offscreen:fe,collisionDetected:pe}}projectPathToScreenSpace(e,i){const u=function(h,g){const v=c.K();return c.ai(v,g.pitchedLabelPlaneMatrix),h.map(S=>{const P=ke(S.x,S.y,v,g.getElevation),E=g.transform.projectTileCoordinates(P.point.x,P.point.y,g.unwrappedTileID,g.getElevation);return E.point.x=(.5*E.point.x+.5)*g.width,E.point.y=(.5*-E.point.y+.5)*g.height,E})}(e,i);return function(h){let g=0,v=0,S=0,P=0;for(let E=0;E<h.length;E++)h[E].isOccluded?(S=E+1,P=0):(P++,P>v&&(v=P,g=S));return h.slice(g,g+v)}(u)}queryRenderedSymbols(e){if(e.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const i=[];let u=1/0,h=1/0,g=-1/0,v=-1/0;for(const k of e){const R=new c.P(k.x+rr,k.y+rr);u=Math.min(u,R.x),h=Math.min(h,R.y),g=Math.max(g,R.x),v=Math.max(v,R.y),i.push(R)}const S=this.grid.query(u,h,g,v).concat(this.ignoredGrid.query(u,h,g,v)),P={},E={};for(const k of S){const R=k.key;if(P[R.bucketInstanceId]===void 0&&(P[R.bucketInstanceId]={}),P[R.bucketInstanceId][R.featureIndex])continue;const L=[new c.P(k.x1,k.y1),new c.P(k.x2,k.y1),new c.P(k.x2,k.y2),new c.P(k.x1,k.y2)];c.ar(i,L)&&(P[R.bucketInstanceId][R.featureIndex]=!0,E[R.bucketInstanceId]===void 0&&(E[R.bucketInstanceId]=[]),E[R.bucketInstanceId].push(R.featureIndex))}return E}insertCollisionBox(e,i,u,h,g,v){(u?this.ignoredGrid:this.grid).insert({bucketInstanceId:h,featureIndex:g,collisionGroupID:v,overlapMode:i},e[0],e[1],e[2],e[3])}insertCollisionCircles(e,i,u,h,g,v){const S=u?this.ignoredGrid:this.grid,P={bucketInstanceId:h,featureIndex:g,collisionGroupID:v,overlapMode:i};for(let E=0;E<e.length;E+=4)S.insertCircle(P,e[E],e[E+1],e[E+2])}projectAndGetPerspectiveRatio(e,i,u,h,g){if(g){let v;h?(v=[e,i,h(e,i),1],c.ao(v,v,g)):(v=[e,i,0,1],Nr(v,v,g));const S=v[3];return{x:(v[0]/S+1)/2*this.transform.width+rr,y:(-v[1]/S+1)/2*this.transform.height+rr,perspectiveRatio:.5+this.transform.cameraToCenterDistance/S*.5,isOccluded:!1,signedDistanceFromCamera:S}}{const v=this.transform.projectTileCoordinates(e,i,u,h);return{x:(v.point.x+1)/2*this.transform.width+rr,y:(1-v.point.y)/2*this.transform.height+rr,perspectiveRatio:.5+this.transform.cameraToCenterDistance/v.signedDistanceFromCamera*.5,isOccluded:v.isOccluded,signedDistanceFromCamera:v.signedDistanceFromCamera}}}getPerspectiveRatio(e,i,u,h){const g=this.transform.projectTileCoordinates(e,i,u,h);return .5+this.transform.cameraToCenterDistance/g.signedDistanceFromCamera*.5}isOffscreen(e,i,u,h){return u<rr||e>=this.screenRightBoundary||h<rr||i>this.screenBottomBoundary}isInsideGrid(e,i,u,h){return u>=0&&e<this.gridRightBoundary&&h>=0&&i<this.gridBottomBoundary}getViewportMatrix(){const e=c.as([]);return c.L(e,e,[-100,-100,0]),e}_projectCollisionBox(e,i,u,h,g,v,S,P,E,k,R){let L=1,N=0,V=0,J=1;const K=e.anchorPointX+S[0],te=e.anchorPointY+S[1];if(v&&!g){const Ke=this.projectAndGetPerspectiveRatio(K+1,te,h,E,R),Ge=Ke.x-P.x,lt=Math.atan((Ke.y-P.y)/Ge)+(Ge<0?Math.PI:0),mt=Math.sin(lt),Vt=Math.cos(lt);L=Vt,N=mt,V=-mt,J=Vt}else if(!v&&g){const Ke=Oe(this.transform);L=Ke.vecEast[0],N=Ke.vecEast[1],V=Ke.vecSouth[0],J=Ke.vecSouth[1]}let oe=P.x,ue=P.y,he=i;g&&(oe=K,ue=te,he=Math.pow(2,-(this.transform.zoom-u.overscaledZ)),he*=this.transform.getPitchedTextCorrection(K,te,h),k||(he*=c.ad(.5+P.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),k&&(oe+=L*k.x*he+V*k.y*he,ue+=N*k.x*he+J*k.y*he);const pe=e.x1*he,ge=e.x2*he,fe=(pe+ge)/2,Pe=e.y1*he,Ee=e.y2*he,Be=(Pe+Ee)/2,je=[{offsetX:pe,offsetY:Pe},{offsetX:fe,offsetY:Pe},{offsetX:ge,offsetY:Pe},{offsetX:ge,offsetY:Be},{offsetX:ge,offsetY:Ee},{offsetX:fe,offsetY:Ee},{offsetX:pe,offsetY:Ee},{offsetX:pe,offsetY:Be}];let Le=[];for(const{offsetX:Ke,offsetY:Ge}of je)Le.push(new c.P(oe+L*Ke+V*Ge,ue+N*Ke+J*Ge));let Qe=!1;if(g){const Ke=Le.map(Ge=>this.projectAndGetPerspectiveRatio(Ge.x,Ge.y,h,E,R));Qe=Ke.some(Ge=>!Ge.isOccluded),Le=Ke.map(Ge=>new c.P(Ge.x,Ge.y))}else Qe=!0;return{box:c.at(Le),allPointsOccluded:!Qe}}}class Ln{constructor(e,i,u,h){this.opacity=e?Math.max(0,Math.min(1,e.opacity+(e.placed?i:-i))):h&&u?1:0,this.placed=u}isHidden(){return this.opacity===0&&!this.placed}}class Xt{constructor(e,i,u,h,g){this.text=new Ln(e?e.text:null,i,u,g),this.icon=new Ln(e?e.icon:null,i,h,g)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class np{constructor(e,i,u){this.text=e,this.icon=i,this.skipFade=u}}class Na{constructor(e,i,u,h,g){this.bucketInstanceId=e,this.featureIndex=i,this.sourceLayerIndex=u,this.bucketIndex=h,this.tileID=g}}class Mu{constructor(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}get(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){const i=++this.maxGroupID;this.collisionGroups[e]={ID:i,predicate:u=>u.collisionGroupID===i}}return this.collisionGroups[e]}}function Ao(f,e,i,u,h){const{horizontalAlign:g,verticalAlign:v}=c.aA(f);return new c.P(-(g-.5)*e+u[0]*h,-(v-.5)*i+u[1]*h)}class Zs{constructor(e,i,u,h,g){this.transform=e.clone(),this.terrain=i,this.collisionIndex=new kl(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=u,this.retainedQueryData={},this.collisionGroups=new Mu(h),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=g,g&&(g.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(e){const i=this.terrain;return i?(u,h)=>i.getElevation(e,u,h):null}getBucketParts(e,i,u,h){const g=u.getBucket(i),v=u.latestFeatureIndex;if(!g||!v||i.id!==g.layerIds[0])return;const S=u.collisionBoxArray,P=g.layers[0].layout,E=g.layers[0].paint,k=Math.pow(2,this.transform.zoom-u.tileID.overscaledZ),R=u.tileSize/c.Z,L=u.tileID.toUnwrapped(),N=P.get("text-rotation-alignment")==="map",V=c.av(u,1,this.transform.zoom),J=c.aw(this.collisionIndex.transform,u,E.get("text-translate"),E.get("text-translate-anchor")),K=c.aw(this.collisionIndex.transform,u,E.get("icon-translate"),E.get("icon-translate-anchor")),te=Me(N,this.transform,V);this.retainedQueryData[g.bucketInstanceId]=new Na(g.bucketInstanceId,v,g.sourceLayerIndex,g.index,u.tileID);const oe={bucket:g,layout:P,translationText:J,translationIcon:K,unwrappedTileID:L,pitchedLabelPlaneMatrix:te,scale:k,textPixelRatio:R,holdingForFade:u.holdingForFade(),collisionBoxArray:S,partiallyEvaluatedTextSize:c.af(g.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(g.sourceID)};if(h)for(const ue of g.sortKeyRanges){const{sortKey:he,symbolInstanceStart:pe,symbolInstanceEnd:ge}=ue;e.push({sortKey:he,symbolInstanceStart:pe,symbolInstanceEnd:ge,parameters:oe})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:g.symbolInstances.length,parameters:oe})}attemptAnchorPlacement(e,i,u,h,g,v,S,P,E,k,R,L,N,V,J,K,te,oe,ue,he){const pe=c.ax[e.textAnchor],ge=[e.textOffset0,e.textOffset1],fe=Ao(pe,u,h,ge,g),Pe=this.collisionIndex.placeCollisionBox(i,L,P,E,k,S,v,K,R.predicate,ue,fe,he);if((!oe||this.collisionIndex.placeCollisionBox(oe,L,P,E,k,S,v,te,R.predicate,ue,fe,he).placeable)&&Pe.placeable){let Ee;if(this.prevPlacement&&this.prevPlacement.variableOffsets[N.crossTileID]&&this.prevPlacement.placements[N.crossTileID]&&this.prevPlacement.placements[N.crossTileID].text&&(Ee=this.prevPlacement.variableOffsets[N.crossTileID].anchor),N.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[N.crossTileID]={textOffset:ge,width:u,height:h,anchor:pe,textBoxScale:g,prevAnchor:Ee},this.markUsedJustification(V,pe,N,J),V.allowVerticalPlacement&&(this.markUsedOrientation(V,J,N),this.placedOrientations[N.crossTileID]=J),{shift:fe,placedGlyphBoxes:Pe}}}placeLayerBucketPart(e,i,u){const{bucket:h,layout:g,translationText:v,translationIcon:S,unwrappedTileID:P,pitchedLabelPlaneMatrix:E,textPixelRatio:k,holdingForFade:R,collisionBoxArray:L,partiallyEvaluatedTextSize:N,collisionGroup:V}=e.parameters,J=g.get("text-optional"),K=g.get("icon-optional"),te=c.ay(g,"text-overlap","text-allow-overlap"),oe=te==="always",ue=c.ay(g,"icon-overlap","icon-allow-overlap"),he=ue==="always",pe=g.get("text-rotation-alignment")==="map",ge=g.get("text-pitch-alignment")==="map",fe=g.get("icon-text-fit")!=="none",Pe=g.get("symbol-z-order")==="viewport-y",Ee=oe&&(he||!h.hasIconData()||K),Be=he&&(oe||!h.hasTextData()||J);!h.collisionArrays&&L&&h.deserializeCollisionBoxes(L);const je=this.retainedQueryData[h.bucketInstanceId].tileID,Le=this._getTerrainElevationFunc(je),Qe=this.transform.getFastPathSimpleProjectionMatrix(je),Ke=(Ge,lt,mt)=>{var Vt,Yt;if(i[Ge.crossTileID])return;if(R)return void(this.placements[Ge.crossTileID]=new np(!1,!1,!1));let Gt=!1,lr=!1,nr=!0,Ut=null,qt={box:null,placeable:!1,offscreen:null,occluded:!1},Jr={placeable:!1},en=null,$r=null,un=null,Oo=0,mo=0,Wi=0;lt.textFeatureIndex?Oo=lt.textFeatureIndex:Ge.useRuntimeCollisionCircles&&(Oo=Ge.featureIndex),lt.verticalTextFeatureIndex&&(mo=lt.verticalTextFeatureIndex);const di=lt.textBox;if(di){const pi=Qt=>{let Kt=c.ag.horizontal;if(h.allowVerticalPlacement&&!Qt&&this.prevPlacement){const Vr=this.prevPlacement.placedOrientations[Ge.crossTileID];Vr&&(this.placedOrientations[Ge.crossTileID]=Vr,Kt=Vr,this.markUsedOrientation(h,Kt,Ge))}return Kt},Hi=(Qt,Kt)=>{if(h.allowVerticalPlacement&&Ge.numVerticalGlyphVertices>0&&lt.verticalTextBox){for(const Vr of h.writingModes)if(Vr===c.ag.vertical?(qt=Kt(),Jr=qt):qt=Qt(),qt&&qt.placeable)break}else qt=Qt()},Ti=Ge.textAnchorOffsetStartIndex,Xi=Ge.textAnchorOffsetEndIndex;if(Xi===Ti){const Qt=(Kt,Vr)=>{const Ur=this.collisionIndex.placeCollisionBox(Kt,te,k,je,P,ge,pe,v,V.predicate,Le,void 0,Qe);return Ur&&Ur.placeable&&(this.markUsedOrientation(h,Vr,Ge),this.placedOrientations[Ge.crossTileID]=Vr),Ur};Hi(()=>Qt(di,c.ag.horizontal),()=>{const Kt=lt.verticalTextBox;return h.allowVerticalPlacement&&Ge.numVerticalGlyphVertices>0&&Kt?Qt(Kt,c.ag.vertical):{box:null,offscreen:null}}),pi(qt&&qt.placeable)}else{let Qt=c.ax[(Yt=(Vt=this.prevPlacement)===null||Vt===void 0?void 0:Vt.variableOffsets[Ge.crossTileID])===null||Yt===void 0?void 0:Yt.anchor];const Kt=(Ur,ws,s_)=>{const Wp=Ur.x2-Ur.x1,Mh=Ur.y2-Ur.y1,Hp=Ge.textBoxScale,Ss=fe&&ue==="never"?ws:null;let Kn=null,Ih=te==="never"?1:2,Xp="never";Qt&&Ih++;for(let xc=0;xc<Ih;xc++){for(let bc=Ti;bc<Xi;bc++){const Kp=h.textAnchorOffsets.get(bc);if(Qt&&Kp.textAnchor!==Qt)continue;const wc=this.attemptAnchorPlacement(Kp,Ur,Wp,Mh,Hp,pe,ge,k,je,P,V,Xp,Ge,h,s_,v,S,Ss,Le);if(wc&&(Kn=wc.placedGlyphBoxes,Kn&&Kn.placeable))return Gt=!0,Ut=wc.shift,Kn}Qt?Qt=null:Xp=te}return u&&!Kn&&(Kn={box:this.collisionIndex.placeCollisionBox(di,"always",k,je,P,ge,pe,v,V.predicate,Le,void 0,Qe).box,offscreen:!1,placeable:!1,occluded:!1}),Kn};Hi(()=>Kt(di,lt.iconBox,c.ag.horizontal),()=>{const Ur=lt.verticalTextBox;return h.allowVerticalPlacement&&(!qt||!qt.placeable)&&Ge.numVerticalGlyphVertices>0&&Ur?Kt(Ur,lt.verticalIconBox,c.ag.vertical):{box:null,occluded:!0,offscreen:null}}),qt&&(Gt=qt.placeable,nr=qt.offscreen);const Vr=pi(qt&&qt.placeable);if(!Gt&&this.prevPlacement){const Ur=this.prevPlacement.variableOffsets[Ge.crossTileID];Ur&&(this.variableOffsets[Ge.crossTileID]=Ur,this.markUsedJustification(h,Ur.anchor,Ge,Vr))}}}if(en=qt,Gt=en&&en.placeable,nr=en&&en.offscreen,Ge.useRuntimeCollisionCircles){const pi=h.text.placedSymbolArray.get(Ge.centerJustifiedTextSymbolIndex),Hi=c.ah(h.textSizeData,N,pi),Ti=g.get("text-padding");$r=this.collisionIndex.placeCollisionCircles(te,pi,h.lineVertexArray,h.glyphOffsetArray,Hi,P,E,u,ge,V.predicate,Ge.collisionCircleDiameter,Ti,v,Le),$r.circles.length&&$r.collisionDetected&&!u&&c.w("Collisions detected, but collision boxes are not shown"),Gt=oe||$r.circles.length>0&&!$r.collisionDetected,nr=nr&&$r.offscreen}if(lt.iconFeatureIndex&&(Wi=lt.iconFeatureIndex),lt.iconBox){const pi=Hi=>this.collisionIndex.placeCollisionBox(Hi,ue,k,je,P,ge,pe,S,V.predicate,Le,fe&&Ut?Ut:void 0,Qe);Jr&&Jr.placeable&&lt.verticalIconBox?(un=pi(lt.verticalIconBox),lr=un.placeable):(un=pi(lt.iconBox),lr=un.placeable),nr=nr&&un.offscreen}const xs=J||Ge.numHorizontalGlyphVertices===0&&Ge.numVerticalGlyphVertices===0,sl=K||Ge.numIconVertices===0;xs||sl?sl?xs||(lr=lr&&Gt):Gt=lr&&Gt:lr=Gt=lr&&Gt;const bs=lr&&un.placeable;if(Gt&&en.placeable&&this.collisionIndex.insertCollisionBox(en.box,te,g.get("text-ignore-placement"),h.bucketInstanceId,Jr&&Jr.placeable&&mo?mo:Oo,V.ID),bs&&this.collisionIndex.insertCollisionBox(un.box,ue,g.get("icon-ignore-placement"),h.bucketInstanceId,Wi,V.ID),$r&&Gt&&this.collisionIndex.insertCollisionCircles($r.circles,te,g.get("text-ignore-placement"),h.bucketInstanceId,Oo,V.ID),u&&this.storeCollisionData(h.bucketInstanceId,mt,lt,en,un,$r),Ge.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(h.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Ge.crossTileID]=new np((Gt||Ee)&&!(en!=null&&en.occluded),(lr||Be)&&!(un!=null&&un.occluded),nr||h.justReloaded),i[Ge.crossTileID]=!0};if(Pe){if(e.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Ge=h.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let lt=Ge.length-1;lt>=0;--lt){const mt=Ge[lt];Ke(h.symbolInstances.get(mt),h.collisionArrays[mt],mt)}}else for(let Ge=e.symbolInstanceStart;Ge<e.symbolInstanceEnd;Ge++)Ke(h.symbolInstances.get(Ge),h.collisionArrays[Ge],Ge);h.justReloaded=!1}storeCollisionData(e,i,u,h,g,v){if(u.textBox||u.iconBox){let S,P;this.collisionBoxArrays.has(e)?S=this.collisionBoxArrays.get(e):(S=new Map,this.collisionBoxArrays.set(e,S)),S.has(i)?P=S.get(i):(P={text:null,icon:null},S.set(i,P)),u.textBox&&(P.text=h.box),u.iconBox&&(P.icon=g.box)}if(v){let S=this.collisionCircleArrays[e];S===void 0&&(S=this.collisionCircleArrays[e]=[]);for(let P=0;P<v.circles.length;P+=4)S.push(v.circles[P+0]-rr),S.push(v.circles[P+1]-rr),S.push(v.circles[P+2]),S.push(v.collisionDetected?1:0)}}markUsedJustification(e,i,u,h){let g;g=h===c.ag.vertical?u.verticalPlacedTextSymbolIndex:{left:u.leftJustifiedTextSymbolIndex,center:u.centerJustifiedTextSymbolIndex,right:u.rightJustifiedTextSymbolIndex}[c.az(i)];const v=[u.leftJustifiedTextSymbolIndex,u.centerJustifiedTextSymbolIndex,u.rightJustifiedTextSymbolIndex,u.verticalPlacedTextSymbolIndex];for(const S of v)S>=0&&(e.text.placedSymbolArray.get(S).crossTileID=g>=0&&S!==g?0:u.crossTileID)}markUsedOrientation(e,i,u){const h=i===c.ag.horizontal||i===c.ag.horizontalOnly?i:0,g=i===c.ag.vertical?i:0,v=[u.leftJustifiedTextSymbolIndex,u.centerJustifiedTextSymbolIndex,u.rightJustifiedTextSymbolIndex];for(const S of v)e.text.placedSymbolArray.get(S).placedOrientation=h;u.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(u.verticalPlacedTextSymbolIndex).placedOrientation=g)}commit(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;const i=this.prevPlacement;let u=!1;this.prevZoomAdjustment=i?i.zoomAdjustment(this.transform.zoom):0;const h=i?i.symbolFadeChange(e):1,g=i?i.opacities:{},v=i?i.variableOffsets:{},S=i?i.placedOrientations:{};for(const P in this.placements){const E=this.placements[P],k=g[P];k?(this.opacities[P]=new Xt(k,h,E.text,E.icon),u=u||E.text!==k.text.placed||E.icon!==k.icon.placed):(this.opacities[P]=new Xt(null,h,E.text,E.icon,E.skipFade),u=u||E.text||E.icon)}for(const P in g){const E=g[P];if(!this.opacities[P]){const k=new Xt(E,h,!1,!1);k.isHidden()||(this.opacities[P]=k,u=u||E.text.placed||E.icon.placed)}}for(const P in v)this.variableOffsets[P]||!this.opacities[P]||this.opacities[P].isHidden()||(this.variableOffsets[P]=v[P]);for(const P in S)this.placedOrientations[P]||!this.opacities[P]||this.opacities[P].isHidden()||(this.placedOrientations[P]=S[P]);if(i&&i.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");u?this.lastPlacementChangeTime=e:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=i?i.lastPlacementChangeTime:e)}updateLayerOpacities(e,i){const u={};for(const h of i){const g=h.getBucket(e);g&&h.latestFeatureIndex&&e.id===g.layerIds[0]&&this.updateBucketOpacities(g,h.tileID,u,h.collisionBoxArray)}}updateBucketOpacities(e,i,u,h){e.hasTextData()&&(e.text.opacityVertexArray.clear(),e.text.hasVisibleVertices=!1),e.hasIconData()&&(e.icon.opacityVertexArray.clear(),e.icon.hasVisibleVertices=!1),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();const g=e.layers[0],v=g.layout,S=new Xt(null,0,!1,!1,!0),P=v.get("text-allow-overlap"),E=v.get("icon-allow-overlap"),k=g._unevaluatedLayout.hasValue("text-variable-anchor")||g._unevaluatedLayout.hasValue("text-variable-anchor-offset"),R=v.get("text-rotation-alignment")==="map",L=v.get("text-pitch-alignment")==="map",N=v.get("icon-text-fit")!=="none",V=new Xt(null,0,P&&(E||!e.hasIconData()||v.get("icon-optional")),E&&(P||!e.hasTextData()||v.get("text-optional")),!0);!e.collisionArrays&&h&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(h);const J=(te,oe,ue)=>{for(let he=0;he<oe/4;he++)te.opacityVertexArray.emplaceBack(ue);te.hasVisibleVertices=te.hasVisibleVertices||ue!==qs},K=this.collisionBoxArrays.get(e.bucketInstanceId);for(let te=0;te<e.symbolInstances.length;te++){const oe=e.symbolInstances.get(te),{numHorizontalGlyphVertices:ue,numVerticalGlyphVertices:he,crossTileID:pe}=oe;let ge=this.opacities[pe];u[pe]?ge=S:ge||(ge=V,this.opacities[pe]=ge),u[pe]=!0;const fe=oe.numIconVertices>0,Pe=this.placedOrientations[oe.crossTileID],Ee=Pe===c.ag.vertical,Be=Pe===c.ag.horizontal||Pe===c.ag.horizontalOnly;if(ue>0||he>0){const Le=ku(ge.text);J(e.text,ue,Ee?qs:Le),J(e.text,he,Be?qs:Le);const Qe=ge.text.isHidden();[oe.rightJustifiedTextSymbolIndex,oe.centerJustifiedTextSymbolIndex,oe.leftJustifiedTextSymbolIndex].forEach(lt=>{lt>=0&&(e.text.placedSymbolArray.get(lt).hidden=Qe||Ee?1:0)}),oe.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(oe.verticalPlacedTextSymbolIndex).hidden=Qe||Be?1:0);const Ke=this.variableOffsets[oe.crossTileID];Ke&&this.markUsedJustification(e,Ke.anchor,oe,Pe);const Ge=this.placedOrientations[oe.crossTileID];Ge&&(this.markUsedJustification(e,"left",oe,Ge),this.markUsedOrientation(e,Ge,oe))}if(fe){const Le=ku(ge.icon),Qe=!(N&&oe.verticalPlacedIconSymbolIndex&&Ee);oe.placedIconSymbolIndex>=0&&(J(e.icon,oe.numIconVertices,Qe?Le:qs),e.icon.placedSymbolArray.get(oe.placedIconSymbolIndex).hidden=ge.icon.isHidden()),oe.verticalPlacedIconSymbolIndex>=0&&(J(e.icon,oe.numVerticalIconVertices,Qe?qs:Le),e.icon.placedSymbolArray.get(oe.verticalPlacedIconSymbolIndex).hidden=ge.icon.isHidden())}const je=K&&K.has(te)?K.get(te):{text:null,icon:null};if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){const Le=e.collisionArrays[te];if(Le){let Qe=new c.P(0,0);if(Le.textBox||Le.verticalTextBox){let Ke=!0;if(k){const Ge=this.variableOffsets[pe];Ge?(Qe=Ao(Ge.anchor,Ge.width,Ge.height,Ge.textOffset,Ge.textBoxScale),R&&Qe._rotate(L?-this.transform.bearingInRadians:this.transform.bearingInRadians)):Ke=!1}if(Le.textBox||Le.verticalTextBox){let Ge;Le.textBox&&(Ge=Ee),Le.verticalTextBox&&(Ge=Be),Iu(e.textCollisionBox.collisionVertexArray,ge.text.placed,!Ke||Ge,je.text,Qe.x,Qe.y)}}if(Le.iconBox||Le.verticalIconBox){const Ke=!!(!Be&&Le.verticalIconBox);let Ge;Le.iconBox&&(Ge=Ke),Le.verticalIconBox&&(Ge=!Ke),Iu(e.iconCollisionBox.collisionVertexArray,ge.icon.placed,Ge,je.icon,N?Qe.x:0,N?Qe.y:0)}}}}if(e.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.text.opacityVertexArray.length!==e.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${e.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${e.text.layoutVertexArray.length}) / 4`);if(e.icon.opacityVertexArray.length!==e.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${e.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${e.icon.layoutVertexArray.length}) / 4`);e.bucketInstanceId in this.collisionCircleArrays&&(e.collisionCircleArray=this.collisionCircleArrays[e.bucketInstanceId],delete this.collisionCircleArrays[e.bucketInstanceId])}symbolFadeChange(e){return this.fadeDuration===0?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(e){return Math.max(0,(this.transform.zoom-e)/1.5)}hasTransitions(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(e,i){const u=this.zoomAtLastRecencyCheck===i?1-this.zoomAdjustment(i):1;return this.zoomAtLastRecencyCheck=i,this.commitTime+this.fadeDuration*u>e}setStale(){this.stale=!0}}function Iu(f,e,i,u,h,g){u&&u.length!==0||(u=[0,0,0,0]);const v=u[0]-rr,S=u[1]-rr,P=u[2]-rr,E=u[3]-rr;f.emplaceBack(e?1:0,i?1:0,h||0,g||0,v,S),f.emplaceBack(e?1:0,i?1:0,h||0,g||0,P,S),f.emplaceBack(e?1:0,i?1:0,h||0,g||0,P,E),f.emplaceBack(e?1:0,i?1:0,h||0,g||0,v,E)}const ip=Math.pow(2,25),op=Math.pow(2,24),Gs=Math.pow(2,17),sp=Math.pow(2,16),Fg=Math.pow(2,9),Bg=Math.pow(2,8),Og=Math.pow(2,1);function ku(f){if(f.opacity===0&&!f.placed)return 0;if(f.opacity===1&&f.placed)return 4294967295;const e=f.placed?1:0,i=Math.floor(127*f.opacity);return i*ip+e*op+i*Gs+e*sp+i*Fg+e*Bg+i*Og+e}const qs=0;class Au{constructor(e){this._sortAcrossTiles=e.layout.get("symbol-z-order")!=="viewport-y"&&!e.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(e,i,u,h,g){const v=this._bucketParts;for(;this._currentTileIndex<e.length;)if(i.getBucketParts(v,h,e[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,g())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,v.sort((S,P)=>S.sortKey-P.sortKey));this._currentPartIndex<v.length;)if(i.placeLayerBucketPart(v[this._currentPartIndex],this._seenCrossTileIDs,u),this._currentPartIndex++,g())return!0;return!1}}class zu{constructor(e,i,u,h,g,v,S,P){this.placement=new Zs(e,i,v,S,P),this._currentPlacementIndex=u.length-1,this._forceFullPlacement=h,this._showCollisionBoxes=g,this._done=!1}isDone(){return this._done}continuePlacement(e,i,u){const h=H.now(),g=()=>!this._forceFullPlacement&&H.now()-h>2;for(;this._currentPlacementIndex>=0;){const v=i[e[this._currentPlacementIndex]],S=this.placement.collisionIndex.transform.zoom;if(v.type==="symbol"&&(!v.minzoom||v.minzoom<=S)&&(!v.maxzoom||v.maxzoom>S)){if(this._inProgressLayer||(this._inProgressLayer=new Au(v)),this._inProgressLayer.continuePlacement(u[v.source],this.placement,this._showCollisionBoxes,v,g))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(e){return this.placement.commit(e),this.placement}}const Ws=512/c.Z/2;class Ru{constructor(e,i,u){this.tileID=e,this.bucketInstanceId=u,this._symbolsByKey={};const h=new Map;for(let g=0;g<i.length;g++){const v=i.get(g),S=v.key,P=h.get(S);P?P.push(v):h.set(S,[v])}for(const[g,v]of h){const S={positions:v.map(P=>({x:Math.floor(P.anchorX*Ws),y:Math.floor(P.anchorY*Ws)})),crossTileIDs:v.map(P=>P.crossTileID)};if(S.positions.length>128){const P=new c.aB(S.positions.length,16,Uint16Array);for(const{x:E,y:k}of S.positions)P.add(E,k);P.finish(),delete S.positions,S.index=P}this._symbolsByKey[g]=S}}getScaledCoordinates(e,i){const{x:u,y:h,z:g}=this.tileID.canonical,{x:v,y:S,z:P}=i.canonical,E=Ws/Math.pow(2,P-g),k=(S*c.Z+e.anchorY)*E,R=h*c.Z*Ws;return{x:Math.floor((v*c.Z+e.anchorX)*E-u*c.Z*Ws),y:Math.floor(k-R)}}findMatches(e,i,u){const h=this.tileID.canonical.z<i.canonical.z?1:Math.pow(2,this.tileID.canonical.z-i.canonical.z);for(let g=0;g<e.length;g++){const v=e.get(g);if(v.crossTileID)continue;const S=this._symbolsByKey[v.key];if(!S)continue;const P=this.getScaledCoordinates(v,i);if(S.index){const E=S.index.range(P.x-h,P.y-h,P.x+h,P.y+h).sort();for(const k of E){const R=S.crossTileIDs[k];if(!u[R]){u[R]=!0,v.crossTileID=R;break}}}else if(S.positions)for(let E=0;E<S.positions.length;E++){const k=S.positions[E],R=S.crossTileIDs[E];if(Math.abs(k.x-P.x)<=h&&Math.abs(k.y-P.y)<=h&&!u[R]){u[R]=!0,v.crossTileID=R;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:e})=>e)}}class Lu{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Al{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(e){const i=Math.round((e-this.lng)/360);if(i!==0)for(const u in this.indexes){const h=this.indexes[u],g={};for(const v in h){const S=h[v];S.tileID=S.tileID.unwrapTo(S.tileID.wrap+i),g[S.tileID.key]=S}this.indexes[u]=g}this.lng=e}addBucket(e,i,u){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===i.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(let g=0;g<i.symbolInstances.length;g++)i.symbolInstances.get(g).crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]={});const h=this.usedCrossTileIDs[e.overscaledZ];for(const g in this.indexes){const v=this.indexes[g];if(Number(g)>e.overscaledZ)for(const S in v){const P=v[S];P.tileID.isChildOf(e)&&P.findMatches(i.symbolInstances,e,h)}else{const S=v[e.scaledTo(Number(g)).key];S&&S.findMatches(i.symbolInstances,e,h)}}for(let g=0;g<i.symbolInstances.length;g++){const v=i.symbolInstances.get(g);v.crossTileID||(v.crossTileID=u.generate(),h[v.crossTileID]=!0)}return this.indexes[e.overscaledZ]===void 0&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new Ru(e,i.symbolInstances,i.bucketInstanceId),!0}removeBucketCrossTileIDs(e,i){for(const u of i.getCrossTileIDsLists())for(const h of u)delete this.usedCrossTileIDs[e][h]}removeStaleBuckets(e){let i=!1;for(const u in this.indexes){const h=this.indexes[u];for(const g in h)e[h[g].bucketInstanceId]||(this.removeBucketCrossTileIDs(u,h[g]),delete h[g],i=!0)}return i}}class Du{constructor(){this.layerIndexes={},this.crossTileIDs=new Lu,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(e,i,u){let h=this.layerIndexes[e.id];h===void 0&&(h=this.layerIndexes[e.id]=new Al);let g=!1;const v={};h.handleWrapJump(u);for(const S of i){const P=S.getBucket(e);P&&e.id===P.layerIds[0]&&(P.bucketInstanceId||(P.bucketInstanceId=++this.maxBucketInstanceId),h.addBucket(S.tileID,P,this.crossTileIDs)&&(g=!0),v[P.bucketInstanceId]=!0)}return h.removeStaleBuckets(v)&&(g=!0),g}pruneUnusedLayers(e){const i={};e.forEach(u=>{i[u]=!0});for(const u in this.layerIndexes)i[u]||delete this.layerIndexes[u]}}var os="void main() {fragColor=vec4(1.0);}";const bi={prelude:Ft(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:Ft("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:Ft("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:Ft(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:Ft(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Ft(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Ft(os,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:Ft(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:Ft(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Ft("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Ft("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Ft("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:Ft(os,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:Ft(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:Ft(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:Ft(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:Ft(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Ft(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Ft(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Ft(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));fragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Ft(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:Ft(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Ft(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Ft(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Ft(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Ft(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:Ft(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Ft(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Ft(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Ft("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:Ft("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:Ft("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:Ft("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:Ft(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:Ft("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function Ft(f,e){const i=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,u=e.match(/in ([\w]+) ([\w]+)/g),h=f.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),g=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),v=g?g.concat(h):h,S={};return{fragmentSource:f=f.replace(i,(P,E,k,R,L)=>(S[L]=!0,E==="define"?`
#ifndef HAS_UNIFORM_u_${L}
in ${k} ${R} ${L};
#else
uniform ${k} ${R} u_${L};
#endif
`:`
#ifdef HAS_UNIFORM_u_${L}
    ${k} ${R} ${L} = u_${L};
#endif
`)),vertexSource:e=e.replace(i,(P,E,k,R,L)=>{const N=R==="float"?"vec2":"vec4",V=L.match(/color/)?"color":N;return S[L]?E==="define"?`
#ifndef HAS_UNIFORM_u_${L}
uniform lowp float u_${L}_t;
in ${k} ${N} a_${L};
out ${k} ${R} ${L};
#else
uniform ${k} ${R} u_${L};
#endif
`:V==="vec4"?`
#ifndef HAS_UNIFORM_u_${L}
    ${L} = a_${L};
#else
    ${k} ${R} ${L} = u_${L};
#endif
`:`
#ifndef HAS_UNIFORM_u_${L}
    ${L} = unpack_mix_${V}(a_${L}, u_${L}_t);
#else
    ${k} ${R} ${L} = u_${L};
#endif
`:E==="define"?`
#ifndef HAS_UNIFORM_u_${L}
uniform lowp float u_${L}_t;
in ${k} ${N} a_${L};
#else
uniform ${k} ${R} u_${L};
#endif
`:V==="vec4"?`
#ifndef HAS_UNIFORM_u_${L}
    ${k} ${R} ${L} = a_${L};
#else
    ${k} ${R} ${L} = u_${L};
#endif
`:`
#ifndef HAS_UNIFORM_u_${L}
    ${k} ${R} ${L} = unpack_mix_${V}(a_${L}, u_${L}_t);
#else
    ${k} ${R} ${L} = u_${L};
#endif
`}),staticAttributes:u,staticUniforms:v}}class Wn{constructor(e,i,u){this.vertexBuffer=e,this.indexBuffer=i,this.segments=u}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var ii=c.aC([{name:"a_pos",type:"Int16",components:2}]);const Bt="#define PROJECTION_MERCATOR",zl="mercator";class Fu{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return zl}get shaderDefine(){return Bt}get shaderPreludeCode(){return bi.projectionMercator}get vertexShaderPreludeCode(){return bi.projectionMercator.vertexSource}get subdivisionGranularity(){return c.aD.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(e){}getMeshFromTileID(e,i,u,h,g){if(this._cachedMesh)return this._cachedMesh;const v=new c.aE;v.emplaceBack(0,0),v.emplaceBack(c.Z,0),v.emplaceBack(0,c.Z),v.emplaceBack(c.Z,c.Z);const S=e.createVertexBuffer(v,ii.members),P=c.aF.simpleSegment(0,0,4,2),E=new c.aG;E.emplaceBack(1,0,2),E.emplaceBack(1,2,3);const k=e.createIndexBuffer(E);return this._cachedMesh=new Wn(S,k,P),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(e){}}function oi(f,e){const i=c.ad(e.lat,-85.051129,c.aI);return new c.P(c.U(e.lng)*f,c.S(i)*f)}function cn(f,e){return new c.$(e.x/f,e.y/f).toLngLat()}function Yr(f){return f.cameraToCenterDistance*Math.min(.85*Math.tan(c.ac(90-f.pitch)),Math.tan(c.ac(89.25-f.pitch)))}function mr(f,e){const i=f.canonical,u=e/c.aH(i.z),h=i.x+Math.pow(2,i.z)*f.wrap,g=c.as(new Float64Array(16));return c.L(g,g,[h*u,i.y*u,0]),c.M(g,g,[u/c.Z,u/c.Z,1]),g}function Bu(f,e,i,u,h){const g=c.$.fromLngLat(f,e),v=h*c.aJ(1,f.lat),S=v*Math.cos(c.ac(i)),P=Math.sqrt(v*v-S*S),E=P*Math.sin(c.ac(-u)),k=P*Math.cos(c.ac(-u));return new c.$(g.x+E,g.y+k,g.z+S)}class Qr{constructor(e=0,i=0,u=0,h=0){if(isNaN(e)||e<0||isNaN(i)||i<0||isNaN(u)||u<0||isNaN(h)||h<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=i,this.left=u,this.right=h}interpolate(e,i,u){return i.top!=null&&e.top!=null&&(this.top=c.B.number(e.top,i.top,u)),i.bottom!=null&&e.bottom!=null&&(this.bottom=c.B.number(e.bottom,i.bottom,u)),i.left!=null&&e.left!=null&&(this.left=c.B.number(e.left,i.left,u)),i.right!=null&&e.right!=null&&(this.right=c.B.number(e.right,i.right,u)),this}getCenter(e,i){const u=c.ad((this.left+e-this.right)/2,0,e),h=c.ad((this.top+i-this.bottom)/2,0,i);return new c.P(u,h)}equals(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}clone(){return new Qr(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Cn(f,e){if(!f.renderWorldCopies||f.lngRange)return;const i=e.lng-f.center.lng;e.lng+=i>180?-360:i<-180?360:0}function Dn(f){return Math.max(0,Math.floor(f))}class Rl{constructor(e,i,u,h,g,v){this._callbacks=e,this._tileSize=512,this._renderWorldCopies=v===void 0||!!v,this._minZoom=i||0,this._maxZoom=u||22,this._minPitch=h??0,this._maxPitch=g??60,this.setMaxBounds(),this._width=0,this._height=0,this._center=new c.Q(0,0),this._elevation=0,this._zoom=0,this._tileZoom=Dn(this._zoom),this._scale=c.aH(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new Qr,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(e,i,u){this._latRange=e.latRange,this._lngRange=e.lngRange,this._width=e.width,this._height=e.height,this._center=e.center,this._elevation=e.elevation,this._minElevationForCurrentTile=e.minElevationForCurrentTile,this._zoom=e.zoom,this._tileZoom=Dn(this._zoom),this._scale=c.aH(this._zoom),this._bearingInRadians=e.bearingInRadians,this._fovInRadians=e.fovInRadians,this._pitchInRadians=e.pitchInRadians,this._rollInRadians=e.rollInRadians,this._unmodified=e.unmodified,this._edgeInsets=new Qr(e.padding.top,e.padding.bottom,e.padding.left,e.padding.right),this._minZoom=e.minZoom,this._maxZoom=e.maxZoom,this._minPitch=e.minPitch,this._maxPitch=e.maxPitch,this._renderWorldCopies=e.renderWorldCopies,this._cameraToCenterDistance=e.cameraToCenterDistance,this._nearZ=e.nearZ,this._farZ=e.farZ,this._autoCalculateNearFarZ=!u&&e.autoCalculateNearFarZ,i&&this._constrain(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(e){this._minElevationForCurrentTile=e}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(e){this._minZoom!==e&&(this._minZoom=e,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(e){this._maxZoom!==e&&(this._maxZoom=e,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(e){this._minPitch!==e&&(this._minPitch=e,this.setPitch(Math.max(this.pitch,e)))}get maxPitch(){return this._maxPitch}setMaxPitch(e){this._maxPitch!==e&&(this._maxPitch=e,this.setPitch(Math.min(this.pitch,e)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(e){e===void 0?e=!0:e===null&&(e=!1),this._renderWorldCopies=e}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new c.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(e){const i=c.aK(e,-180,180)*Math.PI/180;var u,h,g,v,S,P,E,k,R;this._bearingInRadians!==i&&(this._unmodified=!1,this._bearingInRadians=i,this._calcMatrices(),this._rotationMatrix=j(),u=this._rotationMatrix,g=-this._bearingInRadians,v=(h=this._rotationMatrix)[0],S=h[1],P=h[2],E=h[3],k=Math.sin(g),R=Math.cos(g),u[0]=v*R+P*k,u[1]=S*R+E*k,u[2]=v*-k+P*R,u[3]=S*-k+E*R)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(e){const i=c.ad(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==i&&(this._unmodified=!1,this._pitchInRadians=i,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(e){const i=e/180*Math.PI;this._rollInRadians!==i&&(this._unmodified=!1,this._rollInRadians=i,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return c.aL(this._fovInRadians)}setFov(e){e=c.ad(e,.1,150),this.fov!==e&&(this._unmodified=!1,this._fovInRadians=c.ac(e),this._calcMatrices())}get zoom(){return this._zoom}setZoom(e){const i=this.getConstrained(this._center,e).zoom;this._zoom!==i&&(this._unmodified=!1,this._zoom=i,this._tileZoom=Math.max(0,Math.floor(i)),this._scale=c.aH(i),this._constrain(),this._calcMatrices())}get center(){return this._center}setCenter(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(e){e!==this._elevation&&(this._elevation=e,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(e,i){this._autoCalculateNearFarZ=!1,this._nearZ=e,this._farZ=i,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(e){return this._edgeInsets.equals(e)}interpolatePadding(e,i,u){this._unmodified=!1,this._edgeInsets.interpolate(e,i,u),this._constrain(),this._calcMatrices()}resize(e,i,u=!0){this._width=e,this._height=i,u&&this._constrain(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new or([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(e){e?(this._lngRange=[e.getWest(),e.getEast()],this._latRange=[e.getSouth(),e.getNorth()],this._constrain()):(this._lngRange=null,this._latRange=[-85.051129,c.aI])}getConstrained(e,i){return this._callbacks.getConstrained(e,i)}getCameraQueryGeometry(e,i){if(i.length===1)return[i[0],e];{let u=e.x,h=e.y,g=e.x,v=e.y;for(const S of i)u=Math.min(u,S.x),h=Math.min(h,S.y),g=Math.max(g,S.x),v=Math.max(v,S.y);return[new c.P(u,h),new c.P(g,h),new c.P(g,v),new c.P(u,v),new c.P(u,h)]}}_constrain(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const e=this._unmodified,{center:i,zoom:u}=this.getConstrained(this.center,this.zoom);this.setCenter(i),this.setZoom(u),this._unmodified=e,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let e=c.as(new Float64Array(16));c.M(e,e,[this._width/2,-this._height/2,1]),c.L(e,e,[1,-1,0]),this._clipSpaceToPixelsMatrix=e,e=c.as(new Float64Array(16)),c.M(e,e,[1,-1,1]),c.L(e,e,[-1,-1,0]),c.M(e,e,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=e,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(e,i,u,h){const g=u!==void 0?u:this.bearing,v=h=h!==void 0?h:this.pitch,S=c.$.fromLngLat(e,i),P=-Math.cos(c.ac(v)),E=Math.sin(c.ac(v)),k=E*Math.sin(c.ac(g)),R=-E*Math.cos(c.ac(g));let L=this.elevation;const N=i-L;let V;P*N>=0||Math.abs(P)<.1?(V=1e4,L=i+V*P):V=-N/P;let J,K,te=c.aM(1,S.y),oe=0;do{if(oe+=1,oe>10)break;K=V/te,J=new c.$(S.x+k*K,S.y+R*K),te=1/J.meterInMercatorCoordinateUnits()}while(Math.abs(V-K*te)>1e-12);return{center:J.toLngLat(),elevation:L,zoom:c.aa(this.height/2/Math.tan(this.fovInRadians/2)/K/this.tileSize)}}recalculateZoomAndCenter(e){if(this.elevation-e==0)return;const i=c.aJ(1,this.center.lat)*this.worldSize,u=this.cameraToCenterDistance/i,h=c.$.fromLngLat(this.center,this.elevation),g=Bu(this.center,this.elevation,this.pitch,this.bearing,u);this._elevation=e;const v=this.calculateCenterFromCameraLngLatAlt(g.toLngLat(),c.aM(g.z,h.y),this.bearing,this.pitch);this._elevation=v.elevation,this._center=v.center,this.setZoom(v.zoom)}getCameraPoint(){const e=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new c.P(e*Math.sin(this.rollInRadians),e*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const e=c.aJ(1,this.center.lat)*this.worldSize;return Bu(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/e).toLngLat()}getMercatorTileCoordinates(e){if(!e)return[0,0,1,1];const i=e.canonical.z>=0?1<<e.canonical.z:Math.pow(2,e.canonical.z);return[e.canonical.x/i,e.canonical.y/i,1/i/c.Z,1/i/c.Z]}}class wi{constructor(e,i){this.min=e,this.max=i,this.center=c.aN([],c.aO([],this.min,this.max),.5)}quadrant(e){const i=[e%2==0,e<2],u=c.aP(this.min),h=c.aP(this.max);for(let g=0;g<i.length;g++)u[g]=i[g]?this.min[g]:this.center[g],h[g]=i[g]?this.center[g]:this.max[g];return h[2]=this.max[2],new wi(u,h)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}intersectsFrustum(e){let i=!0;for(let u=0;u<e.planes.length;u++){const h=this.intersectsPlane(e.planes[u]);if(h===0)return 0;h===1&&(i=!1)}return i?2:e.aabb.min[0]>this.max[0]||e.aabb.min[1]>this.max[1]||e.aabb.min[2]>this.max[2]||e.aabb.max[0]<this.min[0]||e.aabb.max[1]<this.min[1]||e.aabb.max[2]<this.min[2]?0:1}intersectsPlane(e){let i=e[3],u=e[3];for(let h=0;h<3;h++)e[h]>0?(i+=e[h]*this.min[h],u+=e[h]*this.max[h]):(u+=e[h]*this.min[h],i+=e[h]*this.max[h]);return i>=0?2:u<0?0:1}}class Dr{distanceToTile2d(e,i,u,h){const g=h.distanceX([e,i]),v=h.distanceY([e,i]);return Math.hypot(g,v)}getWrap(e,i,u){return u}getTileAABB(e,i,u,h){var g,v;let S=u,P=u;if(h.terrain){const k=new c.Y(e.z,i,e.z,e.x,e.y),R=h.terrain.getMinMaxElevation(k);S=(g=R.minElevation)!==null&&g!==void 0?g:u,P=(v=R.maxElevation)!==null&&v!==void 0?v:u}const E=1<<e.z;return new wi([i+e.x/E,e.y/E,S],[i+(e.x+1)/E,(e.y+1)/E,P])}allowVariableZoom(e,i){const u=e.fov*(Math.abs(Math.cos(e.rollInRadians))*e.height+Math.abs(Math.sin(e.rollInRadians))*e.width)/e.height,h=c.ad(78.5-u/2,0,60);return!!i.terrain||e.pitch>h}allowWorldCopies(){return!0}recalculateCache(){}}class zo{constructor(e,i,u){this.points=e,this.planes=i,this.aabb=u}static fromInvProjectionMatrix(e,i=1,u=0){const h=Math.pow(2,u),g=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(E=>{const k=1/(E=c.ao([],E,e))[3]/i*h;return c.aQ(E,E,[k,k,1/E[3],k])}),v=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(E=>{const k=c.aR([],g[E[0]],g[E[1]]),R=c.aR([],g[E[2]],g[E[1]]),L=c.aS([],c.aT([],k,R)),N=-c.aU(L,g[E[1]]);return L.concat(N)}),S=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],P=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const E of g)for(let k=0;k<3;k++)S[k]=Math.min(S[k],E[k]),P[k]=Math.max(P[k],E[k]);return new zo(g,v,new wi(S,P))}}class si{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,i,u){return this._helper.interpolatePadding(e,i,u)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,i,u=!0){this._helper.resize(e,i,u)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,i){this._helper.overrideNearFarZ(e,i)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e,i){}constructor(e,i,u,h,g){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this._helper=new Rl({calcMatrices:()=>{this._calcMatrices()},getConstrained:(v,S)=>this.getConstrained(v,S)},e,i,u,h,g),this._coveringTilesDetailsProvider=new Dr}clone(){const e=new si;return e.apply(this),e}apply(e,i,u){this._helper.apply(e,i,u)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(e){const i=[new c.aV(0,e)];if(this._helper._renderWorldCopies){const u=this.screenPointToMercatorCoordinate(new c.P(0,0)),h=this.screenPointToMercatorCoordinate(new c.P(this._helper._width,0)),g=this.screenPointToMercatorCoordinate(new c.P(this._helper._width,this._helper._height)),v=this.screenPointToMercatorCoordinate(new c.P(0,this._helper._height)),S=Math.floor(Math.min(u.x,h.x,g.x,v.x)),P=Math.floor(Math.max(u.x,h.x,g.x,v.x)),E=1;for(let k=S-E;k<=P+E;k++)k!==0&&i.push(new c.aV(k,e))}return i}getCameraFrustum(){return zo.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){const i=this.screenPointToLocation(this.centerPoint,e),u=e?e.getElevationForLngLatZoom(i,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(u)}setLocationAtPoint(e,i){const u=c.aJ(this.elevation,this.center.lat),h=this.screenPointToMercatorCoordinateAtZ(i,u),g=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,u),v=c.$.fromLngLat(e),S=new c.$(v.x-(h.x-g.x),v.y-(h.y-g.y));this.setCenter(S==null?void 0:S.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(e,i){return i?this.coordinatePoint(c.$.fromLngLat(e),i.getElevationForLngLatZoom(e,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(c.$.fromLngLat(e))}screenPointToLocation(e,i){var u;return(u=this.screenPointToMercatorCoordinate(e,i))===null||u===void 0?void 0:u.toLngLat()}screenPointToMercatorCoordinate(e,i){if(i){const u=i.pointCoordinate(e);if(u!=null)return u}return this.screenPointToMercatorCoordinateAtZ(e)}screenPointToMercatorCoordinateAtZ(e,i){const u=i||0,h=[e.x,e.y,0,1],g=[e.x,e.y,1,1];c.ao(h,h,this._pixelMatrixInverse),c.ao(g,g,this._pixelMatrixInverse);const v=h[3],S=g[3],P=h[1]/v,E=g[1]/S,k=h[2]/v,R=g[2]/S,L=k===R?0:(u-k)/(R-k);return new c.$(c.B.number(h[0]/v,g[0]/S,L)/this.worldSize,c.B.number(P,E,L)/this.worldSize,u)}coordinatePoint(e,i=0,u=this._pixelMatrix){const h=[e.x*this.worldSize,e.y*this.worldSize,i,1];return c.ao(h,h,u),new c.P(h[0]/h[3],h[1]/h[3])}getBounds(){const e=Math.max(0,this._helper._height/2-Yr(this));return new or().extend(this.screenPointToLocation(new c.P(0,e))).extend(this.screenPointToLocation(new c.P(this._helper._width,e))).extend(this.screenPointToLocation(new c.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new c.P(0,this._helper._height)))}isPointOnMapSurface(e,i){return i?i.pointCoordinate(e)!=null:e.y>this.height/2-Yr(this)}calculatePosMatrix(e,i=!1,u){var h;const g=(h=e.key)!==null&&h!==void 0?h:c.aW(e.wrap,e.canonical.z,e.canonical.z,e.canonical.x,e.canonical.y),v=i?this._alignedPosMatrixCache:this._posMatrixCache;if(v.has(g)){const E=v.get(g);return u?E.f32:E.f64}const S=mr(e,this.worldSize);c.N(S,i?this._alignedProjMatrix:this._viewProjMatrix,S);const P={f64:S,f32:new Float32Array(S)};return v.set(g,P),u?P.f32:P.f64}calculateFogMatrix(e){const i=e.key,u=this._fogMatrixCacheF32;if(u.has(i))return u.get(i);const h=mr(e,this.worldSize);return c.N(h,this._fogMatrix,h),u.set(i,new Float32Array(h)),u.get(i)}getConstrained(e,i){i=c.ad(+i,this.minZoom,this.maxZoom);const u={center:new c.Q(e.lng,e.lat),zoom:i};let h=this._helper._lngRange;this._helper._renderWorldCopies||h!==null||(h=[-179.9999999999,180-1e-10]);const g=this.tileSize*c.aH(u.zoom);let v=0,S=g,P=0,E=g,k=0,R=0;const{x:L,y:N}=this.size;if(this._helper._latRange){const ue=this._helper._latRange;v=c.S(ue[1])*g,S=c.S(ue[0])*g,S-v<N&&(k=N/(S-v))}h&&(P=c.aK(c.U(h[0])*g,0,g),E=c.aK(c.U(h[1])*g,0,g),E<P&&(E+=g),E-P<L&&(R=L/(E-P)));const{x:V,y:J}=oi(g,e);let K,te;const oe=Math.max(R||0,k||0);if(oe){const ue=new c.P(R?(E+P)/2:V,k?(S+v)/2:J);return u.center=cn(g,ue).wrap(),u.zoom+=c.aa(oe),u}if(this._helper._latRange){const ue=N/2;J-ue<v&&(te=v+ue),J+ue>S&&(te=S-ue)}if(h){const ue=(P+E)/2;let he=V;this._helper._renderWorldCopies&&(he=c.aK(V,ue-g/2,ue+g/2));const pe=L/2;he-pe<P&&(K=P+pe),he+pe>E&&(K=E-pe)}if(K!==void 0||te!==void 0){const ue=new c.P(K??V,te??J);u.center=cn(g,ue).wrap()}return u}calculateCenterFromCameraLngLatAlt(e,i,u,h){return this._helper.calculateCenterFromCameraLngLatAlt(e,i,u,h)}_calculateNearFarZIfNeeded(e,i,u){if(!this._helper.autoCalculateNearFarZ)return;const h=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),g=e-h*this._helper._pixelPerMeter/Math.cos(i),v=h<0?g:e,S=Math.PI/2+this.pitchInRadians,P=c.ac(this.fov)*(Math.abs(Math.cos(c.ac(this.roll)))*this.height+Math.abs(Math.sin(c.ac(this.roll)))*this.width)/this.height*(.5+u.y/this.height),E=Math.sin(P)*v/Math.sin(c.ad(Math.PI-S-P,.01,Math.PI-.01)),k=Yr(this),R=Math.atan(k/this._helper.cameraToCenterDistance),L=c.ac(.75),N=R>L?2*R*(.5+u.y/(2*k)):L,V=Math.sin(N)*v/Math.sin(c.ad(Math.PI-S-N,.01,Math.PI-.01)),J=Math.min(E,V);this._helper._farZ=1.01*(Math.cos(Math.PI/2-i)*J+v),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const e=this.centerOffset,i=oi(this.worldSize,this.center),u=i.x,h=i.y;this._helper._pixelPerMeter=c.aJ(1,this.center.lat)*this.worldSize;const g=c.ac(Math.min(this.pitch,89.25)),v=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(g));let S;this._calculateNearFarZIfNeeded(v,g,e),S=new Float64Array(16),c.aX(S,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),c.ai(this._invProjMatrix,S),S[8]=2*-e.x/this._helper._width,S[9]=2*e.y/this._helper._height,this._projectionMatrix=c.aY(S),c.M(S,S,[1,-1,1]),c.L(S,S,[0,0,-this._helper.cameraToCenterDistance]),c.aZ(S,S,-this.rollInRadians),c.a_(S,S,this.pitchInRadians),c.aZ(S,S,-this.bearingInRadians),c.L(S,S,[-u,-h,0]),this._mercatorMatrix=c.M([],S,[this.worldSize,this.worldSize,this.worldSize]),c.M(S,S,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=c.N(new Float64Array(16),this.clipSpaceToPixelsMatrix,S),c.L(S,S,[0,0,-this.elevation]),this._viewProjMatrix=S,this._invViewProjMatrix=c.ai([],S);const P=[0,0,-1,1];c.ao(P,P,this._invViewProjMatrix),this._cameraPosition=[P[0]/P[3],P[1]/P[3],P[2]/P[3]],this._fogMatrix=new Float64Array(16),c.aX(this._fogMatrix,this.fovInRadians,this.width/this.height,v,this._helper._farZ),this._fogMatrix[8]=2*-e.x/this.width,this._fogMatrix[9]=2*e.y/this.height,c.M(this._fogMatrix,this._fogMatrix,[1,-1,1]),c.L(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),c.aZ(this._fogMatrix,this._fogMatrix,-this.rollInRadians),c.a_(this._fogMatrix,this._fogMatrix,this.pitchInRadians),c.aZ(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),c.L(this._fogMatrix,this._fogMatrix,[-u,-h,0]),c.M(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),c.L(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=c.N(new Float64Array(16),this.clipSpaceToPixelsMatrix,S);const E=this._helper._width%2/2,k=this._helper._height%2/2,R=Math.cos(this.bearingInRadians),L=Math.sin(-this.bearingInRadians),N=u-Math.round(u)+R*E+L*k,V=h-Math.round(h)+R*k+L*E,J=new Float64Array(S);if(c.L(J,J,[N>.5?N-1:N,V>.5?V-1:V,0]),this._alignedProjMatrix=J,S=c.ai(new Float64Array(16),this._pixelMatrix),!S)throw new Error("failed to invert matrix");this._pixelMatrixInverse=S,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const e=this.screenPointToMercatorCoordinate(new c.P(0,0)),i=[e.x*this.worldSize,e.y*this.worldSize,0,1];return c.ao(i,i,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const e=c.aJ(1,this.center.lat)*this.worldSize;return Bu(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/e).toLngLat()}lngLatToCameraDepth(e,i){const u=c.$.fromLngLat(e),h=[u.x*this.worldSize,u.y*this.worldSize,i,1];return c.ao(h,h,this._viewProjMatrix),h[2]/h[3]}getProjectionData(e){const{overscaledTileID:i,aligned:u,applyTerrainMatrix:h}=e,g=this._helper.getMercatorTileCoordinates(i),v=i?this.calculatePosMatrix(i,u,!0):null;let S;return S=i&&i.terrainRttPosMatrix32f&&h?i.terrainRttPosMatrix32f:v||c.a$(),{mainMatrix:S,tileMercatorCoords:g,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:S}}isLocationOccluded(e){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(e,i,u){return 1}transformLightDirection(e){return c.aP(e)}getRayDirectionFromPixel(e){throw new Error("Not implemented.")}projectTileCoordinates(e,i,u,h){const g=this.calculatePosMatrix(u);let v;h?(v=[e,i,h(e,i),1],c.ao(v,v,g)):(v=[e,i,0,1],Nr(v,v,g));const S=v[3];return{point:new c.P(v[0]/S,v[1]/S),signedDistanceFromCamera:S,isOccluded:!1}}populateCache(e){for(const i of e)this.calculatePosMatrix(i)}getMatrixForModel(e,i){const u=c.$.fromLngLat(e,i),h=u.meterInMercatorCoordinateUnits(),g=c.b0();return c.L(g,g,[u.x,u.y,u.z]),c.aZ(g,g,Math.PI),c.a_(g,g,Math.PI/2),c.M(g,g,[-h,h,h]),g}getProjectionDataForCustomLayer(e=!0){const i=new c.Y(0,0,0,0,0),u=this.getProjectionData({overscaledTileID:i,applyGlobeMatrix:e}),h=mr(i,this.worldSize);c.N(h,this._viewProjMatrix,h),u.tileMercatorCoords=[0,0,1,1];const g=[c.Z,c.Z,this.worldSize/this._helper.pixelsPerMeter],v=c.b1();return c.M(v,h,g),u.fallbackMatrix=v,u.mainMatrix=v,u}getFastPathSimpleProjectionMatrix(e){return this.calculatePosMatrix(e)}}function $a(){c.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function ai(f){if(f.useSlerp)if(f.k<1){const e=c.b2(f.startEulerAngles.roll,f.startEulerAngles.pitch,f.startEulerAngles.bearing),i=c.b2(f.endEulerAngles.roll,f.endEulerAngles.pitch,f.endEulerAngles.bearing),u=new Float64Array(4);c.b3(u,e,i,f.k);const h=c.b4(u);f.tr.setRoll(h.roll),f.tr.setPitch(h.pitch),f.tr.setBearing(h.bearing)}else f.tr.setRoll(f.endEulerAngles.roll),f.tr.setPitch(f.endEulerAngles.pitch),f.tr.setBearing(f.endEulerAngles.bearing);else f.tr.setRoll(c.B.number(f.startEulerAngles.roll,f.endEulerAngles.roll,f.k)),f.tr.setPitch(c.B.number(f.startEulerAngles.pitch,f.endEulerAngles.pitch,f.k)),f.tr.setBearing(c.B.number(f.startEulerAngles.bearing,f.endEulerAngles.bearing,f.k))}function Ou(f,e,i,u,h){const g=h.padding,v=oi(h.worldSize,i.getNorthWest()),S=oi(h.worldSize,i.getNorthEast()),P=oi(h.worldSize,i.getSouthEast()),E=oi(h.worldSize,i.getSouthWest()),k=c.ac(-u),R=v.rotate(k),L=S.rotate(k),N=P.rotate(k),V=E.rotate(k),J=new c.P(Math.max(R.x,L.x,V.x,N.x),Math.max(R.y,L.y,V.y,N.y)),K=new c.P(Math.min(R.x,L.x,V.x,N.x),Math.min(R.y,L.y,V.y,N.y)),te=J.sub(K),oe=(h.width-(g.left+g.right+e.left+e.right))/te.x,ue=(h.height-(g.top+g.bottom+e.top+e.bottom))/te.y;if(ue<0||oe<0)return void $a();const he=Math.min(c.aa(h.scale*Math.min(oe,ue)),f.maxZoom),pe=c.P.convert(f.offset),ge=new c.P((e.left-e.right)/2,(e.top-e.bottom)/2).rotate(c.ac(u)),fe=pe.add(ge).mult(h.scale/c.aH(he));return{center:cn(h.worldSize,v.add(P).div(2).sub(fe)),zoom:he,bearing:u}}class Si{get useGlobeControls(){return!1}handlePanInertia(e,i){return{easingOffset:e,easingCenter:i.center}}handleMapControlsRollPitchBearingZoom(e,i){e.bearingDelta&&i.setBearing(i.bearing+e.bearingDelta),e.pitchDelta&&i.setPitch(i.pitch+e.pitchDelta),e.rollDelta&&i.setRoll(i.roll+e.rollDelta),e.zoomDelta&&i.setZoom(i.zoom+e.zoomDelta)}handleMapControlsPan(e,i,u){e.around.distSqr(i.centerPoint)<.01||i.setLocationAtPoint(u,e.around)}cameraForBoxAndBearing(e,i,u,h,g){return Ou(e,i,u,h,g)}handleJumpToCenterZoom(e,i){e.zoom!==(i.zoom!==void 0?+i.zoom:e.zoom)&&e.setZoom(+i.zoom),i.center!==void 0&&e.setCenter(c.Q.convert(i.center))}handleEaseTo(e,i){const u=e.zoom,h=e.padding,g={roll:e.roll,pitch:e.pitch,bearing:e.bearing},v={roll:i.roll===void 0?e.roll:i.roll,pitch:i.pitch===void 0?e.pitch:i.pitch,bearing:i.bearing===void 0?e.bearing:i.bearing},S=i.zoom!==void 0,P=!e.isPaddingEqual(i.padding);let E=!1;const k=S?+i.zoom:e.zoom;let R=e.centerPoint.add(i.offsetAsPoint);const L=e.screenPointToLocation(R),{center:N,zoom:V}=e.getConstrained(c.Q.convert(i.center||L),k??u);Cn(e,N);const J=oi(e.worldSize,L),K=oi(e.worldSize,N).sub(J),te=c.aH(V-u);return E=V!==u,{easeFunc:oe=>{if(E&&e.setZoom(c.B.number(u,V,oe)),c.b5(g,v)||ai({startEulerAngles:g,endEulerAngles:v,tr:e,k:oe,useSlerp:g.roll!=v.roll}),P&&(e.interpolatePadding(h,i.padding,oe),R=e.centerPoint.add(i.offsetAsPoint)),i.around)e.setLocationAtPoint(i.around,i.aroundPoint);else{const ue=c.aH(e.zoom-u),he=V>u?Math.min(2,te):Math.max(.5,te),pe=Math.pow(he,1-oe),ge=cn(e.worldSize,J.add(K.mult(oe*pe)).mult(ue));e.setLocationAtPoint(e.renderWorldCopies?ge.wrap():ge,R)}},isZooming:E,elevationCenter:N}}handleFlyTo(e,i){const u=i.zoom!==void 0,h=e.zoom,g=e.getConstrained(c.Q.convert(i.center||i.locationAtOffset),u?+i.zoom:h),v=g.center,S=g.zoom;Cn(e,v);const P=oi(e.worldSize,i.locationAtOffset),E=oi(e.worldSize,v).sub(P),k=E.mag(),R=c.aH(S-h);let L;if(i.minZoom!==void 0){const N=Math.min(+i.minZoom,h,S),V=e.getConstrained(v,N).zoom;L=c.aH(V-h)}return{easeFunc:(N,V,J,K)=>{e.setZoom(N===1?S:h+c.aa(V));const te=N===1?v:cn(e.worldSize,P.add(E.mult(J)).mult(V));e.setLocationAtPoint(e.renderWorldCopies?te.wrap():te,K)},scaleOfZoom:R,targetCenter:v,scaleOfMinZoom:L,pixelPathLength:k}}}class sr{constructor(e,i,u){this.blendFunction=e,this.blendColor=i,this.mask=u}}sr.Replace=[1,0],sr.disabled=new sr(sr.Replace,c.b6.transparent,[!1,!1,!1,!1]),sr.unblended=new sr(sr.Replace,c.b6.transparent,[!0,!0,!0,!0]),sr.alphaBlended=new sr([1,771],c.b6.transparent,[!0,!0,!0,!0]);const Ll=2305;class Rt{constructor(e,i,u){this.enable=e,this.mode=i,this.frontFace=u}}Rt.disabled=new Rt(!1,1029,Ll),Rt.backCCW=new Rt(!0,1029,Ll),Rt.frontCCW=new Rt(!0,1028,Ll);class Mt{constructor(e,i,u){this.func=e,this.mask=i,this.range=u}}Mt.ReadOnly=!1,Mt.ReadWrite=!0,Mt.disabled=new Mt(519,Mt.ReadOnly,[0,1]);const Hs=7680;class Dt{constructor(e,i,u,h,g,v){this.test=e,this.ref=i,this.mask=u,this.fail=h,this.depthFail=g,this.pass=v}}Dt.disabled=new Dt({func:519,mask:0},0,0,Hs,Hs,Hs);const Va=new WeakMap;function li(f){var e;if(Va.has(f))return Va.get(f);{const i=(e=f.getParameter(f.VERSION))===null||e===void 0?void 0:e.startsWith("WebGL 2.0");return Va.set(f,i),i}}class Ua{get awaitingQuery(){return!!this._readbackQueue}constructor(e){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=e;const i=e.context,u=i.gl;this._texFormat=u.RGBA,this._texType=u.UNSIGNED_BYTE;const h=new c.aE;h.emplaceBack(-1,-1),h.emplaceBack(2,-1),h.emplaceBack(-1,2);const g=new c.aG;g.emplaceBack(0,1,2),this._fullscreenTriangle=new Wn(i.createVertexBuffer(h,ii.members),i.createIndexBuffer(g),c.aF.simpleSegment(0,0,h.length,g.length)),this._resultBuffer=new Uint8Array(4),i.activeTexture.set(u.TEXTURE1);const v=u.createTexture();u.bindTexture(u.TEXTURE_2D,v),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,u.CLAMP_TO_EDGE),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,u.CLAMP_TO_EDGE),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,u.NEAREST),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,u.NEAREST),u.texImage2D(u.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=i.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(v),li(u)&&(this._pbo=u.createBuffer(),u.bindBuffer(u.PIXEL_PACK_BUFFER,this._pbo),u.bufferData(u.PIXEL_PACK_BUFFER,4,u.STREAM_READ),u.bindBuffer(u.PIXEL_PACK_BUFFER,null))}destroy(){const e=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),e.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(e,i){const u=this._updateCount;return this._readbackQueue?u>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():u>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(e,i),this._updateCount++,this._measuredError}_bindFramebuffer(){const e=this._cachedRenderContext.context,i=e.gl;e.activeTexture.set(i.TEXTURE1),i.bindTexture(i.TEXTURE_2D,this._fbo.colorAttachment.get()),e.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(e,i){const u=this._cachedRenderContext.context,h=u.gl;if(this._bindFramebuffer(),u.viewport.set([0,0,this._texWidth,this._texHeight]),u.clear({color:c.b6.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(u,h.TRIANGLES,Mt.disabled,Dt.disabled,sr.unblended,Rt.disabled,((g,v)=>({u_input:g,u_output_expected:v}))(e,i),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&li(h)){h.bindBuffer(h.PIXEL_PACK_BUFFER,this._pbo),h.readBuffer(h.COLOR_ATTACHMENT0),h.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),h.bindBuffer(h.PIXEL_PACK_BUFFER,null);const g=h.fenceSync(h.SYNC_GPU_COMMANDS_COMPLETE,0);h.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:g}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const e=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&li(e)){const i=e.clientWaitSync(this._readbackQueue.sync,0,0);if(i===e.WAIT_FAILED)return c.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(i===e.TIMEOUT_EXPIRED)return;e.bindBuffer(e.PIXEL_PACK_BUFFER,this._pbo),e.getBufferSubData(e.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),e.bindBuffer(e.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),e.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=Ua._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(e){let i=0;return i+=e[0]/256,i+=e[1]/65536,i+=e[2]/16777216,e[3]<127&&(i=-i),i/128}}const Dl=c.Z/128;function Za(f,e){const i=f.granularity!==void 0?Math.max(f.granularity,1):1,u=i+(f.generateBorders?2:0),h=i+(f.extendToNorthPole||f.generateBorders?1:0)+(f.extendToSouthPole||f.generateBorders?1:0),g=u+1,v=h+1,S=f.generateBorders?-1:0,P=f.generateBorders||f.extendToNorthPole?-1:0,E=i+(f.generateBorders?1:0),k=i+(f.generateBorders||f.extendToSouthPole?1:0),R=g*v,L=u*h*6,N=g*v>65536;if(N&&e==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const V=N||e==="32bit",J=new Int16Array(2*R);let K=0;for(let ue=P;ue<=k;ue++)for(let he=S;he<=E;he++){let pe=he/i*c.Z;he===-1&&(pe=-64),he===i+1&&(pe=c.Z+Dl);let ge=ue/i*c.Z;ue===-1&&(ge=f.extendToNorthPole?c.b8:-64),ue===i+1&&(ge=f.extendToSouthPole?c.b9:c.Z+Dl),J[K++]=pe,J[K++]=ge}const te=V?new Uint32Array(L):new Uint16Array(L);let oe=0;for(let ue=0;ue<h;ue++)for(let he=0;he<u;he++){const pe=he+1+ue*g,ge=he+(ue+1)*g,fe=he+1+(ue+1)*g;te[oe++]=he+ue*g,te[oe++]=ge,te[oe++]=pe,te[oe++]=pe,te[oe++]=ge,te[oe++]=fe}return{vertices:J.buffer.slice(0),indices:te.buffer.slice(0),uses32bitIndices:V}}const Xs=new c.aD({fill:new c.ba(128,2),line:new c.ba(512,0),tile:new c.ba(128,32),stencil:new c.ba(128,1),circle:3});class Ks{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return bi.projectionGlobe}get vertexShaderPreludeCode(){return bi.projectionMercator.vertexSource}get subdivisionGranularity(){return Xs}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(e){this._errorMeasurement||(this._errorMeasurement=new Ua(e));const i=c.S(this._errorQueryLatitudeDegrees),u=2*Math.atan(Math.exp(Math.PI-i*Math.PI*2))-.5*Math.PI,h=this._errorMeasurement.updateErrorLoop(i,u),g=H.now();h!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=h,this._errorMeasurementLastChangeTime=g);const v=Math.min(Math.max((g-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=c.bb(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,c.bc(v))}_getMeshKey(e){return`${e.granularity.toString(36)}_${e.generateBorders?"b":""}${e.extendToNorthPole?"n":""}${e.extendToSouthPole?"s":""}`}getMeshFromTileID(e,i,u,h,g){const v=(g==="stencil"?Xs.stencil:Xs.tile).getGranularityForZoomLevel(i.z);return this._getMesh(e,{granularity:v,generateBorders:u,extendToNorthPole:i.y===0&&h,extendToSouthPole:i.y===(1<<i.z)-1&&h})}_getMesh(e,i){const u=this._getMeshKey(i);if(u in this._tileMeshCache)return this._tileMeshCache[u];const h=function(g,v){const S=Za(v,"16bit"),P=c.aE.deserialize({arrayBuffer:S.vertices,length:S.vertices.byteLength/2/2}),E=c.aG.deserialize({arrayBuffer:S.indices,length:S.indices.byteLength/2/3});return new Wn(g.createVertexBuffer(P,ii.members),g.createIndexBuffer(E),c.aF.simpleSegment(0,0,P.length,E.length))}(e,i);return this._tileMeshCache[u]=h,h}recalculate(e){}hasTransition(){const e=H.now();let i=!1;return i=i||(e-this._errorMeasurementLastChangeTime)/1e3<.7,i=i||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,i}setErrorQueryLatitudeDegrees(e){this._errorQueryLatitudeDegrees=e}}const jg=new c.r({type:new c.D(c.v.projection.type)});class Fl extends c.E{constructor(e){super(),this._transitionable=new c.T(jg),this.setProjection(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new c.C(0)),this._mercatorProjection=new Fu,this._verticalPerspectiveProjection=new Ks}get transitionState(){const e=this.properties.get("type");if(typeof e=="string"&&e==="mercator")return 0;if(typeof e=="string"&&e==="vertical-perspective")return 1;if(e instanceof c.bd){if(e.from==="vertical-perspective"&&e.to==="mercator")return 1-e.transition;if(e.from==="mercator"&&e.to==="vertical-perspective")return e.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(e){this._mercatorProjection.updateGPUdependent(e),this._verticalPerspectiveProjection.updateGPUdependent(e)}getMeshFromTileID(e,i,u,h,g){return this.currentProjection.getMeshFromTileID(e,i,u,h,g)}setProjection(e){this._transitionable.setValue("type",(e==null?void 0:e.type)||"mercator")}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}setErrorQueryLatitudeDegrees(e){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(e),this._mercatorProjection.setErrorQueryLatitudeDegrees(e)}}function ju(f){const e=yn(f.worldSize,f.center.lat);return 2*Math.PI*e}function Ga(f,e,i,u,h){const g=1/(1<<h),v=e/c.Z*g+u*g,S=c.bf((f/c.Z*g+i*g)*Math.PI*2+Math.PI,2*Math.PI),P=2*Math.atan(Math.exp(Math.PI-v*Math.PI*2))-.5*Math.PI,E=Math.cos(P),k=new Float64Array(3);return k[0]=Math.sin(S)*E,k[1]=Math.sin(P),k[2]=Math.cos(S)*E,k}function _n(f){return function(e,i){const u=Math.cos(i),h=new Float64Array(3);return h[0]=Math.sin(e)*u,h[1]=Math.sin(i),h[2]=Math.cos(e)*u,h}(f.lng*Math.PI/180,f.lat*Math.PI/180)}function yn(f,e){return f/(2*Math.PI)/Math.cos(e*Math.PI/180)}function Bl(f){const e=Math.asin(f[1])/Math.PI*180,i=Math.sqrt(f[0]*f[0]+f[2]*f[2]);if(i>1e-6){const u=f[0]/i,h=Math.acos(f[2]/i),g=(u>0?h:-h)/Math.PI*180;return new c.Q(c.aK(g,-180,180),e)}return new c.Q(0,e)}function Hn(f){return Math.cos(f*Math.PI/180)}function Er(f,e){const i=Hn(f),u=Hn(e);return c.aa(u/i)}function Nu(f,e){const i=f.rotate(e.bearingInRadians),u=e.zoom+Er(e.center.lat,0),h=c.bb(1/Hn(e.center.lat),1/Hn(Math.min(Math.abs(e.center.lat),60)),c.be(u,7,3,0,1)),g=360/ju({worldSize:e.worldSize,center:{lat:e.center.lat}});return new c.Q(e.center.lng-i.x*g*h,c.ad(e.center.lat+i.y*g,-85.051129,c.aI))}function Ol(f){const e=.5*f,i=Math.sin(e),u=Math.cos(e);return Math.log(i+u)-Math.log(u-i)}function ss(f,e,i,u){const h=f.lat+i*u;if(Math.abs(i)>1){const g=(Math.sign(f.lat+i)!==Math.sign(f.lat)?-Math.abs(f.lat):Math.abs(f.lat))*Math.PI/180,v=Math.abs(f.lat+i)*Math.PI/180,S=Ol(g+u*(v-g)),P=Ol(g),E=Ol(v);return new c.Q(f.lng+e*((S-P)/(E-P)),h)}return new c.Q(f.lng+e*u,h)}class Ng{constructor(e){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._aabbFactory=e}recalculateCache(){if(!this._hadAnyChanges)return;const e=this._cachePrevious;this._cachePrevious=this._cache,this._cache=e,this._cache.clear(),this._hadAnyChanges=!1}getTileAABB(e,i,u,h){const g=`${e.z}_${e.x}_${e.y}`,v=this._cache.get(g);if(v)return v;const S=this._cachePrevious.get(g);if(S)return this._cache.set(g,S),S;const P=this._aabbFactory(e,i,u,h);return this._cache.set(g,P),this._hadAnyChanges=!0,P}}function jl(f,e,i){const u=f-e;return u<0?-u:Math.max(0,u-i)}function $u(f,e,i,u,h){const g=f-i;let v;return v=g<0?Math.min(-g,1+g-h):g>1?Math.min(Math.max(g-h,0),1-g):0,Math.max(v,jl(e,u,h))}class $g{constructor(){this._aabbCache=new Ng(this._computeTileAABB)}recalculateCache(){this._aabbCache.recalculateCache()}distanceToTile2d(e,i,u,h){const g=1<<u.z,v=1/g,S=u.x/g,P=u.y/g;let E=2;return E=Math.min(E,$u(e,i,S,P,v)),E=Math.min(E,$u(e,i,S+.5,-P-v,v)),E=Math.min(E,$u(e,i,S+.5,2-P-v,v)),E}getWrap(e,i,u){const h=1<<i.z,g=1/h,v=i.x/h,S=jl(e.x,v,g),P=jl(e.x,v-1,g),E=jl(e.x,v+1,g),k=Math.min(S,P,E);return k===E?1:k===P?-1:0}allowVariableZoom(e,i){return ho(e,i)>4}allowWorldCopies(){return!1}getTileAABB(e,i,u,h){return this._aabbCache.getTileAABB(e,i,u,h)}_computeTileAABB(e,i,u,h){if(e.z<=0)return new wi([-1,-1,-1],[1,1,1]);if(e.z===1)return new wi([e.x===0?-1:0,e.y===0?0:-1,-1],[e.x===0?0:1,e.y===0?1:0,1]);{const g=[Ga(0,0,e.x,e.y,e.z),Ga(c.Z,0,e.x,e.y,e.z),Ga(c.Z,c.Z,e.x,e.y,e.z),Ga(0,c.Z,e.x,e.y,e.z)],v=[1,1,1],S=[-1,-1,-1];for(const P of g)for(let E=0;E<3;E++)v[E]=Math.min(v[E],P[E]),S[E]=Math.max(S[E],P[E]);if(e.y===0||e.y===(1<<e.z)-1){const P=[0,e.y===0?1:-1,0];for(let E=0;E<3;E++)v[E]=Math.min(v[E],P[E]),S[E]=Math.max(S[E],P[E])}return new wi(v,S)}}}class Nl{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,i,u){return this._helper.interpolatePadding(e,i,u)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,i){this._helper.resize(e,i)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,i){this._helper.overrideNearFarZ(e,i)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e){}constructor(){this._cachedClippingPlane=c.bg(),this._projectionMatrix=c.b0(),this._globeViewProjMatrix32f=c.a$(),this._globeViewProjMatrixNoCorrection=c.b0(),this._globeViewProjMatrixNoCorrectionInverted=c.b0(),this._globeProjMatrixInverted=c.b0(),this._cameraPosition=c.bh(),this._globeLatitudeErrorCorrectionRadians=0,this._helper=new Rl({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,i)=>this.getConstrained(e,i)}),this._coveringTilesDetailsProvider=new $g}clone(){const e=new Nl;return e.apply(this),e}apply(e,i){this._globeLatitudeErrorCorrectionRadians=i||0,this._helper.apply(e)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const e=c.bh();return e[0]=this._cameraPosition[0],e[1]=this._cameraPosition[1],e[2]=this._cameraPosition[2],e}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(e){const{overscaledTileID:i,applyGlobeMatrix:u}=e,h=this._helper.getMercatorTileCoordinates(i);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:h,clippingPlane:this._cachedClippingPlane,projectionTransition:u?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(e){const i=this.pitchInRadians,u=this.cameraToCenterDistance/e,h=Math.sin(i)*u,g=Math.cos(i)*u+1,v=1/Math.sqrt(h*h+g*g)*1;let S=-h,P=g;const E=Math.sqrt(S*S+P*P);S/=E,P/=E;const k=[0,S,P];return c.bi(k,k,[0,0,0],-this.bearingInRadians),c.bj(k,k,[0,0,0],-1*this.center.lat*Math.PI/180),c.bk(k,k,[0,0,0],this.center.lng*Math.PI/180),c.aN(k,k,.25),[...k,.25*-v]}isLocationOccluded(e){return!this.isSurfacePointVisible(_n(e))}transformLightDirection(e){const i=this._helper._center.lng*Math.PI/180,u=this._helper._center.lat*Math.PI/180,h=Math.cos(u),g=[Math.sin(i)*h,Math.sin(u),Math.cos(i)*h],v=[g[2],0,-g[0]],S=[0,0,0];c.aT(S,v,g),c.aS(v,v),c.aS(S,S);const P=[0,0,0];return c.aS(P,[v[0]*e[0]+S[0]*e[1]+g[0]*e[2],v[1]*e[0]+S[1]*e[1]+g[1]*e[2],v[2]*e[0]+S[2]*e[1]+g[2]*e[2]]),P}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(e,i,u){const h=function(S,P,E){const k=1/(1<<E.z);return new c.$(S/c.Z*k+E.x*k,P/c.Z*k+E.y*k)}(e,i,u.canonical),g=(v=h.y,[c.bf(h.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-v*Math.PI*2))-.5*Math.PI]);var v;return this.getCircleRadiusCorrection()/Math.cos(g[1])}projectTileCoordinates(e,i,u,h){const g=u.canonical,v=Ga(e,i,g.x,g.y,g.z),S=1+(h?h(e,i):0)/c.bq,P=[v[0]*S,v[1]*S,v[2]*S,1];c.ao(P,P,this._globeViewProjMatrixNoCorrection);const E=this._cachedClippingPlane,k=E[0]*v[0]+E[1]*v[1]+E[2]*v[2]+E[3]<0;return{point:new c.P(P[0]/P[3],P[1]/P[3]),signedDistanceFromCamera:P[3],isOccluded:k}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const e=yn(this.worldSize,this.center.lat),i=c.b1(),u=c.b1();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*e),c.aX(i,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const h=this.centerOffset;i[8]=2*-h.x/this._helper._width,i[9]=2*h.y/this._helper._height,this._projectionMatrix=c.aY(i),this._globeProjMatrixInverted=c.b1(),c.ai(this._globeProjMatrixInverted,i),c.L(i,i,[0,0,-this.cameraToCenterDistance]),c.aZ(i,i,this.rollInRadians),c.a_(i,i,-this.pitchInRadians),c.aZ(i,i,this.bearingInRadians),c.L(i,i,[0,0,-e]);const g=c.bh();g[0]=e,g[1]=e,g[2]=e,c.a_(u,i,this.center.lat*Math.PI/180),c.bl(u,u,-this.center.lng*Math.PI/180),c.M(u,u,g),this._globeViewProjMatrixNoCorrection=u,c.a_(i,i,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),c.bl(i,i,-this.center.lng*Math.PI/180),c.M(i,i,g),this._globeViewProjMatrix32f=new Float32Array(i),this._globeViewProjMatrixNoCorrectionInverted=c.b1(),c.ai(this._globeViewProjMatrixNoCorrectionInverted,u);const v=c.bh();this._cameraPosition=c.bh(),this._cameraPosition[2]=this.cameraToCenterDistance/e,c.bi(this._cameraPosition,this._cameraPosition,v,-this.rollInRadians),c.bj(this._cameraPosition,this._cameraPosition,v,this.pitchInRadians),c.bi(this._cameraPosition,this._cameraPosition,v,-this.bearingInRadians),c.aO(this._cameraPosition,this._cameraPosition,[0,0,1]),c.bj(this._cameraPosition,this._cameraPosition,v,-this.center.lat*Math.PI/180),c.bk(this._cameraPosition,this._cameraPosition,v,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(e);const S=c.aY(this._globeViewProjMatrixNoCorrectionInverted);c.M(S,S,[1,1,-1]),this._cachedFrustum=zo.fromInvProjectionMatrix(S)}calculateFogMatrix(e){c.w("calculateFogMatrix is not supported on globe projection.");const i=c.b1();return c.as(i),i}getVisibleUnwrappedCoordinates(e){return[new c.aV(0,e)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){e&&c.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,i){if(!this._globeViewProjMatrixNoCorrection)return 1;const u=_n(e);c.aN(u,u,1+i/c.bq);const h=c.bg();return c.ao(h,[u[0],u[1],u[2],1],this._globeViewProjMatrixNoCorrection),h[2]/h[3]}populateCache(e){}getBounds(){const e=.5*this.width,i=.5*this.height,u=[new c.P(0,0),new c.P(e,0),new c.P(this.width,0),new c.P(this.width,i),new c.P(this.width,this.height),new c.P(e,this.height),new c.P(0,this.height),new c.P(0,i)],h=[];for(const R of u)h.push(this.unprojectScreenPoint(R));let g=0,v=0,S=0,P=0;const E=this.center;for(const R of h){const L=c.bm(E.lng,R.lng),N=c.bm(E.lat,R.lat);L<v&&(v=L),L>g&&(g=L),N<P&&(P=N),N>S&&(S=N)}const k=[E.lng+v,E.lat+P,E.lng+g,E.lat+S];return this.isSurfacePointOnScreen([0,1,0])&&(k[3]=90,k[0]=-180,k[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(k[1]=-90,k[0]=-180,k[2]=180),new or(k)}getConstrained(e,i){const u=c.ad(e.lat,-85.051129,c.aI),h=c.ad(+i,this.minZoom+Er(0,u),this.maxZoom);return{center:new c.Q(e.lng,u),zoom:h}}calculateCenterFromCameraLngLatAlt(e,i,u,h){return this._helper.calculateCenterFromCameraLngLatAlt(e,i,u,h)}setLocationAtPoint(e,i){const u=_n(this.unprojectScreenPoint(i)),h=_n(e),g=c.bh();c.bn(g);const v=c.bh();c.bk(v,u,g,-this.center.lng*Math.PI/180),c.bj(v,v,g,this.center.lat*Math.PI/180);const S=h[0]*h[0]+h[2]*h[2],P=v[0]*v[0];if(S<P)return;const E=Math.sqrt(S-P),k=-E,R=c.bo(h[0],h[2],v[0],E),L=c.bo(h[0],h[2],v[0],k),N=c.bh();c.bk(N,h,g,-R);const V=c.bo(N[1],N[2],v[1],v[2]),J=c.bh();c.bk(J,h,g,-L);const K=c.bo(J[1],J[2],v[1],v[2]),te=.5*Math.PI,oe=V>=-te&&V<=te,ue=K>=-te&&K<=te;let he,pe;if(oe&&ue){const Ee=this.center.lng*Math.PI/180,Be=this.center.lat*Math.PI/180;c.br(R,Ee)+c.br(V,Be)<c.br(L,Ee)+c.br(K,Be)?(he=R,pe=V):(he=L,pe=K)}else if(oe)he=R,pe=V;else{if(!ue)return;he=L,pe=K}const ge=he/Math.PI*180,fe=pe/Math.PI*180,Pe=this.center.lat;this.setCenter(new c.Q(ge,c.ad(fe,-90,90))),this.setZoom(this.zoom+Er(Pe,this.center.lat))}locationToScreenPoint(e,i){const u=_n(e);if(i){const h=i.getElevationForLngLatZoom(e,this._helper._tileZoom);c.aN(u,u,1+h/c.bq)}return this._projectSurfacePointToScreen(u)}_projectSurfacePointToScreen(e){const i=c.bg();return c.ao(i,[...e,1],this._globeViewProjMatrixNoCorrection),i[0]/=i[3],i[1]/=i[3],new c.P((.5*i[0]+.5)*this.width,(.5*-i[1]+.5)*this.height)}screenPointToMercatorCoordinate(e,i){if(i){const u=i.pointCoordinate(e);if(u)return u}return c.$.fromLngLat(this.unprojectScreenPoint(e))}screenPointToLocation(e,i){var u;return(u=this.screenPointToMercatorCoordinate(e,i))===null||u===void 0?void 0:u.toLngLat()}isPointOnMapSurface(e,i){const u=this._cameraPosition,h=this.getRayDirectionFromPixel(e);return!!this.rayPlanetIntersection(u,h)}getRayDirectionFromPixel(e){const i=c.bg();i[0]=e.x/this.width*2-1,i[1]=-1*(e.y/this.height*2-1),i[2]=1,i[3]=1,c.ao(i,i,this._globeViewProjMatrixNoCorrectionInverted),i[0]/=i[3],i[1]/=i[3],i[2]/=i[3];const u=c.bh();u[0]=i[0]-this._cameraPosition[0],u[1]=i[1]-this._cameraPosition[1],u[2]=i[2]-this._cameraPosition[2];const h=c.bh();return c.aS(h,u),h}isSurfacePointVisible(e){const i=this._cachedClippingPlane;return i[0]*e[0]+i[1]*e[1]+i[2]*e[2]+i[3]>=0}isSurfacePointOnScreen(e){if(!this.isSurfacePointVisible(e))return!1;const i=c.bg();return c.ao(i,[...e,1],this._globeViewProjMatrixNoCorrection),i[0]/=i[3],i[1]/=i[3],i[2]/=i[3],i[0]>-1&&i[0]<1&&i[1]>-1&&i[1]<1&&i[2]>-1&&i[2]<1}rayPlanetIntersection(e,i){const u=c.aU(e,i),h=c.bh(),g=c.bh();c.aN(g,i,u),c.aR(h,e,g);const v=1-c.aU(h,h);if(v<0)return null;const S=c.aU(e,e)-1,P=-u+(u<0?1:-1)*Math.sqrt(v),E=S/P,k=P;return{tMin:Math.min(E,k),tMax:Math.max(E,k)}}unprojectScreenPoint(e){const i=this._cameraPosition,u=this.getRayDirectionFromPixel(e),h=this.rayPlanetIntersection(i,u);if(h){const E=c.bh();c.aO(E,i,[u[0]*h.tMin,u[1]*h.tMin,u[2]*h.tMin]);const k=c.bh();return c.aS(k,E),Bl(k)}const g=this._cachedClippingPlane[0]*u[0]+this._cachedClippingPlane[1]*u[1]+this._cachedClippingPlane[2]*u[2],v=-c.bp(this._cachedClippingPlane,i)/g,S=c.bh();if(v>0)c.aO(S,i,[u[0]*v,u[1]*v,u[2]*v]);else{const E=c.bh();c.aO(E,i,[2*u[0],2*u[1],2*u[2]]);const k=c.bp(this._cachedClippingPlane,E);c.aR(S,E,[this._cachedClippingPlane[0]*k,this._cachedClippingPlane[1]*k,this._cachedClippingPlane[2]*k])}const P=c.bh();return c.aS(P,S),Bl(P)}getMatrixForModel(e,i){const u=c.Q.convert(e),h=1/c.bq,g=c.b0();return c.bl(g,g,u.lng/180*Math.PI),c.a_(g,g,-u.lat/180*Math.PI),c.L(g,g,[0,0,1+i/c.bq]),c.a_(g,g,.5*Math.PI),c.M(g,g,[h,h,h]),g}getProjectionDataForCustomLayer(e=!0){const i=this.getProjectionData({overscaledTileID:new c.Y(0,0,0,0,0),applyGlobeMatrix:e});return i.tileMercatorCoords=[0,0,1,1],i}getFastPathSimpleProjectionMatrix(e){}}class $l{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,i,u){return this._helper.interpolatePadding(e,i,u)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,i,u=!0){this._helper.resize(e,i,u)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,i){this._helper.overrideNearFarZ(e,i)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(e,i){this._globeness=e,this._globeLatitudeErrorCorrectionRadians=i,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().recalculateCache(),this._mercatorTransform.getCoveringTilesDetailsProvider().recalculateCache()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this._helper=new Rl({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,i)=>this.getConstrained(e,i)}),this._globeness=1,this._mercatorTransform=new si,this._verticalPerspectiveTransform=new Nl}clone(){const e=new $l;return e._globeness=this._globeness,e._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,e.apply(this),e}apply(e){this._helper.apply(e),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(e){const i=this._mercatorTransform.getProjectionData(e),u=this._verticalPerspectiveTransform.getProjectionData(e);return{mainMatrix:this.isGlobeRendering?u.mainMatrix:i.mainMatrix,clippingPlane:u.clippingPlane,tileMercatorCoords:u.tileMercatorCoords,projectionTransition:e.applyGlobeMatrix?this._globeness:0,fallbackMatrix:i.fallbackMatrix}}isLocationOccluded(e){return this.currentTransform.isLocationOccluded(e)}transformLightDirection(e){return this.currentTransform.transformLightDirection(e)}getPixelScale(){return c.bb(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return c.bb(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(e,i,u){const h=this._mercatorTransform.getPitchedTextCorrection(e,i,u),g=this._verticalPerspectiveTransform.getPitchedTextCorrection(e,i,u);return c.bb(h,g,this._globeness)}projectTileCoordinates(e,i,u,h){return this.currentTransform.projectTileCoordinates(e,i,u,h)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(e){return this.currentTransform.calculateFogMatrix(e)}getVisibleUnwrappedCoordinates(e){return this.currentTransform.getVisibleUnwrappedCoordinates(e)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(e){this._mercatorTransform.recalculateZoomAndCenter(e),this._verticalPerspectiveTransform.recalculateZoomAndCenter(e)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,i){return this.currentTransform.lngLatToCameraDepth(e,i)}populateCache(e){this._mercatorTransform.populateCache(e),this._verticalPerspectiveTransform.populateCache(e)}getBounds(){return this.currentTransform.getBounds()}getConstrained(e,i){return this.currentTransform.getConstrained(e,i)}calculateCenterFromCameraLngLatAlt(e,i,u,h){return this._helper.calculateCenterFromCameraLngLatAlt(e,i,u,h)}setLocationAtPoint(e,i){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(e,i),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(e,i),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(e,i){return this.currentTransform.locationToScreenPoint(e,i)}screenPointToMercatorCoordinate(e,i){return this.currentTransform.screenPointToMercatorCoordinate(e,i)}screenPointToLocation(e,i){return this.currentTransform.screenPointToLocation(e,i)}isPointOnMapSurface(e,i){return this.currentTransform.isPointOnMapSurface(e,i)}getRayDirectionFromPixel(e){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(e)}getMatrixForModel(e,i){return this.currentTransform.getMatrixForModel(e,i)}getProjectionDataForCustomLayer(e=!0){const i=this._mercatorTransform.getProjectionDataForCustomLayer(e);if(!this.isGlobeRendering)return i;const u=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(e);return u.fallbackMatrix=i.mainMatrix,u}getFastPathSimpleProjectionMatrix(e){return this.currentTransform.getFastPathSimpleProjectionMatrix(e)}}class Fn{get useGlobeControls(){return!0}handlePanInertia(e,i){const u=Nu(e,i);return Math.abs(u.lng-i.center.lng)>180&&(u.lng=i.center.lng+179.5*Math.sign(u.lng-i.center.lng)),{easingCenter:u,easingOffset:new c.P(0,0)}}handleMapControlsRollPitchBearingZoom(e,i){const u=e.around,h=i.screenPointToLocation(u);e.bearingDelta&&i.setBearing(i.bearing+e.bearingDelta),e.pitchDelta&&i.setPitch(i.pitch+e.pitchDelta),e.rollDelta&&i.setRoll(i.roll+e.rollDelta);const g=i.zoom;e.zoomDelta&&i.setZoom(i.zoom+e.zoomDelta);const v=i.zoom-g;if(v===0)return;const S=c.bm(i.center.lng,h.lng),P=S/(Math.abs(S/180)+1),E=c.bm(i.center.lat,h.lat),k=i.getRayDirectionFromPixel(u),R=i.cameraPosition,L=-1*c.aU(R,k),N=c.bh();c.aO(N,R,[k[0]*L,k[1]*L,k[2]*L]);const V=c.bs(N)-1,J=Math.exp(.5*-Math.max(V-.3,0)),K=yn(i.worldSize,i.center.lat)/Math.min(i.width,i.height),te=c.be(K,.9,.5,1,.25),oe=(1-c.aH(-v))*Math.min(J,te),ue=i.center.lat,he=i.zoom,pe=new c.Q(i.center.lng+P*oe,c.ad(i.center.lat+E*oe,-85.051129,c.aI));i.setLocationAtPoint(h,u);const ge=i.center,fe=c.be(Math.abs(S),45,85,0,1),Pe=c.be(K,.75,.35,0,1),Ee=Math.pow(Math.max(fe,Pe),.25),Be=c.bm(ge.lng,pe.lng),je=c.bm(ge.lat,pe.lat);i.setCenter(new c.Q(ge.lng+Be*Ee,ge.lat+je*Ee).wrap()),i.setZoom(he+Er(ue,i.center.lat))}handleMapControlsPan(e,i,u){if(!e.panDelta)return;const h=i.center.lat,g=i.zoom;i.setCenter(Nu(e.panDelta,i).wrap()),i.setZoom(g+Er(h,i.center.lat))}cameraForBoxAndBearing(e,i,u,h,g){const v=Ou(e,i,u,h,g),S=i.left/g.width*2-1,P=(g.width-i.right)/g.width*2-1,E=i.top/g.height*-2+1,k=(g.height-i.bottom)/g.height*-2+1,R=c.bm(u.getWest(),u.getEast())<0,L=R?u.getEast():u.getWest(),N=R?u.getWest():u.getEast(),V=Math.max(u.getNorth(),u.getSouth()),J=Math.min(u.getNorth(),u.getSouth()),K=L+.5*c.bm(L,N),te=V+.5*c.bm(V,J),oe=g.clone();oe.setCenter(v.center),oe.setBearing(v.bearing),oe.setPitch(0),oe.setRoll(0),oe.setZoom(v.zoom);const ue=oe.modelViewProjectionMatrix,he=[_n(u.getNorthWest()),_n(u.getNorthEast()),_n(u.getSouthWest()),_n(u.getSouthEast()),_n(new c.Q(N,te)),_n(new c.Q(L,te)),_n(new c.Q(K,V)),_n(new c.Q(K,J))],pe=_n(v.center);let ge=Number.POSITIVE_INFINITY;for(const fe of he)S<0&&(ge=Fn.getLesserNonNegativeNonNull(ge,Fn.solveVectorScale(fe,pe,ue,"x",S))),P>0&&(ge=Fn.getLesserNonNegativeNonNull(ge,Fn.solveVectorScale(fe,pe,ue,"x",P))),E>0&&(ge=Fn.getLesserNonNegativeNonNull(ge,Fn.solveVectorScale(fe,pe,ue,"y",E))),k<0&&(ge=Fn.getLesserNonNegativeNonNull(ge,Fn.solveVectorScale(fe,pe,ue,"y",k)));if(Number.isFinite(ge)&&ge!==0)return v.zoom=oe.zoom+c.aa(ge),v;$a()}handleJumpToCenterZoom(e,i){const u=e.center.lat,h=e.getConstrained(i.center?c.Q.convert(i.center):e.center,e.zoom).center;e.setCenter(h.wrap());const g=i.zoom!==void 0?+i.zoom:e.zoom+Er(u,h.lat);e.zoom!==g&&e.setZoom(g)}handleEaseTo(e,i){const u=e.zoom,h=e.center,g=e.padding,v={roll:e.roll,pitch:e.pitch,bearing:e.bearing},S={roll:i.roll===void 0?e.roll:i.roll,pitch:i.pitch===void 0?e.pitch:i.pitch,bearing:i.bearing===void 0?e.bearing:i.bearing},P=i.zoom!==void 0,E=!e.isPaddingEqual(i.padding);let k=!1;const R=i.center?c.Q.convert(i.center):h,L=e.getConstrained(R,u).center;Cn(e,L);const N=e.clone();N.setCenter(L),N.setZoom(P?+i.zoom:u+Er(h.lat,R.lat)),N.setBearing(i.bearing);const V=new c.P(c.ad(e.centerPoint.x+i.offsetAsPoint.x,0,e.width),c.ad(e.centerPoint.y+i.offsetAsPoint.y,0,e.height));N.setLocationAtPoint(L,V);const J=(i.offset&&i.offsetAsPoint.mag())>0?N.center:L,K=P?+i.zoom:u+Er(h.lat,J.lat),te=u+Er(h.lat,0),oe=K+Er(J.lat,0),ue=c.bm(h.lng,J.lng),he=c.bm(h.lat,J.lat),pe=c.aH(oe-te);return k=K!==u,{easeFunc:ge=>{if(c.b5(v,S)||ai({startEulerAngles:v,endEulerAngles:S,tr:e,k:ge,useSlerp:v.roll!=S.roll}),E&&e.interpolatePadding(g,i.padding,ge),i.around)c.w("Easing around a point is not supported under globe projection."),e.setLocationAtPoint(i.around,i.aroundPoint);else{const fe=oe>te?Math.min(2,pe):Math.max(.5,pe),Pe=Math.pow(fe,1-ge),Ee=ss(h,ue,he,ge*Pe);e.setCenter(Ee.wrap())}if(k){const fe=c.B.number(te,oe,ge)+Er(0,e.center.lat);e.setZoom(fe)}},isZooming:k,elevationCenter:J}}handleFlyTo(e,i){const u=i.zoom!==void 0,h=e.center,g=e.zoom,v=e.padding,S=!e.isPaddingEqual(i.padding),P=e.getConstrained(c.Q.convert(i.center||i.locationAtOffset),g).center,E=u?+i.zoom:e.zoom+Er(e.center.lat,P.lat),k=e.clone();k.setCenter(P),k.setZoom(E),k.setBearing(i.bearing);const R=new c.P(c.ad(e.centerPoint.x+i.offsetAsPoint.x,0,e.width),c.ad(e.centerPoint.y+i.offsetAsPoint.y,0,e.height));k.setLocationAtPoint(P,R);const L=k.center;Cn(e,L);const N=function(he,pe,ge){const fe=_n(pe),Pe=_n(ge),Ee=c.aU(fe,Pe),Be=Math.acos(Ee),je=ju(he);return Be/(2*Math.PI)*je}(e,h,L),V=g+Er(h.lat,0),J=E+Er(L.lat,0),K=c.aH(J-V);let te;if(typeof i.minZoom=="number"){const he=+i.minZoom+Er(L.lat,0),pe=Math.min(he,V,J)+Er(0,L.lat),ge=e.getConstrained(L,pe).zoom+Er(L.lat,0);te=c.aH(ge-V)}const oe=c.bm(h.lng,L.lng),ue=c.bm(h.lat,L.lat);return{easeFunc:(he,pe,ge,fe)=>{const Pe=ss(h,oe,ue,ge);S&&e.interpolatePadding(v,i.padding,he);const Ee=he===1?L:Pe;e.setCenter(Ee.wrap());const Be=V+c.aa(pe);e.setZoom(he===1?E:Be+Er(0,Ee.lat))},scaleOfZoom:K,targetCenter:L,scaleOfMinZoom:te,pixelPathLength:N}}static solveVectorScale(e,i,u,h,g){const v=h==="x"?[u[0],u[4],u[8],u[12]]:[u[1],u[5],u[9],u[13]],S=[u[3],u[7],u[11],u[15]],P=e[0]*v[0]+e[1]*v[1]+e[2]*v[2],E=e[0]*S[0]+e[1]*S[1]+e[2]*S[2],k=i[0]*v[0]+i[1]*v[1]+i[2]*v[2],R=i[0]*S[0]+i[1]*S[1]+i[2]*S[2];return k+g*E===P+g*R||S[3]*(P-k)+v[3]*(R-E)+P*R==k*E?null:(k+v[3]-g*R-g*S[3])/(k-P-g*R+g*E)}static getLesserNonNegativeNonNull(e,i){return i!==null&&i>=0&&i<e?i:e}}class Vl{constructor(e){this._globe=e,this._mercatorCameraHelper=new Si,this._verticalPerspectiveCameraHelper=new Fn}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(e,i){return this.currentHelper.handlePanInertia(e,i)}handleMapControlsRollPitchBearingZoom(e,i){return this.currentHelper.handleMapControlsRollPitchBearingZoom(e,i)}handleMapControlsPan(e,i,u){this.currentHelper.handleMapControlsPan(e,i,u)}cameraForBoxAndBearing(e,i,u,h,g){return this.currentHelper.cameraForBoxAndBearing(e,i,u,h,g)}handleJumpToCenterZoom(e,i){this.currentHelper.handleJumpToCenterZoom(e,i)}handleEaseTo(e,i){return this.currentHelper.handleEaseTo(e,i)}handleFlyTo(e,i){return this.currentHelper.handleFlyTo(e,i)}}const as=(f,e)=>c.x(f,e&&e.filter(i=>i.identifier!=="source.canvas")),Vu=c.bt();class qa extends c.E{constructor(e,i={}){super(),this._rtlPluginLoaded=()=>{for(const u in this.sourceCaches){const h=this.sourceCaches[u].getSource().type;h!=="vector"&&h!=="geojson"||this.sourceCaches[u].reload()}},this.map=e,this.dispatcher=new zn(ln(),e._getMapId()),this.dispatcher.registerMessageHandler("GG",(u,h)=>this.getGlyphs(u,h)),this.dispatcher.registerMessageHandler("GI",(u,h)=>this.getImages(u,h)),this.imageManager=new X,this.imageManager.setEventedParent(this),this.glyphManager=new Ct(e._requestManager,i.localIdeographFontFamily),this.lineAtlas=new Tt(256,512),this.crossTileSymbolIndex=new Du,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new c.bu,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",c.bv()),uo().on(Vs,this._rtlPluginLoaded),this.on("data",u=>{if(u.dataType!=="source"||u.sourceDataType!=="metadata")return;const h=this.sourceCaches[u.sourceId];if(!h)return;const g=h.getSource();if(g&&g.vectorLayerIds)for(const v in this._layers){const S=this._layers[v];S.source===g.id&&this._validateLayer(S)}})}loadURL(e,i={},u){this.fire(new c.l("dataloading",{dataType:"style"})),i.validate=typeof i.validate!="boolean"||i.validate;const h=this.map._requestManager.transformRequest(e,"Style");this._loadStyleRequest=new AbortController;const g=this._loadStyleRequest;c.j(h,this._loadStyleRequest).then(v=>{this._loadStyleRequest=null,this._load(v.data,i,u)}).catch(v=>{this._loadStyleRequest=null,v&&!g.signal.aborted&&this.fire(new c.k(v))})}loadJSON(e,i={},u){this.fire(new c.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,H.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,i.validate=i.validate!==!1,this._load(e,i,u)}).catch(()=>{})}loadEmpty(){this.fire(new c.l("dataloading",{dataType:"style"})),this._load(Vu,{validate:!1})}_load(e,i,u){var h,g;const v=i.transformStyle?i.transformStyle(u,e):e;if(!i.validate||!as(this,c.y(v))){this._loaded=!0,this.stylesheet=v;for(const S in v.sources)this.addSource(S,v.sources[S],{validate:!1});v.sprite?this._loadSprite(v.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(v.glyphs),this._createLayers(),this.light=new br(this.stylesheet.light),this._setProjectionInternal(((h=this.stylesheet.projection)===null||h===void 0?void 0:h.type)||"mercator"),this.sky=new ut(this.stylesheet.sky),this.map.setTerrain((g=this.stylesheet.terrain)!==null&&g!==void 0?g:null),this.fire(new c.l("data",{dataType:"style"})),this.fire(new c.l("style.load"))}}_createLayers(){const e=c.bw(this.stylesheet.layers);this.dispatcher.broadcast("SL",e),this._order=e.map(i=>i.id),this._layers={},this._serializedLayers=null;for(const i of e){const u=c.bx(i);u.setEventedParent(this,{layer:{id:i.id}}),this._layers[i.id]=u}}_loadSprite(e,i=!1,u=void 0){let h;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(g,v,S,P){return c._(this,void 0,void 0,function*(){const E=Fe(g),k=S>1?"@2x":"",R={},L={};for(const{id:N,url:V}of E){const J=v.transformRequest(ze(V,k,".json"),"SpriteJSON");R[N]=c.j(J,P);const K=v.transformRequest(ze(V,k,".png"),"SpriteImage");L[N]=_e.getImage(K,P)}return yield Promise.all([...Object.values(R),...Object.values(L)]),function(N,V){return c._(this,void 0,void 0,function*(){const J={};for(const K in N){J[K]={};const te=H.getImageCanvasContext((yield V[K]).data),oe=(yield N[K]).data;for(const ue in oe){const{width:he,height:pe,x:ge,y:fe,sdf:Pe,pixelRatio:Ee,stretchX:Be,stretchY:je,content:Le,textFitWidth:Qe,textFitHeight:Ke}=oe[ue];J[K][ue]={data:null,pixelRatio:Ee,sdf:Pe,stretchX:Be,stretchY:je,content:Le,textFitWidth:Qe,textFitHeight:Ke,spriteData:{width:he,height:pe,x:ge,y:fe,context:te}}}}return J})}(R,L)})}(e,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(g=>{if(this._spriteRequest=null,g)for(const v in g){this._spritesImagesIds[v]=[];const S=this._spritesImagesIds[v]?this._spritesImagesIds[v].filter(P=>!(P in g)):[];for(const P of S)this.imageManager.removeImage(P),this._changedImages[P]=!0;for(const P in g[v]){const E=v==="default"?P:`${v}:${P}`;this._spritesImagesIds[v].push(E),E in this.imageManager.images?this.imageManager.updateImage(E,g[v][P],!1):this.imageManager.addImage(E,g[v][P]),i&&(this._changedImages[E]=!0)}}}).catch(g=>{this._spriteRequest=null,h=g,this.fire(new c.k(h))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),i&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"})),u&&u(h)})}_unloadSprite(){for(const e of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(e),this._changedImages[e]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"}))}_validateLayer(e){const i=this.sourceCaches[e.source];if(!i)return;const u=e.sourceLayer;if(!u)return;const h=i.getSource();(h.type==="geojson"||h.vectorLayerIds&&h.vectorLayerIds.indexOf(u)===-1)&&this.fire(new c.k(new Error(`Source layer "${u}" does not exist on source "${h.id}" as specified by style layer "${e.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const e in this.sourceCaches)if(!this.sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(e,i=!1){const u=this._serializedAllLayers();if(!e||e.length===0)return Object.values(i?c.by(u):u);const h=[];for(const g of e)if(u[g]){const v=i?c.by(u[g]):u[g];h.push(v)}return h}_serializedAllLayers(){let e=this._serializedLayers;if(e)return e;e=this._serializedLayers={};const i=Object.keys(this._layers);for(const u of i){const h=this._layers[u];h.type!=="custom"&&(e[u]=h.serialize())}return e}hasTransitions(){var e,i,u;if(!((e=this.light)===null||e===void 0)&&e.hasTransition()||!((i=this.sky)===null||i===void 0)&&i.hasTransition()||!((u=this.projection)===null||u===void 0)&&u.hasTransition())return!0;for(const h in this.sourceCaches)if(this.sourceCaches[h].hasTransition())return!0;for(const h in this._layers)if(this._layers[h].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(e){if(!this._loaded)return;const i=this._changed;if(i){const h=Object.keys(this._updatedLayers),g=Object.keys(this._removedLayers);(h.length||g.length)&&this._updateWorkerLayers(h,g);for(const v in this._updatedSources){const S=this._updatedSources[v];if(S==="reload")this._reloadSource(v);else{if(S!=="clear")throw new Error(`Invalid action ${S}`);this._clearSource(v)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const v in this._updatedPaintProps)this._layers[v].updateTransitions(e);this.light.updateTransitions(e),this.sky.updateTransitions(e),this._resetUpdates()}const u={};for(const h in this.sourceCaches){const g=this.sourceCaches[h];u[h]=g.used,g.used=!1}for(const h of this._order){const g=this._layers[h];g.recalculate(e,this._availableImages),!g.isHidden(e.zoom)&&g.source&&(this.sourceCaches[g.source].used=!0)}for(const h in u){const g=this.sourceCaches[h];!!u[h]!=!!g.used&&g.fire(new c.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:h}))}this.light.recalculate(e),this.sky.recalculate(e),this.projection.recalculate(e),this.z=e.zoom,i&&this.fire(new c.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const e=Object.keys(this._changedImages);if(e.length){for(const i in this.sourceCaches)this.sourceCaches[i].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(e,i){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(e,!1),removedIds:i})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(e,i={}){var u;this._checkLoaded();const h=this.serialize();if(e=i.transformStyle?i.transformStyle(h,e):e,((u=i.validate)===null||u===void 0||u)&&as(this,c.y(e)))return!1;(e=c.by(e)).layers=c.bw(e.layers);const g=c.bz(h,e),v=this._getOperationsToPerform(g);if(v.unimplemented.length>0)throw new Error(`Unimplemented: ${v.unimplemented.join(", ")}.`);if(v.operations.length===0)return!1;for(const S of v.operations)S();return this.stylesheet=e,this._serializedLayers=null,!0}_getOperationsToPerform(e){const i=[],u=[];for(const h of e)switch(h.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":i.push(()=>this.addLayer.apply(this,h.args));break;case"removeLayer":i.push(()=>this.removeLayer.apply(this,h.args));break;case"setPaintProperty":i.push(()=>this.setPaintProperty.apply(this,h.args));break;case"setLayoutProperty":i.push(()=>this.setLayoutProperty.apply(this,h.args));break;case"setFilter":i.push(()=>this.setFilter.apply(this,h.args));break;case"addSource":i.push(()=>this.addSource.apply(this,h.args));break;case"removeSource":i.push(()=>this.removeSource.apply(this,h.args));break;case"setLayerZoomRange":i.push(()=>this.setLayerZoomRange.apply(this,h.args));break;case"setLight":i.push(()=>this.setLight.apply(this,h.args));break;case"setGeoJSONSourceData":i.push(()=>this.setGeoJSONSourceData.apply(this,h.args));break;case"setGlyphs":i.push(()=>this.setGlyphs.apply(this,h.args));break;case"setSprite":i.push(()=>this.setSprite.apply(this,h.args));break;case"setTerrain":i.push(()=>this.map.setTerrain.apply(this,h.args));break;case"setSky":i.push(()=>this.setSky.apply(this,h.args));break;case"setProjection":this.setProjection.apply(this,h.args);break;case"setTransition":i.push(()=>{});break;default:u.push(h.command)}return{operations:i,unimplemented:u}}addImage(e,i){if(this.getImage(e))return this.fire(new c.k(new Error(`An image named "${e}" already exists.`)));this.imageManager.addImage(e,i),this._afterImageUpdated(e)}updateImage(e,i){this.imageManager.updateImage(e,i)}getImage(e){return this.imageManager.getImage(e)}removeImage(e){if(!this.getImage(e))return this.fire(new c.k(new Error(`An image named "${e}" does not exist.`)));this.imageManager.removeImage(e),this._afterImageUpdated(e)}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(e,i,u={}){if(this._checkLoaded(),this.sourceCaches[e]!==void 0)throw new Error(`Source "${e}" already exists.`);if(!i.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(i).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(i.type)>=0&&this._validate(c.y.source,`sources.${e}`,i,null,u))return;this.map&&this.map._collectResourceTiming&&(i.collectResourceTiming=!0);const h=this.sourceCaches[e]=new z(e,i,this.dispatcher);h.style=this,h.setEventedParent(this,()=>({isSourceLoaded:h.loaded(),source:h.serialize(),sourceId:e})),h.onAdd(this.map),this._changed=!0}removeSource(e){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error("There is no source with this ID");for(const u in this._layers)if(this._layers[u].source===e)return this.fire(new c.k(new Error(`Source "${e}" cannot be removed while layer "${u}" is using it.`)));const i=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],i.fire(new c.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),i.setEventedParent(null),i.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(e,i){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error(`There is no source with this ID=${e}`);const u=this.sourceCaches[e].getSource();if(u.type!=="geojson")throw new Error(`geojsonSource.type is ${u.type}, which is !== 'geojson`);u.setData(i),this._changed=!0}getSource(e){return this.sourceCaches[e]&&this.sourceCaches[e].getSource()}addLayer(e,i,u={}){this._checkLoaded();const h=e.id;if(this.getLayer(h))return void this.fire(new c.k(new Error(`Layer "${h}" already exists on this map.`)));let g;if(e.type==="custom"){if(as(this,c.bA(e)))return;g=c.bx(e)}else{if("source"in e&&typeof e.source=="object"&&(this.addSource(h,e.source),e=c.by(e),e=c.e(e,{source:h})),this._validate(c.y.layer,`layers.${h}`,e,{arrayIndex:-1},u))return;g=c.bx(e),this._validateLayer(g),g.setEventedParent(this,{layer:{id:h}})}const v=i?this._order.indexOf(i):this._order.length;if(i&&v===-1)this.fire(new c.k(new Error(`Cannot add layer "${h}" before non-existing layer "${i}".`)));else{if(this._order.splice(v,0,h),this._layerOrderChanged=!0,this._layers[h]=g,this._removedLayers[h]&&g.source&&g.type!=="custom"){const S=this._removedLayers[h];delete this._removedLayers[h],S.type!==g.type?this._updatedSources[g.source]="clear":(this._updatedSources[g.source]="reload",this.sourceCaches[g.source].pause())}this._updateLayer(g),g.onAdd&&g.onAdd(this.map)}}moveLayer(e,i){if(this._checkLoaded(),this._changed=!0,!this._layers[e])return void this.fire(new c.k(new Error(`The layer '${e}' does not exist in the map's style and cannot be moved.`)));if(e===i)return;const u=this._order.indexOf(e);this._order.splice(u,1);const h=i?this._order.indexOf(i):this._order.length;i&&h===-1?this.fire(new c.k(new Error(`Cannot move layer "${e}" before non-existing layer "${i}".`))):(this._order.splice(h,0,e),this._layerOrderChanged=!0)}removeLayer(e){this._checkLoaded();const i=this._layers[e];if(!i)return void this.fire(new c.k(new Error(`Cannot remove non-existing layer "${e}".`)));i.setEventedParent(null);const u=this._order.indexOf(e);this._order.splice(u,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=i,delete this._layers[e],this._serializedLayers&&delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],i.onRemove&&i.onRemove(this.map)}getLayer(e){return this._layers[e]}getLayersOrder(){return[...this._order]}hasLayer(e){return e in this._layers}setLayerZoomRange(e,i,u){this._checkLoaded();const h=this.getLayer(e);h?h.minzoom===i&&h.maxzoom===u||(i!=null&&(h.minzoom=i),u!=null&&(h.maxzoom=u),this._updateLayer(h)):this.fire(new c.k(new Error(`Cannot set the zoom range of non-existing layer "${e}".`)))}setFilter(e,i,u={}){this._checkLoaded();const h=this.getLayer(e);if(h){if(!c.bB(h.filter,i))return i==null?(h.filter=void 0,void this._updateLayer(h)):void(this._validate(c.y.filter,`layers.${h.id}.filter`,i,null,u)||(h.filter=c.by(i),this._updateLayer(h)))}else this.fire(new c.k(new Error(`Cannot filter non-existing layer "${e}".`)))}getFilter(e){return c.by(this.getLayer(e).filter)}setLayoutProperty(e,i,u,h={}){this._checkLoaded();const g=this.getLayer(e);g?c.bB(g.getLayoutProperty(i),u)||(g.setLayoutProperty(i,u,h),this._updateLayer(g)):this.fire(new c.k(new Error(`Cannot style non-existing layer "${e}".`)))}getLayoutProperty(e,i){const u=this.getLayer(e);if(u)return u.getLayoutProperty(i);this.fire(new c.k(new Error(`Cannot get style of non-existing layer "${e}".`)))}setPaintProperty(e,i,u,h={}){this._checkLoaded();const g=this.getLayer(e);g?c.bB(g.getPaintProperty(i),u)||(g.setPaintProperty(i,u,h)&&this._updateLayer(g),this._changed=!0,this._updatedPaintProps[e]=!0,this._serializedLayers=null):this.fire(new c.k(new Error(`Cannot style non-existing layer "${e}".`)))}getPaintProperty(e,i){return this.getLayer(e).getPaintProperty(i)}setFeatureState(e,i){this._checkLoaded();const u=e.source,h=e.sourceLayer,g=this.sourceCaches[u];if(g===void 0)return void this.fire(new c.k(new Error(`The source '${u}' does not exist in the map's style.`)));const v=g.getSource().type;v==="geojson"&&h?this.fire(new c.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):v!=="vector"||h?(e.id===void 0&&this.fire(new c.k(new Error("The feature id parameter must be provided."))),g.setFeatureState(h,e.id,i)):this.fire(new c.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(e,i){this._checkLoaded();const u=e.source,h=this.sourceCaches[u];if(h===void 0)return void this.fire(new c.k(new Error(`The source '${u}' does not exist in the map's style.`)));const g=h.getSource().type,v=g==="vector"?e.sourceLayer:void 0;g!=="vector"||v?i&&typeof e.id!="string"&&typeof e.id!="number"?this.fire(new c.k(new Error("A feature id is required to remove its specific state property."))):h.removeFeatureState(v,e.id,i):this.fire(new c.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(e){this._checkLoaded();const i=e.source,u=e.sourceLayer,h=this.sourceCaches[i];if(h!==void 0)return h.getSource().type!=="vector"||u?(e.id===void 0&&this.fire(new c.k(new Error("The feature id parameter must be provided."))),h.getFeatureState(u,e.id)):void this.fire(new c.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new c.k(new Error(`The source '${i}' does not exist in the map's style.`)))}getTransition(){return c.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const e=c.bC(this.sourceCaches,g=>g.serialize()),i=this._serializeByIds(this._order,!0),u=this.map.getTerrain()||void 0,h=this.stylesheet;return c.bD({version:h.version,name:h.name,metadata:h.metadata,light:h.light,sky:h.sky,center:h.center,zoom:h.zoom,bearing:h.bearing,pitch:h.pitch,sprite:h.sprite,glyphs:h.glyphs,transition:h.transition,projection:h.projection,sources:e,layers:i,terrain:u},g=>g!==void 0)}_updateLayer(e){this._updatedLayers[e.id]=!0,e.source&&!this._updatedSources[e.source]&&this.sourceCaches[e.source].getSource().type!=="raster"&&(this._updatedSources[e.source]="reload",this.sourceCaches[e.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(e){const i=v=>this._layers[v].type==="fill-extrusion",u={},h=[];for(let v=this._order.length-1;v>=0;v--){const S=this._order[v];if(i(S)){u[S]=v;for(const P of e){const E=P[S];if(E)for(const k of E)h.push(k)}}}h.sort((v,S)=>S.intersectionZ-v.intersectionZ);const g=[];for(let v=this._order.length-1;v>=0;v--){const S=this._order[v];if(i(S))for(let P=h.length-1;P>=0;P--){const E=h[P].feature;if(u[E.layer.id]<v)break;g.push(E),h.pop()}else for(const P of e){const E=P[S];if(E)for(const k of E)g.push(k.feature)}}return g}queryRenderedFeatures(e,i,u){i&&i.filter&&this._validate(c.y.filter,"queryRenderedFeatures.filter",i.filter,null,i);const h={};if(i&&i.layers){if(!(Array.isArray(i.layers)||i.layers instanceof Set))return this.fire(new c.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const E of i.layers){const k=this._layers[E];if(!k)return this.fire(new c.k(new Error(`The layer '${E}' does not exist in the map's style and cannot be queried for features.`))),[];h[k.source]=!0}}const g=[];i.availableImages=this._availableImages;const v=this._serializedAllLayers(),S=i.layers instanceof Set?i.layers:Array.isArray(i.layers)?new Set(i.layers):null,P=Object.assign(Object.assign({},i),{layers:S});for(const E in this.sourceCaches)i.layers&&!h[E]||g.push(es(this.sourceCaches[E],this._layers,v,e,P,u));return this.placement&&g.push(function(E,k,R,L,N,V,J){const K={},te=V.queryRenderedSymbols(L),oe=[];for(const ue of Object.keys(te).map(Number))oe.push(J[ue]);oe.sort(Kr);for(const ue of oe){const he=ue.featureIndex.lookupSymbolFeatures(te[ue.bucketInstanceId],k,ue.bucketIndex,ue.sourceLayerIndex,N.filter,N.layers,N.availableImages,E);for(const pe in he){const ge=K[pe]=K[pe]||[],fe=he[pe];fe.sort((Pe,Ee)=>{const Be=ue.featureSortOrder;if(Be){const je=Be.indexOf(Pe.featureIndex);return Be.indexOf(Ee.featureIndex)-je}return Ee.featureIndex-Pe.featureIndex});for(const Pe of fe)ge.push(Pe)}}return function(ue,he,pe){for(const ge in ue)for(const fe of ue[ge])Cr(fe,pe[he[ge].source]);return ue}(K,E,R)}(this._layers,v,this.sourceCaches,e,P,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(g)}querySourceFeatures(e,i){i&&i.filter&&this._validate(c.y.filter,"querySourceFeatures.filter",i.filter,null,i);const u=this.sourceCaches[e];return u?function(h,g){const v=h.getRenderableIds().map(E=>h.getTileByID(E)),S=[],P={};for(let E=0;E<v.length;E++){const k=v[E],R=k.tileID.canonical.key;P[R]||(P[R]=!0,k.querySourceFeatures(S,g))}return S}(u,i):[]}getLight(){return this.light.getLight()}setLight(e,i={}){this._checkLoaded();const u=this.light.getLight();let h=!1;for(const v in e)if(!c.bB(e[v],u[v])){h=!0;break}if(!h)return;const g={now:H.now(),transition:c.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,i),this.light.updateTransitions(g)}getProjection(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.projection}setProjection(e){if(this._checkLoaded(),this.projection){if(this.projection.name===e.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=e,this._setProjectionInternal(e.type)}getSky(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.sky}setSky(e,i={}){this._checkLoaded();const u=this.getSky();let h=!1;if(!e&&!u)return;if(e&&!u)h=!0;else if(!e&&u)h=!0;else for(const v in e)if(!c.bB(e[v],u[v])){h=!0;break}if(!h)return;const g={now:H.now(),transition:c.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=e,this.sky.setSky(e,i),this.sky.updateTransitions(g)}_setProjectionInternal(e){const i=function(u){if(Array.isArray(u)){const h=new Fl({type:u});return{projection:h,transform:new $l,cameraHelper:new Vl(h)}}switch(u){case"mercator":return{projection:new Fu,transform:new si,cameraHelper:new Si};case"globe":{const h=new Fl({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:h,transform:new $l,cameraHelper:new Vl(h)}}case"vertical-perspective":return{projection:new Ks,transform:new Nl,cameraHelper:new Fn};default:return c.w(`Unknown projection name: ${u}. Falling back to mercator projection.`),{projection:new Fu,transform:new si,cameraHelper:new Si}}}(e);this.projection=i.projection,this.map.migrateProjection(i.transform,i.cameraHelper);for(const u in this.sourceCaches)this.sourceCaches[u].reload()}_validate(e,i,u,h,g={}){return(!g||g.validate!==!1)&&as(this,e.call(c.y,c.e({key:i,style:this.serialize(),value:u,styleSpec:c.v},h)))}_remove(e=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),uo().off(Vs,this._rtlPluginLoaded);for(const i in this._layers)this._layers[i].setEventedParent(null);for(const i in this.sourceCaches){const u=this.sourceCaches[i];u.setEventedParent(null),u.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),e&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(e)}_clearSource(e){this.sourceCaches[e].clearTiles()}_reloadSource(e){this.sourceCaches[e].resume(),this.sourceCaches[e].reload()}_updateSources(e){for(const i in this.sourceCaches)this.sourceCaches[i].update(e,this.map.terrain)}_generateCollisionBoxes(){for(const e in this.sourceCaches)this._reloadSource(e)}_updatePlacement(e,i,u,h,g=!1){let v=!1,S=!1;const P={};for(const E of this._order){const k=this._layers[E];if(k.type!=="symbol")continue;if(!P[k.source]){const L=this.sourceCaches[k.source];P[k.source]=L.getRenderableIds(!0).map(N=>L.getTileByID(N)).sort((N,V)=>V.tileID.overscaledZ-N.tileID.overscaledZ||(N.tileID.isLessThan(V.tileID)?-1:1))}const R=this.crossTileSymbolIndex.addLayer(k,P[k.source],e.center.lng);v=v||R}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((g=g||this._layerOrderChanged||u===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(H.now(),e.zoom))&&(this.pauseablePlacement=new zu(e,this.map.terrain,this._order,g,i,u,h,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,P),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(H.now()),S=!0),v&&this.pauseablePlacement.placement.setStale()),S||v)for(const E of this._order){const k=this._layers[E];k.type==="symbol"&&this.placement.updateLayerOpacities(k,P[k.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(H.now())}_releaseSymbolFadeTiles(){for(const e in this.sourceCaches)this.sourceCaches[e].releaseSymbolFadeTiles()}getImages(e,i){return c._(this,void 0,void 0,function*(){const u=yield this.imageManager.getImages(i.icons);this._updateTilesForChangedImages();const h=this.sourceCaches[i.source];return h&&h.setDependencies(i.tileID.key,i.type,i.icons),u})}getGlyphs(e,i){return c._(this,void 0,void 0,function*(){const u=yield this.glyphManager.getGlyphs(i.stacks),h=this.sourceCaches[i.source];return h&&h.setDependencies(i.tileID.key,i.type,[""]),u})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(e,i={}){this._checkLoaded(),e&&this._validate(c.y.glyphs,"glyphs",e,null,i)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=e,this.glyphManager.entries={},this.glyphManager.setURL(e))}addSprite(e,i,u={},h){this._checkLoaded();const g=[{id:e,url:i}],v=[...Fe(this.stylesheet.sprite),...g];this._validate(c.y.sprite,"sprite",v,null,u)||(this.stylesheet.sprite=v,this._loadSprite(g,!0,h))}removeSprite(e){this._checkLoaded();const i=Fe(this.stylesheet.sprite);if(i.find(u=>u.id===e)){if(this._spritesImagesIds[e])for(const u of this._spritesImagesIds[e])this.imageManager.removeImage(u),this._changedImages[u]=!0;i.splice(i.findIndex(u=>u.id===e),1),this.stylesheet.sprite=i.length>0?i:void 0,delete this._spritesImagesIds[e],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"}))}else this.fire(new c.k(new Error(`Sprite "${e}" doesn't exists on this map.`)))}getSprite(){return Fe(this.stylesheet.sprite)}setSprite(e,i={},u){this._checkLoaded(),e&&this._validate(c.y.sprite,"sprite",e,null,i)||(this.stylesheet.sprite=e,e?this._loadSprite(e,!0,u):(this._unloadSprite(),u&&u(null)))}}var Ui=c.aC([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Vg{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(e,i,u,h,g,v,S,P,E){this.context=e;let k=this.boundPaintVertexBuffers.length!==h.length;for(let R=0;!k&&R<h.length;R++)this.boundPaintVertexBuffers[R]!==h[R]&&(k=!0);!this.vao||this.boundProgram!==i||this.boundLayoutVertexBuffer!==u||k||this.boundIndexBuffer!==g||this.boundVertexOffset!==v||this.boundDynamicVertexBuffer!==S||this.boundDynamicVertexBuffer2!==P||this.boundDynamicVertexBuffer3!==E?this.freshBind(i,u,h,g,v,S,P,E):(e.bindVertexArray.set(this.vao),S&&S.bind(),g&&g.dynamicDraw&&g.bind(),P&&P.bind(),E&&E.bind())}freshBind(e,i,u,h,g,v,S,P){const E=e.numAttributes,k=this.context,R=k.gl;this.vao&&this.destroy(),this.vao=k.createVertexArray(),k.bindVertexArray.set(this.vao),this.boundProgram=e,this.boundLayoutVertexBuffer=i,this.boundPaintVertexBuffers=u,this.boundIndexBuffer=h,this.boundVertexOffset=g,this.boundDynamicVertexBuffer=v,this.boundDynamicVertexBuffer2=S,this.boundDynamicVertexBuffer3=P,i.enableAttributes(R,e);for(const L of u)L.enableAttributes(R,e);v&&v.enableAttributes(R,e),S&&S.enableAttributes(R,e),P&&P.enableAttributes(R,e),i.bind(),i.setVertexAttribPointers(R,e,g);for(const L of u)L.bind(),L.setVertexAttribPointers(R,e,g);v&&(v.bind(),v.setVertexAttribPointers(R,e,g)),h&&h.bind(),S&&(S.bind(),S.setVertexAttribPointers(R,e,g)),P&&(P.bind(),P.setVertexAttribPointers(R,e,g)),k.currentNumAttributes=E}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const Uu=(f,e,i,u,h)=>({u_texture:0,u_ele_delta:f,u_fog_matrix:e,u_fog_color:i?i.properties.get("fog-color"):c.b6.white,u_fog_ground_blend:i?i.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:h?0:i?i.calculateFogBlendOpacity(u):0,u_horizon_color:i?i.properties.get("horizon-color"):c.b6.white,u_horizon_fog_blend:i?i.properties.get("horizon-fog-blend"):1,u_is_globe_mode:h?1:0}),Wa={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function Ro(f){const e=[];for(let i=0;i<f.length;i++){if(f[i]===null)continue;const u=f[i].split(" ");e.push(u.pop())}return e}class Ug{constructor(e,i,u,h,g,v,S,P){const E=e.gl;this.program=E.createProgram();const k=Ro(i.staticAttributes),R=u?u.getBinderAttributes():[],L=k.concat(R),N=bi.prelude.staticUniforms?Ro(bi.prelude.staticUniforms):[],V=S.staticUniforms?Ro(S.staticUniforms):[],J=i.staticUniforms?Ro(i.staticUniforms):[],K=u?u.getBinderUniforms():[],te=N.concat(V).concat(J).concat(K),oe=[];for(const Ee of te)oe.indexOf(Ee)<0&&oe.push(Ee);const ue=u?u.defines():[];li(E)&&ue.unshift("#version 300 es"),g&&ue.push("#define OVERDRAW_INSPECTOR;"),v&&ue.push("#define TERRAIN3D;"),P&&ue.push(P);let he=ue.concat(bi.prelude.fragmentSource,S.fragmentSource,i.fragmentSource).join(`
`),pe=ue.concat(bi.prelude.vertexSource,S.vertexSource,i.vertexSource).join(`
`);li(E)||(he=function(Ee){return Ee.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")}(he),pe=function(Ee){return Ee.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")}(pe));const ge=E.createShader(E.FRAGMENT_SHADER);if(E.isContextLost())return void(this.failedToCreate=!0);if(E.shaderSource(ge,he),E.compileShader(ge),!E.getShaderParameter(ge,E.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${E.getShaderInfoLog(ge)}`);E.attachShader(this.program,ge);const fe=E.createShader(E.VERTEX_SHADER);if(E.isContextLost())return void(this.failedToCreate=!0);if(E.shaderSource(fe,pe),E.compileShader(fe),!E.getShaderParameter(fe,E.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${E.getShaderInfoLog(fe)}`);E.attachShader(this.program,fe),this.attributes={};const Pe={};this.numAttributes=L.length;for(let Ee=0;Ee<this.numAttributes;Ee++)L[Ee]&&(E.bindAttribLocation(this.program,Ee,L[Ee]),this.attributes[L[Ee]]=Ee);if(E.linkProgram(this.program),!E.getProgramParameter(this.program,E.LINK_STATUS))throw new Error(`Program failed to link: ${E.getProgramInfoLog(this.program)}`);E.deleteShader(fe),E.deleteShader(ge);for(let Ee=0;Ee<oe.length;Ee++){const Be=oe[Ee];if(Be&&!Pe[Be]){const je=E.getUniformLocation(this.program,Be);je&&(Pe[Be]=je)}}this.fixedUniforms=h(e,Pe),this.terrainUniforms=((Ee,Be)=>({u_depth:new c.bE(Ee,Be.u_depth),u_terrain:new c.bE(Ee,Be.u_terrain),u_terrain_dim:new c.b7(Ee,Be.u_terrain_dim),u_terrain_matrix:new c.bG(Ee,Be.u_terrain_matrix),u_terrain_unpack:new c.bH(Ee,Be.u_terrain_unpack),u_terrain_exaggeration:new c.b7(Ee,Be.u_terrain_exaggeration)}))(e,Pe),this.projectionUniforms=((Ee,Be)=>({u_projection_matrix:new c.bG(Ee,Be.u_projection_matrix),u_projection_tile_mercator_coords:new c.bH(Ee,Be.u_projection_tile_mercator_coords),u_projection_clipping_plane:new c.bH(Ee,Be.u_projection_clipping_plane),u_projection_transition:new c.b7(Ee,Be.u_projection_transition),u_projection_fallback_matrix:new c.bG(Ee,Be.u_projection_fallback_matrix)}))(e,Pe),this.binderUniforms=u?u.getUniforms(e,Pe):[]}draw(e,i,u,h,g,v,S,P,E,k,R,L,N,V,J,K,te,oe,ue){const he=e.gl;if(this.failedToCreate)return;if(e.program.set(this.program),e.setDepthMode(u),e.setStencilMode(h),e.setColorMode(g),e.setCullFace(v),P){e.activeTexture.set(he.TEXTURE2),he.bindTexture(he.TEXTURE_2D,P.depthTexture),e.activeTexture.set(he.TEXTURE3),he.bindTexture(he.TEXTURE_2D,P.texture);for(const ge in this.terrainUniforms)this.terrainUniforms[ge].set(P[ge])}if(E)for(const ge in E)this.projectionUniforms[Wa[ge]].set(E[ge]);if(S)for(const ge in this.fixedUniforms)this.fixedUniforms[ge].set(S[ge]);K&&K.setUniforms(e,this.binderUniforms,V,{zoom:J});let pe=0;switch(i){case he.LINES:pe=2;break;case he.TRIANGLES:pe=3;break;case he.LINE_STRIP:pe=1}for(const ge of N.get()){const fe=ge.vaos||(ge.vaos={});(fe[k]||(fe[k]=new Vg)).bind(e,this,R,K?K.getPaintVertexBuffers():[],L,ge.vertexOffset,te,oe,ue),he.drawElements(i,ge.primitiveLength*pe,he.UNSIGNED_SHORT,ge.primitiveOffset*pe*2)}}}function Ha(f,e,i){const u=1/c.av(i,1,e.transform.tileZoom),h=Math.pow(2,i.tileID.overscaledZ),g=i.tileSize*Math.pow(2,e.transform.tileZoom)/h,v=g*(i.tileID.canonical.x+i.tileID.wrap*h),S=g*i.tileID.canonical.y;return{u_image:0,u_texsize:i.imageAtlasTexture.size,u_scale:[u,f.fromScale,f.toScale],u_fade:f.t,u_pixel_coord_upper:[v>>16,S>>16],u_pixel_coord_lower:[65535&v,65535&S]}}const ap=(f,e,i,u)=>{const h=f.style.light,g=h.properties.get("position"),v=[g.x,g.y,g.z],S=c.bK();h.properties.get("anchor")==="viewport"&&c.bL(S,f.transform.bearingInRadians),c.bM(v,v,S);const P=f.transform.transformLightDirection(v),E=h.properties.get("color");return{u_lightpos:v,u_lightpos_globe:P,u_lightintensity:h.properties.get("intensity"),u_lightcolor:[E.r,E.g,E.b],u_vertical_gradient:+e,u_opacity:i,u_fill_translate:u}},Ys=(f,e,i,u,h,g,v)=>c.e(ap(f,e,i,u),Ha(g,f,v),{u_height_factor:-Math.pow(2,h.overscaledZ)/v.tileSize/8}),lp=(f,e,i,u)=>c.e(Ha(e,f,i),{u_fill_translate:u}),cp=(f,e)=>({u_world:f,u_fill_translate:e}),Zg=(f,e,i,u,h)=>c.e(lp(f,e,i,h),{u_world:u}),up=(f,e,i,u,h)=>{const g=f.transform;let v,S,P=0;if(i.paint.get("circle-pitch-alignment")==="map"){const E=c.av(e,1,g.zoom);v=!0,S=[E,E],P=E/(c.Z*Math.pow(2,e.tileID.overscaledZ))*2*Math.PI*h}else v=!1,S=g.pixelsToGLUnits;return{u_camera_to_center_distance:g.cameraToCenterDistance,u_scale_with_map:+(i.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+v,u_device_pixel_ratio:f.pixelRatio,u_extrude_scale:S,u_globe_extrude_scale:P,u_translate:u}},Zu=f=>({u_pixel_extrude_scale:[1/f.width,1/f.height]}),hp=f=>({u_viewport_size:[f.width,f.height]}),Gu=(f,e=1)=>({u_color:f,u_overlay:0,u_overlay_scale:e}),qu=(f,e,i,u)=>{const h=c.av(f,1,e)/(c.Z*Math.pow(2,f.tileID.overscaledZ))*2*Math.PI*u;return{u_extrude_scale:c.av(f,1,e),u_intensity:i,u_globe_extrude_scale:h}},Wu=(f,e,i,u)=>{const h=c.K();c.bN(h,0,f.width,f.height,0,0,1);const g=f.context.gl;return{u_matrix:h,u_world:[g.drawingBufferWidth,g.drawingBufferHeight],u_image:i,u_color_ramp:u,u_opacity:e.paint.get("heatmap-opacity")}},ls=(f,e,i)=>{const u=i.paint.get("hillshade-shadow-color"),h=i.paint.get("hillshade-highlight-color"),g=i.paint.get("hillshade-accent-color");let v=i.paint.get("hillshade-illumination-direction")*(Math.PI/180);return i.paint.get("hillshade-illumination-anchor")==="viewport"&&(v+=f.transform.bearingInRadians),{u_image:0,u_latrange:pp(0,e.tileID),u_light:[i.paint.get("hillshade-exaggeration"),v],u_shadow:u,u_highlight:h,u_accent:g}},dp=(f,e)=>{const i=e.stride,u=c.K();return c.bN(u,0,c.Z,-8192,0,0,1),c.L(u,u,[0,-8192,0]),{u_matrix:u,u_image:1,u_dimension:[i,i],u_zoom:f.overscaledZ,u_unpack:e.getUnpackVector()}};function pp(f,e){const i=Math.pow(2,e.canonical.z),u=e.canonical.y;return[new c.$(0,u/i).toLngLat().lat,new c.$(0,(u+1)/i).toLngLat().lat]}const cs=(f,e,i,u)=>{const h=f.transform;return{u_translation:Hu(f,e,i),u_ratio:u/c.av(e,1,h.zoom),u_device_pixel_ratio:f.pixelRatio,u_units_to_pixels:[1/h.pixelsToGLUnits[0],1/h.pixelsToGLUnits[1]]}},Gg=(f,e,i,u,h)=>c.e(cs(f,e,i,u),{u_image:0,u_image_height:h}),Ul=(f,e,i,u,h)=>{const g=f.transform,v=fp(e,g);return{u_translation:Hu(f,e,i),u_texsize:e.imageAtlasTexture.size,u_ratio:u/c.av(e,1,g.zoom),u_device_pixel_ratio:f.pixelRatio,u_image:0,u_scale:[v,h.fromScale,h.toScale],u_fade:h.t,u_units_to_pixels:[1/g.pixelsToGLUnits[0],1/g.pixelsToGLUnits[1]]}},qg=(f,e,i,u,h,g)=>{const v=f.lineAtlas,S=fp(e,f.transform),P=i.layout.get("line-cap")==="round",E=v.getDash(h.from,P),k=v.getDash(h.to,P),R=E.width*g.fromScale,L=k.width*g.toScale;return c.e(cs(f,e,i,u),{u_patternscale_a:[S/R,-E.height/2],u_patternscale_b:[S/L,-k.height/2],u_sdfgamma:v.width/(256*Math.min(R,L)*f.pixelRatio)/2,u_image:0,u_tex_y_a:E.y,u_tex_y_b:k.y,u_mix:g.t})};function fp(f,e){return 1/c.av(f,1,e.tileZoom)}function Hu(f,e,i){return c.aw(f.transform,e,i.paint.get("line-translate"),i.paint.get("line-translate-anchor"))}const mp=(f,e,i,u,h)=>{return{u_tl_parent:f,u_scale_parent:e,u_buffer_scale:1,u_fade_t:i.mix,u_opacity:i.opacity*u.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:u.paint.get("raster-brightness-min"),u_brightness_high:u.paint.get("raster-brightness-max"),u_saturation_factor:(v=u.paint.get("raster-saturation"),v>0?1-1/(1.001-v):-v),u_contrast_factor:(g=u.paint.get("raster-contrast"),g>0?1/(1-g):1+g),u_spin_weights:gp(u.paint.get("raster-hue-rotate")),u_coords_top:[h[0].x,h[0].y,h[1].x,h[1].y],u_coords_bottom:[h[3].x,h[3].y,h[2].x,h[2].y]};var g,v};function gp(f){f*=Math.PI/180;const e=Math.sin(f),i=Math.cos(f);return[(2*i+1)/3,(-Math.sqrt(3)*e-i+1)/3,(Math.sqrt(3)*e-i+1)/3]}const Zl=(f,e,i,u,h,g,v,S,P,E,k,R,L)=>{const N=v.transform;return{u_is_size_zoom_constant:+(f==="constant"||f==="source"),u_is_size_feature_constant:+(f==="constant"||f==="camera"),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:N.cameraToCenterDistance,u_pitch:N.pitch/360*2*Math.PI,u_rotate_symbol:+i,u_aspect_ratio:N.width/N.height,u_fade_change:v.options.fadeDuration?v.symbolFadeChange:1,u_label_plane_matrix:S,u_coord_matrix:P,u_is_text:+k,u_pitch_with_map:+u,u_is_along_line:h,u_is_variable_anchor:g,u_texsize:R,u_texture:0,u_translation:E,u_pitched_scale:L}},Xu=(f,e,i,u,h,g,v,S,P,E,k,R,L,N)=>{const V=v.transform;return c.e(Zl(f,e,i,u,h,g,v,S,P,E,k,R,N),{u_gamma_scale:u?Math.cos(V.pitch*Math.PI/180)*V.cameraToCenterDistance:1,u_device_pixel_ratio:v.pixelRatio,u_is_halo:1})},Gl=(f,e,i,u,h,g,v,S,P,E,k,R,L)=>c.e(Xu(f,e,i,u,h,g,v,S,P,E,!0,k,0,L),{u_texsize_icon:R,u_texture_icon:1}),po=(f,e)=>({u_opacity:f,u_color:e}),Ku=(f,e,i,u,h)=>c.e(function(g,v,S,P){const E=S.imageManager.getPattern(g.from.toString()),k=S.imageManager.getPattern(g.to.toString()),{width:R,height:L}=S.imageManager.getPixelSize(),N=Math.pow(2,P.tileID.overscaledZ),V=P.tileSize*Math.pow(2,S.transform.tileZoom)/N,J=V*(P.tileID.canonical.x+P.tileID.wrap*N),K=V*P.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:E.tl,u_pattern_br_a:E.br,u_pattern_tl_b:k.tl,u_pattern_br_b:k.br,u_texsize:[R,L],u_mix:v.t,u_pattern_size_a:E.displaySize,u_pattern_size_b:k.displaySize,u_scale_a:v.fromScale,u_scale_b:v.toScale,u_tile_units_to_pixels:1/c.av(P,1,S.transform.tileZoom),u_pixel_coord_upper:[J>>16,K>>16],u_pixel_coord_lower:[65535&J,65535&K]}}(i,h,e,u),{u_opacity:f}),ql=(f,e)=>{},Yu={fillExtrusion:(f,e)=>({u_lightpos:new c.bI(f,e.u_lightpos),u_lightpos_globe:new c.bI(f,e.u_lightpos_globe),u_lightintensity:new c.b7(f,e.u_lightintensity),u_lightcolor:new c.bI(f,e.u_lightcolor),u_vertical_gradient:new c.b7(f,e.u_vertical_gradient),u_opacity:new c.b7(f,e.u_opacity),u_fill_translate:new c.bJ(f,e.u_fill_translate)}),fillExtrusionPattern:(f,e)=>({u_lightpos:new c.bI(f,e.u_lightpos),u_lightpos_globe:new c.bI(f,e.u_lightpos_globe),u_lightintensity:new c.b7(f,e.u_lightintensity),u_lightcolor:new c.bI(f,e.u_lightcolor),u_vertical_gradient:new c.b7(f,e.u_vertical_gradient),u_height_factor:new c.b7(f,e.u_height_factor),u_opacity:new c.b7(f,e.u_opacity),u_fill_translate:new c.bJ(f,e.u_fill_translate),u_image:new c.bE(f,e.u_image),u_texsize:new c.bJ(f,e.u_texsize),u_pixel_coord_upper:new c.bJ(f,e.u_pixel_coord_upper),u_pixel_coord_lower:new c.bJ(f,e.u_pixel_coord_lower),u_scale:new c.bI(f,e.u_scale),u_fade:new c.b7(f,e.u_fade)}),fill:(f,e)=>({u_fill_translate:new c.bJ(f,e.u_fill_translate)}),fillPattern:(f,e)=>({u_image:new c.bE(f,e.u_image),u_texsize:new c.bJ(f,e.u_texsize),u_pixel_coord_upper:new c.bJ(f,e.u_pixel_coord_upper),u_pixel_coord_lower:new c.bJ(f,e.u_pixel_coord_lower),u_scale:new c.bI(f,e.u_scale),u_fade:new c.b7(f,e.u_fade),u_fill_translate:new c.bJ(f,e.u_fill_translate)}),fillOutline:(f,e)=>({u_world:new c.bJ(f,e.u_world),u_fill_translate:new c.bJ(f,e.u_fill_translate)}),fillOutlinePattern:(f,e)=>({u_world:new c.bJ(f,e.u_world),u_image:new c.bE(f,e.u_image),u_texsize:new c.bJ(f,e.u_texsize),u_pixel_coord_upper:new c.bJ(f,e.u_pixel_coord_upper),u_pixel_coord_lower:new c.bJ(f,e.u_pixel_coord_lower),u_scale:new c.bI(f,e.u_scale),u_fade:new c.b7(f,e.u_fade),u_fill_translate:new c.bJ(f,e.u_fill_translate)}),circle:(f,e)=>({u_camera_to_center_distance:new c.b7(f,e.u_camera_to_center_distance),u_scale_with_map:new c.bE(f,e.u_scale_with_map),u_pitch_with_map:new c.bE(f,e.u_pitch_with_map),u_extrude_scale:new c.bJ(f,e.u_extrude_scale),u_device_pixel_ratio:new c.b7(f,e.u_device_pixel_ratio),u_globe_extrude_scale:new c.b7(f,e.u_globe_extrude_scale),u_translate:new c.bJ(f,e.u_translate)}),collisionBox:(f,e)=>({u_pixel_extrude_scale:new c.bJ(f,e.u_pixel_extrude_scale)}),collisionCircle:(f,e)=>({u_viewport_size:new c.bJ(f,e.u_viewport_size)}),debug:(f,e)=>({u_color:new c.bF(f,e.u_color),u_overlay:new c.bE(f,e.u_overlay),u_overlay_scale:new c.b7(f,e.u_overlay_scale)}),depth:ql,clippingMask:ql,heatmap:(f,e)=>({u_extrude_scale:new c.b7(f,e.u_extrude_scale),u_intensity:new c.b7(f,e.u_intensity),u_globe_extrude_scale:new c.b7(f,e.u_globe_extrude_scale)}),heatmapTexture:(f,e)=>({u_matrix:new c.bG(f,e.u_matrix),u_world:new c.bJ(f,e.u_world),u_image:new c.bE(f,e.u_image),u_color_ramp:new c.bE(f,e.u_color_ramp),u_opacity:new c.b7(f,e.u_opacity)}),hillshade:(f,e)=>({u_image:new c.bE(f,e.u_image),u_latrange:new c.bJ(f,e.u_latrange),u_light:new c.bJ(f,e.u_light),u_shadow:new c.bF(f,e.u_shadow),u_highlight:new c.bF(f,e.u_highlight),u_accent:new c.bF(f,e.u_accent)}),hillshadePrepare:(f,e)=>({u_matrix:new c.bG(f,e.u_matrix),u_image:new c.bE(f,e.u_image),u_dimension:new c.bJ(f,e.u_dimension),u_zoom:new c.b7(f,e.u_zoom),u_unpack:new c.bH(f,e.u_unpack)}),line:(f,e)=>({u_translation:new c.bJ(f,e.u_translation),u_ratio:new c.b7(f,e.u_ratio),u_device_pixel_ratio:new c.b7(f,e.u_device_pixel_ratio),u_units_to_pixels:new c.bJ(f,e.u_units_to_pixels)}),lineGradient:(f,e)=>({u_translation:new c.bJ(f,e.u_translation),u_ratio:new c.b7(f,e.u_ratio),u_device_pixel_ratio:new c.b7(f,e.u_device_pixel_ratio),u_units_to_pixels:new c.bJ(f,e.u_units_to_pixels),u_image:new c.bE(f,e.u_image),u_image_height:new c.b7(f,e.u_image_height)}),linePattern:(f,e)=>({u_translation:new c.bJ(f,e.u_translation),u_texsize:new c.bJ(f,e.u_texsize),u_ratio:new c.b7(f,e.u_ratio),u_device_pixel_ratio:new c.b7(f,e.u_device_pixel_ratio),u_image:new c.bE(f,e.u_image),u_units_to_pixels:new c.bJ(f,e.u_units_to_pixels),u_scale:new c.bI(f,e.u_scale),u_fade:new c.b7(f,e.u_fade)}),lineSDF:(f,e)=>({u_translation:new c.bJ(f,e.u_translation),u_ratio:new c.b7(f,e.u_ratio),u_device_pixel_ratio:new c.b7(f,e.u_device_pixel_ratio),u_units_to_pixels:new c.bJ(f,e.u_units_to_pixels),u_patternscale_a:new c.bJ(f,e.u_patternscale_a),u_patternscale_b:new c.bJ(f,e.u_patternscale_b),u_sdfgamma:new c.b7(f,e.u_sdfgamma),u_image:new c.bE(f,e.u_image),u_tex_y_a:new c.b7(f,e.u_tex_y_a),u_tex_y_b:new c.b7(f,e.u_tex_y_b),u_mix:new c.b7(f,e.u_mix)}),raster:(f,e)=>({u_tl_parent:new c.bJ(f,e.u_tl_parent),u_scale_parent:new c.b7(f,e.u_scale_parent),u_buffer_scale:new c.b7(f,e.u_buffer_scale),u_fade_t:new c.b7(f,e.u_fade_t),u_opacity:new c.b7(f,e.u_opacity),u_image0:new c.bE(f,e.u_image0),u_image1:new c.bE(f,e.u_image1),u_brightness_low:new c.b7(f,e.u_brightness_low),u_brightness_high:new c.b7(f,e.u_brightness_high),u_saturation_factor:new c.b7(f,e.u_saturation_factor),u_contrast_factor:new c.b7(f,e.u_contrast_factor),u_spin_weights:new c.bI(f,e.u_spin_weights),u_coords_top:new c.bH(f,e.u_coords_top),u_coords_bottom:new c.bH(f,e.u_coords_bottom)}),symbolIcon:(f,e)=>({u_is_size_zoom_constant:new c.bE(f,e.u_is_size_zoom_constant),u_is_size_feature_constant:new c.bE(f,e.u_is_size_feature_constant),u_size_t:new c.b7(f,e.u_size_t),u_size:new c.b7(f,e.u_size),u_camera_to_center_distance:new c.b7(f,e.u_camera_to_center_distance),u_pitch:new c.b7(f,e.u_pitch),u_rotate_symbol:new c.bE(f,e.u_rotate_symbol),u_aspect_ratio:new c.b7(f,e.u_aspect_ratio),u_fade_change:new c.b7(f,e.u_fade_change),u_label_plane_matrix:new c.bG(f,e.u_label_plane_matrix),u_coord_matrix:new c.bG(f,e.u_coord_matrix),u_is_text:new c.bE(f,e.u_is_text),u_pitch_with_map:new c.bE(f,e.u_pitch_with_map),u_is_along_line:new c.bE(f,e.u_is_along_line),u_is_variable_anchor:new c.bE(f,e.u_is_variable_anchor),u_texsize:new c.bJ(f,e.u_texsize),u_texture:new c.bE(f,e.u_texture),u_translation:new c.bJ(f,e.u_translation),u_pitched_scale:new c.b7(f,e.u_pitched_scale)}),symbolSDF:(f,e)=>({u_is_size_zoom_constant:new c.bE(f,e.u_is_size_zoom_constant),u_is_size_feature_constant:new c.bE(f,e.u_is_size_feature_constant),u_size_t:new c.b7(f,e.u_size_t),u_size:new c.b7(f,e.u_size),u_camera_to_center_distance:new c.b7(f,e.u_camera_to_center_distance),u_pitch:new c.b7(f,e.u_pitch),u_rotate_symbol:new c.bE(f,e.u_rotate_symbol),u_aspect_ratio:new c.b7(f,e.u_aspect_ratio),u_fade_change:new c.b7(f,e.u_fade_change),u_label_plane_matrix:new c.bG(f,e.u_label_plane_matrix),u_coord_matrix:new c.bG(f,e.u_coord_matrix),u_is_text:new c.bE(f,e.u_is_text),u_pitch_with_map:new c.bE(f,e.u_pitch_with_map),u_is_along_line:new c.bE(f,e.u_is_along_line),u_is_variable_anchor:new c.bE(f,e.u_is_variable_anchor),u_texsize:new c.bJ(f,e.u_texsize),u_texture:new c.bE(f,e.u_texture),u_gamma_scale:new c.b7(f,e.u_gamma_scale),u_device_pixel_ratio:new c.b7(f,e.u_device_pixel_ratio),u_is_halo:new c.bE(f,e.u_is_halo),u_translation:new c.bJ(f,e.u_translation),u_pitched_scale:new c.b7(f,e.u_pitched_scale)}),symbolTextAndIcon:(f,e)=>({u_is_size_zoom_constant:new c.bE(f,e.u_is_size_zoom_constant),u_is_size_feature_constant:new c.bE(f,e.u_is_size_feature_constant),u_size_t:new c.b7(f,e.u_size_t),u_size:new c.b7(f,e.u_size),u_camera_to_center_distance:new c.b7(f,e.u_camera_to_center_distance),u_pitch:new c.b7(f,e.u_pitch),u_rotate_symbol:new c.bE(f,e.u_rotate_symbol),u_aspect_ratio:new c.b7(f,e.u_aspect_ratio),u_fade_change:new c.b7(f,e.u_fade_change),u_label_plane_matrix:new c.bG(f,e.u_label_plane_matrix),u_coord_matrix:new c.bG(f,e.u_coord_matrix),u_is_text:new c.bE(f,e.u_is_text),u_pitch_with_map:new c.bE(f,e.u_pitch_with_map),u_is_along_line:new c.bE(f,e.u_is_along_line),u_is_variable_anchor:new c.bE(f,e.u_is_variable_anchor),u_texsize:new c.bJ(f,e.u_texsize),u_texsize_icon:new c.bJ(f,e.u_texsize_icon),u_texture:new c.bE(f,e.u_texture),u_texture_icon:new c.bE(f,e.u_texture_icon),u_gamma_scale:new c.b7(f,e.u_gamma_scale),u_device_pixel_ratio:new c.b7(f,e.u_device_pixel_ratio),u_is_halo:new c.bE(f,e.u_is_halo),u_translation:new c.bJ(f,e.u_translation),u_pitched_scale:new c.b7(f,e.u_pitched_scale)}),background:(f,e)=>({u_opacity:new c.b7(f,e.u_opacity),u_color:new c.bF(f,e.u_color)}),backgroundPattern:(f,e)=>({u_opacity:new c.b7(f,e.u_opacity),u_image:new c.bE(f,e.u_image),u_pattern_tl_a:new c.bJ(f,e.u_pattern_tl_a),u_pattern_br_a:new c.bJ(f,e.u_pattern_br_a),u_pattern_tl_b:new c.bJ(f,e.u_pattern_tl_b),u_pattern_br_b:new c.bJ(f,e.u_pattern_br_b),u_texsize:new c.bJ(f,e.u_texsize),u_mix:new c.b7(f,e.u_mix),u_pattern_size_a:new c.bJ(f,e.u_pattern_size_a),u_pattern_size_b:new c.bJ(f,e.u_pattern_size_b),u_scale_a:new c.b7(f,e.u_scale_a),u_scale_b:new c.b7(f,e.u_scale_b),u_pixel_coord_upper:new c.bJ(f,e.u_pixel_coord_upper),u_pixel_coord_lower:new c.bJ(f,e.u_pixel_coord_lower),u_tile_units_to_pixels:new c.b7(f,e.u_tile_units_to_pixels)}),terrain:(f,e)=>({u_texture:new c.bE(f,e.u_texture),u_ele_delta:new c.b7(f,e.u_ele_delta),u_fog_matrix:new c.bG(f,e.u_fog_matrix),u_fog_color:new c.bF(f,e.u_fog_color),u_fog_ground_blend:new c.b7(f,e.u_fog_ground_blend),u_fog_ground_blend_opacity:new c.b7(f,e.u_fog_ground_blend_opacity),u_horizon_color:new c.bF(f,e.u_horizon_color),u_horizon_fog_blend:new c.b7(f,e.u_horizon_fog_blend),u_is_globe_mode:new c.b7(f,e.u_is_globe_mode)}),terrainDepth:(f,e)=>({u_ele_delta:new c.b7(f,e.u_ele_delta)}),terrainCoords:(f,e)=>({u_texture:new c.bE(f,e.u_texture),u_terrain_coords_id:new c.b7(f,e.u_terrain_coords_id),u_ele_delta:new c.b7(f,e.u_ele_delta)}),projectionErrorMeasurement:(f,e)=>({u_input:new c.b7(f,e.u_input),u_output_expected:new c.b7(f,e.u_output_expected)}),atmosphere:(f,e)=>({u_sun_pos:new c.bI(f,e.u_sun_pos),u_atmosphere_blend:new c.b7(f,e.u_atmosphere_blend),u_globe_position:new c.bI(f,e.u_globe_position),u_globe_radius:new c.b7(f,e.u_globe_radius),u_inv_proj_matrix:new c.bG(f,e.u_inv_proj_matrix)}),sky:(f,e)=>({u_sky_color:new c.bF(f,e.u_sky_color),u_horizon_color:new c.bF(f,e.u_horizon_color),u_horizon:new c.bJ(f,e.u_horizon),u_horizon_normal:new c.bJ(f,e.u_horizon_normal),u_sky_horizon_blend:new c.b7(f,e.u_sky_horizon_blend),u_sky_blend:new c.b7(f,e.u_sky_blend)})};class _p{constructor(e,i,u){this.context=e;const h=e.gl;this.buffer=h.createBuffer(),this.dynamicDraw=!!u,this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),h.bufferData(h.ELEMENT_ARRAY_BUFFER,i.arrayBuffer,this.dynamicDraw?h.DYNAMIC_DRAW:h.STATIC_DRAW),this.dynamicDraw||delete i.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(e){const i=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),i.bufferSubData(i.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Qu={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class us{constructor(e,i,u,h){this.length=i.length,this.attributes=u,this.itemSize=i.bytesPerElement,this.dynamicDraw=h,this.context=e;const g=e.gl;this.buffer=g.createBuffer(),e.bindVertexBuffer.set(this.buffer),g.bufferData(g.ARRAY_BUFFER,i.arrayBuffer,this.dynamicDraw?g.DYNAMIC_DRAW:g.STATIC_DRAW),this.dynamicDraw||delete i.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(e){if(e.length!==this.length)throw new Error(`Length of new data is ${e.length}, which doesn't match current length of ${this.length}`);const i=this.context.gl;this.bind(),i.bufferSubData(i.ARRAY_BUFFER,0,e.arrayBuffer)}enableAttributes(e,i){for(let u=0;u<this.attributes.length;u++){const h=i.attributes[this.attributes[u].name];h!==void 0&&e.enableVertexAttribArray(h)}}setVertexAttribPointers(e,i,u){for(let h=0;h<this.attributes.length;h++){const g=this.attributes[h],v=i.attributes[g.name];v!==void 0&&e.vertexAttribPointer(v,g.components,e[Qu[g.type]],!1,this.itemSize,g.offset+this.itemSize*(u||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class $t{constructor(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(e){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Wg extends $t{getDefault(){return c.b6.transparent}set(e){const i=this.current;(e.r!==i.r||e.g!==i.g||e.b!==i.b||e.a!==i.a||this.dirty)&&(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class Hg extends $t{getDefault(){return 1}set(e){(e!==this.current||this.dirty)&&(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}}class Xg extends $t{getDefault(){return 0}set(e){(e!==this.current||this.dirty)&&(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}}class Kg extends $t{getDefault(){return[!0,!0,!0,!0]}set(e){const i=this.current;(e[0]!==i[0]||e[1]!==i[1]||e[2]!==i[2]||e[3]!==i[3]||this.dirty)&&(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class yp extends $t{getDefault(){return!0}set(e){(e!==this.current||this.dirty)&&(this.gl.depthMask(e),this.current=e,this.dirty=!1)}}class Yg extends $t{getDefault(){return 255}set(e){(e!==this.current||this.dirty)&&(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}}class vp extends $t{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(e){const i=this.current;(e.func!==i.func||e.ref!==i.ref||e.mask!==i.mask||this.dirty)&&(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}}class Wl extends $t{getDefault(){const e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}set(e){const i=this.current;(e[0]!==i[0]||e[1]!==i[1]||e[2]!==i[2]||this.dirty)&&(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}}class Hl extends $t{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const i=this.gl;e?i.enable(i.STENCIL_TEST):i.disable(i.STENCIL_TEST),this.current=e,this.dirty=!1}}class Xl extends $t{getDefault(){return[0,1]}set(e){const i=this.current;(e[0]!==i[0]||e[1]!==i[1]||this.dirty)&&(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}}class Ju extends $t{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const i=this.gl;e?i.enable(i.DEPTH_TEST):i.disable(i.DEPTH_TEST),this.current=e,this.dirty=!1}}class hs extends $t{getDefault(){return this.gl.LESS}set(e){(e!==this.current||this.dirty)&&(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}}class Qs extends $t{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const i=this.gl;e?i.enable(i.BLEND):i.disable(i.BLEND),this.current=e,this.dirty=!1}}class ci extends $t{getDefault(){const e=this.gl;return[e.ONE,e.ZERO]}set(e){const i=this.current;(e[0]!==i[0]||e[1]!==i[1]||this.dirty)&&(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)}}class xp extends $t{getDefault(){return c.b6.transparent}set(e){const i=this.current;(e.r!==i.r||e.g!==i.g||e.b!==i.b||e.a!==i.a||this.dirty)&&(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class bp extends $t{getDefault(){return this.gl.FUNC_ADD}set(e){(e!==this.current||this.dirty)&&(this.gl.blendEquation(e),this.current=e,this.dirty=!1)}}class eh extends $t{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const i=this.gl;e?i.enable(i.CULL_FACE):i.disable(i.CULL_FACE),this.current=e,this.dirty=!1}}class ds extends $t{getDefault(){return this.gl.BACK}set(e){(e!==this.current||this.dirty)&&(this.gl.cullFace(e),this.current=e,this.dirty=!1)}}class Kl extends $t{getDefault(){return this.gl.CCW}set(e){(e!==this.current||this.dirty)&&(this.gl.frontFace(e),this.current=e,this.dirty=!1)}}class Yl extends $t{getDefault(){return null}set(e){(e!==this.current||this.dirty)&&(this.gl.useProgram(e),this.current=e,this.dirty=!1)}}class Xa extends $t{getDefault(){return this.gl.TEXTURE0}set(e){(e!==this.current||this.dirty)&&(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}}class Ql extends $t{getDefault(){const e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}set(e){const i=this.current;(e[0]!==i[0]||e[1]!==i[1]||e[2]!==i[2]||e[3]!==i[3]||this.dirty)&&(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class wp extends $t{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const i=this.gl;i.bindFramebuffer(i.FRAMEBUFFER,e),this.current=e,this.dirty=!1}}class Js extends $t{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const i=this.gl;i.bindRenderbuffer(i.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class ea extends $t{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const i=this.gl;i.bindTexture(i.TEXTURE_2D,e),this.current=e,this.dirty=!1}}class Sp extends $t{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const i=this.gl;i.bindBuffer(i.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class th extends $t{getDefault(){return null}set(e){const i=this.gl;i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class Ot extends $t{getDefault(){return null}set(e){var i;if(e===this.current&&!this.dirty)return;const u=this.gl;li(u)?u.bindVertexArray(e):(i=u.getExtension("OES_vertex_array_object"))===null||i===void 0||i.bindVertexArrayOES(e),this.current=e,this.dirty=!1}}class Jl extends $t{getDefault(){return 4}set(e){if(e===this.current&&!this.dirty)return;const i=this.gl;i.pixelStorei(i.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}}class Qg extends $t{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const i=this.gl;i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}}class Tp extends $t{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const i=this.gl;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}}class ps extends $t{constructor(e,i){super(e),this.context=e,this.parent=i}getDefault(){return null}}class Jg extends ps{setDirty(){this.dirty=!0}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const i=this.gl;i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}}class e_ extends ps{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const i=this.gl;i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class Pp extends ps{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const i=this.gl;i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.RENDERBUFFER,e),this.current=e,this.dirty=!1}}const Cp="Framebuffer is not complete";class rh{constructor(e,i,u,h,g){this.context=e,this.width=i,this.height=u;const v=e.gl,S=this.framebuffer=v.createFramebuffer();if(this.colorAttachment=new Jg(e,S),h)this.depthAttachment=g?new Pp(e,S):new e_(e,S);else if(g)throw new Error("Stencil cannot be set without depth");if(v.checkFramebufferStatus(v.FRAMEBUFFER)!==v.FRAMEBUFFER_COMPLETE)throw new Error(Cp)}destroy(){const e=this.context.gl,i=this.colorAttachment.get();if(i&&e.deleteTexture(i),this.depthAttachment){const u=this.depthAttachment.get();u&&e.deleteRenderbuffer(u)}e.deleteFramebuffer(this.framebuffer)}}class ec{constructor(e){var i,u;if(this.gl=e,this.clearColor=new Wg(this),this.clearDepth=new Hg(this),this.clearStencil=new Xg(this),this.colorMask=new Kg(this),this.depthMask=new yp(this),this.stencilMask=new Yg(this),this.stencilFunc=new vp(this),this.stencilOp=new Wl(this),this.stencilTest=new Hl(this),this.depthRange=new Xl(this),this.depthTest=new Ju(this),this.depthFunc=new hs(this),this.blend=new Qs(this),this.blendFunc=new ci(this),this.blendColor=new xp(this),this.blendEquation=new bp(this),this.cullFace=new eh(this),this.cullFaceSide=new ds(this),this.frontFace=new Kl(this),this.program=new Yl(this),this.activeTexture=new Xa(this),this.viewport=new Ql(this),this.bindFramebuffer=new wp(this),this.bindRenderbuffer=new Js(this),this.bindTexture=new ea(this),this.bindVertexBuffer=new Sp(this),this.bindElementBuffer=new th(this),this.bindVertexArray=new Ot(this),this.pixelStoreUnpack=new Jl(this),this.pixelStoreUnpackPremultiplyAlpha=new Qg(this),this.pixelStoreUnpackFlipY=new Tp(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),li(e)){this.HALF_FLOAT=e.HALF_FLOAT;const h=e.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(i=e.RGBA16F)!==null&&i!==void 0?i:h==null?void 0:h.RGBA16F_EXT,this.RGB16F=(u=e.RGB16F)!==null&&u!==void 0?u:h==null?void 0:h.RGB16F_EXT,e.getExtension("EXT_color_buffer_float")}else{e.getExtension("EXT_color_buffer_half_float"),e.getExtension("OES_texture_half_float_linear");const h=e.getExtension("OES_texture_half_float");this.HALF_FLOAT=h==null?void 0:h.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,i){return new _p(this,e,i)}createVertexBuffer(e,i,u){return new us(this,e,i,u)}createRenderbuffer(e,i,u){const h=this.gl,g=h.createRenderbuffer();return this.bindRenderbuffer.set(g),h.renderbufferStorage(h.RENDERBUFFER,e,i,u),this.bindRenderbuffer.set(null),g}createFramebuffer(e,i,u,h){return new rh(this,e,i,u,h)}clear({color:e,depth:i,stencil:u}){const h=this.gl;let g=0;e&&(g|=h.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),i!==void 0&&(g|=h.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(i),this.depthMask.set(!0)),u!==void 0&&(g|=h.STENCIL_BUFFER_BIT,this.clearStencil.set(u),this.stencilMask.set(255)),h.clear(g)}setCullFace(e){e.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}setDepthMode(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)}setStencilMode(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)}setColorMode(e){c.bB(e.blendFunction,sr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)}createVertexArray(){var e;return li(this.gl)?this.gl.createVertexArray():(e=this.gl.getExtension("OES_vertex_array_object"))===null||e===void 0?void 0:e.createVertexArrayOES()}deleteVertexArray(e){var i;return li(this.gl)?this.gl.deleteVertexArray(e):(i=this.gl.getExtension("OES_vertex_array_object"))===null||i===void 0?void 0:i.deleteVertexArrayOES(e)}unbindVAO(){this.bindVertexArray.set(null)}}let fs;function tc(f,e,i,u,h){const g=f.context,v=f.transform,S=g.gl,P=f.useProgram("collisionBox"),E=[];let k=0,R=0;for(let te=0;te<u.length;te++){const oe=u[te],ue=e.getTile(oe).getBucket(i);if(!ue)continue;const he=h?ue.textCollisionBox:ue.iconCollisionBox,pe=ue.collisionCircleArray;pe.length>0&&(E.push({circleArray:pe,circleOffset:R,coord:oe}),k+=pe.length/4,R=k),he&&P.draw(g,S.LINES,Mt.disabled,Dt.disabled,f.colorModeForRenderPass(),Rt.disabled,Zu(f.transform),f.style.map.terrain&&f.style.map.terrain.getTerrainData(oe),v.getProjectionData({overscaledTileID:oe,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),i.id,he.layoutVertexBuffer,he.indexBuffer,he.segments,null,f.transform.zoom,null,null,he.collisionVertexBuffer)}if(!h||!E.length)return;const L=f.useProgram("collisionCircle"),N=new c.bO;N.resize(4*k),N._trim();let V=0;for(const te of E)for(let oe=0;oe<te.circleArray.length/4;oe++){const ue=4*oe,he=te.circleArray[ue+0],pe=te.circleArray[ue+1],ge=te.circleArray[ue+2],fe=te.circleArray[ue+3];N.emplace(V++,he,pe,ge,fe,0),N.emplace(V++,he,pe,ge,fe,1),N.emplace(V++,he,pe,ge,fe,2),N.emplace(V++,he,pe,ge,fe,3)}(!fs||fs.length<2*k)&&(fs=function(te){const oe=2*te,ue=new c.bQ;ue.resize(oe),ue._trim();for(let he=0;he<oe;he++){const pe=6*he;ue.uint16[pe+0]=4*he+0,ue.uint16[pe+1]=4*he+1,ue.uint16[pe+2]=4*he+2,ue.uint16[pe+3]=4*he+2,ue.uint16[pe+4]=4*he+3,ue.uint16[pe+5]=4*he+0}return ue}(k));const J=g.createIndexBuffer(fs,!0),K=g.createVertexBuffer(N,c.bP.members,!0);for(const te of E){const oe=hp(f.transform);L.draw(g,S.TRIANGLES,Mt.disabled,Dt.disabled,f.colorModeForRenderPass(),Rt.disabled,oe,f.style.map.terrain&&f.style.map.terrain.getTerrainData(te.coord),null,i.id,K,J,c.aF.simpleSegment(0,2*te.circleOffset,te.circleArray.length,te.circleArray.length/2),null,f.transform.zoom,null,null,null)}K.destroy(),J.destroy()}const nh=c.as(new Float32Array(16));function Ep(f,e,i,u,h,g){const{horizontalAlign:v,verticalAlign:S}=c.aA(f);return new c.P((-(v-.5)*e/h+u[0])*g,(-(S-.5)*i/h+u[1])*g)}function rc(f,e,i,u,h,g){const v=e.tileAnchorPoint.add(new c.P(e.translation[0],e.translation[1]));if(e.pitchWithMap){let S=u.mult(g);i||(S=S.rotate(-h));const P=v.add(S);return ke(P.x,P.y,e.pitchedLabelPlaneMatrix,e.getElevation).point}if(i){const S=st(e.tileAnchorPoint.x+1,e.tileAnchorPoint.y,e).point.sub(f),P=Math.atan(S.y/S.x)+(S.x<0?Math.PI:0);return f.add(u.rotate(P))}return f.add(u)}function nc(f,e,i,u,h,g,v,S,P,E,k,R){const L=f.text.placedSymbolArray,N=f.text.dynamicLayoutVertexArray,V=f.icon.dynamicLayoutVertexArray,J={};N.clear();for(let K=0;K<L.length;K++){const te=L.get(K),oe=te.hidden||!te.crossTileID||f.allowVerticalPlacement&&!te.placedOrientation?null:u[te.crossTileID];if(oe){const ue=new c.P(te.anchorX,te.anchorY),he={getElevation:R,width:h.width,height:h.height,pitchedLabelPlaneMatrix:g,pitchWithMap:i,transform:h,tileAnchorPoint:ue,translation:E,unwrappedTileID:k},pe=i?It(ue.x,ue.y,he):st(ue.x,ue.y,he),ge=Se(h.cameraToCenterDistance,pe.signedDistanceFromCamera);let fe=c.ah(f.textSizeData,S,te)*ge/c.au;i&&(fe*=f.tilePixelRatio/v);const{width:Pe,height:Ee,anchor:Be,textOffset:je,textBoxScale:Le}=oe,Qe=Ep(Be,Pe,Ee,je,Le,fe),Ke=h.getPitchedTextCorrection(ue.x+E[0],ue.y+E[1],k),Ge=rc(pe.point,he,e,Qe,-h.bearingInRadians,Ke),lt=f.allowVerticalPlacement&&te.placedOrientation===c.ag.vertical?Math.PI/2:0;for(let mt=0;mt<te.numGlyphs;mt++)c.an(N,Ge,lt);P&&te.associatedIconIndex>=0&&(J[te.associatedIconIndex]={shiftedAnchor:Ge,angle:lt})}else Lr(te.numGlyphs,N)}if(P){V.clear();const K=f.icon.placedSymbolArray;for(let te=0;te<K.length;te++){const oe=K.get(te);if(oe.hidden)Lr(oe.numGlyphs,V);else{const ue=J[te];if(ue)for(let he=0;he<oe.numGlyphs;he++)c.an(V,ue.shiftedAnchor,ue.angle);else Lr(oe.numGlyphs,V)}}f.icon.dynamicLayoutVertexBuffer.updateData(V)}f.text.dynamicLayoutVertexBuffer.updateData(N)}function ih(f,e,i){return i.iconsInText&&e?"symbolTextAndIcon":f?"symbolSDF":"symbolIcon"}function Mp(f,e,i,u,h,g,v,S,P,E,k,R,L){const N=f.context,V=N.gl,J=f.transform,K=S==="map",te=P==="map",oe=S!=="viewport"&&i.layout.get("symbol-placement")!=="point",ue=K&&!te&&!oe,he=!i.layout.get("symbol-sort-key").isConstant();let pe=!1;const ge=f.getDepthModeForSublayer(0,Mt.ReadOnly),fe=i._unevaluatedLayout.hasValue("text-variable-anchor")||i._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Pe=[],Ee=J.getCircleRadiusCorrection();for(const Be of u){const je=e.getTile(Be),Le=je.getBucket(i);if(!Le)continue;const Qe=h?Le.text:Le.icon;if(!Qe||!Qe.segments.get().length||!Qe.hasVisibleVertices)continue;const Ke=Qe.programConfigurations.get(i.id),Ge=h||Le.sdfIcons,lt=h?Le.textSizeData:Le.iconSizeData,mt=te||J.pitch!==0,Vt=f.useProgram(ih(Ge,h,Le),Ke),Yt=c.af(lt,J.zoom),Gt=f.style.map.terrain&&f.style.map.terrain.getTerrainData(Be);let lr,nr,Ut,qt,Jr=[0,0],en=null;if(h)nr=je.glyphAtlasTexture,Ut=V.LINEAR,lr=je.glyphAtlasTexture.size,Le.iconsInText&&(Jr=je.imageAtlasTexture.size,en=je.imageAtlasTexture,qt=mt||f.options.rotating||f.options.zooming||lt.kind==="composite"||lt.kind==="camera"?V.LINEAR:V.NEAREST);else{const Qt=i.layout.get("icon-size").constantOr(0)!==1||Le.iconsNeedLinear;nr=je.imageAtlasTexture,Ut=Ge||f.options.rotating||f.options.zooming||Qt||mt?V.LINEAR:V.NEAREST,lr=je.imageAtlasTexture.size}const $r=c.av(je,1,f.transform.zoom),un=Me(K,f.transform,$r),Oo=c.K();c.ai(Oo,un);const mo=ye(te,K,f.transform,$r),Wi=c.aw(J,je,g,v),di=J.getProjectionData({overscaledTileID:Be,applyGlobeMatrix:!L,applyTerrainMatrix:!0}),xs=fe&&Le.hasTextData(),sl=i.layout.get("icon-text-fit")!=="none"&&xs&&Le.hasIconData();if(oe){const Qt=f.style.map.terrain?(Vr,Ur)=>f.style.map.terrain.getElevation(Be,Vr,Ur):null,Kt=i.layout.get("text-rotation-alignment")==="map";Te(Le,f,h,un,Oo,te,E,Kt,Be.toUnwrapped(),J.width,J.height,Wi,Qt)}const bs=h&&fe||sl,pi=oe||bs?nh:te?un:f.transform.clipSpaceToPixelsMatrix,Hi=Ge&&i.paint.get(h?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Ti;Ti=Ge?Le.iconsInText?Gl(lt.kind,Yt,ue,te,oe,bs,f,pi,mo,Wi,lr,Jr,Ee):Xu(lt.kind,Yt,ue,te,oe,bs,f,pi,mo,Wi,h,lr,0,Ee):Zl(lt.kind,Yt,ue,te,oe,bs,f,pi,mo,Wi,h,lr,Ee);const Xi={program:Vt,buffers:Qe,uniformValues:Ti,projectionData:di,atlasTexture:nr,atlasTextureIcon:en,atlasInterpolation:Ut,atlasInterpolationIcon:qt,isSDF:Ge,hasHalo:Hi};if(he&&Le.canOverlap){pe=!0;const Qt=Qe.segments.get();for(const Kt of Qt)Pe.push({segments:new c.aF([Kt]),sortKey:Kt.sortKey,state:Xi,terrainData:Gt})}else Pe.push({segments:Qe.segments,sortKey:0,state:Xi,terrainData:Gt})}pe&&Pe.sort((Be,je)=>Be.sortKey-je.sortKey);for(const Be of Pe){const je=Be.state;if(N.activeTexture.set(V.TEXTURE0),je.atlasTexture.bind(je.atlasInterpolation,V.CLAMP_TO_EDGE),je.atlasTextureIcon&&(N.activeTexture.set(V.TEXTURE1),je.atlasTextureIcon&&je.atlasTextureIcon.bind(je.atlasInterpolationIcon,V.CLAMP_TO_EDGE)),je.isSDF){const Le=je.uniformValues;je.hasHalo&&(Le.u_is_halo=1,ic(je.buffers,Be.segments,i,f,je.program,ge,k,R,Le,je.projectionData,Be.terrainData)),Le.u_is_halo=0}ic(je.buffers,Be.segments,i,f,je.program,ge,k,R,je.uniformValues,je.projectionData,Be.terrainData)}}function ic(f,e,i,u,h,g,v,S,P,E,k){const R=u.context;h.draw(R,R.gl.TRIANGLES,g,v,S,Rt.backCCW,P,k,E,i.id,f.layoutVertexBuffer,f.indexBuffer,e,i.paint,u.transform.zoom,f.programConfigurations.get(i.id),f.dynamicLayoutVertexBuffer,f.opacityVertexBuffer)}function t_(f,e,i,u,h){const g=f.context,v=g.gl,S=Dt.disabled,P=new sr([v.ONE,v.ONE],c.b6.transparent,[!0,!0,!0,!0]),E=e.getBucket(i);if(!E)return;const k=u.key;let R=i.heatmapFbos.get(k);R||(R=Ka(g,e.tileSize,e.tileSize),i.heatmapFbos.set(k,R)),g.bindFramebuffer.set(R.framebuffer),g.viewport.set([0,0,e.tileSize,e.tileSize]),g.clear({color:c.b6.transparent});const L=E.programConfigurations.get(i.id),N=f.useProgram("heatmap",L,!h),V=f.transform.getProjectionData({overscaledTileID:e.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),J=f.style.map.terrain.getTerrainData(u);N.draw(g,v.TRIANGLES,Mt.disabled,S,P,Rt.disabled,qu(e,f.transform.zoom,i.paint.get("heatmap-intensity"),1),J,V,i.id,E.layoutVertexBuffer,E.indexBuffer,E.segments,i.paint,f.transform.zoom,L)}function Ip(f,e,i,u,h){const g=f.context,v=g.gl,S=f.transform;g.setColorMode(f.colorModeForRenderPass());const P=oc(g,e),E=i.key,k=e.heatmapFbos.get(E);if(!k)return;g.activeTexture.set(v.TEXTURE0),v.bindTexture(v.TEXTURE_2D,k.colorAttachment.get()),g.activeTexture.set(v.TEXTURE1),P.bind(v.LINEAR,v.CLAMP_TO_EDGE);const R=S.getProjectionData({overscaledTileID:i,applyTerrainMatrix:h,applyGlobeMatrix:!u});f.useProgram("heatmapTexture").draw(g,v.TRIANGLES,Mt.disabled,Dt.disabled,f.colorModeForRenderPass(),Rt.disabled,Wu(f,e,0,1),null,R,e.id,f.rasterBoundsBuffer,f.quadTriangleIndexBuffer,f.rasterBoundsSegments,e.paint,S.zoom),k.destroy(),e.heatmapFbos.delete(E)}function Ka(f,e,i){var u,h;const g=f.gl,v=g.createTexture();g.bindTexture(g.TEXTURE_2D,v),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,g.CLAMP_TO_EDGE),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,g.CLAMP_TO_EDGE),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,g.LINEAR),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,g.LINEAR);const S=(u=f.HALF_FLOAT)!==null&&u!==void 0?u:g.UNSIGNED_BYTE,P=(h=f.RGBA16F)!==null&&h!==void 0?h:g.RGBA;g.texImage2D(g.TEXTURE_2D,0,P,e,i,0,g.RGBA,S,null);const E=f.createFramebuffer(e,i,!1,!1);return E.colorAttachment.set(v),E}function oc(f,e){return e.colorRampTexture||(e.colorRampTexture=new We(f,e.colorRamp,f.gl.RGBA)),e.colorRampTexture}function oh(f,e,i,u,h){if(!i||!u||!u.imageAtlas)return;const g=u.imageAtlas.patternPositions;let v=g[i.to.toString()],S=g[i.from.toString()];if(!v&&S&&(v=S),!S&&v&&(S=v),!v||!S){const P=h.getPaintProperty(e);v=g[P],S=g[P]}v&&S&&f.setConstantPatternPositions(v,S)}function sh(f,e,i,u,h,g,v,S){const P=f.context.gl,E="fill-pattern",k=i.paint.get(E),R=k&&k.constantOr(1),L=i.getCrossfadeParameters();let N,V,J,K,te;const oe=f.transform,ue=i.paint.get("fill-translate"),he=i.paint.get("fill-translate-anchor");v?(V=R&&!i.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",N=P.LINES):(V=R?"fillPattern":"fill",N=P.TRIANGLES);const pe=k.constantOr(null);for(const ge of u){const fe=e.getTile(ge);if(R&&!fe.patternsLoaded())continue;const Pe=fe.getBucket(i);if(!Pe)continue;const Ee=Pe.programConfigurations.get(i.id),Be=f.useProgram(V,Ee),je=f.style.map.terrain&&f.style.map.terrain.getTerrainData(ge);R&&(f.context.activeTexture.set(P.TEXTURE0),fe.imageAtlasTexture.bind(P.LINEAR,P.CLAMP_TO_EDGE),Ee.updatePaintBuffers(L)),oh(Ee,E,pe,fe,i);const Le=oe.getProjectionData({overscaledTileID:ge,applyGlobeMatrix:!S,applyTerrainMatrix:!0}),Qe=c.aw(oe,fe,ue,he);if(v){K=Pe.indexBuffer2,te=Pe.segments2;const Ge=[P.drawingBufferWidth,P.drawingBufferHeight];J=V==="fillOutlinePattern"&&R?Zg(f,L,fe,Ge,Qe):cp(Ge,Qe)}else K=Pe.indexBuffer,te=Pe.segments,J=R?lp(f,L,fe,Qe):{u_fill_translate:Qe};let Ke;if(f.renderPass==="translucent"&&S){const[Ge]=f.getStencilConfigForOverlapAndUpdateStencilID(u);Ke=Ge[ge.overscaledZ]}else Ke=f.stencilModeForClipping(ge);Be.draw(f.context,N,h,Ke,g,Rt.backCCW,J,je,Le,i.id,Pe.layoutVertexBuffer,K,te,i.paint,f.transform.zoom,Ee)}}function ta(f,e,i,u,h,g,v,S){const P=f.context,E=P.gl,k="fill-extrusion-pattern",R=i.paint.get(k),L=R.constantOr(1),N=i.getCrossfadeParameters(),V=i.paint.get("fill-extrusion-opacity"),J=R.constantOr(null),K=f.transform;for(const te of u){const oe=e.getTile(te),ue=oe.getBucket(i);if(!ue)continue;const he=f.style.map.terrain&&f.style.map.terrain.getTerrainData(te),pe=ue.programConfigurations.get(i.id),ge=f.useProgram(L?"fillExtrusionPattern":"fillExtrusion",pe);L&&(f.context.activeTexture.set(E.TEXTURE0),oe.imageAtlasTexture.bind(E.LINEAR,E.CLAMP_TO_EDGE),pe.updatePaintBuffers(N));const fe=K.getProjectionData({overscaledTileID:te,applyGlobeMatrix:!S,applyTerrainMatrix:!0});oh(pe,k,J,oe,i);const Pe=c.aw(K,oe,i.paint.get("fill-extrusion-translate"),i.paint.get("fill-extrusion-translate-anchor")),Ee=i.paint.get("fill-extrusion-vertical-gradient"),Be=L?Ys(f,Ee,V,Pe,te,N,oe):ap(f,Ee,V,Pe);ge.draw(P,P.gl.TRIANGLES,h,g,v,Rt.backCCW,Be,he,fe,i.id,ue.layoutVertexBuffer,ue.indexBuffer,ue.segments,i.paint,f.transform.zoom,pe,f.style.map.terrain&&ue.centroidVertexBuffer)}}function Ya(f,e,i,u,h,g,v,S,P){var E;const k=f.style.projection,R=f.context,L=f.transform,N=R.gl,V=f.useProgram("hillshade"),J=!f.options.moving;for(const K of u){const te=e.getTile(K),oe=te.fbo;if(!oe)continue;const ue=k.getMeshFromTileID(R,K.canonical,S,!0,"raster"),he=(E=f.style.map.terrain)===null||E===void 0?void 0:E.getTerrainData(K);R.activeTexture.set(N.TEXTURE0),N.bindTexture(N.TEXTURE_2D,oe.colorAttachment.get());const pe=L.getProjectionData({overscaledTileID:K,aligned:J,applyGlobeMatrix:!P,applyTerrainMatrix:!0});V.draw(R,N.TRIANGLES,g,h[K.overscaledZ],v,Rt.backCCW,ls(f,te,i),he,pe,i.id,ue.vertexBuffer,ue.indexBuffer,ue.segments)}}const ah=[new c.P(0,0),new c.P(c.Z,0),new c.P(c.Z,c.Z),new c.P(0,c.Z)];function Qa(f,e,i,u,h,g,v,S,P=!1,E=!1){const k=u[u.length-1].overscaledZ,R=f.context,L=R.gl,N=f.useProgram("raster"),V=f.transform,J=f.style.projection,K=f.colorModeForRenderPass(),te=!f.options.moving;for(const oe of u){const ue=f.getDepthModeForSublayer(oe.overscaledZ-k,i.paint.get("raster-opacity")===1?Mt.ReadWrite:Mt.ReadOnly,L.LESS),he=e.getTile(oe);he.registerFadeDuration(i.paint.get("raster-fade-duration"));const pe=e.findLoadedParent(oe,0),ge=e.findLoadedSibling(oe),fe=Sr(he,pe||ge||null,e,i,f.transform,f.style.map.terrain);let Pe,Ee;const Be=i.paint.get("raster-resampling")==="nearest"?L.NEAREST:L.LINEAR;R.activeTexture.set(L.TEXTURE0),he.texture.bind(Be,L.CLAMP_TO_EDGE,L.LINEAR_MIPMAP_NEAREST),R.activeTexture.set(L.TEXTURE1),pe?(pe.texture.bind(Be,L.CLAMP_TO_EDGE,L.LINEAR_MIPMAP_NEAREST),Pe=Math.pow(2,pe.tileID.overscaledZ-he.tileID.overscaledZ),Ee=[he.tileID.canonical.x*Pe%1,he.tileID.canonical.y*Pe%1]):he.texture.bind(Be,L.CLAMP_TO_EDGE,L.LINEAR_MIPMAP_NEAREST),he.texture.useMipmap&&R.extTextureFilterAnisotropic&&f.transform.pitch>20&&L.texParameterf(L.TEXTURE_2D,R.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,R.extTextureFilterAnisotropicMax);const je=f.style.map.terrain&&f.style.map.terrain.getTerrainData(oe),Le=V.getProjectionData({overscaledTileID:oe,aligned:te,applyGlobeMatrix:!E,applyTerrainMatrix:!0}),Qe=mp(Ee||[0,0],Pe||1,fe,i,S),Ke=J.getMeshFromTileID(R,oe.canonical,g,v,"raster");N.draw(R,L.TRIANGLES,ue,h?h[oe.overscaledZ]:Dt.disabled,K,P?Rt.frontCCW:Rt.backCCW,Qe,je,Le,i.id,Ke.vertexBuffer,Ke.indexBuffer,Ke.segments)}}function Sr(f,e,i,u,h,g){const v=u.paint.get("raster-fade-duration");if(!g&&v>0){const S=H.now(),P=(S-f.timeAdded)/v,E=e?(S-e.timeAdded)/v:-1,k=i.getSource(),R=ho(h,{tileSize:k.tileSize,roundZoom:k.roundZoom}),L=!e||Math.abs(e.tileID.overscaledZ-R)>Math.abs(f.tileID.overscaledZ-R),N=L&&f.refreshedUponExpiration?1:c.ad(L?P:1-E,0,1);return f.refreshedUponExpiration&&P>=1&&(f.refreshedUponExpiration=!1),e?{opacity:1,mix:1-N}:{opacity:N,mix:0}}return{opacity:1,mix:0}}const ms=new c.b6(1,0,0,1),ui=new c.b6(0,1,0,1),lh=new c.b6(0,0,1,1),ch=new c.b6(1,0,1,1),kp=new c.b6(0,1,1,1);function gs(f,e,i,u){na(f,0,e+i/2,f.transform.width,i,u)}function ra(f,e,i,u){na(f,e-i/2,0,i,f.transform.height,u)}function na(f,e,i,u,h,g){const v=f.context,S=v.gl;S.enable(S.SCISSOR_TEST),S.scissor(e*f.pixelRatio,i*f.pixelRatio,u*f.pixelRatio,h*f.pixelRatio),v.clear({color:g}),S.disable(S.SCISSOR_TEST)}function Ap(f,e,i){const u=f.context,h=u.gl,g=f.useProgram("debug"),v=Mt.disabled,S=Dt.disabled,P=f.colorModeForRenderPass(),E="$debug",k=f.style.map.terrain&&f.style.map.terrain.getTerrainData(i);u.activeTexture.set(h.TEXTURE0);const R=e.getTileByID(i.key).latestRawTileData,L=Math.floor((R&&R.byteLength||0)/1024),N=e.getTile(i).tileSize,V=512/Math.min(N,512)*(i.overscaledZ/f.transform.zoom)*.5;let J=i.canonical.toString();i.overscaledZ!==i.canonical.z&&(J+=` => ${i.overscaledZ}`),function(te,oe){te.initDebugOverlayCanvas();const ue=te.debugOverlayCanvas,he=te.context.gl,pe=te.debugOverlayCanvas.getContext("2d");pe.clearRect(0,0,ue.width,ue.height),pe.shadowColor="white",pe.shadowBlur=2,pe.lineWidth=1.5,pe.strokeStyle="white",pe.textBaseline="top",pe.font="bold 36px Open Sans, sans-serif",pe.fillText(oe,5,5),pe.strokeText(oe,5,5),te.debugOverlayTexture.update(ue),te.debugOverlayTexture.bind(he.LINEAR,he.CLAMP_TO_EDGE)}(f,`${J} ${L}kB`);const K=f.transform.getProjectionData({overscaledTileID:i,applyGlobeMatrix:!0,applyTerrainMatrix:!0});g.draw(u,h.TRIANGLES,v,S,sr.alphaBlended,Rt.disabled,Gu(c.b6.transparent,V),null,K,E,f.debugBuffer,f.quadTriangleIndexBuffer,f.debugSegments),g.draw(u,h.LINE_STRIP,v,S,P,Rt.disabled,Gu(c.b6.red),k,K,E,f.debugBuffer,f.tileBorderIndexBuffer,f.debugSegments)}function uh(f,e,i,u){const{isRenderingGlobe:h}=u,g=f.context,v=g.gl,S=f.transform,P=f.colorModeForRenderPass(),E=f.getDepthModeFor3D(),k=f.useProgram("terrain");g.bindFramebuffer.set(null),g.viewport.set([0,0,f.width,f.height]);for(const R of i){const L=e.getTerrainMesh(R.tileID),N=f.renderToTexture.getTexture(R),V=e.getTerrainData(R.tileID);g.activeTexture.set(v.TEXTURE0),v.bindTexture(v.TEXTURE_2D,N.texture);const J=e.getMeshFrameDelta(S.zoom),K=S.calculateFogMatrix(R.tileID.toUnwrapped()),te=Uu(J,K,f.style.sky,S.pitch,h),oe=S.getProjectionData({overscaledTileID:R.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});k.draw(g,v.TRIANGLES,E,Dt.disabled,P,Rt.backCCW,te,V,oe,"terrain",L.vertexBuffer,L.indexBuffer,L.segments)}}function hh(f,e){if(!e.mesh){const i=new c.aE;i.emplaceBack(-1,-1),i.emplaceBack(1,-1),i.emplaceBack(1,1),i.emplaceBack(-1,1);const u=new c.aG;u.emplaceBack(0,1,2),u.emplaceBack(0,2,3),e.mesh=new Wn(f.createVertexBuffer(i,ii.members),f.createIndexBuffer(u),c.aF.simpleSegment(0,0,i.length,u.length))}return e.mesh}class zp{constructor(e,i){this.context=new ec(e),this.transform=i,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:c.as(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=z.maxUnderzooming+z.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Du}resize(e,i,u){if(this.width=Math.floor(e*u),this.height=Math.floor(i*u),this.pixelRatio=u,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const h of this.style._order)this.style._layers[h].resize()}setup(){const e=this.context,i=new c.aE;i.emplaceBack(0,0),i.emplaceBack(c.Z,0),i.emplaceBack(0,c.Z),i.emplaceBack(c.Z,c.Z),this.tileExtentBuffer=e.createVertexBuffer(i,ii.members),this.tileExtentSegments=c.aF.simpleSegment(0,0,4,2);const u=new c.aE;u.emplaceBack(0,0),u.emplaceBack(c.Z,0),u.emplaceBack(0,c.Z),u.emplaceBack(c.Z,c.Z),this.debugBuffer=e.createVertexBuffer(u,ii.members),this.debugSegments=c.aF.simpleSegment(0,0,4,5);const h=new c.bV;h.emplaceBack(0,0,0,0),h.emplaceBack(c.Z,0,c.Z,0),h.emplaceBack(0,c.Z,0,c.Z),h.emplaceBack(c.Z,c.Z,c.Z,c.Z),this.rasterBoundsBuffer=e.createVertexBuffer(h,Ui.members),this.rasterBoundsSegments=c.aF.simpleSegment(0,0,4,2);const g=new c.aE;g.emplaceBack(0,0),g.emplaceBack(c.Z,0),g.emplaceBack(0,c.Z),g.emplaceBack(c.Z,c.Z),this.rasterBoundsBufferPosOnly=e.createVertexBuffer(g,ii.members),this.rasterBoundsSegmentsPosOnly=c.aF.simpleSegment(0,0,4,5);const v=new c.aE;v.emplaceBack(0,0),v.emplaceBack(1,0),v.emplaceBack(0,1),v.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(v,ii.members),this.viewportSegments=c.aF.simpleSegment(0,0,4,2);const S=new c.bW;S.emplaceBack(0),S.emplaceBack(1),S.emplaceBack(3),S.emplaceBack(2),S.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(S);const P=new c.aG;P.emplaceBack(1,0,2),P.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(P);const E=this.context.gl;this.stencilClearMode=new Dt({func:E.ALWAYS,mask:0},0,255,E.ZERO,E.ZERO,E.ZERO),this.tileExtentMesh=new Wn(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const e=this.context,i=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const u=c.K();c.bN(u,0,this.width,this.height,0,0,1),c.M(u,u,[i.drawingBufferWidth,i.drawingBufferHeight,0]);const h={mainMatrix:u,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:u};this.useProgram("clippingMask",null,!0).draw(e,i.TRIANGLES,Mt.disabled,this.stencilClearMode,sr.disabled,Rt.disabled,null,null,h,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(e,i,u){if(this.currentStencilSource===e.source||!e.isTileClipped()||!i||!i.length)return;this.currentStencilSource=e.source,this.nextStencilID+i.length>256&&this.clearStencil();const h=this.context;h.setColorMode(sr.disabled),h.setDepthMode(Mt.disabled);const g={};for(const v of i)g[v.key]=this.nextStencilID++;this._renderTileMasks(g,i,u,!0),this._renderTileMasks(g,i,u,!1),this._tileClippingMaskIDs=g}_renderTileMasks(e,i,u,h){const g=this.context,v=g.gl,S=this.style.projection,P=this.transform,E=this.useProgram("clippingMask");for(const k of i){const R=e[k.key],L=this.style.map.terrain&&this.style.map.terrain.getTerrainData(k),N=S.getMeshFromTileID(this.context,k.canonical,h,!0,"stencil"),V=P.getProjectionData({overscaledTileID:k,applyGlobeMatrix:!0,applyTerrainMatrix:!0});E.draw(g,v.TRIANGLES,Mt.disabled,new Dt({func:v.ALWAYS,mask:0},R,255,v.KEEP,v.KEEP,v.REPLACE),sr.disabled,u?Rt.disabled:Rt.backCCW,null,L,V,"$clipping",N.vertexBuffer,N.indexBuffer,N.segments)}}_renderTilesDepthBuffer(){const e=this.context,i=e.gl,u=this.style.projection,h=this.transform,g=this.useProgram("depth"),v=this.getDepthModeFor3D(),S=be(h,{tileSize:h.tileSize});for(const P of S){const E=this.style.map.terrain&&this.style.map.terrain.getTerrainData(P),k=u.getMeshFromTileID(this.context,P.canonical,!0,!0,"raster"),R=h.getProjectionData({overscaledTileID:P,applyGlobeMatrix:!0,applyTerrainMatrix:!0});g.draw(e,i.TRIANGLES,v,Dt.disabled,sr.disabled,Rt.backCCW,null,E,R,"$clipping",k.vertexBuffer,k.indexBuffer,k.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const e=this.nextStencilID++,i=this.context.gl;return new Dt({func:i.NOTEQUAL,mask:255},e,255,i.KEEP,i.KEEP,i.REPLACE)}stencilModeForClipping(e){const i=this.context.gl;return new Dt({func:i.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,i.KEEP,i.KEEP,i.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(e){const i=this.context.gl,u=e.sort((v,S)=>S.overscaledZ-v.overscaledZ),h=u[u.length-1].overscaledZ,g=u[0].overscaledZ-h+1;if(g>1){this.currentStencilSource=void 0,this.nextStencilID+g>256&&this.clearStencil();const v={};for(let S=0;S<g;S++)v[S+h]=new Dt({func:i.GEQUAL,mask:255},S+this.nextStencilID,255,i.KEEP,i.KEEP,i.REPLACE);return this.nextStencilID+=g,[v,u]}return[{[h]:Dt.disabled},u]}stencilConfigForOverlapTwoPass(e){const i=this.context.gl,u=e.sort((v,S)=>S.overscaledZ-v.overscaledZ),h=u[u.length-1].overscaledZ,g=u[0].overscaledZ-h+1;if(this.clearStencil(),g>1){const v={},S={};for(let P=0;P<g;P++)v[P+h]=new Dt({func:i.GREATER,mask:255},g+1+P,255,i.KEEP,i.KEEP,i.REPLACE),S[P+h]=new Dt({func:i.GREATER,mask:255},1+P,255,i.KEEP,i.KEEP,i.REPLACE);return this.nextStencilID=2*g+1,[v,S,u]}return this.nextStencilID=3,[{[h]:new Dt({func:i.GREATER,mask:255},2,255,i.KEEP,i.KEEP,i.REPLACE)},{[h]:new Dt({func:i.GREATER,mask:255},1,255,i.KEEP,i.KEEP,i.REPLACE)},u]}colorModeForRenderPass(){const e=this.context.gl;return this._showOverdrawInspector?new sr([e.CONSTANT_COLOR,e.ONE],new c.b6(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?sr.unblended:sr.alphaBlended}getDepthModeForSublayer(e,i,u){if(!this.opaquePassEnabledForLayer())return Mt.disabled;const h=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new Mt(u||this.context.gl.LEQUAL,i,[h,h])}getDepthModeFor3D(){return new Mt(this.context.gl.LEQUAL,Mt.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(e,i){var u,h;this.style=e,this.options=i,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(H.now()),this.imageManager.beginFrame();const g=this.style._order,v=this.style.sourceCaches,S={},P={},E={},k={isRenderingToTexture:!1,isRenderingGlobe:((u=e.projection)===null||u===void 0?void 0:u.transitionState)>0};for(const L in v){const N=v[L];N.used&&N.prepare(this.context),S[L]=N.getVisibleCoordinates(!1),P[L]=S[L].slice().reverse(),E[L]=N.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let L=0;L<g.length;L++)if(this.style._layers[g[L]].is3D()){this.opaquePassCutoff=L;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const L of g){const N=this.style._layers[L];if(!N.hasOffscreenPass()||N.isHidden(this.transform.zoom))continue;const V=P[N.source];(N.type==="custom"||V.length)&&this.renderLayer(this,v[N.source],N,V,k)}if((h=this.style.projection)===null||h===void 0||h.updateGPUdependent({context:this.context,useProgram:L=>this.useProgram(L)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:i.showOverdrawInspector?c.b6.black:c.b6.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(L,N){const V=L.context,J=V.gl,K=((ge,fe,Pe)=>{const Ee=Math.cos(fe.rollInRadians),Be=Math.sin(fe.rollInRadians),je=Yr(fe),Le=fe.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:ge.properties.get("sky-color"),u_horizon_color:ge.properties.get("horizon-color"),u_horizon:[(fe.width/2-je*Be)*Pe,(fe.height/2+je*Ee)*Pe],u_horizon_normal:[-Be,Ee],u_sky_horizon_blend:ge.properties.get("sky-horizon-blend")*fe.height/2*Pe,u_sky_blend:Le}})(N,L.style.map.transform,L.pixelRatio),te=new Mt(J.LEQUAL,Mt.ReadWrite,[0,1]),oe=Dt.disabled,ue=L.colorModeForRenderPass(),he=L.useProgram("sky"),pe=hh(V,N);he.draw(V,J.TRIANGLES,te,oe,ue,Rt.disabled,K,null,void 0,"sky",pe.vertexBuffer,pe.indexBuffer,pe.segments)}(this,this.style.sky),this._showOverdrawInspector=i.showOverdrawInspector,this.depthRangeFor3D=[0,1-(e._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=g.length-1;this.currentLayer>=0;this.currentLayer--){const L=this.style._layers[g[this.currentLayer]],N=v[L.source],V=S[L.source];this._renderTileClippingMasks(L,V,!1),this.renderLayer(this,N,L,V,k)}this.renderPass="translucent";let R=!1;for(this.currentLayer=0;this.currentLayer<g.length;this.currentLayer++){const L=this.style._layers[g[this.currentLayer]],N=v[L.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(L,k))continue;this.opaquePassEnabledForLayer()||R||(R=!0,k.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const V=(L.type==="symbol"?E:P)[L.source];this._renderTileClippingMasks(L,S[L.source],!1),this.renderLayer(this,N,L,V,k)}if(k.isRenderingGlobe&&function(L,N,V){const J=L.context,K=J.gl,te=L.useProgram("atmosphere"),oe=new Mt(K.LEQUAL,Mt.ReadOnly,[0,1]),ue=L.transform,he=function(Le,Qe){const Ke=Le.properties.get("position"),Ge=[-Ke.x,-Ke.y,-Ke.z],lt=c.as(new Float64Array(16));return Le.properties.get("anchor")==="map"&&(c.aZ(lt,lt,Qe.rollInRadians),c.a_(lt,lt,-Qe.pitchInRadians),c.aZ(lt,lt,Qe.bearingInRadians),c.a_(lt,lt,Qe.center.lat*Math.PI/180),c.bl(lt,lt,-Qe.center.lng*Math.PI/180)),c.bU(Ge,Ge,lt),Ge}(V,L.transform),pe=ue.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),ge=N.properties.get("atmosphere-blend")*pe.projectionTransition;if(ge===0)return;const fe=yn(ue.worldSize,ue.center.lat),Pe=ue.inverseProjectionMatrix,Ee=new Float64Array(4);Ee[3]=1,c.ao(Ee,Ee,ue.modelViewProjectionMatrix),Ee[0]/=Ee[3],Ee[1]/=Ee[3],Ee[2]/=Ee[3],Ee[3]=1,c.ao(Ee,Ee,Pe),Ee[0]/=Ee[3],Ee[1]/=Ee[3],Ee[2]/=Ee[3],Ee[3]=1;const Be=((Le,Qe,Ke,Ge,lt)=>({u_sun_pos:Le,u_atmosphere_blend:Qe,u_globe_position:Ke,u_globe_radius:Ge,u_inv_proj_matrix:lt}))(he,ge,[Ee[0],Ee[1],Ee[2]],fe,Pe),je=hh(J,N);te.draw(J,K.TRIANGLES,oe,Dt.disabled,sr.alphaBlended,Rt.disabled,Be,null,null,"atmosphere",je.vertexBuffer,je.indexBuffer,je.segments)}(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const L=function(N,V){let J=null;const K=Object.values(N._layers).flatMap(he=>he.source&&!he.isHidden(V)?[N.sourceCaches[he.source]]:[]),te=K.filter(he=>he.getSource().type==="vector"),oe=K.filter(he=>he.getSource().type!=="vector"),ue=he=>{(!J||J.getSource().maxzoom<he.getSource().maxzoom)&&(J=he)};return te.forEach(he=>ue(he)),J||oe.forEach(he=>ue(he)),J}(this.style,this.transform.zoom);L&&function(N,V,J){for(let K=0;K<J.length;K++)Ap(N,V,J[K])}(this,L,L.getVisibleCoordinates())}this.options.showPadding&&function(L){const N=L.transform.padding;gs(L,L.transform.height-(N.top||0),3,ms),gs(L,N.bottom||0,3,ui),ra(L,N.left||0,3,lh),ra(L,L.transform.width-(N.right||0),3,ch);const V=L.transform.centerPoint;(function(J,K,te,oe){na(J,K-1,te-10,2,20,oe),na(J,K-10,te-1,20,2,oe)})(L,V.x,L.transform.height-V.y,kp)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(e){if(!this.style||!this.style.map||!this.style.map.terrain)return;const i=this.terrainFacilitator.matrix,u=this.transform.modelViewProjectionMatrix;let h=this.terrainFacilitator.dirty;h||(h=e?!c.bX(i,u):!c.bY(i,u)),h||(h=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),h&&(c.bZ(i,u),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(g,v){const S=g.context,P=S.gl,E=g.transform,k=sr.unblended,R=new Mt(P.LEQUAL,Mt.ReadWrite,[0,1]),L=v.sourceCache.getRenderableTiles(),N=g.useProgram("terrainDepth");S.bindFramebuffer.set(v.getFramebuffer("depth").framebuffer),S.viewport.set([0,0,g.width/devicePixelRatio,g.height/devicePixelRatio]),S.clear({color:c.b6.transparent,depth:1});for(const V of L){const J=v.getTerrainMesh(V.tileID),K=v.getTerrainData(V.tileID),te=E.getProjectionData({overscaledTileID:V.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),oe={u_ele_delta:v.getMeshFrameDelta(E.zoom)};N.draw(S,P.TRIANGLES,R,Dt.disabled,k,Rt.backCCW,oe,K,te,"terrain",J.vertexBuffer,J.indexBuffer,J.segments)}S.bindFramebuffer.set(null),S.viewport.set([0,0,g.width,g.height])}(this,this.style.map.terrain),function(g,v){const S=g.context,P=S.gl,E=g.transform,k=sr.unblended,R=new Mt(P.LEQUAL,Mt.ReadWrite,[0,1]),L=v.getCoordsTexture(),N=v.sourceCache.getRenderableTiles(),V=g.useProgram("terrainCoords");S.bindFramebuffer.set(v.getFramebuffer("coords").framebuffer),S.viewport.set([0,0,g.width/devicePixelRatio,g.height/devicePixelRatio]),S.clear({color:c.b6.transparent,depth:1}),v.coordsIndex=[];for(const J of N){const K=v.getTerrainMesh(J.tileID),te=v.getTerrainData(J.tileID);S.activeTexture.set(P.TEXTURE0),P.bindTexture(P.TEXTURE_2D,L.texture);const oe={u_terrain_coords_id:(255-v.coordsIndex.length)/255,u_texture:0,u_ele_delta:v.getMeshFrameDelta(E.zoom)},ue=E.getProjectionData({overscaledTileID:J.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});V.draw(S,P.TRIANGLES,R,Dt.disabled,k,Rt.backCCW,oe,te,ue,"terrain",K.vertexBuffer,K.indexBuffer,K.segments),v.coordsIndex.push(J.tileID.key)}S.bindFramebuffer.set(null),S.viewport.set([0,0,g.width,g.height])}(this,this.style.map.terrain))}renderLayer(e,i,u,h,g){u.isHidden(this.transform.zoom)||(u.type==="background"||u.type==="custom"||(h||[]).length)&&(this.id=u.id,c.b_(u)?function(v,S,P,E,k,R){if(v.renderPass!=="translucent")return;const{isRenderingToTexture:L}=R,N=Dt.disabled,V=v.colorModeForRenderPass();(P._unevaluatedLayout.hasValue("text-variable-anchor")||P._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(J,K,te,oe,ue,he,pe,ge,fe){const Pe=K.transform,Ee=K.style.map.terrain,Be=ue==="map",je=he==="map";for(const Le of J){const Qe=oe.getTile(Le),Ke=Qe.getBucket(te);if(!Ke||!Ke.text||!Ke.text.segments.get().length)continue;const Ge=c.af(Ke.textSizeData,Pe.zoom),lt=c.av(Qe,1,K.transform.zoom),mt=Me(Be,K.transform,lt),Vt=te.layout.get("icon-text-fit")!=="none"&&Ke.hasIconData();if(Ge){const Yt=Math.pow(2,Pe.zoom-Qe.tileID.overscaledZ),Gt=Ee?(lr,nr)=>Ee.getElevation(Le,lr,nr):null;nc(Ke,Be,je,fe,Pe,mt,Yt,Ge,Vt,c.aw(Pe,Qe,pe,ge),Le.toUnwrapped(),Gt)}}}(E,v,P,S,P.layout.get("text-rotation-alignment"),P.layout.get("text-pitch-alignment"),P.paint.get("text-translate"),P.paint.get("text-translate-anchor"),k),P.paint.get("icon-opacity").constantOr(1)!==0&&Mp(v,S,P,E,!1,P.paint.get("icon-translate"),P.paint.get("icon-translate-anchor"),P.layout.get("icon-rotation-alignment"),P.layout.get("icon-pitch-alignment"),P.layout.get("icon-keep-upright"),N,V,L),P.paint.get("text-opacity").constantOr(1)!==0&&Mp(v,S,P,E,!0,P.paint.get("text-translate"),P.paint.get("text-translate-anchor"),P.layout.get("text-rotation-alignment"),P.layout.get("text-pitch-alignment"),P.layout.get("text-keep-upright"),N,V,L),S.map.showCollisionBoxes&&(tc(v,S,P,E,!0),tc(v,S,P,E,!1))}(e,i,u,h,this.style.placement.variableOffsets,g):c.b$(u)?function(v,S,P,E,k){if(v.renderPass!=="translucent")return;const{isRenderingToTexture:R}=k,L=P.paint.get("circle-opacity"),N=P.paint.get("circle-stroke-width"),V=P.paint.get("circle-stroke-opacity"),J=!P.layout.get("circle-sort-key").isConstant();if(L.constantOr(1)===0&&(N.constantOr(1)===0||V.constantOr(1)===0))return;const K=v.context,te=K.gl,oe=v.transform,ue=v.getDepthModeForSublayer(0,Mt.ReadOnly),he=Dt.disabled,pe=v.colorModeForRenderPass(),ge=[],fe=oe.getCircleRadiusCorrection();for(let Pe=0;Pe<E.length;Pe++){const Ee=E[Pe],Be=S.getTile(Ee),je=Be.getBucket(P);if(!je)continue;const Le=P.paint.get("circle-translate"),Qe=P.paint.get("circle-translate-anchor"),Ke=c.aw(oe,Be,Le,Qe),Ge=je.programConfigurations.get(P.id),lt=v.useProgram("circle",Ge),mt=je.layoutVertexBuffer,Vt=je.indexBuffer,Yt=v.style.map.terrain&&v.style.map.terrain.getTerrainData(Ee),Gt={programConfiguration:Ge,program:lt,layoutVertexBuffer:mt,indexBuffer:Vt,uniformValues:up(v,Be,P,Ke,fe),terrainData:Yt,projectionData:oe.getProjectionData({overscaledTileID:Ee,applyGlobeMatrix:!R,applyTerrainMatrix:!0})};if(J){const lr=je.segments.get();for(const nr of lr)ge.push({segments:new c.aF([nr]),sortKey:nr.sortKey,state:Gt})}else ge.push({segments:je.segments,sortKey:0,state:Gt})}J&&ge.sort((Pe,Ee)=>Pe.sortKey-Ee.sortKey);for(const Pe of ge){const{programConfiguration:Ee,program:Be,layoutVertexBuffer:je,indexBuffer:Le,uniformValues:Qe,terrainData:Ke,projectionData:Ge}=Pe.state;Be.draw(K,te.TRIANGLES,ue,he,pe,Rt.backCCW,Qe,Ke,Ge,P.id,je,Le,Pe.segments,P.paint,v.transform.zoom,Ee)}}(e,i,u,h,g):c.c0(u)?function(v,S,P,E,k){if(P.paint.get("heatmap-opacity")===0)return;const R=v.context,{isRenderingToTexture:L,isRenderingGlobe:N}=k;if(v.style.map.terrain){for(const V of E){const J=S.getTile(V);S.hasRenderableParent(V)||(v.renderPass==="offscreen"?t_(v,J,P,V,N):v.renderPass==="translucent"&&Ip(v,P,V,L,N))}R.viewport.set([0,0,v.width,v.height])}else v.renderPass==="offscreen"?function(V,J,K,te){const oe=V.context,ue=oe.gl,he=V.transform,pe=Dt.disabled,ge=new sr([ue.ONE,ue.ONE],c.b6.transparent,[!0,!0,!0,!0]);(function(fe,Pe,Ee){const Be=fe.gl;fe.activeTexture.set(Be.TEXTURE1),fe.viewport.set([0,0,Pe.width/4,Pe.height/4]);let je=Ee.heatmapFbos.get(c.bR);je?(Be.bindTexture(Be.TEXTURE_2D,je.colorAttachment.get()),fe.bindFramebuffer.set(je.framebuffer)):(je=Ka(fe,Pe.width/4,Pe.height/4),Ee.heatmapFbos.set(c.bR,je))})(oe,V,K),oe.clear({color:c.b6.transparent});for(let fe=0;fe<te.length;fe++){const Pe=te[fe];if(J.hasRenderableParent(Pe))continue;const Ee=J.getTile(Pe),Be=Ee.getBucket(K);if(!Be)continue;const je=Be.programConfigurations.get(K.id),Le=V.useProgram("heatmap",je),Qe=he.getProjectionData({overscaledTileID:Pe,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),Ke=he.getCircleRadiusCorrection();Le.draw(oe,ue.TRIANGLES,Mt.disabled,pe,ge,Rt.backCCW,qu(Ee,he.zoom,K.paint.get("heatmap-intensity"),Ke),null,Qe,K.id,Be.layoutVertexBuffer,Be.indexBuffer,Be.segments,K.paint,he.zoom,je)}oe.viewport.set([0,0,V.width,V.height])}(v,S,P,E):v.renderPass==="translucent"&&function(V,J){const K=V.context,te=K.gl;K.setColorMode(V.colorModeForRenderPass());const oe=J.heatmapFbos.get(c.bR);oe&&(K.activeTexture.set(te.TEXTURE0),te.bindTexture(te.TEXTURE_2D,oe.colorAttachment.get()),K.activeTexture.set(te.TEXTURE1),oc(K,J).bind(te.LINEAR,te.CLAMP_TO_EDGE),V.useProgram("heatmapTexture").draw(K,te.TRIANGLES,Mt.disabled,Dt.disabled,V.colorModeForRenderPass(),Rt.disabled,Wu(V,J,0,1),null,null,J.id,V.viewportBuffer,V.quadTriangleIndexBuffer,V.viewportSegments,J.paint,V.transform.zoom))}(v,P)}(e,i,u,h,g):c.c1(u)?function(v,S,P,E,k){if(v.renderPass!=="translucent")return;const{isRenderingToTexture:R}=k,L=P.paint.get("line-opacity"),N=P.paint.get("line-width");if(L.constantOr(1)===0||N.constantOr(1)===0)return;const V=v.getDepthModeForSublayer(0,Mt.ReadOnly),J=v.colorModeForRenderPass(),K=P.paint.get("line-dasharray"),te=P.paint.get("line-pattern"),oe=te.constantOr(1),ue=P.paint.get("line-gradient"),he=P.getCrossfadeParameters(),pe=oe?"linePattern":K?"lineSDF":ue?"lineGradient":"line",ge=v.context,fe=ge.gl,Pe=v.transform;let Ee=!0;for(const Be of E){const je=S.getTile(Be);if(oe&&!je.patternsLoaded())continue;const Le=je.getBucket(P);if(!Le)continue;const Qe=Le.programConfigurations.get(P.id),Ke=v.context.program.get(),Ge=v.useProgram(pe,Qe),lt=Ee||Ge.program!==Ke,mt=v.style.map.terrain&&v.style.map.terrain.getTerrainData(Be),Vt=te.constantOr(null);if(Vt&&je.imageAtlas){const Ut=je.imageAtlas,qt=Ut.patternPositions[Vt.to.toString()],Jr=Ut.patternPositions[Vt.from.toString()];qt&&Jr&&Qe.setConstantPatternPositions(qt,Jr)}const Yt=Pe.getProjectionData({overscaledTileID:Be,applyGlobeMatrix:!R,applyTerrainMatrix:!0}),Gt=Pe.getPixelScale(),lr=oe?Ul(v,je,P,Gt,he):K?qg(v,je,P,Gt,K,he):ue?Gg(v,je,P,Gt,Le.lineClipsArray.length):cs(v,je,P,Gt);if(oe)ge.activeTexture.set(fe.TEXTURE0),je.imageAtlasTexture.bind(fe.LINEAR,fe.CLAMP_TO_EDGE),Qe.updatePaintBuffers(he);else if(K&&(lt||v.lineAtlas.dirty))ge.activeTexture.set(fe.TEXTURE0),v.lineAtlas.bind(ge);else if(ue){const Ut=Le.gradients[P.id];let qt=Ut.texture;if(P.gradientVersion!==Ut.version){let Jr=256;if(P.stepInterpolant){const en=S.getSource().maxzoom,$r=Be.canonical.z===en?Math.ceil(1<<v.transform.maxZoom-Be.canonical.z):1;Jr=c.ad(c.bS(Le.maxLineLength/c.Z*1024*$r),256,ge.maxTextureSize)}Ut.gradient=c.bT({expression:P.gradientExpression(),evaluationKey:"lineProgress",resolution:Jr,image:Ut.gradient||void 0,clips:Le.lineClipsArray}),Ut.texture?Ut.texture.update(Ut.gradient):Ut.texture=new We(ge,Ut.gradient,fe.RGBA),Ut.version=P.gradientVersion,qt=Ut.texture}ge.activeTexture.set(fe.TEXTURE0),qt.bind(P.stepInterpolant?fe.NEAREST:fe.LINEAR,fe.CLAMP_TO_EDGE)}let nr;if(R){const[Ut]=v.getStencilConfigForOverlapAndUpdateStencilID(E);nr=Ut[Be.overscaledZ]}else nr=v.stencilModeForClipping(Be);Ge.draw(ge,fe.TRIANGLES,V,nr,J,Rt.disabled,lr,mt,Yt,P.id,Le.layoutVertexBuffer,Le.indexBuffer,Le.segments,P.paint,v.transform.zoom,Qe,Le.layoutVertexBuffer2),Ee=!1}}(e,i,u,h,g):c.c2(u)?function(v,S,P,E,k){const R=P.paint.get("fill-color"),L=P.paint.get("fill-opacity");if(L.constantOr(1)===0)return;const{isRenderingToTexture:N}=k,V=v.colorModeForRenderPass(),J=P.paint.get("fill-pattern"),K=v.opaquePassEnabledForLayer()&&!J.constantOr(1)&&R.constantOr(c.b6.transparent).a===1&&L.constantOr(0)===1?"opaque":"translucent";if(v.renderPass===K){const te=v.getDepthModeForSublayer(1,v.renderPass==="opaque"?Mt.ReadWrite:Mt.ReadOnly);sh(v,S,P,E,te,V,!1,N)}if(v.renderPass==="translucent"&&P.paint.get("fill-antialias")){const te=v.getDepthModeForSublayer(P.getPaintProperty("fill-outline-color")?2:0,Mt.ReadOnly);sh(v,S,P,E,te,V,!0,N)}}(e,i,u,h,g):c.c3(u)?function(v,S,P,E,k){const R=P.paint.get("fill-extrusion-opacity");if(R===0)return;const{isRenderingToTexture:L}=k;if(v.renderPass==="translucent"){const N=new Mt(v.context.gl.LEQUAL,Mt.ReadWrite,v.depthRangeFor3D);if(R!==1||P.paint.get("fill-extrusion-pattern").constantOr(1))ta(v,S,P,E,N,Dt.disabled,sr.disabled,L),ta(v,S,P,E,N,v.stencilModeFor3D(),v.colorModeForRenderPass(),L);else{const V=v.colorModeForRenderPass();ta(v,S,P,E,N,Dt.disabled,V,L)}}}(e,i,u,h,g):c.c4(u)?function(v,S,P,E,k){if(v.renderPass!=="offscreen"&&v.renderPass!=="translucent")return;const{isRenderingToTexture:R}=k,L=v.context,N=v.style.projection.useSubdivision,V=v.getDepthModeForSublayer(0,Mt.ReadOnly),J=v.colorModeForRenderPass();if(v.renderPass==="offscreen")(function(K,te,oe,ue,he,pe,ge){const fe=K.context,Pe=fe.gl;for(const Ee of oe){const Be=te.getTile(Ee),je=Be.dem;if(!je||!je.data||!Be.needsHillshadePrepare)continue;const Le=je.dim,Qe=je.stride,Ke=je.getPixels();if(fe.activeTexture.set(Pe.TEXTURE1),fe.pixelStoreUnpackPremultiplyAlpha.set(!1),Be.demTexture=Be.demTexture||K.getTileTexture(Qe),Be.demTexture){const lt=Be.demTexture;lt.update(Ke,{premultiply:!1}),lt.bind(Pe.NEAREST,Pe.CLAMP_TO_EDGE)}else Be.demTexture=new We(fe,Ke,Pe.RGBA,{premultiply:!1}),Be.demTexture.bind(Pe.NEAREST,Pe.CLAMP_TO_EDGE);fe.activeTexture.set(Pe.TEXTURE0);let Ge=Be.fbo;if(!Ge){const lt=new We(fe,{width:Le,height:Le,data:null},Pe.RGBA);lt.bind(Pe.LINEAR,Pe.CLAMP_TO_EDGE),Ge=Be.fbo=fe.createFramebuffer(Le,Le,!0,!1),Ge.colorAttachment.set(lt.texture)}fe.bindFramebuffer.set(Ge.framebuffer),fe.viewport.set([0,0,Le,Le]),K.useProgram("hillshadePrepare").draw(fe,Pe.TRIANGLES,he,pe,ge,Rt.disabled,dp(Be.tileID,je),null,null,ue.id,K.rasterBoundsBuffer,K.quadTriangleIndexBuffer,K.rasterBoundsSegments),Be.needsHillshadePrepare=!1}})(v,S,E,P,V,Dt.disabled,J),L.viewport.set([0,0,v.width,v.height]);else if(v.renderPass==="translucent")if(N){const[K,te,oe]=v.stencilConfigForOverlapTwoPass(E);Ya(v,S,P,oe,K,V,J,!1,R),Ya(v,S,P,oe,te,V,J,!0,R)}else{const[K,te]=v.getStencilConfigForOverlapAndUpdateStencilID(E);Ya(v,S,P,te,K,V,J,!1,R)}}(e,i,u,h,g):c.c5(u)?function(v,S,P,E,k){if(v.renderPass!=="translucent"||P.paint.get("raster-opacity")===0||!E.length)return;const{isRenderingToTexture:R}=k,L=S.getSource(),N=v.style.projection.useSubdivision;if(L instanceof Gn)Qa(v,S,P,E,null,!1,!1,L.tileCoords,L.flippedWindingOrder,R);else if(N){const[V,J,K]=v.stencilConfigForOverlapTwoPass(E);Qa(v,S,P,K,V,!1,!0,ah,!1,R),Qa(v,S,P,K,J,!0,!0,ah,!1,R)}else{const[V,J]=v.getStencilConfigForOverlapAndUpdateStencilID(E);Qa(v,S,P,J,V,!1,!0,ah,!1,R)}}(e,i,u,h,g):c.c6(u)?function(v,S,P,E,k){const R=P.paint.get("background-color"),L=P.paint.get("background-opacity");if(L===0)return;const{isRenderingToTexture:N}=k,V=v.context,J=V.gl,K=v.style.projection,te=v.transform,oe=te.tileSize,ue=P.paint.get("background-pattern");if(v.isPatternMissing(ue))return;const he=!ue&&R.a===1&&L===1&&v.opaquePassEnabledForLayer()?"opaque":"translucent";if(v.renderPass!==he)return;const pe=Dt.disabled,ge=v.getDepthModeForSublayer(0,he==="opaque"?Mt.ReadWrite:Mt.ReadOnly),fe=v.colorModeForRenderPass(),Pe=v.useProgram(ue?"backgroundPattern":"background"),Ee=E||be(te,{tileSize:oe,terrain:v.style.map.terrain});ue&&(V.activeTexture.set(J.TEXTURE0),v.imageManager.bind(v.context));const Be=P.getCrossfadeParameters();for(const je of Ee){const Le=te.getProjectionData({overscaledTileID:je,applyGlobeMatrix:!N,applyTerrainMatrix:!0}),Qe=ue?Ku(L,v,ue,{tileID:je,tileSize:oe},Be):po(L,R),Ke=v.style.map.terrain&&v.style.map.terrain.getTerrainData(je),Ge=K.getMeshFromTileID(V,je.canonical,!1,!0,"raster");Pe.draw(V,J.TRIANGLES,ge,pe,fe,Rt.backCCW,Qe,Ke,Le,P.id,Ge.vertexBuffer,Ge.indexBuffer,Ge.segments)}}(e,0,u,h,g):c.c7(u)&&function(v,S,P,E){const{isRenderingGlobe:k}=E,R=v.context,L=P.implementation,N=v.style.projection,V=v.transform,J=V.getProjectionDataForCustomLayer(k),K={farZ:V.farZ,nearZ:V.nearZ,fov:V.fov*Math.PI/180,modelViewProjectionMatrix:V.modelViewProjectionMatrix,projectionMatrix:V.projectionMatrix,shaderData:{variantName:N.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${N.shaderPreludeCode.vertexSource}`,define:N.shaderDefine},defaultProjectionData:J},te=L.renderingMode?L.renderingMode:"2d";if(v.renderPass==="offscreen"){const oe=L.prerender;oe&&(v.setCustomLayerDefaults(),R.setColorMode(v.colorModeForRenderPass()),oe.call(L,R.gl,K),R.setDirty(),v.setBaseState())}else if(v.renderPass==="translucent"){v.setCustomLayerDefaults(),R.setColorMode(v.colorModeForRenderPass()),R.setStencilMode(Dt.disabled);const oe=te==="3d"?v.getDepthModeFor3D():v.getDepthModeForSublayer(0,Mt.ReadOnly);R.setDepthMode(oe),L.render(R.gl,K),R.setDirty(),v.setBaseState(),R.bindFramebuffer.set(null)}}(e,0,u,g))}saveTileTexture(e){const i=this._tileTextures[e.size[0]];i?i.push(e):this._tileTextures[e.size[0]]=[e]}getTileTexture(e){const i=this._tileTextures[e];return i&&i.length>0?i.pop():null}isPatternMissing(e){if(!e)return!1;if(!e.from||!e.to)return!0;const i=this.imageManager.getPattern(e.from.toString()),u=this.imageManager.getPattern(e.to.toString());return!i||!u}useProgram(e,i,u=!1){this.cache=this.cache||{};const h=!!this.style.map.terrain,g=this.style.projection,v=e+(i?i.cacheKey:"")+`/${u?zl:g.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(h?"/terrain":"");return this.cache[v]||(this.cache[v]=new Ug(this.context,bi[e],i,Yu[e],this._showOverdrawInspector,h,u?bi.projectionMercator:g.shaderPreludeCode,u?Bt:g.shaderDefine)),this.cache[v]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new We(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:e,drawingBufferHeight:i}=this.context.gl;return this.width!==e||this.height!==i}}function dh(f,e){let i,u=!1,h=null,g=null;const v=()=>{h=null,u&&(f.apply(g,i),h=setTimeout(v,e),u=!1)};return(...S)=>(u=!0,g=this,i=S,h||v(),h)}class Lo{constructor(e){this._getCurrentHash=()=>{const i=window.location.hash.replace("#","");if(this._hashName){let u;return i.split("&").map(h=>h.split("=")).forEach(h=>{h[0]===this._hashName&&(u=h)}),(u&&u[1]||"").split("/")}return i.split("/")},this._onHashChange=()=>{const i=this._getCurrentHash();if(!this._isValidHash(i))return!1;const u=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(i[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+i[2],+i[1]],zoom:+i[0],bearing:u,pitch:+(i[4]||0)}),!0},this._updateHashUnthrottled=()=>{const i=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,i)},this._removeHash=()=>{const i=this._getCurrentHash();if(i.length===0)return;const u=i.join("/");let h=u;h.split("&").length>0&&(h=h.split("&")[0]),this._hashName&&(h=`${this._hashName}=${u}`);let g=window.location.hash.replace(h,"");g.startsWith("#&")?g=g.slice(0,1)+g.slice(2):g==="#"&&(g="");let v=window.location.href.replace(/(#.+)?$/,g);v=v.replace("&&","&"),window.history.replaceState(window.history.state,null,v)},this._updateHash=dh(this._updateHashUnthrottled,300),this._hashName=e&&encodeURIComponent(e)}addTo(e){return this._map=e,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(e){const i=this._map.getCenter(),u=Math.round(100*this._map.getZoom())/100,h=Math.ceil((u*Math.LN2+Math.log(512/360/.5))/Math.LN10),g=Math.pow(10,h),v=Math.round(i.lng*g)/g,S=Math.round(i.lat*g)/g,P=this._map.getBearing(),E=this._map.getPitch();let k="";if(k+=e?`/${v}/${S}/${u}`:`${u}/${S}/${v}`,(P||E)&&(k+="/"+Math.round(10*P)/10),E&&(k+=`/${Math.round(E)}`),this._hashName){const R=this._hashName;let L=!1;const N=window.location.hash.slice(1).split("&").map(V=>{const J=V.split("=")[0];return J===R?(L=!0,`${J}=${k}`):V}).filter(V=>V);return L||N.push(`${R}=${k}`),`#${N.join("&")}`}return`#${k}`}_isValidHash(e){if(e.length<3||e.some(isNaN))return!1;try{new c.Q(+e[2],+e[1])}catch{return!1}const i=+e[0],u=+(e[3]||0),h=+(e[4]||0);return i>=this._map.getMinZoom()&&i<=this._map.getMaxZoom()&&u>=-180&&u<=180&&h>=this._map.getMinPitch()&&h<=this._map.getMaxPitch()}}const ia={linearity:.3,easing:c.c8(0,0,.3,1)},Rp=c.e({deceleration:2500,maxSpeed:1400},ia),Lp=c.e({deceleration:20,maxSpeed:1400},ia),Dp=c.e({deceleration:1e3,maxSpeed:360},ia),Fp=c.e({deceleration:1e3,maxSpeed:90},ia),Bp=c.e({deceleration:1e3,maxSpeed:360},ia);class Op{constructor(e){this._map=e,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:H.now(),settings:e})}_drainInertiaBuffer(){const e=this._inertiaBuffer,i=H.now();for(;e.length>0&&i-e[0].time>160;)e.shift()}_onMoveEnd(e){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const i={zoom:0,bearing:0,pitch:0,roll:0,pan:new c.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:g}of this._inertiaBuffer)i.zoom+=g.zoomDelta||0,i.bearing+=g.bearingDelta||0,i.pitch+=g.pitchDelta||0,i.roll+=g.rollDelta||0,g.panDelta&&i.pan._add(g.panDelta),g.around&&(i.around=g.around),g.pinchAround&&(i.pinchAround=g.pinchAround);const u=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,h={};if(i.pan.mag()){const g=oa(i.pan.mag(),u,c.e({},Rp,e||{})),v=i.pan.mult(g.amount/i.pan.mag()),S=this._map.cameraHelper.handlePanInertia(v,this._map.transform);h.center=S.easingCenter,h.offset=S.easingOffset,Do(h,g)}if(i.zoom){const g=oa(i.zoom,u,Lp);h.zoom=this._map.transform.zoom+g.amount,Do(h,g)}if(i.bearing){const g=oa(i.bearing,u,Dp);h.bearing=this._map.transform.bearing+c.ad(g.amount,-179,179),Do(h,g)}if(i.pitch){const g=oa(i.pitch,u,Fp);h.pitch=this._map.transform.pitch+g.amount,Do(h,g)}if(i.roll){const g=oa(i.roll,u,Bp);h.roll=this._map.transform.roll+c.ad(g.amount,-179,179),Do(h,g)}if(h.zoom||h.bearing){const g=i.pinchAround===void 0?i.around:i.pinchAround;h.around=g?this._map.unproject(g):this._map.getCenter()}return this.clear(),c.e(h,{noMoveStart:!0})}}function Do(f,e){(!f.duration||f.duration<e.duration)&&(f.duration=e.duration,f.easing=e.easing)}function oa(f,e,i){const{maxSpeed:u,linearity:h,deceleration:g}=i,v=c.ad(f*h/(e/1e3),-u,u),S=Math.abs(v)/(g*h);return{easing:i.easing,duration:1e3*S,amount:v*(S/2)}}class gr extends c.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,i,u,h={}){const g=G.mousePos(i.getCanvas(),u),v=i.unproject(g);super(e,c.e({point:g,lngLat:v,originalEvent:u},h)),this._defaultPrevented=!1,this.target=i}}class Bn extends c.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,i,u){const h=e==="touchend"?u.changedTouches:u.touches,g=G.touchPos(i.getCanvasContainer(),h),v=g.map(P=>i.unproject(P)),S=g.reduce((P,E,k,R)=>P.add(E.div(R.length)),new c.P(0,0));super(e,{points:g,point:S,lngLats:v,lngLat:i.unproject(S),originalEvent:u}),this._defaultPrevented=!1}}class ph extends c.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,i,u){super(e,{originalEvent:u}),this._defaultPrevented=!1}}class Zi{constructor(e,i){this._map=e,this._clickTolerance=i.clickTolerance}reset(){delete this._mousedownPos}wheel(e){return this._firePreventable(new ph(e.type,this._map,e))}mousedown(e,i){return this._mousedownPos=i,this._firePreventable(new gr(e.type,this._map,e))}mouseup(e){this._map.fire(new gr(e.type,this._map,e))}click(e,i){this._mousedownPos&&this._mousedownPos.dist(i)>=this._clickTolerance||this._map.fire(new gr(e.type,this._map,e))}dblclick(e){return this._firePreventable(new gr(e.type,this._map,e))}mouseover(e){this._map.fire(new gr(e.type,this._map,e))}mouseout(e){this._map.fire(new gr(e.type,this._map,e))}touchstart(e){return this._firePreventable(new Bn(e.type,this._map,e))}touchmove(e){this._map.fire(new Bn(e.type,this._map,e))}touchend(e){this._map.fire(new Bn(e.type,this._map,e))}touchcancel(e){this._map.fire(new Bn(e.type,this._map,e))}_firePreventable(e){if(this._map.fire(e),e.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class sa{constructor(e){this._map=e}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(e){this._map.fire(new gr(e.type,this._map,e))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new gr("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(e){this._delayContextMenu?this._contextMenuEvent=e:this._ignoreContextMenu||this._map.fire(new gr(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ja{constructor(e){this._map=e}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(e){return this.transform.screenPointToLocation(c.P.convert(e),this._map.terrain)}}class jp{constructor(e,i){this._map=e,this._tr=new Ja(e),this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=i.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(e,i){this.isEnabled()&&e.shiftKey&&e.button===0&&(G.disableDrag(),this._startPos=this._lastPos=i,this._active=!0)}mousemoveWindow(e,i){if(!this._active)return;const u=i;if(this._lastPos.equals(u)||!this._box&&u.dist(this._startPos)<this._clickTolerance)return;const h=this._startPos;this._lastPos=u,this._box||(this._box=G.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",e));const g=Math.min(h.x,u.x),v=Math.max(h.x,u.x),S=Math.min(h.y,u.y),P=Math.max(h.y,u.y);G.setTransform(this._box,`translate(${g}px,${S}px)`),this._box.style.width=v-g+"px",this._box.style.height=P-S+"px"}mouseupWindow(e,i){if(!this._active||e.button!==0)return;const u=this._startPos,h=i;if(this.reset(),G.suppressClick(),u.x!==h.x||u.y!==h.y)return this._map.fire(new c.l("boxzoomend",{originalEvent:e})),{cameraAnimation:g=>g.fitScreenCoordinates(u,h,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",e)}keydown(e){this._active&&e.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",e))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(G.remove(this._box),this._box=null),G.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(e,i){return this._map.fire(new c.l(e,{originalEvent:i}))}}function fh(f,e){if(f.length!==e.length)throw new Error(`The number of touches and points are not equal - touches ${f.length}, points ${e.length}`);const i={};for(let u=0;u<f.length;u++)i[f[u].identifier]=e[u];return i}class r_{constructor(e){this.reset(),this.numTouches=e.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(e,i,u){(this.centroid||u.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=e.timeStamp),u.length===this.numTouches&&(this.centroid=function(h){const g=new c.P(0,0);for(const v of h)g._add(v);return g.div(h.length)}(i),this.touches=fh(u,i)))}touchmove(e,i,u){if(this.aborted||!this.centroid)return;const h=fh(u,i);for(const g in this.touches){const v=h[g];(!v||v.dist(this.touches[g])>30)&&(this.aborted=!0)}}touchend(e,i,u){if((!this.centroid||e.timeStamp-this.startTime>500)&&(this.aborted=!0),u.length===0){const h=!this.aborted&&this.centroid;if(this.reset(),h)return h}}}class sc{constructor(e){this.singleTap=new r_(e),this.numTaps=e.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(e,i,u){this.singleTap.touchstart(e,i,u)}touchmove(e,i,u){this.singleTap.touchmove(e,i,u)}touchend(e,i,u){const h=this.singleTap.touchend(e,i,u);if(h){const g=e.timeStamp-this.lastTime<500,v=!this.lastTap||this.lastTap.dist(h)<30;if(g&&v||this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=h,this.count===this.numTaps)return this.reset(),h}}}class el{constructor(e){this._tr=new Ja(e),this._zoomIn=new sc({numTouches:1,numTaps:2}),this._zoomOut=new sc({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(e,i,u){this._zoomIn.touchstart(e,i,u),this._zoomOut.touchstart(e,i,u)}touchmove(e,i,u){this._zoomIn.touchmove(e,i,u),this._zoomOut.touchmove(e,i,u)}touchend(e,i,u){const h=this._zoomIn.touchend(e,i,u),g=this._zoomOut.touchend(e,i,u),v=this._tr;return h?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:S=>S.easeTo({duration:300,zoom:v.zoom+1,around:v.unproject(h)},{originalEvent:e})}):g?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:S=>S.easeTo({duration:300,zoom:v.zoom-1,around:v.unproject(g)},{originalEvent:e})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Xn{constructor(e){this._enabled=!!e.enable,this._moveStateManager=e.moveStateManager,this._clickTolerance=e.clickTolerance||1,this._moveFunction=e.move,this._activateOnStart=!!e.activateOnStart,e.assignEvents(this),this.reset()}reset(e){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(e)}_move(...e){const i=this._moveFunction(...e);if(i.bearingDelta||i.pitchDelta||i.rollDelta||i.around||i.panDelta)return this._active=!0,i}dragStart(e,i){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(e)&&(this._moveStateManager.startMove(e),this._lastPoint=Array.isArray(i)?i[0]:i,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(e,i){if(!this.isEnabled())return;const u=this._lastPoint;if(!u)return;if(e.preventDefault(),!this._moveStateManager.isValidMoveEvent(e))return void this.reset(e);const h=Array.isArray(i)?i[0]:i;return!this._moved&&h.dist(u)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=h,this._move(u,h))}dragEnd(e){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(e)&&(this._moved&&G.suppressClick(),this.reset(e))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const nt={0:1,2:2};class aa{constructor(e){this._correctEvent=e.checkCorrectEvent}startMove(e){const i=G.mouseButton(e);this._eventButton=i}endMove(e){delete this._eventButton}isValidStartEvent(e){return this._correctEvent(e)}isValidMoveEvent(e){return!function(i,u){const h=nt[u];return i.buttons===void 0||(i.buttons&h)!==h}(e,this._eventButton)}isValidEndEvent(e){return G.mouseButton(e)===this._eventButton}}class mh{constructor(){this._firstTouch=void 0}_isOneFingerTouch(e){return e.targetTouches.length===1}_isSameTouchEvent(e){return e.targetTouches[0].identifier===this._firstTouch}startMove(e){this._firstTouch=e.targetTouches[0].identifier}endMove(e){delete this._firstTouch}isValidStartEvent(e){return this._isOneFingerTouch(e)}isValidMoveEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}isValidEndEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}}class Np{constructor(e=new aa({checkCorrectEvent:()=>!0}),i=new mh){this.mouseMoveStateManager=e,this.oneFingerTouchMoveStateManager=i}_executeRelevantHandler(e,i,u){return e instanceof MouseEvent?i(e):typeof TouchEvent<"u"&&e instanceof TouchEvent?u(e):void 0}startMove(e){this._executeRelevantHandler(e,i=>this.mouseMoveStateManager.startMove(i),i=>this.oneFingerTouchMoveStateManager.startMove(i))}endMove(e){this._executeRelevantHandler(e,i=>this.mouseMoveStateManager.endMove(i),i=>this.oneFingerTouchMoveStateManager.endMove(i))}isValidStartEvent(e){return this._executeRelevantHandler(e,i=>this.mouseMoveStateManager.isValidStartEvent(i),i=>this.oneFingerTouchMoveStateManager.isValidStartEvent(i))}isValidMoveEvent(e){return this._executeRelevantHandler(e,i=>this.mouseMoveStateManager.isValidMoveEvent(i),i=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(i))}isValidEndEvent(e){return this._executeRelevantHandler(e,i=>this.mouseMoveStateManager.isValidEndEvent(i),i=>this.oneFingerTouchMoveStateManager.isValidEndEvent(i))}}const Fo=f=>{f.mousedown=f.dragStart,f.mousemoveWindow=f.dragMove,f.mouseup=f.dragEnd,f.contextmenu=e=>{e.preventDefault()}};class tl{constructor(e,i){this._clickTolerance=e.clickTolerance||1,this._map=i,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new c.P(0,0)}_shouldBePrevented(e){return e<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(e,i,u){return this._calculateTransform(e,i,u)}touchmove(e,i,u){if(this._active){if(!this._shouldBePrevented(u.length))return e.preventDefault(),this._calculateTransform(e,i,u);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",e)}}touchend(e,i,u){this._calculateTransform(e,i,u),this._active&&this._shouldBePrevented(u.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(e,i,u){u.length>0&&(this._active=!0);const h=fh(u,i),g=new c.P(0,0),v=new c.P(0,0);let S=0;for(const E in h){const k=h[E],R=this._touches[E];R&&(g._add(k),v._add(k.sub(R)),S++,h[E]=k)}if(this._touches=h,this._shouldBePrevented(S)||!v.mag())return;const P=v.div(S);return this._sum._add(P),this._sum.mag()<this._clickTolerance?void 0:{around:g.div(S),panDelta:P}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ac{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(e,i,u){this._firstTwoTouches||u.length<2||(this._firstTwoTouches=[u[0].identifier,u[1].identifier],this._start([i[0],i[1]]))}touchmove(e,i,u){if(!this._firstTwoTouches)return;e.preventDefault();const[h,g]=this._firstTwoTouches,v=At(u,i,h),S=At(u,i,g);if(!v||!S)return;const P=this._aroundCenter?null:v.add(S).div(2);return this._move([v,S],P,e)}touchend(e,i,u){if(!this._firstTwoTouches)return;const[h,g]=this._firstTwoTouches,v=At(u,i,h),S=At(u,i,g);v&&S||(this._active&&G.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(e){this._enabled=!0,this._aroundCenter=!!e&&e.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function At(f,e,i){for(let u=0;u<f.length;u++)if(f[u].identifier===i)return e[u]}function lc(f,e){return Math.log(f/e)/Math.LN2}class $p extends ac{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(e){this._startDistance=this._distance=e[0].dist(e[1])}_move(e,i){const u=this._distance;if(this._distance=e[0].dist(e[1]),this._active||!(Math.abs(lc(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:lc(this._distance,u),pinchAround:i}}}function cc(f,e){return 180*f.angleWith(e)/Math.PI}class Vp extends ac{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}_move(e,i,u){const h=this._vector;if(this._vector=e[0].sub(e[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:cc(this._vector,h),pinchAround:i}}_isBelowThreshold(e){this._minDiameter=Math.min(this._minDiameter,e.mag());const i=25/(Math.PI*this._minDiameter)*360,u=cc(e,this._startVector);return Math.abs(u)<i}}function gh(f){return Math.abs(f.y)>Math.abs(f.x)}class _h extends ac{constructor(e){super(),this._currentTouchCount=0,this._map=e}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(e,i,u){super.touchstart(e,i,u),this._currentTouchCount=u.length}_start(e){this._lastPoints=e,gh(e[0].sub(e[1]))&&(this._valid=!1)}_move(e,i,u){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const h=e[0].sub(this._lastPoints[0]),g=e[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(h,g,u.timeStamp),this._valid?(this._lastPoints=e,this._active=!0,{pitchDelta:(h.y+g.y)/2*-.5}):void 0}gestureBeginsVertically(e,i,u){if(this._valid!==void 0)return this._valid;const h=e.mag()>=2,g=i.mag()>=2;if(!h&&!g)return;if(!h||!g)return this._firstMove===void 0&&(this._firstMove=u),u-this._firstMove<100&&void 0;const v=e.y>0==i.y>0;return gh(e)&&gh(i)&&v}}const yh={panStep:100,bearingStep:15,pitchStep:10};class vh{constructor(e){this._tr=new Ja(e);const i=yh;this._panStep=i.panStep,this._bearingStep=i.bearingStep,this._pitchStep=i.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(e){if(e.altKey||e.ctrlKey||e.metaKey)return;let i=0,u=0,h=0,g=0,v=0;switch(e.keyCode){case 61:case 107:case 171:case 187:i=1;break;case 189:case 109:case 173:i=-1;break;case 37:e.shiftKey?u=-1:(e.preventDefault(),g=-1);break;case 39:e.shiftKey?u=1:(e.preventDefault(),g=1);break;case 38:e.shiftKey?h=1:(e.preventDefault(),v=-1);break;case 40:e.shiftKey?h=-1:(e.preventDefault(),v=1);break;default:return}return this._rotationDisabled&&(u=0,h=0),{cameraAnimation:S=>{const P=this._tr;S.easeTo({duration:300,easeId:"keyboardHandler",easing:n_,zoom:i?Math.round(P.zoom)+i*(e.shiftKey?2:1):P.zoom,bearing:P.bearing+u*this._bearingStep,pitch:P.pitch+h*this._pitchStep,offset:[-g*this._panStep,-v*this._panStep],center:P.center},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function n_(f){return f*(2-f)}const xh=4.000244140625;class Up{constructor(e,i){this._onTimeout=u=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(u)},this._map=e,this._tr=new Ja(e),this._triggerRenderFrame=i,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(e){this._defaultZoomRate=e}setWheelZoomRate(e){this._wheelZoomRate=e}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!e&&e.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(e){return!!this._map.cooperativeGestures.isEnabled()&&!(e.ctrlKey||this._map.cooperativeGestures.isBypassed(e))}wheel(e){if(!this.isEnabled())return;if(this._shouldBePrevented(e))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",e);let i=e.deltaMode===WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY;const u=H.now(),h=u-(this._lastWheelEventTime||0);this._lastWheelEventTime=u,i!==0&&i%xh==0?this._type="wheel":i!==0&&Math.abs(i)<4?this._type="trackpad":h>400?(this._type=null,this._lastValue=i,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(h*i)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,i+=this._lastValue)),e.shiftKey&&i&&(i/=4),this._type&&(this._lastWheelEvent=e,this._delta-=i,this._active||this._start(e)),e.preventDefault()}_start(e){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const i=G.mousePos(this._map.getCanvas(),e),u=this._tr;this._aroundPoint=this._aroundCenter?u.transform.locationToScreenPoint(c.Q.convert(u.center)):i,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const e=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const S=e.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=S),typeof this._targetZoom=="number"&&(this._targetZoom+=S)}if(this._delta!==0){const S=this._type==="wheel"&&Math.abs(this._delta)>xh?this._wheelZoomRate:this._defaultZoomRate;let P=2/(1+Math.exp(-Math.abs(this._delta*S)));this._delta<0&&P!==0&&(P=1/P);const E=typeof this._targetZoom!="number"?e.scale:c.aH(this._targetZoom);this._targetZoom=Math.min(e.maxZoom,Math.max(e.minZoom,c.aa(E*P))),this._type==="wheel"&&(this._startZoom=e.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const i=typeof this._targetZoom!="number"?e.zoom:this._targetZoom,u=this._startZoom,h=this._easing;let g,v=!1;if(this._type==="wheel"&&u&&h){const S=H.now()-this._lastWheelEventTime,P=Math.min((S+5)/200,1),E=h(P);g=c.B.number(u,i,E),P<1?this._frameId||(this._frameId=!0):v=!0}else g=i,v=!0;return this._active=!0,v&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout},200)),this._lastExpectedZoom=g,{noInertia:!0,needsRenderFrame:!v,zoomDelta:g-e.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(e){let i=c.ca;if(this._prevEase){const u=this._prevEase,h=(H.now()-u.start)/u.duration,g=u.easing(h+.01)-u.easing(h),v=.27/Math.sqrt(g*g+1e-4)*.01,S=Math.sqrt(.0729-v*v);i=c.c8(v,S,.25,1)}return this._prevEase={start:H.now(),duration:e,easing:i},i}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Zp{constructor(e,i){this._clickZoom=e,this._tapZoom=i}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Bo{constructor(e){this._tr=new Ja(e),this.reset()}reset(){this._active=!1}dblclick(e,i){return e.preventDefault(),{cameraAnimation:u=>{u.easeTo({duration:300,zoom:this._tr.zoom+(e.shiftKey?-1:1),around:this._tr.unproject(i)},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ar{constructor(){this._tap=new sc({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(e,i,u){if(!this._swipePoint)if(this._tapTime){const h=i[0],g=e.timeStamp-this._tapTime<500,v=this._tapPoint.dist(h)<30;g&&v?u.length>0&&(this._swipePoint=h,this._swipeTouch=u[0].identifier):this.reset()}else this._tap.touchstart(e,i,u)}touchmove(e,i,u){if(this._tapTime){if(this._swipePoint){if(u[0].identifier!==this._swipeTouch)return;const h=i[0],g=h.y-this._swipePoint.y;return this._swipePoint=h,e.preventDefault(),this._active=!0,{zoomDelta:g/128}}}else this._tap.touchmove(e,i,u)}touchend(e,i,u){if(this._tapTime)this._swipePoint&&u.length===0&&this.reset();else{const h=this._tap.touchend(e,i,u);h&&(this._tapTime=e.timeStamp,this._tapPoint=h)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class rl{constructor(e,i,u){this._el=e,this._mousePan=i,this._touchPan=u}enable(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class uc{constructor(e,i,u,h){this._pitchWithRotate=e.pitchWithRotate,this._rollEnabled=e.rollEnabled,this._mouseRotate=i,this._mousePitch=u,this._mouseRoll=h}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class bh{constructor(e,i,u,h){this._el=e,this._touchZoom=i,this._touchRotate=u,this._tapDragZoom=h,this._rotationDisabled=!1,this._enabled=!0}enable(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class wh{constructor(e,i){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=e,this._options=i,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const e=this._map.getCanvasContainer();e.classList.add("maplibregl-cooperative-gestures"),this._container=G.create("div","maplibregl-cooperative-gesture-screen",e);let i=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(i=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const u=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),h=document.createElement("div");h.className="maplibregl-desktop-message",h.textContent=i,this._container.appendChild(h);const g=document.createElement("div");g.className="maplibregl-mobile-message",g.textContent=u,this._container.appendChild(g),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(G.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(e){return e[this._bypassKey]}notifyGestureBlocked(e,i){this._enabled&&(this._map.fire(new c.l("cooperativegestureprevented",{gestureType:e,originalEvent:i})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const nl=f=>f.zoom||f.drag||f.roll||f.pitch||f.rotate;class i_ extends c.l{}function hi(f){return f.panDelta&&f.panDelta.mag()||f.zoomDelta||f.bearingDelta||f.pitchDelta||f.rollDelta}class hc{constructor(e,i){this.handleWindowEvent=h=>{this.handleEvent(h,`${h.type}Window`)},this.handleEvent=(h,g)=>{if(h.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const v=h.type==="renderFrame"?void 0:h,S={needsRenderFrame:!1},P={},E={},k=h.touches,R=k?this._getMapTouches(k):void 0,L=R?G.touchPos(this._map.getCanvas(),R):G.mousePos(this._map.getCanvas(),h);for(const{handlerName:J,handler:K,allowed:te}of this._handlers){if(!K.isEnabled())continue;let oe;this._blockedByActive(E,te,J)?K.reset():K[g||h.type]&&(oe=K[g||h.type](h,L,R),this.mergeHandlerResult(S,P,oe,J,v),oe&&oe.needsRenderFrame&&this._triggerRenderFrame()),(oe||K.isActive())&&(E[J]=K)}const N={};for(const J in this._previousActiveHandlers)E[J]||(N[J]=v);this._previousActiveHandlers=E,(Object.keys(N).length||hi(S))&&(this._changes.push([S,P,N]),this._triggerRenderFrame()),(Object.keys(E).length||hi(S))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:V}=S;V&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],V(this._map))},this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Op(e),this._bearingSnap=i.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(i);const u=this._el;this._listeners=[[u,"touchstart",{passive:!0}],[u,"touchmove",{passive:!1}],[u,"touchend",void 0],[u,"touchcancel",void 0],[u,"mousedown",void 0],[u,"mousemove",void 0],[u,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[u,"mouseover",void 0],[u,"mouseout",void 0],[u,"dblclick",void 0],[u,"click",void 0],[u,"keydown",{capture:!1}],[u,"keyup",void 0],[u,"wheel",{passive:!1}],[u,"contextmenu",void 0],[window,"blur",void 0]];for(const[h,g,v]of this._listeners)G.addEventListener(h,g,h===document?this.handleWindowEvent:this.handleEvent,v)}destroy(){for(const[e,i,u]of this._listeners)G.removeEventListener(e,i,e===document?this.handleWindowEvent:this.handleEvent,u)}_addDefaultHandlers(e){const i=this._map,u=i.getCanvasContainer();this._add("mapEvent",new Zi(i,e));const h=i.boxZoom=new jp(i,e);this._add("boxZoom",h),e.interactive&&e.boxZoom&&h.enable();const g=i.cooperativeGestures=new wh(i,e.cooperativeGestures);this._add("cooperativeGestures",g),e.cooperativeGestures&&g.enable();const v=new el(i),S=new Bo(i);i.doubleClickZoom=new Zp(S,v),this._add("tapZoom",v),this._add("clickZoom",S),e.interactive&&e.doubleClickZoom&&i.doubleClickZoom.enable();const P=new ar;this._add("tapDragZoom",P);const E=i.touchPitch=new _h(i);this._add("touchPitch",E),e.interactive&&e.touchPitch&&i.touchPitch.enable(e.touchPitch);const k=()=>i.project(i.getCenter()),R=function({enable:he,clickTolerance:pe,aroundCenter:ge=!0,minPixelCenterThreshold:fe=100,rotateDegreesPerPixelMoved:Pe=.8},Ee){const Be=new aa({checkCorrectEvent:je=>G.mouseButton(je)===0&&je.ctrlKey||G.mouseButton(je)===2&&!je.ctrlKey});return new Xn({clickTolerance:pe,move:(je,Le)=>{const Qe=Ee();if(ge&&Math.abs(Qe.y-je.y)>fe)return{bearingDelta:c.c9(new c.P(je.x,Le.y),Le,Qe)};let Ke=(Le.x-je.x)*Pe;return ge&&Le.y<Qe.y&&(Ke=-Ke),{bearingDelta:Ke}},moveStateManager:Be,enable:he,assignEvents:Fo})}(e,k),L=function({enable:he,clickTolerance:pe,pitchDegreesPerPixelMoved:ge=-.5}){const fe=new aa({checkCorrectEvent:Pe=>G.mouseButton(Pe)===0&&Pe.ctrlKey||G.mouseButton(Pe)===2});return new Xn({clickTolerance:pe,move:(Pe,Ee)=>({pitchDelta:(Ee.y-Pe.y)*ge}),moveStateManager:fe,enable:he,assignEvents:Fo})}(e),N=function({enable:he,clickTolerance:pe,rollDegreesPerPixelMoved:ge=.3},fe){const Pe=new aa({checkCorrectEvent:Ee=>G.mouseButton(Ee)===2&&Ee.ctrlKey});return new Xn({clickTolerance:pe,move:(Ee,Be)=>{const je=fe();let Le=(Be.x-Ee.x)*ge;return Be.y<je.y&&(Le=-Le),{rollDelta:Le}},moveStateManager:Pe,enable:he,assignEvents:Fo})}(e,k);i.dragRotate=new uc(e,R,L,N),this._add("mouseRotate",R,["mousePitch"]),this._add("mousePitch",L,["mouseRotate","mouseRoll"]),this._add("mouseRoll",N,["mousePitch"]),e.interactive&&e.dragRotate&&i.dragRotate.enable();const V=function({enable:he,clickTolerance:pe}){const ge=new aa({checkCorrectEvent:fe=>G.mouseButton(fe)===0&&!fe.ctrlKey});return new Xn({clickTolerance:pe,move:(fe,Pe)=>({around:Pe,panDelta:Pe.sub(fe)}),activateOnStart:!0,moveStateManager:ge,enable:he,assignEvents:Fo})}(e),J=new tl(e,i);i.dragPan=new rl(u,V,J),this._add("mousePan",V),this._add("touchPan",J,["touchZoom","touchRotate"]),e.interactive&&e.dragPan&&i.dragPan.enable(e.dragPan);const K=new Vp,te=new $p;i.touchZoomRotate=new bh(u,te,K,P),this._add("touchRotate",K,["touchPan","touchZoom"]),this._add("touchZoom",te,["touchPan","touchRotate"]),e.interactive&&e.touchZoomRotate&&i.touchZoomRotate.enable(e.touchZoomRotate);const oe=i.scrollZoom=new Up(i,()=>this._triggerRenderFrame());this._add("scrollZoom",oe,["mousePan"]),e.interactive&&e.scrollZoom&&i.scrollZoom.enable(e.scrollZoom);const ue=i.keyboard=new vh(i);this._add("keyboard",ue),e.interactive&&e.keyboard&&i.keyboard.enable(),this._add("blockableMapEvent",new sa(i))}_add(e,i,u){this._handlers.push({handlerName:e,handler:i,allowed:u}),this._handlersById[e]=i}stop(e){if(!this._updatingCamera){for(const{handler:i}of this._handlers)i.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[]}}isActive(){for(const{handler:e}of this._handlers)if(e.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!nl(this._eventsInProgress)||this.isZooming()}_blockedByActive(e,i,u){for(const h in e)if(h!==u&&(!i||i.indexOf(h)<0))return!0;return!1}_getMapTouches(e){const i=[];for(const u of e)this._el.contains(u.target)&&i.push(u);return i}mergeHandlerResult(e,i,u,h,g){if(!u)return;c.e(e,u);const v={handlerName:h,originalEvent:u.originalEvent||g};u.zoomDelta!==void 0&&(i.zoom=v),u.panDelta!==void 0&&(i.drag=v),u.rollDelta!==void 0&&(i.roll=v),u.pitchDelta!==void 0&&(i.pitch=v),u.bearingDelta!==void 0&&(i.rotate=v)}_applyChanges(){const e={},i={},u={};for(const[h,g,v]of this._changes)h.panDelta&&(e.panDelta=(e.panDelta||new c.P(0,0))._add(h.panDelta)),h.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+h.zoomDelta),h.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+h.bearingDelta),h.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+h.pitchDelta),h.rollDelta&&(e.rollDelta=(e.rollDelta||0)+h.rollDelta),h.around!==void 0&&(e.around=h.around),h.pinchAround!==void 0&&(e.pinchAround=h.pinchAround),h.noInertia&&(e.noInertia=h.noInertia),c.e(i,g),c.e(u,v);this._updateMapTransform(e,i,u),this._changes=[]}_updateMapTransform(e,i,u){const h=this._map,g=h._getTransformForUpdate(),v=h.terrain;if(!(hi(e)||v&&this._terrainMovement))return this._fireEvents(i,u,!0);h._stop(!0);let{panDelta:S,zoomDelta:P,bearingDelta:E,pitchDelta:k,rollDelta:R,around:L,pinchAround:N}=e;N!==void 0&&(L=N),L=L||h.transform.centerPoint,v&&!g.isPointOnMapSurface(L)&&(L=g.centerPoint);const V={panDelta:S,zoomDelta:P,rollDelta:R,pitchDelta:k,bearingDelta:E,around:L};this._map.cameraHelper.useGlobeControls&&!g.isPointOnMapSurface(L)&&(L=g.centerPoint);const J=L.distSqr(g.centerPoint)<.01?g.center:g.screenPointToLocation(S?L.sub(S):L);v?(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(V,g),this._terrainMovement||!i.drag&&!i.zoom?i.drag&&this._terrainMovement?g.setCenter(g.screenPointToLocation(g.centerPoint.sub(S))):this._map.cameraHelper.handleMapControlsPan(V,g,J):(this._terrainMovement=!0,this._map._elevationFreeze=!0,this._map.cameraHelper.handleMapControlsPan(V,g,J))):(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(V,g),this._map.cameraHelper.handleMapControlsPan(V,g,J)),h._applyUpdatedTransform(g),this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(i,u,!0)}_fireEvents(e,i,u){const h=nl(this._eventsInProgress),g=nl(e),v={};for(const R in e){const{originalEvent:L}=e[R];this._eventsInProgress[R]||(v[`${R}start`]=L),this._eventsInProgress[R]=e[R]}!h&&g&&this._fireEvent("movestart",g.originalEvent);for(const R in v)this._fireEvent(R,v[R]);g&&this._fireEvent("move",g.originalEvent);for(const R in e){const{originalEvent:L}=e[R];this._fireEvent(R,L)}const S={};let P;for(const R in this._eventsInProgress){const{handlerName:L,originalEvent:N}=this._eventsInProgress[R];this._handlersById[L].isActive()||(delete this._eventsInProgress[R],P=i[L]||N,S[`${R}end`]=P)}for(const R in S)this._fireEvent(R,S[R]);const E=nl(this._eventsInProgress),k=(h||g)&&!E;if(k&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const R=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&R.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(R)}if(u&&k){this._updatingCamera=!0;const R=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),L=N=>N!==0&&-this._bearingSnap<N&&N<this._bearingSnap;!R||!R.essential&&H.prefersReducedMotion?(this._map.fire(new c.l("moveend",{originalEvent:P})),L(this._map.getBearing())&&this._map.resetNorth()):(L(R.bearing||this._map.getBearing())&&(R.bearing=0),R.freezeElevation=!0,this._map.easeTo(R,{originalEvent:P})),this._updatingCamera=!1}}_fireEvent(e,i){this._map.fire(new c.l(e,i?{originalEvent:i}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(e=>{delete this._frameId,this.handleEvent(new i_("renderFrame",{timeStamp:e})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class pt extends c.E{constructor(e,i,u){super(),this._renderFrameCallback=()=>{const h=Math.min((H.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(h)),h<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=u.bearingSnap,this.cameraHelper=i,this.on("moveend",()=>{delete this._requestedCameraState})}migrateProjection(e,i){e.apply(this.transform),this.transform=e,this.cameraHelper=i}getCenter(){return new c.Q(this.transform.center.lng,this.transform.center.lat)}setCenter(e,i){return this.jumpTo({center:e},i)}getCenterElevation(){return this.transform.elevation}setCenterElevation(e,i){return this.jumpTo({elevation:e},i),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(e){this._centerClampedToGround=e}panBy(e,i,u){return e=c.P.convert(e).mult(-1),this.panTo(this.transform.center,c.e({offset:e},i),u)}panTo(e,i,u){return this.easeTo(c.e({center:e},i),u)}getZoom(){return this.transform.zoom}setZoom(e,i){return this.jumpTo({zoom:e},i),this}zoomTo(e,i,u){return this.easeTo(c.e({zoom:e},i),u)}zoomIn(e,i){return this.zoomTo(this.getZoom()+1,e,i),this}zoomOut(e,i){return this.zoomTo(this.getZoom()-1,e,i),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(e,i){return e!=this.transform.fov&&(this.transform.setFov(e),this.fire(new c.l("movestart",i)).fire(new c.l("move",i)).fire(new c.l("moveend",i))),this}getBearing(){return this.transform.bearing}setBearing(e,i){return this.jumpTo({bearing:e},i),this}getPadding(){return this.transform.padding}setPadding(e,i){return this.jumpTo({padding:e},i),this}rotateTo(e,i,u){return this.easeTo(c.e({bearing:e},i),u)}resetNorth(e,i){return this.rotateTo(0,c.e({duration:1e3},e),i),this}resetNorthPitch(e,i){return this.easeTo(c.e({bearing:0,pitch:0,roll:0,duration:1e3},e),i),this}snapToNorth(e,i){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,i):this}getPitch(){return this.transform.pitch}setPitch(e,i){return this.jumpTo({pitch:e},i),this}getRoll(){return this.transform.roll}setRoll(e,i){return this.jumpTo({roll:e},i),this}cameraForBounds(e,i){e=or.convert(e).adjustAntiMeridian();const u=i&&i.bearing||0;return this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),u,i)}_cameraForBoxAndBearing(e,i,u,h){const g={top:0,bottom:0,right:0,left:0};if(typeof(h=c.e({padding:g,offset:[0,0],maxZoom:this.transform.maxZoom},h)).padding=="number"){const E=h.padding;h.padding={top:E,bottom:E,right:E,left:E}}const v=c.e(g,h.padding);h.padding=v;const S=this.transform,P=new or(e,i);return this.cameraHelper.cameraForBoxAndBearing(h,v,P,u,S)}fitBounds(e,i,u){return this._fitInternal(this.cameraForBounds(e,i),i,u)}fitScreenCoordinates(e,i,u,h,g){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(c.P.convert(e)),this.transform.screenPointToLocation(c.P.convert(i)),u,h),h,g)}_fitInternal(e,i,u){return e?(delete(i=c.e(e,i)).padding,i.linear?this.easeTo(i,u):this.flyTo(i,u)):this}jumpTo(e,i){this.stop();const u=this._getTransformForUpdate();let h=!1,g=!1,v=!1;const S=u.zoom;this.cameraHelper.handleJumpToCenterZoom(u,e);const P=u.zoom!==S;return"elevation"in e&&u.elevation!==+e.elevation&&u.setElevation(+e.elevation),"bearing"in e&&u.bearing!==+e.bearing&&(h=!0,u.setBearing(+e.bearing)),"pitch"in e&&u.pitch!==+e.pitch&&(g=!0,u.setPitch(+e.pitch)),"roll"in e&&u.roll!==+e.roll&&(v=!0,u.setRoll(+e.roll)),e.padding==null||u.isPaddingEqual(e.padding)||u.setPadding(e.padding),this._applyUpdatedTransform(u),this.fire(new c.l("movestart",i)).fire(new c.l("move",i)),P&&this.fire(new c.l("zoomstart",i)).fire(new c.l("zoom",i)).fire(new c.l("zoomend",i)),h&&this.fire(new c.l("rotatestart",i)).fire(new c.l("rotate",i)).fire(new c.l("rotateend",i)),g&&this.fire(new c.l("pitchstart",i)).fire(new c.l("pitch",i)).fire(new c.l("pitchend",i)),v&&this.fire(new c.l("rollstart",i)).fire(new c.l("roll",i)).fire(new c.l("rollend",i)),this.fire(new c.l("moveend",i))}calculateCameraOptionsFromTo(e,i,u,h=0){const g=c.$.fromLngLat(e,i),v=c.$.fromLngLat(u,h),S=v.x-g.x,P=v.y-g.y,E=v.z-g.z,k=Math.hypot(S,P,E);if(k===0)throw new Error("Can't calculate camera options with same From and To");const R=Math.hypot(S,P),L=c.aa(this.transform.cameraToCenterDistance/k/this.transform.tileSize),N=180*Math.atan2(S,-P)/Math.PI;let V=180*Math.acos(R/k)/Math.PI;return V=E<0?90-V:90+V,{center:v.toLngLat(),elevation:h,zoom:L,pitch:V,bearing:N}}calculateCameraOptionsFromCameraLngLatAltRotation(e,i,u,h,g){const v=this.transform.calculateCenterFromCameraLngLatAlt(e,i,u,h);return{center:v.center,elevation:v.elevation,zoom:v.zoom,bearing:u,pitch:h,roll:g}}easeTo(e,i){this._stop(!1,e.easeId),((e=c.e({offset:[0,0],duration:500,easing:c.ca},e)).animate===!1||!e.essential&&H.prefersReducedMotion)&&(e.duration=0);const u=this._getTransformForUpdate(),h=this.getBearing(),g=u.pitch,v=u.roll,S="bearing"in e?this._normalizeBearing(e.bearing,h):h,P="pitch"in e?+e.pitch:g,E="roll"in e?this._normalizeBearing(e.roll,v):v,k="padding"in e?e.padding:u.padding,R=c.P.convert(e.offset);let L,N;e.around&&(L=c.Q.convert(e.around),N=u.locationToScreenPoint(L));const V={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},J=this.cameraHelper.handleEaseTo(u,{bearing:S,pitch:P,roll:E,padding:k,around:L,aroundPoint:N,offsetAsPoint:R,offset:e.offset,zoom:e.zoom,center:e.center});return this._rotating=this._rotating||h!==S,this._pitching=this._pitching||P!==g,this._rolling=this._rolling||E!==v,this._padding=!u.isPaddingEqual(k),this._zooming=this._zooming||J.isZooming,this._easeId=e.easeId,this._prepareEase(i,e.noMoveStart,V),this.terrain&&this._prepareElevation(J.elevationCenter),this._ease(K=>{J.easeFunc(K),this.terrain&&!e.freezeElevation&&this._updateElevation(K),this._applyUpdatedTransform(u),this._fireMoveEvents(i)},K=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(i,K)},e),this}_prepareEase(e,i,u={}){this._moving=!0,i||u.moving||this.fire(new c.l("movestart",e)),this._zooming&&!u.zooming&&this.fire(new c.l("zoomstart",e)),this._rotating&&!u.rotating&&this.fire(new c.l("rotatestart",e)),this._pitching&&!u.pitching&&this.fire(new c.l("pitchstart",e)),this._rolling&&!u.rolling&&this.fire(new c.l("rollstart",e))}_prepareElevation(e){this._elevationCenter=e,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(e,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(e){this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const i=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(e<1&&i!==this._elevationTarget){const u=this._elevationTarget-this._elevationStart;this._elevationStart+=e*(u-(i-(u*e+this._elevationStart))/(1-e)),this._elevationTarget=i}this.transform.setElevation(c.B.number(this._elevationStart,this._elevationTarget,e))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(e){if(!this.terrain&&e.elevation>=0&&e.pitch<=90)return{};const i=e.getCameraLngLat(),u=e.getCameraAltitude(),h=this.terrain?this.terrain.getElevationForLngLatZoom(i,e.zoom):0;if(u<h){const g=this.calculateCameraOptionsFromTo(i,h,e.center,e.elevation);return{pitch:g.pitch,zoom:g.zoom}}return{}}_applyUpdatedTransform(e){const i=[];if(i.push(h=>this._elevateCameraIfInsideTerrain(h)),this.transformCameraUpdate&&i.push(h=>this.transformCameraUpdate(h)),!i.length)return;const u=e.clone();for(const h of i){const g=u.clone(),{center:v,zoom:S,roll:P,pitch:E,bearing:k,elevation:R}=h(g);v&&g.setCenter(v),R!==void 0&&g.setElevation(R),S!==void 0&&g.setZoom(S),P!==void 0&&g.setRoll(P),E!==void 0&&g.setPitch(E),k!==void 0&&g.setBearing(k),u.apply(g)}this.transform.apply(u)}_fireMoveEvents(e){this.fire(new c.l("move",e)),this._zooming&&this.fire(new c.l("zoom",e)),this._rotating&&this.fire(new c.l("rotate",e)),this._pitching&&this.fire(new c.l("pitch",e)),this._rolling&&this.fire(new c.l("roll",e))}_afterEase(e,i){if(this._easeId&&i&&this._easeId===i)return;delete this._easeId;const u=this._zooming,h=this._rotating,g=this._pitching,v=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,u&&this.fire(new c.l("zoomend",e)),h&&this.fire(new c.l("rotateend",e)),g&&this.fire(new c.l("pitchend",e)),v&&this.fire(new c.l("rollend",e)),this.fire(new c.l("moveend",e))}flyTo(e,i){if(!e.essential&&H.prefersReducedMotion){const Le=c.O(e,["center","zoom","bearing","pitch","roll","elevation"]);return this.jumpTo(Le,i)}this.stop(),e=c.e({offset:[0,0],speed:1.2,curve:1.42,easing:c.ca},e);const u=this._getTransformForUpdate(),h=u.bearing,g=u.pitch,v=u.roll,S=u.padding,P="bearing"in e?this._normalizeBearing(e.bearing,h):h,E="pitch"in e?+e.pitch:g,k="roll"in e?this._normalizeBearing(e.roll,v):v,R="padding"in e?e.padding:u.padding,L=c.P.convert(e.offset);let N=u.centerPoint.add(L);const V=u.screenPointToLocation(N),J=this.cameraHelper.handleFlyTo(u,{bearing:P,pitch:E,roll:k,padding:R,locationAtOffset:V,offsetAsPoint:L,center:e.center,minZoom:e.minZoom,zoom:e.zoom});let K=e.curve;const te=Math.max(u.width,u.height),oe=te/J.scaleOfZoom,ue=J.pixelPathLength;typeof J.scaleOfMinZoom=="number"&&(K=Math.sqrt(te/J.scaleOfMinZoom/ue*2));const he=K*K;function pe(Le){const Qe=(oe*oe-te*te+(Le?-1:1)*he*he*ue*ue)/(2*(Le?oe:te)*he*ue);return Math.log(Math.sqrt(Qe*Qe+1)-Qe)}function ge(Le){return(Math.exp(Le)-Math.exp(-Le))/2}function fe(Le){return(Math.exp(Le)+Math.exp(-Le))/2}const Pe=pe(!1);let Ee=function(Le){return fe(Pe)/fe(Pe+K*Le)},Be=function(Le){return te*((fe(Pe)*(ge(Qe=Pe+K*Le)/fe(Qe))-ge(Pe))/he)/ue;var Qe},je=(pe(!0)-Pe)/K;if(Math.abs(ue)<2e-6||!isFinite(je)){if(Math.abs(te-oe)<1e-6)return this.easeTo(e,i);const Le=oe<te?-1:1;je=Math.abs(Math.log(oe/te))/K,Be=()=>0,Ee=Qe=>Math.exp(Le*K*Qe)}return e.duration="duration"in e?+e.duration:1e3*je/("screenSpeed"in e?+e.screenSpeed/K:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=h!==P,this._pitching=E!==g,this._rolling=k!==v,this._padding=!u.isPaddingEqual(R),this._prepareEase(i,!1),this.terrain&&this._prepareElevation(J.targetCenter),this._ease(Le=>{const Qe=Le*je,Ke=1/Ee(Qe),Ge=Be(Qe);this._rotating&&u.setBearing(c.B.number(h,P,Le)),this._pitching&&u.setPitch(c.B.number(g,E,Le)),this._rolling&&u.setRoll(c.B.number(v,k,Le)),this._padding&&(u.interpolatePadding(S,R,Le),N=u.centerPoint.add(L)),J.easeFunc(Le,Ke,Ge,N),this.terrain&&!e.freezeElevation&&this._updateElevation(Le),this._applyUpdatedTransform(u),this._fireMoveEvents(i)},()=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(i)},e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(e,i){var u;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const h=this._onEaseEnd;delete this._onEaseEnd,h.call(this,i)}return e||(u=this.handlers)===null||u===void 0||u.stop(!1),this}_ease(e,i,u){u.animate===!1||u.duration===0?(e(1),i()):(this._easeStart=H.now(),this._easeOptions=u,this._onEaseFrame=e,this._onEaseEnd=i,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(e,i){e=c.aK(e,-180,180);const u=Math.abs(e-i);return Math.abs(e-360-i)<u&&(e-=360),Math.abs(e+360-i)<u&&(e+=360),e}queryTerrainElevation(e){return this.terrain?this.terrain.getElevationForLngLatZoom(c.Q.convert(e),this.transform.tileZoom):null}}const xt={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class il{constructor(e=xt){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=i=>{!i||i.sourceDataType!=="metadata"&&i.sourceDataType!=="visibility"&&i.dataType!=="style"&&i.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=e}getDefaultPosition(){return"bottom-right"}onAdd(e){return this._map=e,this._compact=this.options.compact,this._container=G.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=G.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=G.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){G.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._sanitizedAttributionHTML=void 0}_setElementTitle(e,i){const u=this._map._getUIString(`AttributionControl.${i}`);e.title=u,e.setAttribute("aria-label",u)}_updateAttributions(){if(!this._map.style)return;let e=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=e.concat(this.options.customAttribution.map(h=>typeof h!="string"?"":h)):typeof this.options.customAttribution=="string"&&e.push(this.options.customAttribution)),this._map.style.stylesheet){const h=this._map.style.stylesheet;this.styleOwner=h.owner,this.styleId=h.id}const i=this._map.style.sourceCaches;for(const h in i){const g=i[h];if(g.used||g.usedForTerrain){const v=g.getSource();v.attribution&&e.indexOf(v.attribution)<0&&e.push(v.attribution)}}e=e.filter(h=>String(h).trim()),e.sort((h,g)=>h.length-g.length),e=e.filter((h,g)=>{for(let v=g+1;v<e.length;v++)if(e[v].indexOf(h)>=0)return!1;return!0});const u=e.join(" | ");u!==this._sanitizedAttributionHTML&&(this._sanitizedAttributionHTML=G.sanitize(u),e.length?(this._innerContainer.innerHTML=this._sanitizedAttributionHTML,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class dc{constructor(e={}){this._updateCompact=()=>{const i=this._container.children;if(i.length){const u=i[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&u.classList.add("maplibregl-compact"):u.classList.remove("maplibregl-compact")}},this.options=e}getDefaultPosition(){return"bottom-left"}onAdd(e){this._map=e,this._compact=this.options&&this.options.compact,this._container=G.create("div","maplibregl-ctrl");const i=G.create("a","maplibregl-ctrl-logo");return i.target="_blank",i.rel="noopener nofollow",i.href="https://maplibre.org/",i.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),i.setAttribute("rel","noopener nofollow"),this._container.appendChild(i),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){G.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Sh{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(e){const i=++this._id;return this._queue.push({callback:e,id:i,cancelled:!1}),i}remove(e){const i=this._currentlyRunning,u=i?this._queue.concat(i):this._queue;for(const h of u)if(h.id===e)return void(h.cancelled=!0)}run(e=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const i=this._currentlyRunning=this._queue;this._queue=[];for(const u of i)if(!u.cancelled&&(u.callback(e),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var On=c.aC([{name:"a_pos3d",type:"Int16",components:3}]);class Gp extends c.E{constructor(e){super(),this._lastTilesetChange=H.now(),this.sourceCache=e,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=e._source.tileSize*2**this.deltaZoom,e.usedForTerrain=!0,e.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(e,i){this.sourceCache.update(e,i),this._renderableTilesKeys=[];const u={};for(const h of be(e,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:i,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))u[h.key]=!0,this._renderableTilesKeys.push(h.key),this._tiles[h.key]||(h.terrainRttPosMatrix32f=new Float64Array(16),c.bN(h.terrainRttPosMatrix32f,0,c.Z,c.Z,0,0,1),this._tiles[h.key]=new Io(h,this.tileSize),this._lastTilesetChange=H.now());for(const h in this._tiles)u[h]||delete this._tiles[h]}freeRtt(e){for(const i in this._tiles){const u=this._tiles[i];(!e||u.tileID.equals(e)||u.tileID.isChildOf(e)||e.isChildOf(u.tileID))&&(u.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(e=>this.getTileByID(e))}getTileByID(e){return this._tiles[e]}getTerrainCoords(e){const i={};for(const u of this._renderableTilesKeys){const h=this._tiles[u].tileID,g=e.clone(),v=c.b1();if(h.canonical.equals(e.canonical))c.bN(v,0,c.Z,c.Z,0,0,1);else if(h.canonical.isChildOf(e.canonical)){const S=h.canonical.z-e.canonical.z,P=h.canonical.x-(h.canonical.x>>S<<S),E=h.canonical.y-(h.canonical.y>>S<<S),k=c.Z>>S;c.bN(v,0,k,k,0,0,1),c.L(v,v,[-P*k,-E*k,0])}else{if(!e.canonical.isChildOf(h.canonical))continue;{const S=e.canonical.z-h.canonical.z,P=e.canonical.x-(e.canonical.x>>S<<S),E=e.canonical.y-(e.canonical.y>>S<<S),k=c.Z>>S;c.bN(v,0,c.Z,c.Z,0,0,1),c.L(v,v,[P*k,E*k,0]),c.M(v,v,[1/2**S,1/2**S,0])}}g.terrainRttPosMatrix32f=new Float32Array(v),i[u]=g}return i}getSourceTile(e,i){const u=this.sourceCache._source;let h=e.overscaledZ-this.deltaZoom;if(h>u.maxzoom&&(h=u.maxzoom),h<u.minzoom)return null;this._sourceTileCache[e.key]||(this._sourceTileCache[e.key]=e.scaledTo(h).key);let g=this.sourceCache.getTileByID(this._sourceTileCache[e.key]);if((!g||!g.dem)&&i)for(;h>=u.minzoom&&(!g||!g.dem);)g=this.sourceCache.getTileByID(e.scaledTo(h--).key);return g}anyTilesAfterTime(e=Date.now()){return this._lastTilesetChange>=e}}class Gi{constructor(e,i,u){this._meshCache={},this.painter=e,this.sourceCache=new Gp(i),this.options=u,this.exaggeration=typeof u.exaggeration=="number"?u.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(e,i,u,h=c.Z){var g;if(!(i>=0&&i<h&&u>=0&&u<h))return 0;const v=this.getTerrainData(e),S=(g=v.tile)===null||g===void 0?void 0:g.dem;if(!S)return 0;const P=c.cb([],[i/h*c.Z,u/h*c.Z],v.u_terrain_matrix),E=[P[0]*S.dim,P[1]*S.dim],k=Math.floor(E[0]),R=Math.floor(E[1]),L=E[0]-k,N=E[1]-R;return S.get(k,R)*(1-L)*(1-N)+S.get(k+1,R)*L*(1-N)+S.get(k,R+1)*(1-L)*N+S.get(k+1,R+1)*L*N}getElevationForLngLatZoom(e,i){if(!c.cc(i,e.wrap()))return 0;const{tileID:u,mercatorX:h,mercatorY:g}=this._getOverscaledTileIDFromLngLatZoom(e,i);return this.getElevation(u,h%c.Z,g%c.Z,c.Z)}getElevation(e,i,u,h=c.Z){return this.getDEMElevation(e,i,u,h)*this.exaggeration}getTerrainData(e){if(!this._emptyDemTexture){const h=this.painter.context,g=new c.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new We(h,g,h.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new We(h,new c.R({width:1,height:1}),h.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(h.gl.NEAREST,h.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=c.as([])}const i=this.sourceCache.getSourceTile(e,!0);if(i&&i.dem&&(!i.demTexture||i.needsTerrainPrepare)){const h=this.painter.context;i.demTexture=this.painter.getTileTexture(i.dem.stride),i.demTexture?i.demTexture.update(i.dem.getPixels(),{premultiply:!1}):i.demTexture=new We(h,i.dem.getPixels(),h.gl.RGBA,{premultiply:!1}),i.demTexture.bind(h.gl.NEAREST,h.gl.CLAMP_TO_EDGE),i.needsTerrainPrepare=!1}const u=i&&i+i.tileID.key+e.key;if(u&&!this._demMatrixCache[u]){const h=this.sourceCache.sourceCache._source.maxzoom;let g=e.canonical.z-i.tileID.canonical.z;e.overscaledZ>e.canonical.z&&(e.canonical.z>=h?g=e.canonical.z-h:c.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const v=e.canonical.x-(e.canonical.x>>g<<g),S=e.canonical.y-(e.canonical.y>>g<<g),P=c.cd(new Float64Array(16),[1/(c.Z<<g),1/(c.Z<<g),0]);c.L(P,P,[v*c.Z,S*c.Z,0]),this._demMatrixCache[e.key]={matrix:P,coord:e}}return{u_depth:2,u_terrain:3,u_terrain_dim:i&&i.dem&&i.dem.dim||1,u_terrain_matrix:u?this._demMatrixCache[e.key].matrix:this._emptyDemMatrix,u_terrain_unpack:i&&i.dem&&i.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(i&&i.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:i}}getFramebuffer(e){const i=this.painter,u=i.width/devicePixelRatio,h=i.height/devicePixelRatio;return!this._fbo||this._fbo.width===u&&this._fbo.height===h||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new We(i.context,{width:u,height:h,data:null},i.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(i.context.gl.NEAREST,i.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new We(i.context,{width:u,height:h,data:null},i.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(i.context.gl.NEAREST,i.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=i.context.createFramebuffer(u,h,!0,!1),this._fbo.depthAttachment.set(i.context.createRenderbuffer(i.context.gl.DEPTH_COMPONENT16,u,h))),this._fbo.colorAttachment.set(e==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const e=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const i=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let g=0,v=0;g<this._coordsTextureSize;g++)for(let S=0;S<this._coordsTextureSize;S++,v+=4)i[v+0]=255&S,i[v+1]=255&g,i[v+2]=S>>8<<4|g>>8,i[v+3]=0;const u=new c.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(i.buffer)),h=new We(e,u,e.gl.RGBA,{premultiply:!1});return h.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),this._coordsTexture=h,h}pointCoordinate(e){this.painter.maybeDrawDepthAndCoords(!0);const i=new Uint8Array(4),u=this.painter.context,h=u.gl,g=Math.round(e.x*this.painter.pixelRatio/devicePixelRatio),v=Math.round(e.y*this.painter.pixelRatio/devicePixelRatio),S=Math.round(this.painter.height/devicePixelRatio);u.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),h.readPixels(g,S-v-1,1,1,h.RGBA,h.UNSIGNED_BYTE,i),u.bindFramebuffer.set(null);const P=i[0]+(i[2]>>4<<8),E=i[1]+((15&i[2])<<8),k=this.coordsIndex[255-i[3]],R=k&&this.sourceCache.getTileByID(k);if(!R)return null;const L=this._coordsTextureSize,N=(1<<R.tileID.canonical.z)*L;return new c.$((R.tileID.canonical.x*L+P)/N+R.tileID.wrap,(R.tileID.canonical.y*L+E)/N,this.getElevation(R.tileID,P,E,L))}depthAtPoint(e){const i=new Uint8Array(4),u=this.painter.context,h=u.gl;return u.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),h.readPixels(e.x,this.painter.height/devicePixelRatio-e.y-1,1,1,h.RGBA,h.UNSIGNED_BYTE,i),u.bindFramebuffer.set(null),(i[0]/16777216+i[1]/65536+i[2]/256+i[3])/256}getTerrainMesh(e){var i;const u=((i=this.painter.style.projection)===null||i===void 0?void 0:i.transitionState)>0,h=u&&e.canonical.y===0,g=u&&e.canonical.y===(1<<e.canonical.z)-1,v=`m_${h?"n":""}_${g?"s":""}`;if(this._meshCache[v])return this._meshCache[v];const S=this.painter.context,P=new c.ce,E=new c.aG,k=this.meshSize,R=c.Z/k,L=k*k;for(let fe=0;fe<=k;fe++)for(let Pe=0;Pe<=k;Pe++)P.emplaceBack(Pe*R,fe*R,0);for(let fe=0;fe<L;fe+=k+1)for(let Pe=0;Pe<k;Pe++)E.emplaceBack(Pe+fe,k+Pe+fe+1,k+Pe+fe+2),E.emplaceBack(Pe+fe,k+Pe+fe+2,Pe+fe+1);const N=P.length,V=N+(k+1),J=(k+1)*k,K=h?c.b8:0,te=h?0:1,oe=g?c.b9:c.Z,ue=g?0:1;for(let fe=0;fe<=k;fe++)P.emplaceBack(fe*R,K,te);for(let fe=0;fe<=k;fe++)P.emplaceBack(fe*R,oe,ue);for(let fe=0;fe<k;fe++)E.emplaceBack(J+fe,V+fe,V+fe+1),E.emplaceBack(J+fe,V+fe+1,J+fe+1),E.emplaceBack(0+fe,N+fe+1,N+fe),E.emplaceBack(0+fe,0+fe+1,N+fe+1);const he=P.length,pe=he+2*(k+1);for(const fe of[0,1])for(let Pe=0;Pe<=k;Pe++)for(const Ee of[0,1])P.emplaceBack(fe*c.Z,Pe*R,Ee);for(let fe=0;fe<2*k;fe+=2)E.emplaceBack(he+fe,he+fe+1,he+fe+3),E.emplaceBack(he+fe,he+fe+3,he+fe+2),E.emplaceBack(pe+fe,pe+fe+3,pe+fe+1),E.emplaceBack(pe+fe,pe+fe+2,pe+fe+3);const ge=new Wn(S.createVertexBuffer(P,On.members),S.createIndexBuffer(E),c.aF.simpleSegment(0,0,P.length,E.length));return this._meshCache[v]=ge,ge}getMeshFrameDelta(e){return 2*Math.PI*c.bq/Math.pow(2,Math.max(e,0))/5}getMinTileElevationForLngLatZoom(e,i){var u;const{tileID:h}=this._getOverscaledTileIDFromLngLatZoom(e,i);return(u=this.getMinMaxElevation(h).minElevation)!==null&&u!==void 0?u:0}getMinMaxElevation(e){const i=this.getTerrainData(e).tile,u={minElevation:null,maxElevation:null};return i&&i.dem&&(u.minElevation=i.dem.min*this.exaggeration,u.maxElevation=i.dem.max*this.exaggeration),u}_getOverscaledTileIDFromLngLatZoom(e,i){const u=c.$.fromLngLat(e.wrap()),h=(1<<i)*c.Z,g=u.x*h,v=u.y*h,S=Math.floor(g/c.Z),P=Math.floor(v/c.Z);return{tileID:new c.Y(i,0,i,S,P),mercatorX:g,mercatorY:v}}}class o_{constructor(e,i,u){this._context=e,this._size=i,this._tileSize=u,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const e of this._objects)e.texture.destroy(),e.fbo.destroy()}_createObject(e){const i=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),u=new We(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return u.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),i.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),i.colorAttachment.set(u.texture),{id:e,fbo:i,texture:u,stamp:-1,inUse:!1}}getObjectForId(e){return this._objects[e]}useObject(e){e.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(i=>e.id!==i),this._recentlyUsed.push(e.id)}stampObject(e){e.stamp=++this._stamp}getOrCreateFreeObject(){for(const i of this._recentlyUsed)if(!this._objects[i].inUse)return this._objects[i];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const e=this._createObject(this._objects.length);return this._objects.push(e),e}freeObject(e){e.inUse=!1}freeAllObjects(){for(const e of this._objects)this.freeObject(e)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(e=>!e.inUse)===!1}}const qi={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class _r{constructor(e,i){this.painter=e,this.terrain=i,this.pool=new o_(e.context,30,i.sourceCache.tileSize*i.qualityFactor)}destruct(){this.pool.destruct()}getTexture(e){return this.pool.getObjectForId(e.rtt[this._stacks.length-1].id).texture}prepareForRender(e,i){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=e._order.filter(u=>!e._layers[u].isHidden(i)),this._coordsAscending={};for(const u in e.sourceCaches){this._coordsAscending[u]={};const h=e.sourceCaches[u].getVisibleCoordinates();for(const g of h){const v=this.terrain.sourceCache.getTerrainCoords(g);for(const S in v)this._coordsAscending[u][S]||(this._coordsAscending[u][S]=[]),this._coordsAscending[u][S].push(v[S])}}this._coordsAscendingStr={};for(const u of e._order){const h=e._layers[u],g=h.source;if(qi[h.type]&&!this._coordsAscendingStr[g]){this._coordsAscendingStr[g]={};for(const v in this._coordsAscending[g])this._coordsAscendingStr[g][v]=this._coordsAscending[g][v].map(S=>S.key).sort().join()}}for(const u of this._renderableTiles)for(const h in this._coordsAscendingStr){const g=this._coordsAscendingStr[h][u.tileID.key];g&&g!==u.rttCoords[h]&&(u.rtt=[])}}renderLayer(e,i){if(e.isHidden(this.painter.transform.zoom))return!1;const u=Object.assign(Object.assign({},i),{isRenderingToTexture:!0}),h=e.type,g=this.painter,v=this._renderableLayerIds[this._renderableLayerIds.length-1]===e.id;if(qi[h]&&(this._prevType&&qi[this._prevType]||this._stacks.push([]),this._prevType=h,this._stacks[this._stacks.length-1].push(e.id),!v))return!0;if(qi[this._prevType]||qi[h]&&v){this._prevType=h;const S=this._stacks.length-1,P=this._stacks[S]||[];for(const E of this._renderableTiles){if(this.pool.isFull()&&(uh(this.painter,this.terrain,this._rttTiles,u),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(E),E.rtt[S]){const R=this.pool.getObjectForId(E.rtt[S].id);if(R.stamp===E.rtt[S].stamp){this.pool.useObject(R);continue}}const k=this.pool.getOrCreateFreeObject();this.pool.useObject(k),this.pool.stampObject(k),E.rtt[S]={id:k.id,stamp:k.stamp},g.context.bindFramebuffer.set(k.fbo.framebuffer),g.context.clear({color:c.b6.transparent,stencil:0}),g.currentStencilSource=void 0;for(let R=0;R<P.length;R++){const L=g.style._layers[P[R]],N=L.source?this._coordsAscending[L.source][E.tileID.key]:[E.tileID];g.context.viewport.set([0,0,k.fbo.width,k.fbo.height]),g._renderTileClippingMasks(L,N,!0),g.renderLayer(g,g.style.sourceCaches[L.source],L,N,u),L.source&&(E.rttCoords[L.source]=this._coordsAscendingStr[L.source][E.tileID.key])}}return uh(this.painter,this.terrain,this._rttTiles,u),this._rttTiles=[],this.pool.freeAllObjects(),qi[h]}return!1}}const Mr={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},qp=A,la={hash:!1,interactive:!0,bearingSnap:7,attributionControl:xt,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:c.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},pc={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class Th{constructor(e,i,u=!1){this.mousedown=g=>{this.startMove(g,G.mousePos(this.element,g)),G.addEventListener(window,"mousemove",this.mousemove),G.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=g=>{this.move(g,G.mousePos(this.element,g))},this.mouseup=g=>{this._rotatePitchHanlder.dragEnd(g),this.offTemp()},this.touchstart=g=>{g.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=G.touchPos(this.element,g.targetTouches)[0],this.startMove(g,this._startPos),G.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),G.addEventListener(window,"touchend",this.touchend))},this.touchmove=g=>{g.targetTouches.length!==1?this.reset():(this._lastPos=G.touchPos(this.element,g.targetTouches)[0],this.move(g,this._lastPos))},this.touchend=g=>{g.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHanlder.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=i;const h=new Np;this._rotatePitchHanlder=new Xn({clickTolerance:3,move:(g,v)=>{const S=i.getBoundingClientRect(),P=new c.P((S.bottom-S.top)/2,(S.right-S.left)/2);return{bearingDelta:c.c9(new c.P(g.x,v.y),v,P),pitchDelta:u?-.5*(v.y-g.y):void 0}},moveStateManager:h,enable:!0,assignEvents:()=>{}}),this.map=e,G.addEventListener(i,"mousedown",this.mousedown),G.addEventListener(i,"touchstart",this.touchstart,{passive:!1}),G.addEventListener(i,"touchcancel",this.reset)}startMove(e,i){this._rotatePitchHanlder.dragStart(e,i),G.disableDrag()}move(e,i){const u=this.map,{bearingDelta:h,pitchDelta:g}=this._rotatePitchHanlder.dragMove(e,i)||{};h&&u.setBearing(u.getBearing()+h),g&&u.setPitch(u.getPitch()+g)}off(){const e=this.element;G.removeEventListener(e,"mousedown",this.mousedown),G.removeEventListener(e,"touchstart",this.touchstart,{passive:!1}),G.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),G.removeEventListener(window,"touchend",this.touchend),G.removeEventListener(e,"touchcancel",this.reset),this.offTemp()}offTemp(){G.enableDrag(),G.removeEventListener(window,"mousemove",this.mousemove),G.removeEventListener(window,"mouseup",this.mouseup),G.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),G.removeEventListener(window,"touchend",this.touchend)}}let fo;function fc(f,e,i){const u=new c.Q(f.lng,f.lat);if(f=new c.Q(f.lng,f.lat),e){const h=new c.Q(f.lng-360,f.lat),g=new c.Q(f.lng+360,f.lat),v=i.locationToScreenPoint(f).distSqr(e);i.locationToScreenPoint(h).distSqr(e)<v?f=h:i.locationToScreenPoint(g).distSqr(e)<v&&(f=g)}for(;Math.abs(f.lng-i.center.lng)>180;){const h=i.locationToScreenPoint(f);if(h.x>=0&&h.y>=0&&h.x<=i.width&&h.y<=i.height)break;f.lng>i.center.lng?f.lng-=360:f.lng+=360}return f.lng!==u.lng&&i.isPointOnMapSurface(i.locationToScreenPoint(f))?f:u}const _s={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function mc(f,e,i){const u=f.classList;for(const h in _s)u.remove(`maplibregl-${i}-anchor-${h}`);u.add(`maplibregl-${i}-anchor-${e}`)}class ol extends c.E{constructor(e){if(super(),this._onKeyPress=i=>{const u=i.code,h=i.charCode||i.keyCode;u!=="Space"&&u!=="Enter"&&h!==32&&h!==13||this.togglePopup()},this._onMapClick=i=>{const u=i.originalEvent.target,h=this._element;this._popup&&(u===h||h.contains(u))&&this.togglePopup()},this._update=i=>{var u;if(!this._map)return;const h=this._map.loaded()&&!this._map.isMoving();((i==null?void 0:i.type)==="terrain"||(i==null?void 0:i.type)==="render"&&!h)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?fc(this._lngLat,this._flatPos,this._map.transform):(u=this._lngLat)===null||u===void 0?void 0:u.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let g="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?g=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(g=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let v="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?v="rotateX(0deg)":this._pitchAlignment==="map"&&(v=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||i&&i.type!=="moveend"||(this._pos=this._pos.round()),G.setTransform(this._element,`${_s[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${v} ${g}`),H.frameAsync(new AbortController).then(()=>{this._updateOpacity(i&&i.type==="moveend")}).catch(()=>{})},this._onMove=i=>{if(!this._isDragging){const u=this._clickTolerance||this._map._clickTolerance;this._isDragging=i.point.dist(this._pointerdownPos)>=u}this._isDragging&&(this._pos=i.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new c.l("dragstart"))),this.fire(new c.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new c.l("dragend")),this._state="inactive"},this._addDragHandler=i=>{this._element.contains(i.originalEvent.target)&&(i.preventDefault(),this._positionDelta=i.point.sub(this._pos).add(this._offset),this._pointerdownPos=i.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._subpixelPositioning=e&&e.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&e.pitchAlignment!=="auto"?e.pitchAlignment:this._rotationAlignment,this.setOpacity(e==null?void 0:e.opacity,e==null?void 0:e.opacityWhenCovered),e&&e.element)this._element=e.element,this._offset=c.P.convert(e&&e.offset||[0,0]);else{this._defaultMarker=!0,this._element=G.create("div");const i=G.createNS("http://www.w3.org/2000/svg","svg"),u=41,h=27;i.setAttributeNS(null,"display","block"),i.setAttributeNS(null,"height",`${u}px`),i.setAttributeNS(null,"width",`${h}px`),i.setAttributeNS(null,"viewBox",`0 0 ${h} ${u}`);const g=G.createNS("http://www.w3.org/2000/svg","g");g.setAttributeNS(null,"stroke","none"),g.setAttributeNS(null,"stroke-width","1"),g.setAttributeNS(null,"fill","none"),g.setAttributeNS(null,"fill-rule","evenodd");const v=G.createNS("http://www.w3.org/2000/svg","g");v.setAttributeNS(null,"fill-rule","nonzero");const S=G.createNS("http://www.w3.org/2000/svg","g");S.setAttributeNS(null,"transform","translate(3.0, 29.0)"),S.setAttributeNS(null,"fill","#000000");const P=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const te of P){const oe=G.createNS("http://www.w3.org/2000/svg","ellipse");oe.setAttributeNS(null,"opacity","0.04"),oe.setAttributeNS(null,"cx","10.5"),oe.setAttributeNS(null,"cy","5.80029008"),oe.setAttributeNS(null,"rx",te.rx),oe.setAttributeNS(null,"ry",te.ry),S.appendChild(oe)}const E=G.createNS("http://www.w3.org/2000/svg","g");E.setAttributeNS(null,"fill",this._color);const k=G.createNS("http://www.w3.org/2000/svg","path");k.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),E.appendChild(k);const R=G.createNS("http://www.w3.org/2000/svg","g");R.setAttributeNS(null,"opacity","0.25"),R.setAttributeNS(null,"fill","#000000");const L=G.createNS("http://www.w3.org/2000/svg","path");L.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),R.appendChild(L);const N=G.createNS("http://www.w3.org/2000/svg","g");N.setAttributeNS(null,"transform","translate(6.0, 7.0)"),N.setAttributeNS(null,"fill","#FFFFFF");const V=G.createNS("http://www.w3.org/2000/svg","g");V.setAttributeNS(null,"transform","translate(8.0, 8.0)");const J=G.createNS("http://www.w3.org/2000/svg","circle");J.setAttributeNS(null,"fill","#000000"),J.setAttributeNS(null,"opacity","0.25"),J.setAttributeNS(null,"cx","5.5"),J.setAttributeNS(null,"cy","5.5"),J.setAttributeNS(null,"r","5.4999962");const K=G.createNS("http://www.w3.org/2000/svg","circle");K.setAttributeNS(null,"fill","#FFFFFF"),K.setAttributeNS(null,"cx","5.5"),K.setAttributeNS(null,"cy","5.5"),K.setAttributeNS(null,"r","5.4999962"),V.appendChild(J),V.appendChild(K),v.appendChild(S),v.appendChild(E),v.appendChild(R),v.appendChild(N),v.appendChild(V),i.appendChild(v),i.setAttributeNS(null,"height",u*this._scale+"px"),i.setAttributeNS(null,"width",h*this._scale+"px"),this._element.appendChild(i),this._offset=c.P.convert(e&&e.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",i=>{i.preventDefault()}),this._element.addEventListener("mousedown",i=>{i.preventDefault()}),mc(this._element,this._anchor,"marker"),e&&e.className)for(const i of e.className.split(" "))this._element.classList.add(i);this._popup=null}addTo(e){return this.remove(),this._map=e,this._element.setAttribute("aria-label",e._getUIString("Marker.Title")),e.getCanvasContainer().appendChild(this._element),e.on("move",this._update),e.on("moveend",this._update),e.on("terrain",this._update),e.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),G.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=c.Q.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){const h=Math.abs(13.5)/Math.SQRT2;e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[h,-1*(38.1-13.5+h)],"bottom-right":[-h,-1*(38.1-13.5+h)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=e,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(e){return this._subpixelPositioning=e,this}getPopup(){return this._popup}togglePopup(){const e=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:e?(e.isOpen()?e.remove():(e.setLngLat(this._lngLat),e.addTo(this._map)),this):this}_updateOpacity(e=!1){var i,u;if(!(!((i=this._map)===null||i===void 0)&&i.terrain)){const R=this._map.transform.isLocationOccluded(this._lngLat)?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==R&&(this._element.style.opacity=R))}if(e)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const h=this._map,g=h.terrain.depthAtPoint(this._pos),v=h.terrain.getElevationForLngLatZoom(this._lngLat,h.transform.tileZoom);if(h.transform.lngLatToCameraDepth(this._lngLat,v)-g<.006)return void(this._element.style.opacity=this._opacity);const S=-this._offset.y/h.transform.pixelsPerMeter,P=Math.sin(h.getPitch()*Math.PI/180)*S,E=h.terrain.depthAtPoint(new c.P(this._pos.x,this._pos.y-this._offset.y)),k=h.transform.lngLatToCameraDepth(this._lngLat,v+P)-E>.006;!((u=this._popup)===null||u===void 0)&&u.isOpen()&&k&&this._popup.remove(),this._element.style.opacity=k?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(e){return this._offset=c.P.convert(e),this._update(),this}addClassName(e){this._element.classList.add(e)}removeClassName(e){this._element.classList.remove(e)}toggleClassName(e){return this._element.classList.toggle(e)}setDraggable(e){return this._draggable=!!e,this._map&&(e?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(e){return this._rotation=e||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(e){return this._rotationAlignment=e||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(e){return this._pitchAlignment=e&&e!=="auto"?e:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(e,i){return(this._opacity===void 0||e===void 0&&i===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),e!==void 0&&(this._opacity=e),i!==void 0&&(this._opacityWhenCovered=i),this._map&&this._updateOpacity(!0),this}}const Ph={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let ca=0,ys=!1;const Ch={maxWidth:100,unit:"metric"};function gc(f,e,i){const u=i&&i.maxWidth||100,h=f._container.clientHeight/2,g=f._container.clientWidth/2,v=f.unproject([g-u/2,h]),S=f.unproject([g+u/2,h]),P=Math.round(f.project(S).x-f.project(v).x),E=Math.min(u,P,f._container.clientWidth),k=v.distanceTo(S);if(i&&i.unit==="imperial"){const R=3.2808*k;R>5280?vs(e,E,R/5280,f._getUIString("ScaleControl.Miles")):vs(e,E,R,f._getUIString("ScaleControl.Feet"))}else i&&i.unit==="nautical"?vs(e,E,k/1852,f._getUIString("ScaleControl.NauticalMiles")):k>=1e3?vs(e,E,k/1e3,f._getUIString("ScaleControl.Kilometers")):vs(e,E,k,f._getUIString("ScaleControl.Meters"))}function vs(f,e,i,u){const h=function(g){const v=Math.pow(10,`${Math.floor(g)}`.length-1);let S=g/v;return S=S>=10?10:S>=5?5:S>=3?3:S>=2?2:S>=1?1:function(P){const E=Math.pow(10,Math.ceil(-Math.log(P)/Math.LN10));return Math.round(P*E)/E}(S),v*S}(i);f.style.width=e*(h/i)+"px",f.innerHTML=`${h}&nbsp;${u}`}const _c={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},Eh=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function yc(f){if(f){if(typeof f=="number"){const e=Math.round(Math.abs(f)/Math.SQRT2);return{center:new c.P(0,0),top:new c.P(0,f),"top-left":new c.P(e,e),"top-right":new c.P(-e,e),bottom:new c.P(0,-f),"bottom-left":new c.P(e,-e),"bottom-right":new c.P(-e,-e),left:new c.P(f,0),right:new c.P(-f,0)}}if(f instanceof c.P||Array.isArray(f)){const e=c.P.convert(f);return{center:e,top:e,"top-left":e,"top-right":e,bottom:e,"bottom-left":e,"bottom-right":e,left:e,right:e}}return{center:c.P.convert(f.center||[0,0]),top:c.P.convert(f.top||[0,0]),"top-left":c.P.convert(f["top-left"]||[0,0]),"top-right":c.P.convert(f["top-right"]||[0,0]),bottom:c.P.convert(f.bottom||[0,0]),"bottom-left":c.P.convert(f["bottom-left"]||[0,0]),"bottom-right":c.P.convert(f["bottom-right"]||[0,0]),left:c.P.convert(f.left||[0,0]),right:c.P.convert(f.right||[0,0])}}return yc(new c.P(0,0))}const vc=A;x.AJAXError=c.ci,x.Event=c.l,x.Evented=c.E,x.LngLat=c.Q,x.MercatorCoordinate=c.$,x.Point=c.P,x.addProtocol=c.cj,x.config=c.a,x.removeProtocol=c.ck,x.AttributionControl=il,x.BoxZoomHandler=jp,x.CanvasSource=Et,x.CooperativeGesturesHandler=wh,x.DoubleClickZoomHandler=Zp,x.DragPanHandler=rl,x.DragRotateHandler=uc,x.EdgeInsets=Qr,x.FullscreenControl=class extends c.E{constructor(f={}){super(),this._onFullscreenChange=()=>{var e;let i=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((e=i==null?void 0:i.shadowRoot)===null||e===void 0)&&e.fullscreenElement;)i=i.shadowRoot.fullscreenElement;i===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,f&&f.container&&(f.container instanceof HTMLElement?this._container=f.container:c.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(f){return this._map=f,this._container||(this._container=this._map.getContainer()),this._controlContainer=G.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){G.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const f=this._fullscreenButton=G.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);G.create("span","maplibregl-ctrl-icon",f).setAttribute("aria-hidden","true"),f.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const f=this._getTitle();this._fullscreenButton.setAttribute("aria-label",f),this._fullscreenButton.title=f}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new c.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new c.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},x.GeoJSONSource=Vi,x.GeolocateControl=class extends c.E{constructor(f){super(),this._onSuccess=e=>{if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new c.l("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(e),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new c.l("geolocate",e)),this._finish()}},this._updateCamera=e=>{const i=new c.Q(e.coords.longitude,e.coords.latitude),u=e.coords.accuracy,h=this._map.getBearing(),g=c.e({bearing:h},this.options.fitBoundsOptions),v=or.fromLngLat(i,u);this._map.fitBounds(v,g,{geolocateSource:!0})},this._updateMarker=e=>{if(e){const i=new c.Q(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(i).addTo(this._map),this._userLocationDotMarker.setLngLat(i).addTo(this._map),this._accuracy=e.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=e=>{if(this._map){if(this.options.trackUserLocation)if(e.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const i=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=i,this._geolocateButton.setAttribute("aria-label",i),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(e.code===3&&ys)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new c.l("error",e)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",e=>e.preventDefault()),this._geolocateButton=G.create("button","maplibregl-ctrl-geolocate",this._container),G.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=e=>{if(this._map){if(e===!1){c.w("Geolocation support is not available so the GeolocateControl will be disabled.");const i=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=i,this._geolocateButton.setAttribute("aria-label",i)}else{const i=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=i,this._geolocateButton.setAttribute("aria-label",i)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=G.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new ol({element:this._dotElement}),this._circleElement=G.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new ol({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",i=>{i.geolocateSource||this._watchState!=="ACTIVE_LOCK"||i.originalEvent&&i.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new c.l("trackuserlocationend")),this.fire(new c.l("userlocationlostfocus")))})}},this.options=c.e({},Ph,f)}onAdd(f){return this._map=f,this._container=G.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return c._(this,arguments,void 0,function*(e=!1){if(fo!==void 0&&!e)return fo;if(window.navigator.permissions===void 0)return fo=!!window.navigator.geolocation,fo;try{fo=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{fo=!!window.navigator.geolocation}return fo})}().then(e=>this._finishSetupUI(e)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),G.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,ca=0,ys=!1}_isOutOfMapMaxBounds(f){const e=this._map.getMaxBounds(),i=f.coords;return e&&(i.longitude<e.getWest()||i.longitude>e.getEast()||i.latitude<e.getSouth()||i.latitude>e.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const f=this._map.getBounds(),e=f.getSouthEast(),i=f.getNorthEast(),u=e.distanceTo(i),h=Math.ceil(this._accuracy/(u/this._map._container.clientHeight)*2);this._circleElement.style.width=`${h}px`,this._circleElement.style.height=`${h}px`}trigger(){if(!this._setup)return c.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new c.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":ca--,ys=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new c.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new c.l("trackuserlocationstart")),this.fire(new c.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let f;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),ca++,ca>1?(f={maximumAge:6e5,timeout:0},ys=!0):(f=this.options.positionOptions,ys=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,f)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},x.GlobeControl=class{constructor(){this._toggleProjection=()=>{var f;const e=(f=this._map.getProjection())===null||f===void 0?void 0:f.type;this._map.setProjection(e!=="mercator"&&e?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var f;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((f=this._map.getProjection())===null||f===void 0?void 0:f.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(f){return this._map=f,this._container=G.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=G.create("button","maplibregl-ctrl-globe",this._container),G.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){G.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},x.Hash=Lo,x.ImageSource=Gn,x.KeyboardHandler=vh,x.LngLatBounds=or,x.LogoControl=dc,x.Map=class extends pt{constructor(f){var e,i;c.cf.mark(c.cg.create);const u=Object.assign(Object.assign(Object.assign({},la),f),{canvasContextAttributes:Object.assign(Object.assign({},la.canvasContextAttributes),f.canvasContextAttributes)});if(u.minZoom!=null&&u.maxZoom!=null&&u.minZoom>u.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(u.minPitch!=null&&u.maxPitch!=null&&u.minPitch>u.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(u.minPitch!=null&&u.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(u.maxPitch!=null&&u.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const h=new si,g=new Si;if(u.minZoom!==void 0&&h.setMinZoom(u.minZoom),u.maxZoom!==void 0&&h.setMaxZoom(u.maxZoom),u.minPitch!==void 0&&h.setMinPitch(u.minPitch),u.maxPitch!==void 0&&h.setMaxPitch(u.maxPitch),u.renderWorldCopies!==void 0&&h.setRenderWorldCopies(u.renderWorldCopies),super(h,g,{bearingSnap:u.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new Sh,this._controls=[],this._mapId=c.a3(),this._contextLost=S=>{S.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new c.l("webglcontextlost",{originalEvent:S}))},this._contextRestored=S=>{this._setupPainter(),this.resize(),this._update(),this.fire(new c.l("webglcontextrestored",{originalEvent:S}))},this._onMapScroll=S=>{if(S.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=u.interactive,this._maxTileCacheSize=u.maxTileCacheSize,this._maxTileCacheZoomLevels=u.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},u.canvasContextAttributes),this._trackResize=u.trackResize===!0,this._bearingSnap=u.bearingSnap,this._centerClampedToGround=u.centerClampedToGround,this._refreshExpiredTiles=u.refreshExpiredTiles===!0,this._fadeDuration=u.fadeDuration,this._crossSourceCollisions=u.crossSourceCollisions===!0,this._collectResourceTiming=u.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},Mr),u.locale),this._clickTolerance=u.clickTolerance,this._overridePixelRatio=u.pixelRatio,this._maxCanvasSize=u.maxCanvasSize,this.transformCameraUpdate=u.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=u.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=_e.addThrottleControl(()=>this.isMoving()),this._requestManager=new De(u.transformRequest),typeof u.container=="string"){if(this._container=document.getElementById(u.container),!this._container)throw new Error(`Container '${u.container}' not found.`)}else{if(!(u.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=u.container}if(u.maxBounds&&this.setMaxBounds(u.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let S=!1;const P=dh(E=>{this._trackResize&&!this._removed&&(this.resize(E),this.redraw())},50);this._resizeObserver=new ResizeObserver(E=>{S?P(E):S=!0}),this._resizeObserver.observe(this._container)}this.handlers=new hc(this,u),this._hash=u.hash&&new Lo(typeof u.hash=="string"&&u.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:u.center,elevation:u.elevation,zoom:u.zoom,bearing:u.bearing,pitch:u.pitch,roll:u.roll}),u.bounds&&(this.resize(),this.fitBounds(u.bounds,c.e({},u.fitBoundsOptions,{duration:0}))));const v=typeof u.style=="string"||((i=(e=u.style)===null||e===void 0?void 0:e.projection)===null||i===void 0?void 0:i.type)!=="globe";this.resize(null,v),this._localIdeographFontFamily=u.localIdeographFontFamily,this._validateStyle=u.validateStyle,u.style&&this.setStyle(u.style,{localIdeographFontFamily:u.localIdeographFontFamily}),u.attributionControl&&this.addControl(new il(typeof u.attributionControl=="boolean"?void 0:u.attributionControl)),u.maplibreLogo&&this.addControl(new dc,u.logoPosition),this.on("style.load",()=>{if(v||this._resizeTransform(),this.transform.unmodified){const S=c.O(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(S)}}),this.on("data",S=>{this._update(S.dataType==="style"),this.fire(new c.l(`${S.dataType}data`,S))}),this.on("dataloading",S=>{this.fire(new c.l(`${S.dataType}dataloading`,S))}),this.on("dataabort",S=>{this.fire(new c.l("sourcedataabort",S))})}_getMapId(){return this._mapId}addControl(f,e){if(e===void 0&&(e=f.getDefaultPosition?f.getDefaultPosition():"top-right"),!f||!f.onAdd)return this.fire(new c.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const i=f.onAdd(this);this._controls.push(f);const u=this._controlPositions[e];return e.indexOf("bottom")!==-1?u.insertBefore(i,u.firstChild):u.appendChild(i),this}removeControl(f){if(!f||!f.onRemove)return this.fire(new c.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const e=this._controls.indexOf(f);return e>-1&&this._controls.splice(e,1),f.onRemove(this),this}hasControl(f){return this._controls.indexOf(f)>-1}calculateCameraOptionsFromTo(f,e,i,u){return u==null&&this.terrain&&(u=this.terrain.getElevationForLngLatZoom(i,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(f,e,i,u)}resize(f,e=!0){const[i,u]=this._containerDimensions(),h=this._getClampedPixelRatio(i,u);if(this._resizeCanvas(i,u,h),this.painter.resize(i,u,h),this.painter.overLimit()){const v=this.painter.context.gl;this._maxCanvasSize=[v.drawingBufferWidth,v.drawingBufferHeight];const S=this._getClampedPixelRatio(i,u);this._resizeCanvas(i,u,S),this.painter.resize(i,u,S)}this._resizeTransform(e);const g=!this._moving;return g&&(this.stop(),this.fire(new c.l("movestart",f)).fire(new c.l("move",f))),this.fire(new c.l("resize",f)),g&&this.fire(new c.l("moveend",f)),this}_resizeTransform(f=!0){var e;const[i,u]=this._containerDimensions();this.transform.resize(i,u,f),(e=this._requestedCameraState)===null||e===void 0||e.resize(i,u,f)}_getClampedPixelRatio(f,e){const{0:i,1:u}=this._maxCanvasSize,h=this.getPixelRatio(),g=f*h,v=e*h;return Math.min(g>i?i/g:1,v>u?u/v:1)*h}getPixelRatio(){var f;return(f=this._overridePixelRatio)!==null&&f!==void 0?f:devicePixelRatio}setPixelRatio(f){this._overridePixelRatio=f,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(f){return this.transform.setMaxBounds(or.convert(f)),this._update()}setMinZoom(f){if((f=f??-2)>=-2&&f<=this.transform.maxZoom)return this.transform.setMinZoom(f),this._update(),this.getZoom()<f&&this.setZoom(f),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(f){if((f=f??22)>=this.transform.minZoom)return this.transform.setMaxZoom(f),this._update(),this.getZoom()>f&&this.setZoom(f),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(f){if((f=f??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(f>=0&&f<=this.transform.maxPitch)return this.transform.setMinPitch(f),this._update(),this.getPitch()<f&&this.setPitch(f),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(f){if((f=f??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(f>=this.transform.minPitch)return this.transform.setMaxPitch(f),this._update(),this.getPitch()>f&&this.setPitch(f),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(f){return this.transform.setRenderWorldCopies(f),this._update()}project(f){return this.transform.locationToScreenPoint(c.Q.convert(f),this.style&&this.terrain)}unproject(f){return this.transform.screenPointToLocation(c.P.convert(f),this.terrain)}isMoving(){var f;return this._moving||((f=this.handlers)===null||f===void 0?void 0:f.isMoving())}isZooming(){var f;return this._zooming||((f=this.handlers)===null||f===void 0?void 0:f.isZooming())}isRotating(){var f;return this._rotating||((f=this.handlers)===null||f===void 0?void 0:f.isRotating())}_createDelegatedListener(f,e,i){if(f==="mouseenter"||f==="mouseover"){let u=!1;return{layers:e,listener:i,delegates:{mousemove:g=>{const v=e.filter(P=>this.getLayer(P)),S=v.length!==0?this.queryRenderedFeatures(g.point,{layers:v}):[];S.length?u||(u=!0,i.call(this,new gr(f,this,g.originalEvent,{features:S}))):u=!1},mouseout:()=>{u=!1}}}}if(f==="mouseleave"||f==="mouseout"){let u=!1;return{layers:e,listener:i,delegates:{mousemove:v=>{const S=e.filter(P=>this.getLayer(P));(S.length!==0?this.queryRenderedFeatures(v.point,{layers:S}):[]).length?u=!0:u&&(u=!1,i.call(this,new gr(f,this,v.originalEvent)))},mouseout:v=>{u&&(u=!1,i.call(this,new gr(f,this,v.originalEvent)))}}}}{const u=h=>{const g=e.filter(S=>this.getLayer(S)),v=g.length!==0?this.queryRenderedFeatures(h.point,{layers:g}):[];v.length&&(h.features=v,i.call(this,h),delete h.features)};return{layers:e,listener:i,delegates:{[f]:u}}}}_saveDelegatedListener(f,e){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[f]=this._delegatedListeners[f]||[],this._delegatedListeners[f].push(e)}_removeDelegatedListener(f,e,i){if(!this._delegatedListeners||!this._delegatedListeners[f])return;const u=this._delegatedListeners[f];for(let h=0;h<u.length;h++){const g=u[h];if(g.listener===i&&g.layers.length===e.length&&g.layers.every(v=>e.includes(v))){for(const v in g.delegates)this.off(v,g.delegates[v]);return void u.splice(h,1)}}}on(f,e,i){if(i===void 0)return super.on(f,e);const u=typeof e=="string"?[e]:e,h=this._createDelegatedListener(f,u,i);this._saveDelegatedListener(f,h);for(const g in h.delegates)this.on(g,h.delegates[g]);return{unsubscribe:()=>{this._removeDelegatedListener(f,u,i)}}}once(f,e,i){if(i===void 0)return super.once(f,e);const u=typeof e=="string"?[e]:e,h=this._createDelegatedListener(f,u,i);for(const g in h.delegates){const v=h.delegates[g];h.delegates[g]=(...S)=>{this._removeDelegatedListener(f,u,i),v(...S)}}this._saveDelegatedListener(f,h);for(const g in h.delegates)this.once(g,h.delegates[g]);return this}off(f,e,i){return i===void 0?super.off(f,e):(this._removeDelegatedListener(f,typeof e=="string"?[e]:e,i),this)}queryRenderedFeatures(f,e){if(!this.style)return[];let i;const u=f instanceof c.P||Array.isArray(f),h=u?f:[[0,0],[this.transform.width,this.transform.height]];if(e=e||(u?{}:f)||{},h instanceof c.P||typeof h[0]=="number")i=[c.P.convert(h)];else{const g=c.P.convert(h[0]),v=c.P.convert(h[1]);i=[g,new c.P(v.x,g.y),v,new c.P(g.x,v.y),g]}return this.style.queryRenderedFeatures(i,e,this.transform)}querySourceFeatures(f,e){return this.style.querySourceFeatures(f,e)}setStyle(f,e){return(e=c.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},e)).diff!==!1&&e.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&f?(this._diffStyle(f,e),this):(this._localIdeographFontFamily=e.localIdeographFontFamily,this._updateStyle(f,e))}setTransformRequest(f){return this._requestManager.setTransformRequest(f),this}_getUIString(f){const e=this._locale[f];if(e==null)throw new Error(`Missing UI string '${f}'`);return e}_updateStyle(f,e){var i,u;if(e.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(f,e));const h=this.style&&e.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!f)),f?(this.style=new qa(this,e||{}),this.style.setEventedParent(this,{style:this.style}),typeof f=="string"?this.style.loadURL(f,e,h):this.style.loadJSON(f,e,h),this):((u=(i=this.style)===null||i===void 0?void 0:i.projection)===null||u===void 0||u.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new qa(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(f,e){if(typeof f=="string"){const i=this._requestManager.transformRequest(f,"Style");c.j(i,new AbortController).then(u=>{this._updateDiff(u.data,e)}).catch(u=>{u&&this.fire(new c.k(u))})}else typeof f=="object"&&this._updateDiff(f,e)}_updateDiff(f,e){try{this.style.setState(f,e)&&this._update(!0)}catch(i){c.w(`Unable to perform style diff: ${i.message||i.error||i}.  Rebuilding the style from scratch.`),this._updateStyle(f,e)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():c.w("There is no style added to the map.")}addSource(f,e){return this._lazyInitEmptyStyle(),this.style.addSource(f,e),this._update(!0)}isSourceLoaded(f){const e=this.style&&this.style.sourceCaches[f];if(e!==void 0)return e.loaded();this.fire(new c.k(new Error(`There is no source with ID '${f}'`)))}setTerrain(f){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),f){const e=this.style.sourceCaches[f.source];if(!e)throw new Error(`cannot load terrain, because there exists no source with ID: ${f.source}`);this.terrain===null&&e.reload();for(const i in this.style._layers){const u=this.style._layers[i];u.type==="hillshade"&&u.source===f.source&&c.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Gi(this.painter,e,f),this.painter.renderToTexture=new _r(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=i=>{i.dataType==="style"?this.terrain.sourceCache.freeRtt():i.dataType==="source"&&i.tile&&(i.sourceId!==f.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),this.terrain.sourceCache.freeRtt(i.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new c.l("terrain",{terrain:f})),this}getTerrain(){var f,e;return(e=(f=this.terrain)===null||f===void 0?void 0:f.options)!==null&&e!==void 0?e:null}areTilesLoaded(){const f=this.style&&this.style.sourceCaches;for(const e in f){const i=f[e]._tiles;for(const u in i){const h=i[u];if(h.state!=="loaded"&&h.state!=="errored")return!1}}return!0}removeSource(f){return this.style.removeSource(f),this._update(!0)}getSource(f){return this.style.getSource(f)}addImage(f,e,i={}){const{pixelRatio:u=1,sdf:h=!1,stretchX:g,stretchY:v,content:S,textFitWidth:P,textFitHeight:E}=i;if(this._lazyInitEmptyStyle(),!(e instanceof HTMLImageElement||c.b(e))){if(e.width===void 0||e.height===void 0)return this.fire(new c.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:k,height:R,data:L}=e,N=e;return this.style.addImage(f,{data:new c.R({width:k,height:R},new Uint8Array(L)),pixelRatio:u,stretchX:g,stretchY:v,content:S,textFitWidth:P,textFitHeight:E,sdf:h,version:0,userImage:N}),N.onAdd&&N.onAdd(this,f),this}}{const{width:k,height:R,data:L}=H.getImageData(e);this.style.addImage(f,{data:new c.R({width:k,height:R},L),pixelRatio:u,stretchX:g,stretchY:v,content:S,textFitWidth:P,textFitHeight:E,sdf:h,version:0})}}updateImage(f,e){const i=this.style.getImage(f);if(!i)return this.fire(new c.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const u=e instanceof HTMLImageElement||c.b(e)?H.getImageData(e):e,{width:h,height:g,data:v}=u;if(h===void 0||g===void 0)return this.fire(new c.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(h!==i.data.width||g!==i.data.height)return this.fire(new c.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const S=!(e instanceof HTMLImageElement||c.b(e));return i.data.replace(v,S),this.style.updateImage(f,i),this}getImage(f){return this.style.getImage(f)}hasImage(f){return f?!!this.style.getImage(f):(this.fire(new c.k(new Error("Missing required image id"))),!1)}removeImage(f){this.style.removeImage(f)}loadImage(f){return _e.getImage(this._requestManager.transformRequest(f,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(f,e){return this._lazyInitEmptyStyle(),this.style.addLayer(f,e),this._update(!0)}moveLayer(f,e){return this.style.moveLayer(f,e),this._update(!0)}removeLayer(f){return this.style.removeLayer(f),this._update(!0)}getLayer(f){return this.style.getLayer(f)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(f,e,i){return this.style.setLayerZoomRange(f,e,i),this._update(!0)}setFilter(f,e,i={}){return this.style.setFilter(f,e,i),this._update(!0)}getFilter(f){return this.style.getFilter(f)}setPaintProperty(f,e,i,u={}){return this.style.setPaintProperty(f,e,i,u),this._update(!0)}getPaintProperty(f,e){return this.style.getPaintProperty(f,e)}setLayoutProperty(f,e,i,u={}){return this.style.setLayoutProperty(f,e,i,u),this._update(!0)}getLayoutProperty(f,e){return this.style.getLayoutProperty(f,e)}setGlyphs(f,e={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(f,e),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(f,e,i={}){return this._lazyInitEmptyStyle(),this.style.addSprite(f,e,i,u=>{u||this._update(!0)}),this}removeSprite(f){return this._lazyInitEmptyStyle(),this.style.removeSprite(f),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(f,e={}){return this._lazyInitEmptyStyle(),this.style.setSprite(f,e,i=>{i||this._update(!0)}),this}setLight(f,e={}){return this._lazyInitEmptyStyle(),this.style.setLight(f,e),this._update(!0)}getLight(){return this.style.getLight()}setSky(f,e={}){return this._lazyInitEmptyStyle(),this.style.setSky(f,e),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(f,e){return this.style.setFeatureState(f,e),this._update()}removeFeatureState(f,e){return this.style.removeFeatureState(f,e),this._update()}getFeatureState(f){return this.style.getFeatureState(f)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let f=0,e=0;return this._container&&(f=this._container.clientWidth||400,e=this._container.clientHeight||300),[f,e]}_setupContainer(){const f=this._container;f.classList.add("maplibregl-map");const e=this._canvasContainer=G.create("div","maplibregl-canvas-container",f);this._interactive&&e.classList.add("maplibregl-interactive"),this._canvas=G.create("canvas","maplibregl-canvas",e),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const i=this._containerDimensions(),u=this._getClampedPixelRatio(i[0],i[1]);this._resizeCanvas(i[0],i[1],u);const h=this._controlContainer=G.create("div","maplibregl-control-container",f),g=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(v=>{g[v]=G.create("div",`maplibregl-ctrl-${v} `,h)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(f,e,i){this._canvas.width=Math.floor(i*f),this._canvas.height=Math.floor(i*e),this._canvas.style.width=`${f}px`,this._canvas.style.height=`${e}px`}_setupPainter(){const f=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let e=null;this._canvas.addEventListener("webglcontextcreationerror",u=>{e={requestedAttributes:f},u&&(e.statusMessage=u.statusMessage,e.type=u.type)},{once:!0});let i=null;if(i=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,f):this._canvas.getContext("webgl2",f)||this._canvas.getContext("webgl",f),!i){const u="Failed to initialize WebGL";throw e?(e.message=u,new Error(JSON.stringify(e))):new Error(u)}this.painter=new zp(i,this.transform),le.testSupport(i)}migrateProjection(f,e){super.migrateProjection(f,e),this.painter.transform=f,this.fire(new c.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(f){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||f,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(f){return this._update(),this._renderTaskQueue.add(f)}_cancelRenderFrame(f){this._renderTaskQueue.remove(f)}_render(f){var e,i,u,h,g;const v=this._idleTriggered?this._fadeDuration:0,S=((e=this.style.projection)===null||e===void 0?void 0:e.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(f),this._removed)return;let P=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const R=this.transform.zoom,L=H.now();this.style.zoomHistory.update(R,L);const N=new c.C(R,{now:L,fadeDuration:v,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),V=N.crossFadingFactor();V===1&&V===this._crossFadingFactor||(P=!0,this._crossFadingFactor=V),this.style.update(N)}const E=((i=this.style.projection)===null||i===void 0?void 0:i.transitionState)>0!==S;(u=this.style.projection)===null||u===void 0||u.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((h=this.style.projection)===null||h===void 0?void 0:h.transitionState,(g=this.style.projection)===null||g===void 0?void 0:g.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||E)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,v,this._crossSourceCollisions,E),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:v,showPadding:this.showPadding}),this.fire(new c.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,c.cf.mark(c.cg.load),this.fire(new c.l("load"))),this.style&&(this.style.hasTransitions()||P)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const k=this._sourcesDirty||this._styleDirty||this._placementDirty;return k||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new c.l("idle")),!this._loaded||this._fullyLoaded||k||(this._fullyLoaded=!0,c.cf.mark(c.cg.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var f;this._hash&&this._hash.remove();for(const i of this._controls)i.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),_e.removeThrottleControl(this._imageQueueHandle),(f=this._resizeObserver)===null||f===void 0||f.disconnect();const e=this.painter.context.gl.getExtension("WEBGL_lose_context");e!=null&&e.loseContext&&e.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),G.remove(this._canvasContainer),G.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),c.cf.clearMetrics(),this._removed=!0,this.fire(new c.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,H.frame(this._frameRequest,f=>{c.cf.frame(f),this._frameRequest=null;try{this._render(f)}catch(e){if(!c.ch(e)&&!function(i){return i.message===Cp}(e))throw e}},()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(f){this._showTileBoundaries!==f&&(this._showTileBoundaries=f,this._update())}get showPadding(){return!!this._showPadding}set showPadding(f){this._showPadding!==f&&(this._showPadding=f,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(f){this._showCollisionBoxes!==f&&(this._showCollisionBoxes=f,f?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(f){this._showOverdrawInspector!==f&&(this._showOverdrawInspector=f,this._update())}get repaint(){return!!this._repaint}set repaint(f){this._repaint!==f&&(this._repaint=f,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(f){this._vertices=f,this._update()}get version(){return qp}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(f){return this._lazyInitEmptyStyle(),this.style.setProjection(f),this._update(!0)}},x.MapMouseEvent=gr,x.MapTouchEvent=Bn,x.MapWheelEvent=ph,x.Marker=ol,x.NavigationControl=class{constructor(f){this._updateZoomButtons=()=>{const e=this._map.getZoom(),i=e===this._map.getMaxZoom(),u=e===this._map.getMinZoom();this._zoomInButton.disabled=i,this._zoomOutButton.disabled=u,this._zoomInButton.setAttribute("aria-disabled",i.toString()),this._zoomOutButton.setAttribute("aria-disabled",u.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(e,i)=>{const u=this._map._getUIString(`NavigationControl.${i}`);e.title=u,e.setAttribute("aria-label",u)},this.options=c.e({},pc,f),this._container=G.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",e=>e.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",e=>this._map.zoomIn({},{originalEvent:e})),G.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",e=>this._map.zoomOut({},{originalEvent:e})),G.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",e=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:e}):this._map.resetNorth({},{originalEvent:e})}),this._compassIcon=G.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(f){return this._map=f,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Th(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){G.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(f,e){const i=G.create("button",f,this._container);return i.type="button",i.addEventListener("click",e),i}},x.Popup=class extends c.E{constructor(f){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:void 0)},this.remove=()=>(this._content&&G.remove(this._content),this._container&&(G.remove(this._container),delete this._container),this._closeButton&&this._closeButton.removeEventListener("click",this._onClose),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new c.l("close"))),this),this._onMouseUp=e=>{this._update(e.point)},this._onMouseMove=e=>{this._update(e.point)},this._onDrag=e=>{this._update(e.point)},this._update=e=>{var i;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=G.create("div","maplibregl-popup",this._map.getContainer()),this._tip=G.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const S of this.options.className.split(" "))this._container.classList.add(S);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?fc(this._lngLat,this._flatPos,this._map.transform):(i=this._lngLat)===null||i===void 0?void 0:i.wrap(),this._trackPointer&&!e)return;const u=this._flatPos=this._pos=this._trackPointer&&e?e:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&e?e:this._map.transform.locationToScreenPoint(this._lngLat));let h=this.options.anchor;const g=yc(this.options.offset);if(!h){const S=this._container.offsetWidth,P=this._container.offsetHeight;let E;E=u.y+g.bottom.y<P?["top"]:u.y>this._map.transform.height-P?["bottom"]:[],u.x<S/2?E.push("left"):u.x>this._map.transform.width-S/2&&E.push("right"),h=E.length===0?"bottom":E.join("-")}let v=u.add(g[h]);this.options.subpixelPositioning||(v=v.round()),G.setTransform(this._container,`${_s[h]} translate(${v.x}px,${v.y}px)`),mc(this._container,h,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=c.e(Object.create(_c),f)}addTo(f){return this._map&&this.remove(),this._map=f,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new c.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(f){return this._lngLat=c.Q.convert(f),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(f){return this.setDOMContent(document.createTextNode(f))}setHTML(f){const e=document.createDocumentFragment(),i=document.createElement("body");let u;for(i.innerHTML=f;u=i.firstChild,u;)e.appendChild(u);return this.setDOMContent(e)}getMaxWidth(){var f;return(f=this._container)===null||f===void 0?void 0:f.style.maxWidth}setMaxWidth(f){return this.options.maxWidth=f,this._update(),this}setDOMContent(f){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=G.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(f),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(f){return this._container&&this._container.classList.add(f),this}removeClassName(f){return this._container&&this._container.classList.remove(f),this}setOffset(f){return this.options.offset=f,this._update(),this}toggleClassName(f){if(this._container)return this._container.classList.toggle(f)}setSubpixelPositioning(f){this.options.subpixelPositioning=f}_createCloseButton(){this.options.closeButton&&(this._closeButton=G.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const f=this._container.querySelector(Eh);f&&f.focus()}},x.RasterDEMTileSource=Rn,x.RasterTileSource=gn,x.ScaleControl=class{constructor(f){this._onMove=()=>{gc(this._map,this._container,this.options)},this.setUnit=e=>{this.options.unit=e,gc(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},Ch),f)}getDefaultPosition(){return"bottom-left"}onAdd(f){return this._map=f,this._container=G.create("div","maplibregl-ctrl maplibregl-ctrl-scale",f.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){G.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},x.ScrollZoomHandler=Up,x.Style=qa,x.TerrainControl=class{constructor(f){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=f}onAdd(f){return this._map=f,this._container=G.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=G.create("button","maplibregl-ctrl-terrain",this._container),G.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){G.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},x.TwoFingersTouchPitchHandler=_h,x.TwoFingersTouchRotateHandler=Vp,x.TwoFingersTouchZoomHandler=$p,x.TwoFingersTouchZoomRotateHandler=bh,x.VectorTileSource=lo,x.VideoSource=qn,x.addSourceType=(f,e)=>c._(void 0,void 0,void 0,function*(){if(rs(f))throw new Error(`A source type called "${f}" already exists.`);((i,u)=>{ts[i]=u})(f,e)}),x.clearPrewarmedResources=function(){const f=wr;f&&(f.isPreloaded()&&f.numActive()===1?(f.release(Lt),wr=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},x.createTileMesh=Za,x.getMaxParallelImageRequests=function(){return c.a.MAX_PARALLEL_IMAGE_REQUESTS},x.getRTLTextPluginStatus=function(){return uo().getRTLTextPluginStatus()},x.getVersion=function(){return vc},x.getWorkerCount=function(){return Nt.workerCount},x.getWorkerUrl=function(){return c.a.WORKER_URL},x.importScriptInWorkers=function(f){return so().broadcast("IS",f)},x.prewarm=function(){ln().acquire(Lt)},x.setMaxParallelImageRequests=function(f){c.a.MAX_PARALLEL_IMAGE_REQUESTS=f},x.setRTLTextPlugin=function(f,e){return uo().setRTLTextPlugin(f,e)},x.setWorkerCount=function(f){Nt.workerCount=f},x.setWorkerUrl=function(f){c.a.WORKER_URL=f}});var b=a;return b})})(cT);var eA=cT.exports;const tA=Rw(eA);function Yo(t,n){return Array.from(t.getElementsByTagName(n))}function Im(t){return t[0]==="#"?t:`#${t}`}function rA(t,n,a){return Array.from(t.getElementsByTagNameNS(a,n))}function Oi(t){return t==null||t.normalize(),(t==null?void 0:t.textContent)||""}function Qo(t,n,a){const p=t.getElementsByTagName(n),m=p.length?p[0]:null;return m&&a&&a(m),m}function Eo(t,n,a){const p={};if(!t)return p;const m=t.getElementsByTagName(n),b=m.length?m[0]:null;return b&&a?a(b,p):p}function vu(t,n,a){const p=Oi(Qo(t,n));return p&&a?a(p)||{}:{}}function Uc(t,n,a){const p=Number.parseFloat(Oi(Qo(t,n)));if(!Number.isNaN(p))return a&&a(p),p}function hT(t,n){const a={};for(const p of n)vu(t,p,m=>{a[p]=m});return a}function dT(t){return(t==null?void 0:t.nodeType)===1}function pT(t,n){const a={},p=n==="stroke"||n==="fill"?n:`${n}-color`;return t[0]==="#"&&(t=t.substring(1)),t.length===6||t.length===3?a[p]=`#${t}`:t.length===8&&(a[`${n}-opacity`]=Number.parseInt(t.substring(0,2),16)/255,a[p]=`#${t.substring(6,8)}${t.substring(4,6)}${t.substring(2,4)}`),a}function km(t,n,a){const p={};return Uc(t,n,m=>{p[a]=m}),p}function Lv(t,n){return Eo(t,"color",a=>pT(Oi(a),n))}function fT(t){return Eo(t,"Icon",(n,a)=>(vu(n,"href",p=>{a.icon=p}),a))}function nA(t){return Eo(t,"IconStyle",n=>Object.assign(Lv(n,"icon"),km(n,"scale","icon-scale"),km(n,"heading","icon-heading"),Eo(n,"hotSpot",a=>{const p=Number.parseFloat(a.getAttribute("x")||""),m=Number.parseFloat(a.getAttribute("y")||""),b=a.getAttribute("xunits")||"",x=a.getAttribute("yunits")||"";return!Number.isNaN(p)&&!Number.isNaN(m)?{"icon-offset":[p,m],"icon-offset-units":[b,x]}:{}}),fT(n)))}function iA(t){return Eo(t,"LabelStyle",n=>Object.assign(Lv(n,"label"),km(n,"scale","label-scale")))}function oA(t){return Eo(t,"LineStyle",n=>Object.assign(Lv(n,"stroke"),km(n,"width","stroke-width")))}function sA(t){return Eo(t,"PolyStyle",(n,a)=>Object.assign(a,Eo(n,"color",p=>pT(Oi(p),"fill")),vu(n,"fill",p=>{if(p==="0")return{"fill-opacity":0}}),vu(n,"outline",p=>{if(p==="0")return{"stroke-opacity":0}})))}function Dv(t){return Object.assign({},sA(t),oA(t),iA(t),nA(t))}const aA=/\s*/g,lA=/^\s*|\s*$/g,cA=/\s+/;function mT(t){return t.replace(aA,"").split(",").map(Number.parseFloat).filter(n=>!Number.isNaN(n)).slice(0,3)}function w0(t){return t.replace(lA,"").split(cA).map(mT).filter(n=>n.length>=2)}function uA(t){let n=Yo(t,"coord");n.length===0&&(n=rA(t,"coord","*"));const a=n.map(p=>Oi(p).split(" ").map(Number.parseFloat));return a.length===0?null:{geometry:a.length>2?{type:"LineString",coordinates:a}:{type:"Point",coordinates:a[0]},times:Yo(t,"when").map(p=>Oi(p))}}function gT(t){if(t.length===0)return t;const n=t[0],a=t[t.length-1];let p=!0;for(let m=0;m<Math.max(n.length,a.length);m++)if(n[m]!==a[m]){p=!1;break}return p?t:t.concat([t[0]])}function Qf(t){return Oi(Qo(t,"coordinates"))}function _T(t){let n=[],a=[];for(let p=0;p<t.childNodes.length;p++){const m=t.childNodes.item(p);if(dT(m))switch(m.tagName){case"MultiGeometry":case"MultiTrack":case"gx:MultiTrack":{const b=_T(m);n=n.concat(b.geometries),a=a.concat(b.coordTimes);break}case"Point":{const b=mT(Qf(m));b.length>=2&&n.push({type:"Point",coordinates:b});break}case"LinearRing":case"LineString":{const b=w0(Qf(m));b.length>=2&&n.push({type:"LineString",coordinates:b});break}case"Polygon":{const b=[];for(const x of Yo(m,"LinearRing")){const c=gT(w0(Qf(x)));c.length>=4&&b.push(c)}b.length&&n.push({type:"Polygon",coordinates:b});break}case"Track":case"gx:Track":{const b=uA(m);if(!b)break;const{times:x,geometry:c}=b;n.push(c),x.length&&a.push(x);break}}}return{geometries:n,coordTimes:a}}const Bc=t=>Number(t),S0={string:t=>t,int:Bc,uint:Bc,short:Bc,ushort:Bc,float:Bc,double:Bc,bool:t=>!!t};function yT(t,n){return Eo(t,"ExtendedData",(a,p)=>{for(const m of Yo(a,"Data"))p[m.getAttribute("name")||""]=Oi(Qo(m,"value"));for(const m of Yo(a,"SimpleData")){const b=m.getAttribute("name")||"",x=n[b]||S0.string;p[b]=x(Oi(m))}return p})}function vT(t){const n=Qo(t,"description");for(const a of Array.from((n==null?void 0:n.childNodes)||[]))if(a.nodeType===4)return{description:{"@type":"html",value:Oi(a)}};return{}}function xT(t){return Eo(t,"TimeSpan",n=>({timespan:{begin:Oi(Qo(n,"begin")),end:Oi(Qo(n,"end"))}}))}function bT(t){return Eo(t,"TimeStamp",n=>({timestamp:Oi(Qo(n,"when"))}))}function wT(t,n){return vu(t,"styleUrl",a=>(a=Im(a),n[a]?Object.assign({styleUrl:a},n[a]):{styleUrl:a}))}function hA(t){return Qo(t,"gx:LatLonQuad")?{geometry:{type:"Polygon",coordinates:[gT(w0(Qf(t)))]}}:fA(t)}const dA=Math.PI/180;function pA(t,n,a){const p=[(t[0]+t[2])/2,(t[1]+t[3])/2];return[n[0].map(m=>{const b=m[1]-p[1],x=m[0]-p[0],c=Math.sqrt(b**2+x**2),A=Math.atan2(b,x)+a*dA;return[p[0]+Math.cos(A)*c,p[1]+Math.sin(A)*c]})]}function fA(t){const n=Qo(t,"LatLonBox");if(n){const a=Uc(n,"north"),p=Uc(n,"west"),m=Uc(n,"east"),b=Uc(n,"south"),x=Uc(n,"rotation");if(typeof a=="number"&&typeof b=="number"&&typeof p=="number"&&typeof m=="number"){const c=[p,b,m,a];let A=[[[p,a],[m,a],[m,b],[p,b],[p,a]]];return typeof x=="number"&&(A=pA(c,A,x)),{bbox:c,geometry:{type:"Polygon",coordinates:A}}}}return null}function mA(t,n,a,p){var A;const m=hA(t),b=(m==null?void 0:m.geometry)||null;if(!b&&p.skipNullGeometry)return null;const x={type:"Feature",geometry:b,properties:Object.assign({"@geometry-type":"groundoverlay"},hT(t,["name","address","visibility","open","phoneNumber","description"]),vT(t),wT(t,n),Dv(t),fT(t),yT(t,a),xT(t),bT(t))};m!=null&&m.bbox&&(x.bbox=m.bbox),((A=x.properties)==null?void 0:A.visibility)!==void 0&&(x.properties.visibility=x.properties.visibility!=="0");const c=t.getAttribute("id");return c!==null&&c!==""&&(x.id=c),x}function gA(t){return t.length===0?null:t.length===1?t[0]:{type:"GeometryCollection",geometries:t}}function _A(t,n,a,p){var j;const{coordTimes:m,geometries:b}=_T(t),x=gA(b);if(!x&&p.skipNullGeometry)return null;const c={type:"Feature",geometry:x,properties:Object.assign(hT(t,["name","address","visibility","open","phoneNumber","description"]),vT(t),wT(t,n),Dv(t),yT(t,a),xT(t),bT(t),m.length?{coordinateProperties:{times:m.length===1?m[0]:m}}:{})};((j=c.properties)==null?void 0:j.visibility)!==void 0&&(c.properties.visibility=c.properties.visibility!=="0");const A=t.getAttribute("id");return A!==null&&A!==""&&(c.id=A),c}function yA(t){let n=t.getAttribute("id");const a=t.parentNode;return!n&&dT(a)&&a.localName==="CascadingStyle"&&(n=a.getAttribute("kml:id")||a.getAttribute("id")),Im(n||"")}function vA(t){const n={};for(const a of Yo(t,"Style"))n[yA(a)]=Dv(a);for(const a of Yo(t,"StyleMap")){const p=Im(a.getAttribute("id")||"");vu(a,"styleUrl",m=>{m=Im(m),n[m]&&(n[p]=n[m])})}return n}function xA(t){const n={};for(const a of Yo(t,"SimpleField"))n[a.getAttribute("name")||""]=S0[a.getAttribute("type")||""]||S0.string;return n}function*bA(t,n={skipNullGeometry:!1}){const a=t,p=vA(a),m=xA(a);for(const b of Yo(a,"Placemark")){const x=_A(b,p,m,n);x&&(yield x)}for(const b of Yo(a,"GroundOverlay")){const x=mA(b,p,m,n);x&&(yield x)}}function wA(t,n={skipNullGeometry:!1}){return{type:"FeatureCollection",features:Array.from(bA(t,n))}}function SA(){const t=we.useRef(null),n=we.useRef(null);we.useEffect(()=>{const p=new tA.Map({container:t.current,style:"style2.json",center:[0,0],zoom:2,maxZoom:5,minZoom:2});return n.current=p,()=>p.remove()},[]);const a=p=>{var x;const m=(x=p.target.files)==null?void 0:x[0];if(!m)return;const b=new FileReader;b.onload=()=>{const c=new DOMParser,A=b.result,j=c.parseFromString(A,"text/xml");let Y=wA(j);Y.features=Y.features.filter(H=>H.geometry!==null);const Q=n.current;Q&&(Q.getSource("kmlData")?Q.getSource("kmlData").setData({...Y,features:Y.features.filter(H=>H.geometry!==null)}):(Q.addSource("kmlData",{type:"geojson",data:{...Y,features:Y.features.filter(H=>H.geometry!==null)}}),Q.addLayer({id:"kml-fill",type:"fill",source:"kmlData",paint:{"fill-color":"#ADD8E6","fill-opacity":.4}}),Q.addLayer({id:"kml-outline",type:"line",source:"kmlData",paint:{"line-color":"#0057B8","line-width":2}})))},b.readAsText(m)};return tt.jsxs("div",{style:{height:"100%"},children:[tt.jsx("input",{type:"file",accept:".kml",onChange:a,style:{position:"absolute",top:"100px",left:"100px",zIndex:1,background:"white",padding:"4px",borderRadius:"4px",cursor:"pointer"}}),tt.jsx("div",{ref:t,id:"map"})]})}function ST(t){var n,a,p="";if(typeof t=="string"||typeof t=="number")p+=t;else if(typeof t=="object")if(Array.isArray(t)){var m=t.length;for(n=0;n<m;n++)t[n]&&(a=ST(t[n]))&&(p&&(p+=" "),p+=a)}else for(a in t)t[a]&&(p&&(p+=" "),p+=a);return p}function Ai(){for(var t,n,a=0,p="",m=arguments.length;a<m;a++)(t=arguments[a])&&(n=ST(t))&&(p&&(p+=" "),p+=n);return p}function Am(t,n){const a={...n};for(const p in t)if(Object.prototype.hasOwnProperty.call(t,p)){const m=p;if(m==="components"||m==="slots")a[m]={...t[m],...a[m]};else if(m==="componentsProps"||m==="slotProps"){const b=t[m],x=n[m];if(!x)a[m]=b||{};else if(!b)a[m]=x;else{a[m]={...x};for(const c in b)if(Object.prototype.hasOwnProperty.call(b,c)){const A=c;a[m][A]=Am(b[A],x[A])}}}else a[m]===void 0&&(a[m]=t[m])}return a}function Fv(t,n,a=void 0){const p={};for(const m in t){const b=t[m];let x="",c=!0;for(let A=0;A<b.length;A+=1){const j=b[A];j&&(x+=(c===!0?"":" ")+n(j),c=!1,a&&a[j]&&(x+=" "+a[j]))}p[m]=x}return p}function Cl(t,...n){const a=new URL(`https://mui.com/production-error/?code=${t}`);return n.forEach(p=>a.searchParams.append("args[]",p)),`Minified MUI error #${t}; visit ${a} for the full message.`}function TA(t,n=Number.MIN_SAFE_INTEGER,a=Number.MAX_SAFE_INTEGER){return Math.max(n,Math.min(t,a))}function Bv(t,n=0,a=1){return TA(t,n,a)}function PA(t){t=t.slice(1);const n=new RegExp(`.{1,${t.length>=6?2:1}}`,"g");let a=t.match(n);return a&&a[0].length===1&&(a=a.map(p=>p+p)),a?`rgb${a.length===4?"a":""}(${a.map((p,m)=>m<3?parseInt(p,16):Math.round(parseInt(p,16)/255*1e3)/1e3).join(", ")})`:""}function La(t){if(t.type)return t;if(t.charAt(0)==="#")return La(PA(t));const n=t.indexOf("("),a=t.substring(0,n);if(!["rgb","rgba","hsl","hsla","color"].includes(a))throw new Error(Cl(9,t));let p=t.substring(n+1,t.length-1),m;if(a==="color"){if(p=p.split(" "),m=p.shift(),p.length===4&&p[3].charAt(0)==="/"&&(p[3]=p[3].slice(1)),!["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].includes(m))throw new Error(Cl(10,m))}else p=p.split(",");return p=p.map(b=>parseFloat(b)),{type:a,values:p,colorSpace:m}}const CA=t=>{const n=La(t);return n.values.slice(0,3).map((a,p)=>n.type.includes("hsl")&&p!==0?`${a}%`:a).join(" ")},hd=(t,n)=>{try{return CA(t)}catch{return t}};function eg(t){const{type:n,colorSpace:a}=t;let{values:p}=t;return n.includes("rgb")?p=p.map((m,b)=>b<3?parseInt(m,10):m):n.includes("hsl")&&(p[1]=`${p[1]}%`,p[2]=`${p[2]}%`),n.includes("color")?p=`${a} ${p.join(" ")}`:p=`${p.join(", ")}`,`${n}(${p})`}function TT(t){t=La(t);const{values:n}=t,a=n[0],p=n[1]/100,m=n[2]/100,b=p*Math.min(m,1-m),x=(j,Y=(j+a/30)%12)=>m-b*Math.max(Math.min(Y-3,9-Y,1),-1);let c="rgb";const A=[Math.round(x(0)*255),Math.round(x(8)*255),Math.round(x(4)*255)];return t.type==="hsla"&&(c+="a",A.push(n[3])),eg({type:c,values:A})}function T0(t){t=La(t);let n=t.type==="hsl"||t.type==="hsla"?La(TT(t)).values:t.values;return n=n.map(a=>(t.type!=="color"&&(a/=255),a<=.03928?a/12.92:((a+.055)/1.055)**2.4)),Number((.2126*n[0]+.7152*n[1]+.0722*n[2]).toFixed(3))}function EA(t,n){const a=T0(t),p=T0(n);return(Math.max(a,p)+.05)/(Math.min(a,p)+.05)}function Zc(t,n){return t=La(t),n=Bv(n),(t.type==="rgb"||t.type==="hsl")&&(t.type+="a"),t.type==="color"?t.values[3]=`/${n}`:t.values[3]=n,eg(t)}function Df(t,n,a){try{return Zc(t,n)}catch{return t}}function Ov(t,n){if(t=La(t),n=Bv(n),t.type.includes("hsl"))t.values[2]*=1-n;else if(t.type.includes("rgb")||t.type.includes("color"))for(let a=0;a<3;a+=1)t.values[a]*=1-n;return eg(t)}function cr(t,n,a){try{return Ov(t,n)}catch{return t}}function jv(t,n){if(t=La(t),n=Bv(n),t.type.includes("hsl"))t.values[2]+=(100-t.values[2])*n;else if(t.type.includes("rgb"))for(let a=0;a<3;a+=1)t.values[a]+=(255-t.values[a])*n;else if(t.type.includes("color"))for(let a=0;a<3;a+=1)t.values[a]+=(1-t.values[a])*n;return eg(t)}function ur(t,n,a){try{return jv(t,n)}catch{return t}}function MA(t,n=.15){return T0(t)>.5?Ov(t,n):jv(t,n)}function Ff(t,n,a){try{return MA(t,n)}catch{return t}}var PT={exports:{}},hr={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Nv=Symbol.for("react.transitional.element"),$v=Symbol.for("react.portal"),tg=Symbol.for("react.fragment"),rg=Symbol.for("react.strict_mode"),ng=Symbol.for("react.profiler"),ig=Symbol.for("react.consumer"),og=Symbol.for("react.context"),sg=Symbol.for("react.forward_ref"),ag=Symbol.for("react.suspense"),lg=Symbol.for("react.suspense_list"),cg=Symbol.for("react.memo"),ug=Symbol.for("react.lazy"),IA=Symbol.for("react.offscreen"),kA=Symbol.for("react.client.reference");function io(t){if(typeof t=="object"&&t!==null){var n=t.$$typeof;switch(n){case Nv:switch(t=t.type,t){case tg:case ng:case rg:case ag:case lg:return t;default:switch(t=t&&t.$$typeof,t){case og:case sg:case ug:case cg:return t;case ig:return t;default:return n}}case $v:return n}}}hr.ContextConsumer=ig;hr.ContextProvider=og;hr.Element=Nv;hr.ForwardRef=sg;hr.Fragment=tg;hr.Lazy=ug;hr.Memo=cg;hr.Portal=$v;hr.Profiler=ng;hr.StrictMode=rg;hr.Suspense=ag;hr.SuspenseList=lg;hr.isContextConsumer=function(t){return io(t)===ig};hr.isContextProvider=function(t){return io(t)===og};hr.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===Nv};hr.isForwardRef=function(t){return io(t)===sg};hr.isFragment=function(t){return io(t)===tg};hr.isLazy=function(t){return io(t)===ug};hr.isMemo=function(t){return io(t)===cg};hr.isPortal=function(t){return io(t)===$v};hr.isProfiler=function(t){return io(t)===ng};hr.isStrictMode=function(t){return io(t)===rg};hr.isSuspense=function(t){return io(t)===ag};hr.isSuspenseList=function(t){return io(t)===lg};hr.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===tg||t===ng||t===rg||t===ag||t===lg||t===IA||typeof t=="object"&&t!==null&&(t.$$typeof===ug||t.$$typeof===cg||t.$$typeof===og||t.$$typeof===ig||t.$$typeof===sg||t.$$typeof===kA||t.getModuleId!==void 0)};hr.typeOf=io;PT.exports=hr;var CT=PT.exports;function Is(t){if(typeof t!="object"||t===null)return!1;const n=Object.getPrototypeOf(t);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)}function ET(t){if(we.isValidElement(t)||CT.isValidElementType(t)||!Is(t))return t;const n={};return Object.keys(t).forEach(a=>{n[a]=ET(t[a])}),n}function Di(t,n,a={clone:!0}){const p=a.clone?{...t}:t;return Is(t)&&Is(n)&&Object.keys(n).forEach(m=>{we.isValidElement(n[m])||CT.isValidElementType(n[m])?p[m]=n[m]:Is(n[m])&&Object.prototype.hasOwnProperty.call(t,m)&&Is(t[m])?p[m]=Di(t[m],n[m],a):a.clone?p[m]=Is(n[m])?ET(n[m]):n[m]:p[m]=n[m]}),p}function wn(t){if(typeof t!="string")throw new Error(Cl(7));return t.charAt(0).toUpperCase()+t.slice(1)}function AA(t,n){typeof t=="function"?t(n):t&&(t.current=n)}const zA=typeof window<"u"?we.useLayoutEffect:we.useEffect;let iw=0;function RA(t){const[n,a]=we.useState(t),p=t||n;return we.useEffect(()=>{n==null&&(iw+=1,a(`mui-${iw}`))},[n]),p}const LA={...Ey},ow=LA.useId;function DA(t){if(ow!==void 0){const n=ow();return t??n}return RA(t)}function Jf(t){const n=we.useRef(t);return zA(()=>{n.current=t}),we.useRef((...a)=>(0,n.current)(...a)).current}function sw(...t){return we.useMemo(()=>t.every(n=>n==null)?null:n=>{t.forEach(a=>{AA(a,n)})},t)}const aw={};function MT(t,n){const a=we.useRef(aw);return a.current===aw&&(a.current=t(n)),a}const FA=[];function BA(t){we.useEffect(t,FA)}class Vv{constructor(){Hh(this,"currentId",null);Hh(this,"clear",()=>{this.currentId!==null&&(clearTimeout(this.currentId),this.currentId=null)});Hh(this,"disposeEffect",()=>this.clear)}static create(){return new Vv}start(n,a){this.clear(),this.currentId=setTimeout(()=>{this.currentId=null,a()},n)}}function OA(){const t=MT(Vv.create).current;return BA(t.disposeEffect),t}function lw(t){try{return t.matches(":focus-visible")}catch{}return!1}const cw=t=>t,jA=()=>{let t=cw;return{configure(n){t=n},generate(n){return t(n)},reset(){t=cw}}},NA=jA(),$A={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function hg(t,n,a="Mui"){const p=$A[n];return p?`${a}-${p}`:`${NA.generate(t)}-${n}`}function dg(t,n,a="Mui"){const p={};return n.forEach(m=>{p[m]=hg(t,m,a)}),p}function wd(t,n){return n?Di(t,n,{clone:!1}):t}function VA(t,n){if(!t.containerQueries)return n;const a=Object.keys(n).filter(p=>p.startsWith("@container")).sort((p,m)=>{var x,c;const b=/min-width:\s*([0-9.]+)/;return+(((x=p.match(b))==null?void 0:x[1])||0)-+(((c=m.match(b))==null?void 0:c[1])||0)});return a.length?a.reduce((p,m)=>{const b=n[m];return delete p[m],p[m]=b,p},{...n}):n}function UA(t,n){return n==="@"||n.startsWith("@")&&(t.some(a=>n.startsWith(`@${a}`))||!!n.match(/^@\d/))}function ZA(t,n){const a=n.match(/^@([^/]+)?\/?(.+)?$/);if(!a)return null;const[,p,m]=a,b=Number.isNaN(+p)?p||0:+p;return t.containerQueries(m).up(b)}function GA(t){const n=(b,x)=>b.replace("@media",x?`@container ${x}`:"@container");function a(b,x){b.up=(...c)=>n(t.breakpoints.up(...c),x),b.down=(...c)=>n(t.breakpoints.down(...c),x),b.between=(...c)=>n(t.breakpoints.between(...c),x),b.only=(...c)=>n(t.breakpoints.only(...c),x),b.not=(...c)=>{const A=n(t.breakpoints.not(...c),x);return A.includes("not all and")?A.replace("not all and ","").replace("min-width:","width<").replace("max-width:","width>").replace("and","or"):A}}const p={},m=b=>(a(p,b),p);return a(m),{...t,containerQueries:m}}const pg={xs:0,sm:600,md:900,lg:1200,xl:1536},uw={keys:["xs","sm","md","lg","xl"],up:t=>`@media (min-width:${pg[t]}px)`},qA={containerQueries:t=>({up:n=>{let a=typeof n=="number"?n:pg[n]||n;return typeof a=="number"&&(a=`${a}px`),t?`@container ${t} (min-width:${a})`:`@container (min-width:${a})`}})};function js(t,n,a){const p=t.theme||{};if(Array.isArray(n)){const b=p.breakpoints||uw;return n.reduce((x,c,A)=>(x[b.up(b.keys[A])]=a(n[A]),x),{})}if(typeof n=="object"){const b=p.breakpoints||uw;return Object.keys(n).reduce((x,c)=>{if(UA(b.keys,c)){const A=ZA(p.containerQueries?p:qA,c);A&&(x[A]=a(n[c],c))}else if(Object.keys(b.values||pg).includes(c)){const A=b.up(c);x[A]=a(n[c],c)}else{const A=c;x[A]=n[A]}return x},{})}return a(n)}function WA(t={}){var a;return((a=t.keys)==null?void 0:a.reduce((p,m)=>{const b=t.up(m);return p[b]={},p},{}))||{}}function HA(t,n){return t.reduce((a,p)=>{const m=a[p];return(!m||Object.keys(m).length===0)&&delete a[p],a},n)}function fg(t,n,a=!0){if(!n||typeof n!="string")return null;if(t&&t.vars&&a){const p=`vars.${n}`.split(".").reduce((m,b)=>m&&m[b]?m[b]:null,t);if(p!=null)return p}return n.split(".").reduce((p,m)=>p&&p[m]!=null?p[m]:null,t)}function zm(t,n,a,p=a){let m;return typeof t=="function"?m=t(a):Array.isArray(t)?m=t[a]||p:m=fg(t,a)||p,n&&(m=n(m,p,t)),m}function Hr(t){const{prop:n,cssProperty:a=t.prop,themeKey:p,transform:m}=t,b=x=>{if(x[n]==null)return null;const c=x[n],A=x.theme,j=fg(A,p)||{};return js(x,c,Q=>{let H=zm(j,m,Q);return Q===H&&typeof Q=="string"&&(H=zm(j,m,`${n}${Q==="default"?"":wn(Q)}`,Q)),a===!1?H:{[a]:H}})};return b.propTypes={},b.filterProps=[n],b}function XA(t){const n={};return a=>(n[a]===void 0&&(n[a]=t(a)),n[a])}const KA={m:"margin",p:"padding"},YA={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},hw={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},QA=XA(t=>{if(t.length>2)if(hw[t])t=hw[t];else return[t];const[n,a]=t.split(""),p=KA[n],m=YA[a]||"";return Array.isArray(m)?m.map(b=>p+b):[p+m]}),Uv=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],Zv=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...Uv,...Zv];function Jd(t,n,a,p){const m=fg(t,n,!0)??a;return typeof m=="number"||typeof m=="string"?b=>typeof b=="string"?b:typeof m=="string"?`calc(${b} * ${m})`:m*b:Array.isArray(m)?b=>{if(typeof b=="string")return b;const x=Math.abs(b),c=m[x];return b>=0?c:typeof c=="number"?-c:`-${c}`}:typeof m=="function"?m:()=>{}}function Gv(t){return Jd(t,"spacing",8)}function ep(t,n){return typeof n=="string"||n==null?n:t(n)}function JA(t,n){return a=>t.reduce((p,m)=>(p[m]=ep(n,a),p),{})}function ez(t,n,a,p){if(!n.includes(a))return null;const m=QA(a),b=JA(m,p),x=t[a];return js(t,x,b)}function IT(t,n){const a=Gv(t.theme);return Object.keys(t).map(p=>ez(t,n,p,a)).reduce(wd,{})}function Br(t){return IT(t,Uv)}Br.propTypes={};Br.filterProps=Uv;function Or(t){return IT(t,Zv)}Or.propTypes={};Or.filterProps=Zv;function mg(...t){const n=t.reduce((p,m)=>(m.filterProps.forEach(b=>{p[b]=m}),p),{}),a=p=>Object.keys(p).reduce((m,b)=>n[b]?wd(m,n[b](p)):m,{});return a.propTypes={},a.filterProps=t.reduce((p,m)=>p.concat(m.filterProps),[]),a}function Ji(t){return typeof t!="number"?t:`${t}px solid`}function oo(t,n){return Hr({prop:t,themeKey:"borders",transform:n})}const tz=oo("border",Ji),rz=oo("borderTop",Ji),nz=oo("borderRight",Ji),iz=oo("borderBottom",Ji),oz=oo("borderLeft",Ji),sz=oo("borderColor"),az=oo("borderTopColor"),lz=oo("borderRightColor"),cz=oo("borderBottomColor"),uz=oo("borderLeftColor"),hz=oo("outline",Ji),dz=oo("outlineColor"),gg=t=>{if(t.borderRadius!==void 0&&t.borderRadius!==null){const n=Jd(t.theme,"shape.borderRadius",4),a=p=>({borderRadius:ep(n,p)});return js(t,t.borderRadius,a)}return null};gg.propTypes={};gg.filterProps=["borderRadius"];mg(tz,rz,nz,iz,oz,sz,az,lz,cz,uz,gg,hz,dz);const _g=t=>{if(t.gap!==void 0&&t.gap!==null){const n=Jd(t.theme,"spacing",8),a=p=>({gap:ep(n,p)});return js(t,t.gap,a)}return null};_g.propTypes={};_g.filterProps=["gap"];const yg=t=>{if(t.columnGap!==void 0&&t.columnGap!==null){const n=Jd(t.theme,"spacing",8),a=p=>({columnGap:ep(n,p)});return js(t,t.columnGap,a)}return null};yg.propTypes={};yg.filterProps=["columnGap"];const vg=t=>{if(t.rowGap!==void 0&&t.rowGap!==null){const n=Jd(t.theme,"spacing",8),a=p=>({rowGap:ep(n,p)});return js(t,t.rowGap,a)}return null};vg.propTypes={};vg.filterProps=["rowGap"];const pz=Hr({prop:"gridColumn"}),fz=Hr({prop:"gridRow"}),mz=Hr({prop:"gridAutoFlow"}),gz=Hr({prop:"gridAutoColumns"}),_z=Hr({prop:"gridAutoRows"}),yz=Hr({prop:"gridTemplateColumns"}),vz=Hr({prop:"gridTemplateRows"}),xz=Hr({prop:"gridTemplateAreas"}),bz=Hr({prop:"gridArea"});mg(_g,yg,vg,pz,fz,mz,gz,_z,yz,vz,xz,bz);function uu(t,n){return n==="grey"?n:t}const wz=Hr({prop:"color",themeKey:"palette",transform:uu}),Sz=Hr({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:uu}),Tz=Hr({prop:"backgroundColor",themeKey:"palette",transform:uu});mg(wz,Sz,Tz);function zi(t){return t<=1&&t!==0?`${t*100}%`:t}const Pz=Hr({prop:"width",transform:zi}),qv=t=>{if(t.maxWidth!==void 0&&t.maxWidth!==null){const n=a=>{var m,b,x,c,A;const p=((x=(b=(m=t.theme)==null?void 0:m.breakpoints)==null?void 0:b.values)==null?void 0:x[a])||pg[a];return p?((A=(c=t.theme)==null?void 0:c.breakpoints)==null?void 0:A.unit)!=="px"?{maxWidth:`${p}${t.theme.breakpoints.unit}`}:{maxWidth:p}:{maxWidth:zi(a)}};return js(t,t.maxWidth,n)}return null};qv.filterProps=["maxWidth"];const Cz=Hr({prop:"minWidth",transform:zi}),Ez=Hr({prop:"height",transform:zi}),Mz=Hr({prop:"maxHeight",transform:zi}),Iz=Hr({prop:"minHeight",transform:zi});Hr({prop:"size",cssProperty:"width",transform:zi});Hr({prop:"size",cssProperty:"height",transform:zi});const kz=Hr({prop:"boxSizing"});mg(Pz,qv,Cz,Ez,Mz,Iz,kz);const xg={border:{themeKey:"borders",transform:Ji},borderTop:{themeKey:"borders",transform:Ji},borderRight:{themeKey:"borders",transform:Ji},borderBottom:{themeKey:"borders",transform:Ji},borderLeft:{themeKey:"borders",transform:Ji},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:Ji},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:gg},color:{themeKey:"palette",transform:uu},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:uu},backgroundColor:{themeKey:"palette",transform:uu},p:{style:Or},pt:{style:Or},pr:{style:Or},pb:{style:Or},pl:{style:Or},px:{style:Or},py:{style:Or},padding:{style:Or},paddingTop:{style:Or},paddingRight:{style:Or},paddingBottom:{style:Or},paddingLeft:{style:Or},paddingX:{style:Or},paddingY:{style:Or},paddingInline:{style:Or},paddingInlineStart:{style:Or},paddingInlineEnd:{style:Or},paddingBlock:{style:Or},paddingBlockStart:{style:Or},paddingBlockEnd:{style:Or},m:{style:Br},mt:{style:Br},mr:{style:Br},mb:{style:Br},ml:{style:Br},mx:{style:Br},my:{style:Br},margin:{style:Br},marginTop:{style:Br},marginRight:{style:Br},marginBottom:{style:Br},marginLeft:{style:Br},marginX:{style:Br},marginY:{style:Br},marginInline:{style:Br},marginInlineStart:{style:Br},marginInlineEnd:{style:Br},marginBlock:{style:Br},marginBlockStart:{style:Br},marginBlockEnd:{style:Br},displayPrint:{cssProperty:!1,transform:t=>({"@media print":{display:t}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:_g},rowGap:{style:vg},columnGap:{style:yg},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:zi},maxWidth:{style:qv},minWidth:{transform:zi},height:{transform:zi},maxHeight:{transform:zi},minHeight:{transform:zi},boxSizing:{},font:{themeKey:"font"},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}};function Az(...t){const n=t.reduce((p,m)=>p.concat(Object.keys(m)),[]),a=new Set(n);return t.every(p=>a.size===Object.keys(p).length)}function zz(t,n){return typeof t=="function"?t(n):t}function Rz(){function t(a,p,m,b){const x={[a]:p,theme:m},c=b[a];if(!c)return{[a]:p};const{cssProperty:A=a,themeKey:j,transform:Y,style:Q}=c;if(p==null)return null;if(j==="typography"&&p==="inherit")return{[a]:p};const H=fg(m,j)||{};return Q?Q(x):js(x,p,le=>{let ve=zm(H,Y,le);return le===ve&&typeof le=="string"&&(ve=zm(H,Y,`${a}${le==="default"?"":wn(le)}`,le)),A===!1?ve:{[A]:ve}})}function n(a){const{sx:p,theme:m={}}=a||{};if(!p)return null;const b=m.unstable_sxConfig??xg;function x(c){let A=c;if(typeof c=="function")A=c(m);else if(typeof c!="object")return c;if(!A)return null;const j=WA(m.breakpoints),Y=Object.keys(j);let Q=j;return Object.keys(A).forEach(H=>{const G=zz(A[H],m);if(G!=null)if(typeof G=="object")if(b[H])Q=wd(Q,t(H,G,m,b));else{const le=js({theme:m},G,ve=>({[H]:ve}));Az(le,G)?Q[H]=n({sx:G,theme:m}):Q=wd(Q,le)}else Q=wd(Q,t(H,G,m,b))}),VA(m,HA(Y,Q))}return Array.isArray(p)?p.map(x):x(p)}return n}const xu=Rz();xu.filterProps=["sx"];function Rm(){return Rm=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var a=arguments[n];for(var p in a)({}).hasOwnProperty.call(a,p)&&(t[p]=a[p])}return t},Rm.apply(null,arguments)}var Lz=!1;function Dz(t){if(t.sheet)return t.sheet;for(var n=0;n<document.styleSheets.length;n++)if(document.styleSheets[n].ownerNode===t)return document.styleSheets[n]}function Fz(t){var n=document.createElement("style");return n.setAttribute("data-emotion",t.key),t.nonce!==void 0&&n.setAttribute("nonce",t.nonce),n.appendChild(document.createTextNode("")),n.setAttribute("data-s",""),n}var Bz=function(){function t(a){var p=this;this._insertTag=function(m){var b;p.tags.length===0?p.insertionPoint?b=p.insertionPoint.nextSibling:p.prepend?b=p.container.firstChild:b=p.before:b=p.tags[p.tags.length-1].nextSibling,p.container.insertBefore(m,b),p.tags.push(m)},this.isSpeedy=a.speedy===void 0?!Lz:a.speedy,this.tags=[],this.ctr=0,this.nonce=a.nonce,this.key=a.key,this.container=a.container,this.prepend=a.prepend,this.insertionPoint=a.insertionPoint,this.before=null}var n=t.prototype;return n.hydrate=function(p){p.forEach(this._insertTag)},n.insert=function(p){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(Fz(this));var m=this.tags[this.tags.length-1];if(this.isSpeedy){var b=Dz(m);try{b.insertRule(p,b.cssRules.length)}catch{}}else m.appendChild(document.createTextNode(p));this.ctr++},n.flush=function(){this.tags.forEach(function(p){var m;return(m=p.parentNode)==null?void 0:m.removeChild(p)}),this.tags=[],this.ctr=0},t}(),Vn="-ms-",Lm="-moz-",Wt="-webkit-",kT="comm",Wv="rule",Hv="decl",Oz="@import",AT="@keyframes",jz="@layer",Nz=Math.abs,bg=String.fromCharCode,$z=Object.assign;function Vz(t,n){return In(t,0)^45?(((n<<2^In(t,0))<<2^In(t,1))<<2^In(t,2))<<2^In(t,3):0}function zT(t){return t.trim()}function Uz(t,n){return(t=n.exec(t))?t[0]:t}function Ht(t,n,a){return t.replace(n,a)}function P0(t,n){return t.indexOf(n)}function In(t,n){return t.charCodeAt(n)|0}function $d(t,n,a){return t.slice(n,a)}function Zo(t){return t.length}function Xv(t){return t.length}function Bf(t,n){return n.push(t),t}function Zz(t,n){return t.map(n).join("")}var wg=1,bu=1,RT=0,vi=0,sn=0,Eu="";function Sg(t,n,a,p,m,b,x){return{value:t,root:n,parent:a,type:p,props:m,children:b,line:wg,column:bu,length:x,return:""}}function id(t,n){return $z(Sg("",null,null,"",null,null,0),t,{length:-t.length},n)}function Gz(){return sn}function qz(){return sn=vi>0?In(Eu,--vi):0,bu--,sn===10&&(bu=1,wg--),sn}function Fi(){return sn=vi<RT?In(Eu,vi++):0,bu++,sn===10&&(bu=1,wg++),sn}function Xo(){return In(Eu,vi)}function em(){return vi}function tp(t,n){return $d(Eu,t,n)}function Vd(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function LT(t){return wg=bu=1,RT=Zo(Eu=t),vi=0,[]}function DT(t){return Eu="",t}function tm(t){return zT(tp(vi-1,C0(t===91?t+2:t===40?t+1:t)))}function Wz(t){for(;(sn=Xo())&&sn<33;)Fi();return Vd(t)>2||Vd(sn)>3?"":" "}function Hz(t,n){for(;--n&&Fi()&&!(sn<48||sn>102||sn>57&&sn<65||sn>70&&sn<97););return tp(t,em()+(n<6&&Xo()==32&&Fi()==32))}function C0(t){for(;Fi();)switch(sn){case t:return vi;case 34:case 39:t!==34&&t!==39&&C0(sn);break;case 40:t===41&&C0(t);break;case 92:Fi();break}return vi}function Xz(t,n){for(;Fi()&&t+sn!==57;)if(t+sn===84&&Xo()===47)break;return"/*"+tp(n,vi-1)+"*"+bg(t===47?t:Fi())}function Kz(t){for(;!Vd(Xo());)Fi();return tp(t,vi)}function Yz(t){return DT(rm("",null,null,null,[""],t=LT(t),0,[0],t))}function rm(t,n,a,p,m,b,x,c,A){for(var j=0,Y=0,Q=x,H=0,G=0,le=0,ve=1,Ae=1,ee=1,re=0,se="",_e=m,De=b,Fe=p,ze=se;Ae;)switch(le=re,re=Fi()){case 40:if(le!=108&&In(ze,Q-1)==58){P0(ze+=Ht(tm(re),"&","&\f"),"&\f")!=-1&&(ee=-1);break}case 34:case 39:case 91:ze+=tm(re);break;case 9:case 10:case 13:case 32:ze+=Wz(le);break;case 92:ze+=Hz(em()-1,7);continue;case 47:switch(Xo()){case 42:case 47:Bf(Qz(Xz(Fi(),em()),n,a),A);break;default:ze+="/"}break;case 123*ve:c[j++]=Zo(ze)*ee;case 125*ve:case 59:case 0:switch(re){case 0:case 125:Ae=0;case 59+Y:ee==-1&&(ze=Ht(ze,/\f/g,"")),G>0&&Zo(ze)-Q&&Bf(G>32?pw(ze+";",p,a,Q-1):pw(Ht(ze," ","")+";",p,a,Q-2),A);break;case 59:ze+=";";default:if(Bf(Fe=dw(ze,n,a,j,Y,m,c,se,_e=[],De=[],Q),b),re===123)if(Y===0)rm(ze,n,Fe,Fe,_e,b,Q,c,De);else switch(H===99&&In(ze,3)===110?100:H){case 100:case 108:case 109:case 115:rm(t,Fe,Fe,p&&Bf(dw(t,Fe,Fe,0,0,m,c,se,m,_e=[],Q),De),m,De,Q,c,p?_e:De);break;default:rm(ze,Fe,Fe,Fe,[""],De,0,c,De)}}j=Y=G=0,ve=ee=1,se=ze="",Q=x;break;case 58:Q=1+Zo(ze),G=le;default:if(ve<1){if(re==123)--ve;else if(re==125&&ve++==0&&qz()==125)continue}switch(ze+=bg(re),re*ve){case 38:ee=Y>0?1:(ze+="\f",-1);break;case 44:c[j++]=(Zo(ze)-1)*ee,ee=1;break;case 64:Xo()===45&&(ze+=tm(Fi())),H=Xo(),Y=Q=Zo(se=ze+=Kz(em())),re++;break;case 45:le===45&&Zo(ze)==2&&(ve=0)}}return b}function dw(t,n,a,p,m,b,x,c,A,j,Y){for(var Q=m-1,H=m===0?b:[""],G=Xv(H),le=0,ve=0,Ae=0;le<p;++le)for(var ee=0,re=$d(t,Q+1,Q=Nz(ve=x[le])),se=t;ee<G;++ee)(se=zT(ve>0?H[ee]+" "+re:Ht(re,/&\f/g,H[ee])))&&(A[Ae++]=se);return Sg(t,n,a,m===0?Wv:c,A,j,Y)}function Qz(t,n,a){return Sg(t,n,a,kT,bg(Gz()),$d(t,2,-2),0)}function pw(t,n,a,p){return Sg(t,n,a,Hv,$d(t,0,p),$d(t,p+1,-1),p)}function hu(t,n){for(var a="",p=Xv(t),m=0;m<p;m++)a+=n(t[m],m,t,n)||"";return a}function Jz(t,n,a,p){switch(t.type){case jz:if(t.children.length)break;case Oz:case Hv:return t.return=t.return||t.value;case kT:return"";case AT:return t.return=t.value+"{"+hu(t.children,p)+"}";case Wv:t.value=t.props.join(",")}return Zo(a=hu(t.children,p))?t.return=t.value+"{"+a+"}":""}function eR(t){var n=Xv(t);return function(a,p,m,b){for(var x="",c=0;c<n;c++)x+=t[c](a,p,m,b)||"";return x}}function tR(t){return function(n){n.root||(n=n.return)&&t(n)}}function FT(t){var n=Object.create(null);return function(a){return n[a]===void 0&&(n[a]=t(a)),n[a]}}var rR=function(n,a,p){for(var m=0,b=0;m=b,b=Xo(),m===38&&b===12&&(a[p]=1),!Vd(b);)Fi();return tp(n,vi)},nR=function(n,a){var p=-1,m=44;do switch(Vd(m)){case 0:m===38&&Xo()===12&&(a[p]=1),n[p]+=rR(vi-1,a,p);break;case 2:n[p]+=tm(m);break;case 4:if(m===44){n[++p]=Xo()===58?"&\f":"",a[p]=n[p].length;break}default:n[p]+=bg(m)}while(m=Fi());return n},iR=function(n,a){return DT(nR(LT(n),a))},fw=new WeakMap,oR=function(n){if(!(n.type!=="rule"||!n.parent||n.length<1)){for(var a=n.value,p=n.parent,m=n.column===p.column&&n.line===p.line;p.type!=="rule";)if(p=p.parent,!p)return;if(!(n.props.length===1&&a.charCodeAt(0)!==58&&!fw.get(p))&&!m){fw.set(n,!0);for(var b=[],x=iR(a,b),c=p.props,A=0,j=0;A<x.length;A++)for(var Y=0;Y<c.length;Y++,j++)n.props[j]=b[A]?x[A].replace(/&\f/g,c[Y]):c[Y]+" "+x[A]}}},sR=function(n){if(n.type==="decl"){var a=n.value;a.charCodeAt(0)===108&&a.charCodeAt(2)===98&&(n.return="",n.value="")}};function BT(t,n){switch(Vz(t,n)){case 5103:return Wt+"print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Wt+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return Wt+t+Lm+t+Vn+t+t;case 6828:case 4268:return Wt+t+Vn+t+t;case 6165:return Wt+t+Vn+"flex-"+t+t;case 5187:return Wt+t+Ht(t,/(\w+).+(:[^]+)/,Wt+"box-$1$2"+Vn+"flex-$1$2")+t;case 5443:return Wt+t+Vn+"flex-item-"+Ht(t,/flex-|-self/,"")+t;case 4675:return Wt+t+Vn+"flex-line-pack"+Ht(t,/align-content|flex-|-self/,"")+t;case 5548:return Wt+t+Vn+Ht(t,"shrink","negative")+t;case 5292:return Wt+t+Vn+Ht(t,"basis","preferred-size")+t;case 6060:return Wt+"box-"+Ht(t,"-grow","")+Wt+t+Vn+Ht(t,"grow","positive")+t;case 4554:return Wt+Ht(t,/([^-])(transform)/g,"$1"+Wt+"$2")+t;case 6187:return Ht(Ht(Ht(t,/(zoom-|grab)/,Wt+"$1"),/(image-set)/,Wt+"$1"),t,"")+t;case 5495:case 3959:return Ht(t,/(image-set\([^]*)/,Wt+"$1$`$1");case 4968:return Ht(Ht(t,/(.+:)(flex-)?(.*)/,Wt+"box-pack:$3"+Vn+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Wt+t+t;case 4095:case 3583:case 4068:case 2532:return Ht(t,/(.+)-inline(.+)/,Wt+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Zo(t)-1-n>6)switch(In(t,n+1)){case 109:if(In(t,n+4)!==45)break;case 102:return Ht(t,/(.+:)(.+)-([^]+)/,"$1"+Wt+"$2-$3$1"+Lm+(In(t,n+3)==108?"$3":"$2-$3"))+t;case 115:return~P0(t,"stretch")?BT(Ht(t,"stretch","fill-available"),n)+t:t}break;case 4949:if(In(t,n+1)!==115)break;case 6444:switch(In(t,Zo(t)-3-(~P0(t,"!important")&&10))){case 107:return Ht(t,":",":"+Wt)+t;case 101:return Ht(t,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Wt+(In(t,14)===45?"inline-":"")+"box$3$1"+Wt+"$2$3$1"+Vn+"$2box$3")+t}break;case 5936:switch(In(t,n+11)){case 114:return Wt+t+Vn+Ht(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return Wt+t+Vn+Ht(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return Wt+t+Vn+Ht(t,/[svh]\w+-[tblr]{2}/,"lr")+t}return Wt+t+Vn+t+t}return t}var aR=function(n,a,p,m){if(n.length>-1&&!n.return)switch(n.type){case Hv:n.return=BT(n.value,n.length);break;case AT:return hu([id(n,{value:Ht(n.value,"@","@"+Wt)})],m);case Wv:if(n.length)return Zz(n.props,function(b){switch(Uz(b,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return hu([id(n,{props:[Ht(b,/:(read-\w+)/,":"+Lm+"$1")]})],m);case"::placeholder":return hu([id(n,{props:[Ht(b,/:(plac\w+)/,":"+Wt+"input-$1")]}),id(n,{props:[Ht(b,/:(plac\w+)/,":"+Lm+"$1")]}),id(n,{props:[Ht(b,/:(plac\w+)/,Vn+"input-$1")]})],m)}return""})}},lR=[aR],cR=function(n){var a=n.key;if(a==="css"){var p=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(p,function(ve){var Ae=ve.getAttribute("data-emotion");Ae.indexOf(" ")!==-1&&(document.head.appendChild(ve),ve.setAttribute("data-s",""))})}var m=n.stylisPlugins||lR,b={},x,c=[];x=n.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+a+' "]'),function(ve){for(var Ae=ve.getAttribute("data-emotion").split(" "),ee=1;ee<Ae.length;ee++)b[Ae[ee]]=!0;c.push(ve)});var A,j=[oR,sR];{var Y,Q=[Jz,tR(function(ve){Y.insert(ve)})],H=eR(j.concat(m,Q)),G=function(Ae){return hu(Yz(Ae),H)};A=function(Ae,ee,re,se){Y=re,G(Ae?Ae+"{"+ee.styles+"}":ee.styles),se&&(le.inserted[ee.name]=!0)}}var le={key:a,sheet:new Bz({key:a,container:x,nonce:n.nonce,speedy:n.speedy,prepend:n.prepend,insertionPoint:n.insertionPoint}),nonce:n.nonce,inserted:b,registered:{},insert:A};return le.sheet.hydrate(c),le},OT={exports:{}},er={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Tn=typeof Symbol=="function"&&Symbol.for,Kv=Tn?Symbol.for("react.element"):60103,Yv=Tn?Symbol.for("react.portal"):60106,Tg=Tn?Symbol.for("react.fragment"):60107,Pg=Tn?Symbol.for("react.strict_mode"):60108,Cg=Tn?Symbol.for("react.profiler"):60114,Eg=Tn?Symbol.for("react.provider"):60109,Mg=Tn?Symbol.for("react.context"):60110,Qv=Tn?Symbol.for("react.async_mode"):60111,Ig=Tn?Symbol.for("react.concurrent_mode"):60111,kg=Tn?Symbol.for("react.forward_ref"):60112,Ag=Tn?Symbol.for("react.suspense"):60113,uR=Tn?Symbol.for("react.suspense_list"):60120,zg=Tn?Symbol.for("react.memo"):60115,Rg=Tn?Symbol.for("react.lazy"):60116,hR=Tn?Symbol.for("react.block"):60121,dR=Tn?Symbol.for("react.fundamental"):60117,pR=Tn?Symbol.for("react.responder"):60118,fR=Tn?Symbol.for("react.scope"):60119;function $i(t){if(typeof t=="object"&&t!==null){var n=t.$$typeof;switch(n){case Kv:switch(t=t.type,t){case Qv:case Ig:case Tg:case Cg:case Pg:case Ag:return t;default:switch(t=t&&t.$$typeof,t){case Mg:case kg:case Rg:case zg:case Eg:return t;default:return n}}case Yv:return n}}}function jT(t){return $i(t)===Ig}er.AsyncMode=Qv;er.ConcurrentMode=Ig;er.ContextConsumer=Mg;er.ContextProvider=Eg;er.Element=Kv;er.ForwardRef=kg;er.Fragment=Tg;er.Lazy=Rg;er.Memo=zg;er.Portal=Yv;er.Profiler=Cg;er.StrictMode=Pg;er.Suspense=Ag;er.isAsyncMode=function(t){return jT(t)||$i(t)===Qv};er.isConcurrentMode=jT;er.isContextConsumer=function(t){return $i(t)===Mg};er.isContextProvider=function(t){return $i(t)===Eg};er.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===Kv};er.isForwardRef=function(t){return $i(t)===kg};er.isFragment=function(t){return $i(t)===Tg};er.isLazy=function(t){return $i(t)===Rg};er.isMemo=function(t){return $i(t)===zg};er.isPortal=function(t){return $i(t)===Yv};er.isProfiler=function(t){return $i(t)===Cg};er.isStrictMode=function(t){return $i(t)===Pg};er.isSuspense=function(t){return $i(t)===Ag};er.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===Tg||t===Ig||t===Cg||t===Pg||t===Ag||t===uR||typeof t=="object"&&t!==null&&(t.$$typeof===Rg||t.$$typeof===zg||t.$$typeof===Eg||t.$$typeof===Mg||t.$$typeof===kg||t.$$typeof===dR||t.$$typeof===pR||t.$$typeof===fR||t.$$typeof===hR)};er.typeOf=$i;OT.exports=er;var mR=OT.exports,NT=mR,gR={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},_R={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},$T={};$T[NT.ForwardRef]=gR;$T[NT.Memo]=_R;var yR=!0;function VT(t,n,a){var p="";return a.split(" ").forEach(function(m){t[m]!==void 0?n.push(t[m]+";"):m&&(p+=m+" ")}),p}var Jv=function(n,a,p){var m=n.key+"-"+a.name;(p===!1||yR===!1)&&n.registered[m]===void 0&&(n.registered[m]=a.styles)},UT=function(n,a,p){Jv(n,a,p);var m=n.key+"-"+a.name;if(n.inserted[a.name]===void 0){var b=a;do n.insert(a===b?"."+m:"",b,n.sheet,!0),b=b.next;while(b!==void 0)}};function vR(t){for(var n=0,a,p=0,m=t.length;m>=4;++p,m-=4)a=t.charCodeAt(p)&255|(t.charCodeAt(++p)&255)<<8|(t.charCodeAt(++p)&255)<<16|(t.charCodeAt(++p)&255)<<24,a=(a&65535)*1540483477+((a>>>16)*59797<<16),a^=a>>>24,n=(a&65535)*1540483477+((a>>>16)*59797<<16)^(n&65535)*1540483477+((n>>>16)*59797<<16);switch(m){case 3:n^=(t.charCodeAt(p+2)&255)<<16;case 2:n^=(t.charCodeAt(p+1)&255)<<8;case 1:n^=t.charCodeAt(p)&255,n=(n&65535)*1540483477+((n>>>16)*59797<<16)}return n^=n>>>13,n=(n&65535)*1540483477+((n>>>16)*59797<<16),((n^n>>>15)>>>0).toString(36)}var xR={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},bR=!1,wR=/[A-Z]|^ms/g,SR=/_EMO_([^_]+?)_([^]*?)_EMO_/g,ZT=function(n){return n.charCodeAt(1)===45},mw=function(n){return n!=null&&typeof n!="boolean"},Sy=FT(function(t){return ZT(t)?t:t.replace(wR,"-$&").toLowerCase()}),gw=function(n,a){switch(n){case"animation":case"animationName":if(typeof a=="string")return a.replace(SR,function(p,m,b){return Go={name:m,styles:b,next:Go},m})}return xR[n]!==1&&!ZT(n)&&typeof a=="number"&&a!==0?a+"px":a},TR="Component selectors can only be used in conjunction with @emotion/babel-plugin, the swc Emotion plugin, or another Emotion-aware compiler transform.";function Ud(t,n,a){if(a==null)return"";var p=a;if(p.__emotion_styles!==void 0)return p;switch(typeof a){case"boolean":return"";case"object":{var m=a;if(m.anim===1)return Go={name:m.name,styles:m.styles,next:Go},m.name;var b=a;if(b.styles!==void 0){var x=b.next;if(x!==void 0)for(;x!==void 0;)Go={name:x.name,styles:x.styles,next:Go},x=x.next;var c=b.styles+";";return c}return PR(t,n,a)}case"function":{if(t!==void 0){var A=Go,j=a(t);return Go=A,Ud(t,n,j)}break}}var Y=a;if(n==null)return Y;var Q=n[Y];return Q!==void 0?Q:Y}function PR(t,n,a){var p="";if(Array.isArray(a))for(var m=0;m<a.length;m++)p+=Ud(t,n,a[m])+";";else for(var b in a){var x=a[b];if(typeof x!="object"){var c=x;n!=null&&n[c]!==void 0?p+=b+"{"+n[c]+"}":mw(c)&&(p+=Sy(b)+":"+gw(b,c)+";")}else{if(b==="NO_COMPONENT_SELECTOR"&&bR)throw new Error(TR);if(Array.isArray(x)&&typeof x[0]=="string"&&(n==null||n[x[0]]===void 0))for(var A=0;A<x.length;A++)mw(x[A])&&(p+=Sy(b)+":"+gw(b,x[A])+";");else{var j=Ud(t,n,x);switch(b){case"animation":case"animationName":{p+=Sy(b)+":"+j+";";break}default:p+=b+"{"+j+"}"}}}}return p}var _w=/label:\s*([^\s;{]+)\s*(;|$)/g,Go;function Lg(t,n,a){if(t.length===1&&typeof t[0]=="object"&&t[0]!==null&&t[0].styles!==void 0)return t[0];var p=!0,m="";Go=void 0;var b=t[0];if(b==null||b.raw===void 0)p=!1,m+=Ud(a,n,b);else{var x=b;m+=x[0]}for(var c=1;c<t.length;c++)if(m+=Ud(a,n,t[c]),p){var A=b;m+=A[c]}_w.lastIndex=0;for(var j="",Y;(Y=_w.exec(m))!==null;)j+="-"+Y[1];var Q=vR(m)+j;return{name:Q,styles:m,next:Go}}var CR=function(n){return n()},ER=Ey.useInsertionEffect?Ey.useInsertionEffect:!1,GT=ER||CR,MR=!1,qT=we.createContext(typeof HTMLElement<"u"?cR({key:"css"}):null);qT.Provider;var WT=function(n){return we.forwardRef(function(a,p){var m=we.useContext(qT);return n(a,m,p)})},HT=we.createContext({}),ex={}.hasOwnProperty,E0="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",IR=function(n,a){var p={};for(var m in a)ex.call(a,m)&&(p[m]=a[m]);return p[E0]=n,p},kR=function(n){var a=n.cache,p=n.serialized,m=n.isStringTag;return Jv(a,p,m),GT(function(){return UT(a,p,m)}),null},AR=WT(function(t,n,a){var p=t.css;typeof p=="string"&&n.registered[p]!==void 0&&(p=n.registered[p]);var m=t[E0],b=[p],x="";typeof t.className=="string"?x=VT(n.registered,b,t.className):t.className!=null&&(x=t.className+" ");var c=Lg(b,void 0,we.useContext(HT));x+=n.key+"-"+c.name;var A={};for(var j in t)ex.call(t,j)&&j!=="css"&&j!==E0&&!MR&&(A[j]=t[j]);return A.className=x,a&&(A.ref=a),we.createElement(we.Fragment,null,we.createElement(kR,{cache:n,serialized:c,isStringTag:typeof m=="string"}),we.createElement(m,A))}),zR=AR,yw=function(n,a){var p=arguments;if(a==null||!ex.call(a,"css"))return we.createElement.apply(void 0,p);var m=p.length,b=new Array(m);b[0]=zR,b[1]=IR(n,a);for(var x=2;x<m;x++)b[x]=p[x];return we.createElement.apply(null,b)};(function(t){var n;n||(n=t.JSX||(t.JSX={}))})(yw||(yw={}));function tx(){for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return Lg(n)}function rp(){var t=tx.apply(void 0,arguments),n="animation-"+t.name;return{name:n,styles:"@keyframes "+n+"{"+t.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}var RR=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,LR=FT(function(t){return RR.test(t)||t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)<91}),DR=!1,FR=LR,BR=function(n){return n!=="theme"},vw=function(n){return typeof n=="string"&&n.charCodeAt(0)>96?FR:BR},xw=function(n,a,p){var m;if(a){var b=a.shouldForwardProp;m=n.__emotion_forwardProp&&b?function(x){return n.__emotion_forwardProp(x)&&b(x)}:b}return typeof m!="function"&&p&&(m=n.__emotion_forwardProp),m},OR=function(n){var a=n.cache,p=n.serialized,m=n.isStringTag;return Jv(a,p,m),GT(function(){return UT(a,p,m)}),null},jR=function t(n,a){var p=n.__emotion_real===n,m=p&&n.__emotion_base||n,b,x;a!==void 0&&(b=a.label,x=a.target);var c=xw(n,a,p),A=c||vw(m),j=!A("as");return function(){var Y=arguments,Q=p&&n.__emotion_styles!==void 0?n.__emotion_styles.slice(0):[];if(b!==void 0&&Q.push("label:"+b+";"),Y[0]==null||Y[0].raw===void 0)Q.push.apply(Q,Y);else{var H=Y[0];Q.push(H[0]);for(var G=Y.length,le=1;le<G;le++)Q.push(Y[le],H[le])}var ve=WT(function(Ae,ee,re){var se=j&&Ae.as||m,_e="",De=[],Fe=Ae;if(Ae.theme==null){Fe={};for(var ze in Ae)Fe[ze]=Ae[ze];Fe.theme=we.useContext(HT)}typeof Ae.className=="string"?_e=VT(ee.registered,De,Ae.className):Ae.className!=null&&(_e=Ae.className+" ");var We=Lg(Q.concat(De),ee.registered,Fe);_e+=ee.key+"-"+We.name,x!==void 0&&(_e+=" "+x);var gt=j&&c===void 0?vw(se):A,X={};for(var Ye in Ae)j&&Ye==="as"||gt(Ye)&&(X[Ye]=Ae[Ye]);return X.className=_e,re&&(X.ref=re),we.createElement(we.Fragment,null,we.createElement(OR,{cache:ee,serialized:We,isStringTag:typeof se=="string"}),we.createElement(se,X))});return ve.displayName=b!==void 0?b:"Styled("+(typeof m=="string"?m:m.displayName||m.name||"Component")+")",ve.defaultProps=n.defaultProps,ve.__emotion_real=ve,ve.__emotion_base=m,ve.__emotion_styles=Q,ve.__emotion_forwardProp=c,Object.defineProperty(ve,"toString",{value:function(){return x===void 0&&DR?"NO_COMPONENT_SELECTOR":"."+x}}),ve.withComponent=function(Ae,ee){var re=t(Ae,Rm({},a,ee,{shouldForwardProp:xw(ve,ee,!0)}));return re.apply(void 0,Q)},ve}},NR=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],M0=jR.bind(null);NR.forEach(function(t){M0[t]=M0(t)});/**
 * @mui/styled-engine v6.4.8
 *
 * @license MIT
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */function $R(t,n){return M0(t,n)}function VR(t,n){Array.isArray(t.__emotion_styles)&&(t.__emotion_styles=n(t.__emotion_styles))}const bw=[];function ww(t){return bw[0]=t,Lg(bw)}const UR=t=>{const n=Object.keys(t).map(a=>({key:a,val:t[a]}))||[];return n.sort((a,p)=>a.val-p.val),n.reduce((a,p)=>({...a,[p.key]:p.val}),{})};function ZR(t){const{values:n={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:a="px",step:p=5,...m}=t,b=UR(n),x=Object.keys(b);function c(H){return`@media (min-width:${typeof n[H]=="number"?n[H]:H}${a})`}function A(H){return`@media (max-width:${(typeof n[H]=="number"?n[H]:H)-p/100}${a})`}function j(H,G){const le=x.indexOf(G);return`@media (min-width:${typeof n[H]=="number"?n[H]:H}${a}) and (max-width:${(le!==-1&&typeof n[x[le]]=="number"?n[x[le]]:G)-p/100}${a})`}function Y(H){return x.indexOf(H)+1<x.length?j(H,x[x.indexOf(H)+1]):c(H)}function Q(H){const G=x.indexOf(H);return G===0?c(x[1]):G===x.length-1?A(x[G]):j(H,x[x.indexOf(H)+1]).replace("@media","@media not all and")}return{keys:x,values:b,up:c,down:A,between:j,only:Y,not:Q,unit:a,...m}}const GR={borderRadius:4};function XT(t=8,n=Gv({spacing:t})){if(t.mui)return t;const a=(...p)=>(p.length===0?[1]:p).map(b=>{const x=n(b);return typeof x=="number"?`${x}px`:x}).join(" ");return a.mui=!0,a}function qR(t,n){var p;const a=this;if(a.vars){if(!((p=a.colorSchemes)!=null&&p[t])||typeof a.getColorSchemeSelector!="function")return{};let m=a.getColorSchemeSelector(t);return m==="&"?n:((m.includes("data-")||m.includes("."))&&(m=`*:where(${m.replace(/\s*&$/,"")}) &`),{[m]:n})}return a.palette.mode===t?n:{}}function KT(t={},...n){const{breakpoints:a={},palette:p={},spacing:m,shape:b={},...x}=t,c=ZR(a),A=XT(m);let j=Di({breakpoints:c,direction:"ltr",components:{},palette:{mode:"light",...p},spacing:A,shape:{...GR,...b}},x);return j=GA(j),j.applyStyles=qR,j=n.reduce((Y,Q)=>Di(Y,Q),j),j.unstable_sxConfig={...xg,...x==null?void 0:x.unstable_sxConfig},j.unstable_sx=function(Q){return xu({sx:Q,theme:this})},j}function YT(t){const{variants:n,...a}=t,p={variants:n,style:ww(a),isProcessed:!0};return p.style===a||n&&n.forEach(m=>{typeof m.style!="function"&&(m.style=ww(m.style))}),p}const WR=KT();function Ty(t){return t!=="ownerState"&&t!=="theme"&&t!=="sx"&&t!=="as"}function HR(t){return t?(n,a)=>a[t]:null}function XR(t,n,a){t.theme=QR(t.theme)?a:t.theme[n]||t.theme}function nm(t,n){const a=typeof n=="function"?n(t):n;if(Array.isArray(a))return a.flatMap(p=>nm(t,p));if(Array.isArray(a==null?void 0:a.variants)){let p;if(a.isProcessed)p=a.style;else{const{variants:m,...b}=a;p=b}return QT(t,a.variants,[p])}return a!=null&&a.isProcessed?a.style:a}function QT(t,n,a=[]){var m;let p;e:for(let b=0;b<n.length;b+=1){const x=n[b];if(typeof x.props=="function"){if(p??(p={...t,...t.ownerState,ownerState:t.ownerState}),!x.props(p))continue}else for(const c in x.props)if(t[c]!==x.props[c]&&((m=t.ownerState)==null?void 0:m[c])!==x.props[c])continue e;typeof x.style=="function"?(p??(p={...t,...t.ownerState,ownerState:t.ownerState}),a.push(x.style(p))):a.push(x.style)}return a}function KR(t={}){const{themeId:n,defaultTheme:a=WR,rootShouldForwardProp:p=Ty,slotShouldForwardProp:m=Ty}=t;function b(c){XR(c,n,a)}return(c,A={})=>{VR(c,De=>De.filter(Fe=>Fe!==xu));const{name:j,slot:Y,skipVariantsResolver:Q,skipSx:H,overridesResolver:G=HR(eL(Y)),...le}=A,ve=Q!==void 0?Q:Y&&Y!=="Root"&&Y!=="root"||!1,Ae=H||!1;let ee=Ty;Y==="Root"||Y==="root"?ee=p:Y?ee=m:JR(c)&&(ee=void 0);const re=$R(c,{shouldForwardProp:ee,label:YR(),...le}),se=De=>{if(typeof De=="function"&&De.__emotion_real!==De)return function(ze){return nm(ze,De)};if(Is(De)){const Fe=YT(De);return Fe.variants?function(We){return nm(We,Fe)}:Fe.style}return De},_e=(...De)=>{const Fe=[],ze=De.map(se),We=[];if(Fe.push(b),j&&G&&We.push(function(at){var St,br;const Ct=(br=(St=at.theme.components)==null?void 0:St[j])==null?void 0:br.styleOverrides;if(!Ct)return null;const tr={};for(const rt in Ct)tr[rt]=nm(at,Ct[rt]);return G(at,tr)}),j&&!ve&&We.push(function(at){var tr,St;const ht=at.theme,Ct=(St=(tr=ht==null?void 0:ht.components)==null?void 0:tr[j])==null?void 0:St.variants;return Ct?QT(at,Ct):null}),Ae||We.push(xu),Array.isArray(ze[0])){const Ye=ze.shift(),at=new Array(Fe.length).fill(""),ht=new Array(We.length).fill("");let Ct;Ct=[...at,...Ye,...ht],Ct.raw=[...at,...Ye.raw,...ht],Fe.unshift(Ct)}const gt=[...Fe,...ze,...We],X=re(...gt);return c.muiName&&(X.muiName=c.muiName),X};return re.withConfig&&(_e.withConfig=re.withConfig),_e}}function YR(t,n){return void 0}function QR(t){for(const n in t)return!1;return!0}function JR(t){return typeof t=="string"&&t.charCodeAt(0)>96}function eL(t){return t&&t.charAt(0).toLowerCase()+t.slice(1)}const tL=we.createContext(void 0);function rL(t){const{theme:n,name:a,props:p}=t;if(!n||!n.components||!n.components[a])return p;const m=n.components[a];return m.defaultProps?Am(m.defaultProps,p):!m.styleOverrides&&!m.variants?Am(m,p):p}function nL({props:t,name:n}){const a=we.useContext(tL);return rL({props:t,name:n,theme:{components:a}})}const Sw={theme:void 0};function iL(t){let n,a;return function(m){let b=n;return(b===void 0||m.theme!==a)&&(Sw.theme=m.theme,b=YT(t(Sw)),n=b,a=m.theme),b}}function oL(t=""){function n(...p){if(!p.length)return"";const m=p[0];return typeof m=="string"&&!m.match(/(#|\(|\)|(-?(\d*\.)?\d+)(px|em|%|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc))|^(-?(\d*\.)?\d+)$|(\d+ \d+ \d+)/)?`, var(--${t?`${t}-`:""}${m}${n(...p.slice(1))})`:`, ${m}`}return(p,...m)=>`var(--${t?`${t}-`:""}${p}${n(...m)})`}const Tw=(t,n,a,p=[])=>{let m=t;n.forEach((b,x)=>{x===n.length-1?Array.isArray(m)?m[Number(b)]=a:m&&typeof m=="object"&&(m[b]=a):m&&typeof m=="object"&&(m[b]||(m[b]=p.includes(b)?[]:{}),m=m[b])})},sL=(t,n,a)=>{function p(m,b=[],x=[]){Object.entries(m).forEach(([c,A])=>{(!a||a&&!a([...b,c]))&&A!=null&&(typeof A=="object"&&Object.keys(A).length>0?p(A,[...b,c],Array.isArray(A)?[...x,c]:x):n([...b,c],A,x))})}p(t)},aL=(t,n)=>typeof n=="number"?["lineHeight","fontWeight","opacity","zIndex"].some(p=>t.includes(p))||t[t.length-1].toLowerCase().includes("opacity")?n:`${n}px`:n;function Py(t,n){const{prefix:a,shouldSkipGeneratingVar:p}=n||{},m={},b={},x={};return sL(t,(c,A,j)=>{if((typeof A=="string"||typeof A=="number")&&(!p||!p(c,A))){const Y=`--${a?`${a}-`:""}${c.join("-")}`,Q=aL(c,A);Object.assign(m,{[Y]:Q}),Tw(b,c,`var(${Y})`,j),Tw(x,c,`var(${Y}, ${Q})`,j)}},c=>c[0]==="vars"),{css:m,vars:b,varsWithDefaults:x}}function lL(t,n={}){const{getSelector:a=Ae,disableCssColorScheme:p,colorSchemeSelector:m}=n,{colorSchemes:b={},components:x,defaultColorScheme:c="light",...A}=t,{vars:j,css:Y,varsWithDefaults:Q}=Py(A,n);let H=Q;const G={},{[c]:le,...ve}=b;if(Object.entries(ve||{}).forEach(([se,_e])=>{const{vars:De,css:Fe,varsWithDefaults:ze}=Py(_e,n);H=Di(H,ze),G[se]={css:Fe,vars:De}}),le){const{css:se,vars:_e,varsWithDefaults:De}=Py(le,n);H=Di(H,De),G[c]={css:se,vars:_e}}function Ae(se,_e){var Fe,ze;let De=m;if(m==="class"&&(De=".%s"),m==="data"&&(De="[data-%s]"),m!=null&&m.startsWith("data-")&&!m.includes("%s")&&(De=`[${m}="%s"]`),se){if(De==="media")return t.defaultColorScheme===se?":root":{[`@media (prefers-color-scheme: ${((ze=(Fe=b[se])==null?void 0:Fe.palette)==null?void 0:ze.mode)||se})`]:{":root":_e}};if(De)return t.defaultColorScheme===se?`:root, ${De.replace("%s",String(se))}`:De.replace("%s",String(se))}return":root"}return{vars:H,generateThemeVars:()=>{let se={...j};return Object.entries(G).forEach(([,{vars:_e}])=>{se=Di(se,_e)}),se},generateStyleSheets:()=>{var We,gt;const se=[],_e=t.defaultColorScheme||"light";function De(X,Ye){Object.keys(Ye).length&&se.push(typeof X=="string"?{[X]:{...Ye}}:X)}De(a(void 0,{...Y}),Y);const{[_e]:Fe,...ze}=G;if(Fe){const{css:X}=Fe,Ye=(gt=(We=b[_e])==null?void 0:We.palette)==null?void 0:gt.mode,at=!p&&Ye?{colorScheme:Ye,...X}:{...X};De(a(_e,{...at}),at)}return Object.entries(ze).forEach(([X,{css:Ye}])=>{var Ct,tr;const at=(tr=(Ct=b[X])==null?void 0:Ct.palette)==null?void 0:tr.mode,ht=!p&&at?{colorScheme:at,...Ye}:{...Ye};De(a(X,{...ht}),ht)}),se}}}function cL(t){return function(a){return t==="media"?`@media (prefers-color-scheme: ${a})`:t?t.startsWith("data-")&&!t.includes("%s")?`[${t}="${a}"] &`:t==="class"?`.${a} &`:t==="data"?`[data-${a}] &`:`${t.replace("%s",a)} &`:"&"}}const Zd={black:"#000",white:"#fff"},uL={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},Oc={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},jc={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},od={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},Nc={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},$c={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},Vc={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"};function JT(){return{text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:Zd.white,default:Zd.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}}}const hL=JT();function eP(){return{text:{primary:Zd.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:Zd.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}}}const Pw=eP();function Cw(t,n,a,p){const m=p.light||p,b=p.dark||p*1.5;t[n]||(t.hasOwnProperty(a)?t[n]=t[a]:n==="light"?t.light=jv(t.main,m):n==="dark"&&(t.dark=Ov(t.main,b)))}function dL(t="light"){return t==="dark"?{main:Nc[200],light:Nc[50],dark:Nc[400]}:{main:Nc[700],light:Nc[400],dark:Nc[800]}}function pL(t="light"){return t==="dark"?{main:Oc[200],light:Oc[50],dark:Oc[400]}:{main:Oc[500],light:Oc[300],dark:Oc[700]}}function fL(t="light"){return t==="dark"?{main:jc[500],light:jc[300],dark:jc[700]}:{main:jc[700],light:jc[400],dark:jc[800]}}function mL(t="light"){return t==="dark"?{main:$c[400],light:$c[300],dark:$c[700]}:{main:$c[700],light:$c[500],dark:$c[900]}}function gL(t="light"){return t==="dark"?{main:Vc[400],light:Vc[300],dark:Vc[700]}:{main:Vc[800],light:Vc[500],dark:Vc[900]}}function _L(t="light"){return t==="dark"?{main:od[400],light:od[300],dark:od[700]}:{main:"#ed6c02",light:od[500],dark:od[900]}}function rx(t){const{mode:n="light",contrastThreshold:a=3,tonalOffset:p=.2,...m}=t,b=t.primary||dL(n),x=t.secondary||pL(n),c=t.error||fL(n),A=t.info||mL(n),j=t.success||gL(n),Y=t.warning||_L(n);function Q(ve){return EA(ve,Pw.text.primary)>=a?Pw.text.primary:hL.text.primary}const H=({color:ve,name:Ae,mainShade:ee=500,lightShade:re=300,darkShade:se=700})=>{if(ve={...ve},!ve.main&&ve[ee]&&(ve.main=ve[ee]),!ve.hasOwnProperty("main"))throw new Error(Cl(11,Ae?` (${Ae})`:"",ee));if(typeof ve.main!="string")throw new Error(Cl(12,Ae?` (${Ae})`:"",JSON.stringify(ve.main)));return Cw(ve,"light",re,p),Cw(ve,"dark",se,p),ve.contrastText||(ve.contrastText=Q(ve.main)),ve};let G;return n==="light"?G=JT():n==="dark"&&(G=eP()),Di({common:{...Zd},mode:n,primary:H({color:b,name:"primary"}),secondary:H({color:x,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:H({color:c,name:"error"}),warning:H({color:Y,name:"warning"}),info:H({color:A,name:"info"}),success:H({color:j,name:"success"}),grey:uL,contrastThreshold:a,getContrastText:Q,augmentColor:H,tonalOffset:p,...G},m)}function yL(t){const n={};return Object.entries(t).forEach(p=>{const[m,b]=p;typeof b=="object"&&(n[m]=`${b.fontStyle?`${b.fontStyle} `:""}${b.fontVariant?`${b.fontVariant} `:""}${b.fontWeight?`${b.fontWeight} `:""}${b.fontStretch?`${b.fontStretch} `:""}${b.fontSize||""}${b.lineHeight?`/${b.lineHeight} `:""}${b.fontFamily||""}`)}),n}function vL(t,n){return{toolbar:{minHeight:56,[t.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[t.up("sm")]:{minHeight:64}},...n}}function xL(t){return Math.round(t*1e5)/1e5}const Ew={textTransform:"uppercase"},Mw='"Roboto", "Helvetica", "Arial", sans-serif';function bL(t,n){const{fontFamily:a=Mw,fontSize:p=14,fontWeightLight:m=300,fontWeightRegular:b=400,fontWeightMedium:x=500,fontWeightBold:c=700,htmlFontSize:A=16,allVariants:j,pxToRem:Y,...Q}=typeof n=="function"?n(t):n,H=p/14,G=Y||(Ae=>`${Ae/A*H}rem`),le=(Ae,ee,re,se,_e)=>({fontFamily:a,fontWeight:Ae,fontSize:G(ee),lineHeight:re,...a===Mw?{letterSpacing:`${xL(se/ee)}em`}:{},..._e,...j}),ve={h1:le(m,96,1.167,-1.5),h2:le(m,60,1.2,-.5),h3:le(b,48,1.167,0),h4:le(b,34,1.235,.25),h5:le(b,24,1.334,0),h6:le(x,20,1.6,.15),subtitle1:le(b,16,1.75,.15),subtitle2:le(x,14,1.57,.1),body1:le(b,16,1.5,.15),body2:le(b,14,1.43,.15),button:le(x,14,1.75,.4,Ew),caption:le(b,12,1.66,.4),overline:le(b,12,2.66,1,Ew),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return Di({htmlFontSize:A,pxToRem:G,fontFamily:a,fontSize:p,fontWeightLight:m,fontWeightRegular:b,fontWeightMedium:x,fontWeightBold:c,...ve},Q,{clone:!1})}const wL=.2,SL=.14,TL=.12;function Tr(...t){return[`${t[0]}px ${t[1]}px ${t[2]}px ${t[3]}px rgba(0,0,0,${wL})`,`${t[4]}px ${t[5]}px ${t[6]}px ${t[7]}px rgba(0,0,0,${SL})`,`${t[8]}px ${t[9]}px ${t[10]}px ${t[11]}px rgba(0,0,0,${TL})`].join(",")}const PL=["none",Tr(0,2,1,-1,0,1,1,0,0,1,3,0),Tr(0,3,1,-2,0,2,2,0,0,1,5,0),Tr(0,3,3,-2,0,3,4,0,0,1,8,0),Tr(0,2,4,-1,0,4,5,0,0,1,10,0),Tr(0,3,5,-1,0,5,8,0,0,1,14,0),Tr(0,3,5,-1,0,6,10,0,0,1,18,0),Tr(0,4,5,-2,0,7,10,1,0,2,16,1),Tr(0,5,5,-3,0,8,10,1,0,3,14,2),Tr(0,5,6,-3,0,9,12,1,0,3,16,2),Tr(0,6,6,-3,0,10,14,1,0,4,18,3),Tr(0,6,7,-4,0,11,15,1,0,4,20,3),Tr(0,7,8,-4,0,12,17,2,0,5,22,4),Tr(0,7,8,-4,0,13,19,2,0,5,24,4),Tr(0,7,9,-4,0,14,21,2,0,5,26,4),Tr(0,8,9,-5,0,15,22,2,0,6,28,5),Tr(0,8,10,-5,0,16,24,2,0,6,30,5),Tr(0,8,11,-5,0,17,26,2,0,6,32,5),Tr(0,9,11,-5,0,18,28,2,0,7,34,6),Tr(0,9,12,-6,0,19,29,2,0,7,36,6),Tr(0,10,13,-6,0,20,31,3,0,8,38,7),Tr(0,10,13,-6,0,21,33,3,0,8,40,7),Tr(0,10,14,-6,0,22,35,3,0,8,42,7),Tr(0,11,14,-7,0,23,36,3,0,9,44,8),Tr(0,11,15,-7,0,24,38,3,0,9,46,8)],CL={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},EL={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function Iw(t){return`${Math.round(t)}ms`}function ML(t){if(!t)return 0;const n=t/36;return Math.min(Math.round((4+15*n**.25+n/5)*10),3e3)}function IL(t){const n={...CL,...t.easing},a={...EL,...t.duration};return{getAutoHeightDuration:ML,create:(m=["all"],b={})=>{const{duration:x=a.standard,easing:c=n.easeInOut,delay:A=0,...j}=b;return(Array.isArray(m)?m:[m]).map(Y=>`${Y} ${typeof x=="string"?x:Iw(x)} ${c} ${typeof A=="string"?A:Iw(A)}`).join(",")},...t,easing:n,duration:a}}const kL={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500};function AL(t){return Is(t)||typeof t>"u"||typeof t=="string"||typeof t=="boolean"||typeof t=="number"||Array.isArray(t)}function tP(t={}){const n={...t};function a(p){const m=Object.entries(p);for(let b=0;b<m.length;b++){const[x,c]=m[b];!AL(c)||x.startsWith("unstable_")?delete p[x]:Is(c)&&(p[x]={...c},a(p[x]))}}return a(n),`import { unstable_createBreakpoints as createBreakpoints, createTransitions } from '@mui/material/styles';

const theme = ${JSON.stringify(n,null,2)};

theme.breakpoints = createBreakpoints(theme.breakpoints || {});
theme.transitions = createTransitions(theme.transitions || {});

export default theme;`}function I0(t={},...n){const{breakpoints:a,mixins:p={},spacing:m,palette:b={},transitions:x={},typography:c={},shape:A,...j}=t;if(t.vars&&t.generateThemeVars===void 0)throw new Error(Cl(20));const Y=rx(b),Q=KT(t);let H=Di(Q,{mixins:vL(Q.breakpoints,p),palette:Y,shadows:PL.slice(),typography:bL(Y,c),transitions:IL(x),zIndex:{...kL}});return H=Di(H,j),H=n.reduce((G,le)=>Di(G,le),H),H.unstable_sxConfig={...xg,...j==null?void 0:j.unstable_sxConfig},H.unstable_sx=function(le){return xu({sx:le,theme:this})},H.toRuntimeSource=tP,H}function zL(t){let n;return t<1?n=5.11916*t**2:n=4.5*Math.log(t+1)+2,Math.round(n*10)/1e3}const RL=[...Array(25)].map((t,n)=>{if(n===0)return"none";const a=zL(n);return`linear-gradient(rgba(255 255 255 / ${a}), rgba(255 255 255 / ${a}))`});function rP(t){return{inputPlaceholder:t==="dark"?.5:.42,inputUnderline:t==="dark"?.7:.42,switchTrackDisabled:t==="dark"?.2:.12,switchTrack:t==="dark"?.3:.38}}function nP(t){return t==="dark"?RL:[]}function LL(t){const{palette:n={mode:"light"},opacity:a,overlays:p,...m}=t,b=rx(n);return{palette:b,opacity:{...rP(b.mode),...a},overlays:p||nP(b.mode),...m}}function DL(t){var n;return!!t[0].match(/(cssVarPrefix|colorSchemeSelector|rootSelector|typography|mixins|breakpoints|direction|transitions)/)||!!t[0].match(/sxConfig$/)||t[0]==="palette"&&!!((n=t[1])!=null&&n.match(/(mode|contrastThreshold|tonalOffset)/))}const FL=t=>[...[...Array(25)].map((n,a)=>`--${t?`${t}-`:""}overlays-${a}`),`--${t?`${t}-`:""}palette-AppBar-darkBg`,`--${t?`${t}-`:""}palette-AppBar-darkColor`],BL=t=>(n,a)=>{const p=t.rootSelector||":root",m=t.colorSchemeSelector;let b=m;if(m==="class"&&(b=".%s"),m==="data"&&(b="[data-%s]"),m!=null&&m.startsWith("data-")&&!m.includes("%s")&&(b=`[${m}="%s"]`),t.defaultColorScheme===n){if(n==="dark"){const x={};return FL(t.cssVarPrefix).forEach(c=>{x[c]=a[c],delete a[c]}),b==="media"?{[p]:a,"@media (prefers-color-scheme: dark)":{[p]:x}}:b?{[b.replace("%s",n)]:x,[`${p}, ${b.replace("%s",n)}`]:a}:{[p]:{...a,...x}}}if(b&&b!=="media")return`${p}, ${b.replace("%s",String(n))}`}else if(n){if(b==="media")return{[`@media (prefers-color-scheme: ${String(n)})`]:{[p]:a}};if(b)return b.replace("%s",String(n))}return p};function OL(t,n){n.forEach(a=>{t[a]||(t[a]={})})}function Ve(t,n,a){!t[n]&&a&&(t[n]=a)}function dd(t){return typeof t!="string"||!t.startsWith("hsl")?t:TT(t)}function Ps(t,n){`${n}Channel`in t||(t[`${n}Channel`]=hd(dd(t[n]),`MUI: Can't create \`palette.${n}Channel\` because \`palette.${n}\` is not one of these formats: #nnn, #nnnnnn, rgb(), rgba(), hsl(), hsla(), color().
To suppress this warning, you need to explicitly provide the \`palette.${n}Channel\` as a string (in rgb format, for example "12 12 12") or undefined if you want to remove the channel token.`))}function jL(t){return typeof t=="number"?`${t}px`:typeof t=="string"||typeof t=="function"||Array.isArray(t)?t:"8px"}const Vo=t=>{try{return t()}catch{}},NL=(t="mui")=>oL(t);function Cy(t,n,a,p){if(!n)return;n=n===!0?{}:n;const m=p==="dark"?"dark":"light";if(!a){t[p]=LL({...n,palette:{mode:m,...n==null?void 0:n.palette}});return}const{palette:b,...x}=I0({...a,palette:{mode:m,...n==null?void 0:n.palette}});return t[p]={...n,palette:b,opacity:{...rP(m),...n==null?void 0:n.opacity},overlays:(n==null?void 0:n.overlays)||nP(m)},x}function $L(t={},...n){const{colorSchemes:a={light:!0},defaultColorScheme:p,disableCssColorScheme:m=!1,cssVarPrefix:b="mui",shouldSkipGeneratingVar:x=DL,colorSchemeSelector:c=a.light&&a.dark?"media":void 0,rootSelector:A=":root",...j}=t,Y=Object.keys(a)[0],Q=p||(a.light&&Y!=="light"?"light":Y),H=NL(b),{[Q]:G,light:le,dark:ve,...Ae}=a,ee={...Ae};let re=G;if((Q==="dark"&&!("dark"in a)||Q==="light"&&!("light"in a))&&(re=!0),!re)throw new Error(Cl(21,Q));const se=Cy(ee,re,j,Q);le&&!ee.light&&Cy(ee,le,void 0,"light"),ve&&!ee.dark&&Cy(ee,ve,void 0,"dark");let _e={defaultColorScheme:Q,...se,cssVarPrefix:b,colorSchemeSelector:c,rootSelector:A,getCssVar:H,colorSchemes:ee,font:{...yL(se.typography),...se.font},spacing:jL(j.spacing)};Object.keys(_e.colorSchemes).forEach(gt=>{const X=_e.colorSchemes[gt].palette,Ye=at=>{const ht=at.split("-"),Ct=ht[1],tr=ht[2];return H(at,X[Ct][tr])};if(X.mode==="light"&&(Ve(X.common,"background","#fff"),Ve(X.common,"onBackground","#000")),X.mode==="dark"&&(Ve(X.common,"background","#000"),Ve(X.common,"onBackground","#fff")),OL(X,["Alert","AppBar","Avatar","Button","Chip","FilledInput","LinearProgress","Skeleton","Slider","SnackbarContent","SpeedDialAction","StepConnector","StepContent","Switch","TableCell","Tooltip"]),X.mode==="light"){Ve(X.Alert,"errorColor",cr(X.error.light,.6)),Ve(X.Alert,"infoColor",cr(X.info.light,.6)),Ve(X.Alert,"successColor",cr(X.success.light,.6)),Ve(X.Alert,"warningColor",cr(X.warning.light,.6)),Ve(X.Alert,"errorFilledBg",Ye("palette-error-main")),Ve(X.Alert,"infoFilledBg",Ye("palette-info-main")),Ve(X.Alert,"successFilledBg",Ye("palette-success-main")),Ve(X.Alert,"warningFilledBg",Ye("palette-warning-main")),Ve(X.Alert,"errorFilledColor",Vo(()=>X.getContrastText(X.error.main))),Ve(X.Alert,"infoFilledColor",Vo(()=>X.getContrastText(X.info.main))),Ve(X.Alert,"successFilledColor",Vo(()=>X.getContrastText(X.success.main))),Ve(X.Alert,"warningFilledColor",Vo(()=>X.getContrastText(X.warning.main))),Ve(X.Alert,"errorStandardBg",ur(X.error.light,.9)),Ve(X.Alert,"infoStandardBg",ur(X.info.light,.9)),Ve(X.Alert,"successStandardBg",ur(X.success.light,.9)),Ve(X.Alert,"warningStandardBg",ur(X.warning.light,.9)),Ve(X.Alert,"errorIconColor",Ye("palette-error-main")),Ve(X.Alert,"infoIconColor",Ye("palette-info-main")),Ve(X.Alert,"successIconColor",Ye("palette-success-main")),Ve(X.Alert,"warningIconColor",Ye("palette-warning-main")),Ve(X.AppBar,"defaultBg",Ye("palette-grey-100")),Ve(X.Avatar,"defaultBg",Ye("palette-grey-400")),Ve(X.Button,"inheritContainedBg",Ye("palette-grey-300")),Ve(X.Button,"inheritContainedHoverBg",Ye("palette-grey-A100")),Ve(X.Chip,"defaultBorder",Ye("palette-grey-400")),Ve(X.Chip,"defaultAvatarColor",Ye("palette-grey-700")),Ve(X.Chip,"defaultIconColor",Ye("palette-grey-700")),Ve(X.FilledInput,"bg","rgba(0, 0, 0, 0.06)"),Ve(X.FilledInput,"hoverBg","rgba(0, 0, 0, 0.09)"),Ve(X.FilledInput,"disabledBg","rgba(0, 0, 0, 0.12)"),Ve(X.LinearProgress,"primaryBg",ur(X.primary.main,.62)),Ve(X.LinearProgress,"secondaryBg",ur(X.secondary.main,.62)),Ve(X.LinearProgress,"errorBg",ur(X.error.main,.62)),Ve(X.LinearProgress,"infoBg",ur(X.info.main,.62)),Ve(X.LinearProgress,"successBg",ur(X.success.main,.62)),Ve(X.LinearProgress,"warningBg",ur(X.warning.main,.62)),Ve(X.Skeleton,"bg",`rgba(${Ye("palette-text-primaryChannel")} / 0.11)`),Ve(X.Slider,"primaryTrack",ur(X.primary.main,.62)),Ve(X.Slider,"secondaryTrack",ur(X.secondary.main,.62)),Ve(X.Slider,"errorTrack",ur(X.error.main,.62)),Ve(X.Slider,"infoTrack",ur(X.info.main,.62)),Ve(X.Slider,"successTrack",ur(X.success.main,.62)),Ve(X.Slider,"warningTrack",ur(X.warning.main,.62));const at=Ff(X.background.default,.8);Ve(X.SnackbarContent,"bg",at),Ve(X.SnackbarContent,"color",Vo(()=>X.getContrastText(at))),Ve(X.SpeedDialAction,"fabHoverBg",Ff(X.background.paper,.15)),Ve(X.StepConnector,"border",Ye("palette-grey-400")),Ve(X.StepContent,"border",Ye("palette-grey-400")),Ve(X.Switch,"defaultColor",Ye("palette-common-white")),Ve(X.Switch,"defaultDisabledColor",Ye("palette-grey-100")),Ve(X.Switch,"primaryDisabledColor",ur(X.primary.main,.62)),Ve(X.Switch,"secondaryDisabledColor",ur(X.secondary.main,.62)),Ve(X.Switch,"errorDisabledColor",ur(X.error.main,.62)),Ve(X.Switch,"infoDisabledColor",ur(X.info.main,.62)),Ve(X.Switch,"successDisabledColor",ur(X.success.main,.62)),Ve(X.Switch,"warningDisabledColor",ur(X.warning.main,.62)),Ve(X.TableCell,"border",ur(Df(X.divider,1),.88)),Ve(X.Tooltip,"bg",Df(X.grey[700],.92))}if(X.mode==="dark"){Ve(X.Alert,"errorColor",ur(X.error.light,.6)),Ve(X.Alert,"infoColor",ur(X.info.light,.6)),Ve(X.Alert,"successColor",ur(X.success.light,.6)),Ve(X.Alert,"warningColor",ur(X.warning.light,.6)),Ve(X.Alert,"errorFilledBg",Ye("palette-error-dark")),Ve(X.Alert,"infoFilledBg",Ye("palette-info-dark")),Ve(X.Alert,"successFilledBg",Ye("palette-success-dark")),Ve(X.Alert,"warningFilledBg",Ye("palette-warning-dark")),Ve(X.Alert,"errorFilledColor",Vo(()=>X.getContrastText(X.error.dark))),Ve(X.Alert,"infoFilledColor",Vo(()=>X.getContrastText(X.info.dark))),Ve(X.Alert,"successFilledColor",Vo(()=>X.getContrastText(X.success.dark))),Ve(X.Alert,"warningFilledColor",Vo(()=>X.getContrastText(X.warning.dark))),Ve(X.Alert,"errorStandardBg",cr(X.error.light,.9)),Ve(X.Alert,"infoStandardBg",cr(X.info.light,.9)),Ve(X.Alert,"successStandardBg",cr(X.success.light,.9)),Ve(X.Alert,"warningStandardBg",cr(X.warning.light,.9)),Ve(X.Alert,"errorIconColor",Ye("palette-error-main")),Ve(X.Alert,"infoIconColor",Ye("palette-info-main")),Ve(X.Alert,"successIconColor",Ye("palette-success-main")),Ve(X.Alert,"warningIconColor",Ye("palette-warning-main")),Ve(X.AppBar,"defaultBg",Ye("palette-grey-900")),Ve(X.AppBar,"darkBg",Ye("palette-background-paper")),Ve(X.AppBar,"darkColor",Ye("palette-text-primary")),Ve(X.Avatar,"defaultBg",Ye("palette-grey-600")),Ve(X.Button,"inheritContainedBg",Ye("palette-grey-800")),Ve(X.Button,"inheritContainedHoverBg",Ye("palette-grey-700")),Ve(X.Chip,"defaultBorder",Ye("palette-grey-700")),Ve(X.Chip,"defaultAvatarColor",Ye("palette-grey-300")),Ve(X.Chip,"defaultIconColor",Ye("palette-grey-300")),Ve(X.FilledInput,"bg","rgba(255, 255, 255, 0.09)"),Ve(X.FilledInput,"hoverBg","rgba(255, 255, 255, 0.13)"),Ve(X.FilledInput,"disabledBg","rgba(255, 255, 255, 0.12)"),Ve(X.LinearProgress,"primaryBg",cr(X.primary.main,.5)),Ve(X.LinearProgress,"secondaryBg",cr(X.secondary.main,.5)),Ve(X.LinearProgress,"errorBg",cr(X.error.main,.5)),Ve(X.LinearProgress,"infoBg",cr(X.info.main,.5)),Ve(X.LinearProgress,"successBg",cr(X.success.main,.5)),Ve(X.LinearProgress,"warningBg",cr(X.warning.main,.5)),Ve(X.Skeleton,"bg",`rgba(${Ye("palette-text-primaryChannel")} / 0.13)`),Ve(X.Slider,"primaryTrack",cr(X.primary.main,.5)),Ve(X.Slider,"secondaryTrack",cr(X.secondary.main,.5)),Ve(X.Slider,"errorTrack",cr(X.error.main,.5)),Ve(X.Slider,"infoTrack",cr(X.info.main,.5)),Ve(X.Slider,"successTrack",cr(X.success.main,.5)),Ve(X.Slider,"warningTrack",cr(X.warning.main,.5));const at=Ff(X.background.default,.98);Ve(X.SnackbarContent,"bg",at),Ve(X.SnackbarContent,"color",Vo(()=>X.getContrastText(at))),Ve(X.SpeedDialAction,"fabHoverBg",Ff(X.background.paper,.15)),Ve(X.StepConnector,"border",Ye("palette-grey-600")),Ve(X.StepContent,"border",Ye("palette-grey-600")),Ve(X.Switch,"defaultColor",Ye("palette-grey-300")),Ve(X.Switch,"defaultDisabledColor",Ye("palette-grey-600")),Ve(X.Switch,"primaryDisabledColor",cr(X.primary.main,.55)),Ve(X.Switch,"secondaryDisabledColor",cr(X.secondary.main,.55)),Ve(X.Switch,"errorDisabledColor",cr(X.error.main,.55)),Ve(X.Switch,"infoDisabledColor",cr(X.info.main,.55)),Ve(X.Switch,"successDisabledColor",cr(X.success.main,.55)),Ve(X.Switch,"warningDisabledColor",cr(X.warning.main,.55)),Ve(X.TableCell,"border",cr(Df(X.divider,1),.68)),Ve(X.Tooltip,"bg",Df(X.grey[700],.92))}Ps(X.background,"default"),Ps(X.background,"paper"),Ps(X.common,"background"),Ps(X.common,"onBackground"),Ps(X,"divider"),Object.keys(X).forEach(at=>{const ht=X[at];at!=="tonalOffset"&&ht&&typeof ht=="object"&&(ht.main&&Ve(X[at],"mainChannel",hd(dd(ht.main))),ht.light&&Ve(X[at],"lightChannel",hd(dd(ht.light))),ht.dark&&Ve(X[at],"darkChannel",hd(dd(ht.dark))),ht.contrastText&&Ve(X[at],"contrastTextChannel",hd(dd(ht.contrastText))),at==="text"&&(Ps(X[at],"primary"),Ps(X[at],"secondary")),at==="action"&&(ht.active&&Ps(X[at],"active"),ht.selected&&Ps(X[at],"selected")))})}),_e=n.reduce((gt,X)=>Di(gt,X),_e);const De={prefix:b,disableCssColorScheme:m,shouldSkipGeneratingVar:x,getSelector:BL(_e)},{vars:Fe,generateThemeVars:ze,generateStyleSheets:We}=lL(_e,De);return _e.vars=Fe,Object.entries(_e.colorSchemes[_e.defaultColorScheme]).forEach(([gt,X])=>{_e[gt]=X}),_e.generateThemeVars=ze,_e.generateStyleSheets=We,_e.generateSpacing=function(){return XT(j.spacing,Gv(this))},_e.getColorSchemeSelector=cL(c),_e.spacing=_e.generateSpacing(),_e.shouldSkipGeneratingVar=x,_e.unstable_sxConfig={...xg,...j==null?void 0:j.unstable_sxConfig},_e.unstable_sx=function(X){return xu({sx:X,theme:this})},_e.toRuntimeSource=tP,_e}function kw(t,n,a){t.colorSchemes&&a&&(t.colorSchemes[n]={...a!==!0&&a,palette:rx({...a===!0?{}:a.palette,mode:n})})}function VL(t={},...n){const{palette:a,cssVariables:p=!1,colorSchemes:m=a?void 0:{light:!0},defaultColorScheme:b=a==null?void 0:a.mode,...x}=t,c=b||"light",A=m==null?void 0:m[c],j={...m,...a?{[c]:{...typeof A!="boolean"&&A,palette:a}}:void 0};if(p===!1){if(!("colorSchemes"in t))return I0(t,...n);let Y=a;"palette"in t||j[c]&&(j[c]!==!0?Y=j[c].palette:c==="dark"&&(Y={mode:"dark"}));const Q=I0({...t,palette:Y},...n);return Q.defaultColorScheme=c,Q.colorSchemes=j,Q.palette.mode==="light"&&(Q.colorSchemes.light={...j.light!==!0&&j.light,palette:Q.palette},kw(Q,"dark",j.dark)),Q.palette.mode==="dark"&&(Q.colorSchemes.dark={...j.dark!==!0&&j.dark,palette:Q.palette},kw(Q,"light",j.light)),Q}return!a&&!("light"in j)&&c==="light"&&(j.light=!0),$L({...x,colorSchemes:j,defaultColorScheme:c,...typeof p!="boolean"&&p},...n)}const UL=VL(),ZL="$$material";function GL(t){return t!=="ownerState"&&t!=="theme"&&t!=="sx"&&t!=="as"}const iP=t=>GL(t)&&t!=="classes",Mo=KR({themeId:ZL,defaultTheme:UL,rootShouldForwardProp:iP}),nx=iL;function Dg(t){return nL(t)}class Dm{constructor(){Hh(this,"mountEffect",()=>{this.shouldMount&&!this.didMount&&this.ref.current!==null&&(this.didMount=!0,this.mounted.resolve())});this.ref={current:null},this.mounted=null,this.didMount=!1,this.shouldMount=!1,this.setShouldMount=null}static create(){return new Dm}static use(){const n=MT(Dm.create).current,[a,p]=we.useState(!1);return n.shouldMount=a,n.setShouldMount=p,we.useEffect(n.mountEffect,[a]),n}mount(){return this.mounted||(this.mounted=WL(),this.shouldMount=!0,this.setShouldMount(this.shouldMount)),this.mounted}start(...n){this.mount().then(()=>{var a;return(a=this.ref.current)==null?void 0:a.start(...n)})}stop(...n){this.mount().then(()=>{var a;return(a=this.ref.current)==null?void 0:a.stop(...n)})}pulsate(...n){this.mount().then(()=>{var a;return(a=this.ref.current)==null?void 0:a.pulsate(...n)})}}function qL(){return Dm.use()}function WL(){let t,n;const a=new Promise((p,m)=>{t=p,n=m});return a.resolve=t,a.reject=n,a}function HL(t,n){if(t==null)return{};var a={};for(var p in t)if({}.hasOwnProperty.call(t,p)){if(n.indexOf(p)!==-1)continue;a[p]=t[p]}return a}function k0(t,n){return k0=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,p){return a.__proto__=p,a},k0(t,n)}function XL(t,n){t.prototype=Object.create(n.prototype),t.prototype.constructor=t,k0(t,n)}const Aw=Gc.createContext(null);function KL(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ix(t,n){var a=function(b){return n&&we.isValidElement(b)?n(b):b},p=Object.create(null);return t&&we.Children.map(t,function(m){return m}).forEach(function(m){p[m.key]=a(m)}),p}function YL(t,n){t=t||{},n=n||{};function a(Y){return Y in n?n[Y]:t[Y]}var p=Object.create(null),m=[];for(var b in t)b in n?m.length&&(p[b]=m,m=[]):m.push(b);var x,c={};for(var A in n){if(p[A])for(x=0;x<p[A].length;x++){var j=p[A][x];c[p[A][x]]=a(j)}c[A]=a(A)}for(x=0;x<m.length;x++)c[m[x]]=a(m[x]);return c}function yl(t,n,a){return a[n]!=null?a[n]:t.props[n]}function QL(t,n){return ix(t.children,function(a){return we.cloneElement(a,{onExited:n.bind(null,a),in:!0,appear:yl(a,"appear",t),enter:yl(a,"enter",t),exit:yl(a,"exit",t)})})}function JL(t,n,a){var p=ix(t.children),m=YL(n,p);return Object.keys(m).forEach(function(b){var x=m[b];if(we.isValidElement(x)){var c=b in n,A=b in p,j=n[b],Y=we.isValidElement(j)&&!j.props.in;A&&(!c||Y)?m[b]=we.cloneElement(x,{onExited:a.bind(null,x),in:!0,exit:yl(x,"exit",t),enter:yl(x,"enter",t)}):!A&&c&&!Y?m[b]=we.cloneElement(x,{in:!1}):A&&c&&we.isValidElement(j)&&(m[b]=we.cloneElement(x,{onExited:a.bind(null,x),in:j.props.in,exit:yl(x,"exit",t),enter:yl(x,"enter",t)}))}}),m}var eD=Object.values||function(t){return Object.keys(t).map(function(n){return t[n]})},tD={component:"div",childFactory:function(n){return n}},ox=function(t){XL(n,t);function n(p,m){var b;b=t.call(this,p,m)||this;var x=b.handleExited.bind(KL(b));return b.state={contextValue:{isMounting:!0},handleExited:x,firstRender:!0},b}var a=n.prototype;return a.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},a.componentWillUnmount=function(){this.mounted=!1},n.getDerivedStateFromProps=function(m,b){var x=b.children,c=b.handleExited,A=b.firstRender;return{children:A?QL(m,c):JL(m,x,c),firstRender:!1}},a.handleExited=function(m,b){var x=ix(this.props.children);m.key in x||(m.props.onExited&&m.props.onExited(b),this.mounted&&this.setState(function(c){var A=Rm({},c.children);return delete A[m.key],{children:A}}))},a.render=function(){var m=this.props,b=m.component,x=m.childFactory,c=HL(m,["component","childFactory"]),A=this.state.contextValue,j=eD(this.state.children).map(x);return delete c.appear,delete c.enter,delete c.exit,b===null?Gc.createElement(Aw.Provider,{value:A},j):Gc.createElement(Aw.Provider,{value:A},Gc.createElement(b,c,j))},n}(Gc.Component);ox.propTypes={};ox.defaultProps=tD;function rD(t){const{className:n,classes:a,pulsate:p=!1,rippleX:m,rippleY:b,rippleSize:x,in:c,onExited:A,timeout:j}=t,[Y,Q]=we.useState(!1),H=Ai(n,a.ripple,a.rippleVisible,p&&a.ripplePulsate),G={width:x,height:x,top:-(x/2)+b,left:-(x/2)+m},le=Ai(a.child,Y&&a.childLeaving,p&&a.childPulsate);return!c&&!Y&&Q(!0),we.useEffect(()=>{if(!c&&A!=null){const ve=setTimeout(A,j);return()=>{clearTimeout(ve)}}},[A,c,j]),tt.jsx("span",{className:H,style:G,children:tt.jsx("span",{className:le})})}const Ki=dg("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),A0=550,nD=80,iD=rp`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`,oD=rp`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`,sD=rp`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`,aD=Mo("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),lD=Mo(rD,{name:"MuiTouchRipple",slot:"Ripple"})`
  opacity: 0;
  position: absolute;

  &.${Ki.rippleVisible} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${iD};
    animation-duration: ${A0}ms;
    animation-timing-function: ${({theme:t})=>t.transitions.easing.easeInOut};
  }

  &.${Ki.ripplePulsate} {
    animation-duration: ${({theme:t})=>t.transitions.duration.shorter}ms;
  }

  & .${Ki.child} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${Ki.childLeaving} {
    opacity: 0;
    animation-name: ${oD};
    animation-duration: ${A0}ms;
    animation-timing-function: ${({theme:t})=>t.transitions.easing.easeInOut};
  }

  & .${Ki.childPulsate} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${sD};
    animation-duration: 2500ms;
    animation-timing-function: ${({theme:t})=>t.transitions.easing.easeInOut};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`,cD=we.forwardRef(function(n,a){const p=Dg({props:n,name:"MuiTouchRipple"}),{center:m=!1,classes:b={},className:x,...c}=p,[A,j]=we.useState([]),Y=we.useRef(0),Q=we.useRef(null);we.useEffect(()=>{Q.current&&(Q.current(),Q.current=null)},[A]);const H=we.useRef(!1),G=OA(),le=we.useRef(null),ve=we.useRef(null),Ae=we.useCallback(_e=>{const{pulsate:De,rippleX:Fe,rippleY:ze,rippleSize:We,cb:gt}=_e;j(X=>[...X,tt.jsx(lD,{classes:{ripple:Ai(b.ripple,Ki.ripple),rippleVisible:Ai(b.rippleVisible,Ki.rippleVisible),ripplePulsate:Ai(b.ripplePulsate,Ki.ripplePulsate),child:Ai(b.child,Ki.child),childLeaving:Ai(b.childLeaving,Ki.childLeaving),childPulsate:Ai(b.childPulsate,Ki.childPulsate)},timeout:A0,pulsate:De,rippleX:Fe,rippleY:ze,rippleSize:We},Y.current)]),Y.current+=1,Q.current=gt},[b]),ee=we.useCallback((_e={},De={},Fe=()=>{})=>{const{pulsate:ze=!1,center:We=m||De.pulsate,fakeElement:gt=!1}=De;if((_e==null?void 0:_e.type)==="mousedown"&&H.current){H.current=!1;return}(_e==null?void 0:_e.type)==="touchstart"&&(H.current=!0);const X=gt?null:ve.current,Ye=X?X.getBoundingClientRect():{width:0,height:0,left:0,top:0};let at,ht,Ct;if(We||_e===void 0||_e.clientX===0&&_e.clientY===0||!_e.clientX&&!_e.touches)at=Math.round(Ye.width/2),ht=Math.round(Ye.height/2);else{const{clientX:tr,clientY:St}=_e.touches&&_e.touches.length>0?_e.touches[0]:_e;at=Math.round(tr-Ye.left),ht=Math.round(St-Ye.top)}if(We)Ct=Math.sqrt((2*Ye.width**2+Ye.height**2)/3),Ct%2===0&&(Ct+=1);else{const tr=Math.max(Math.abs((X?X.clientWidth:0)-at),at)*2+2,St=Math.max(Math.abs((X?X.clientHeight:0)-ht),ht)*2+2;Ct=Math.sqrt(tr**2+St**2)}_e!=null&&_e.touches?le.current===null&&(le.current=()=>{Ae({pulsate:ze,rippleX:at,rippleY:ht,rippleSize:Ct,cb:Fe})},G.start(nD,()=>{le.current&&(le.current(),le.current=null)})):Ae({pulsate:ze,rippleX:at,rippleY:ht,rippleSize:Ct,cb:Fe})},[m,Ae,G]),re=we.useCallback(()=>{ee({},{pulsate:!0})},[ee]),se=we.useCallback((_e,De)=>{if(G.clear(),(_e==null?void 0:_e.type)==="touchend"&&le.current){le.current(),le.current=null,G.start(0,()=>{se(_e,De)});return}le.current=null,j(Fe=>Fe.length>0?Fe.slice(1):Fe),Q.current=De},[G]);return we.useImperativeHandle(a,()=>({pulsate:re,start:ee,stop:se}),[re,ee,se]),tt.jsx(aD,{className:Ai(Ki.root,b.root,x),ref:ve,...c,children:tt.jsx(ox,{component:null,exit:!0,children:A})})});function uD(t){return hg("MuiButtonBase",t)}const hD=dg("MuiButtonBase",["root","disabled","focusVisible"]),dD=t=>{const{disabled:n,focusVisible:a,focusVisibleClassName:p,classes:m}=t,x=Fv({root:["root",n&&"disabled",a&&"focusVisible"]},uD,m);return a&&p&&(x.root+=` ${p}`),x},pD=Mo("button",{name:"MuiButtonBase",slot:"Root",overridesResolver:(t,n)=>n.root})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${hD.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),fD=we.forwardRef(function(n,a){const p=Dg({props:n,name:"MuiButtonBase"}),{action:m,centerRipple:b=!1,children:x,className:c,component:A="button",disabled:j=!1,disableRipple:Y=!1,disableTouchRipple:Q=!1,focusRipple:H=!1,focusVisibleClassName:G,LinkComponent:le="a",onBlur:ve,onClick:Ae,onContextMenu:ee,onDragLeave:re,onFocus:se,onFocusVisible:_e,onKeyDown:De,onKeyUp:Fe,onMouseDown:ze,onMouseLeave:We,onMouseUp:gt,onTouchEnd:X,onTouchMove:Ye,onTouchStart:at,tabIndex:ht=0,TouchRippleProps:Ct,touchRippleRef:tr,type:St,...br}=p,rt=we.useRef(null),ut=qL(),Tt=sw(ut.ref,tr),[Lt,Nt]=we.useState(!1);j&&Lt&&Nt(!1),we.useImperativeHandle(m,()=>({focusVisible:()=>{Nt(!0),rt.current.focus()}}),[]);const Xr=ut.shouldMount&&!Y&&!j;we.useEffect(()=>{Lt&&H&&!Y&&ut.pulsate()},[Y,H,Lt,ut]);const wr=Cs(ut,"start",ze,Q),fr=Cs(ut,"stop",ee,Q),ln=Cs(ut,"stop",re,Q),zn=Cs(ut,"stop",gt,Q),so=Cs(ut,"stop",Et=>{Lt&&Et.preventDefault(),We&&We(Et)},Q),Pn=Cs(ut,"start",at,Q),es=Cs(ut,"stop",X,Q),Kr=Cs(ut,"stop",Ye,Q),Cr=Cs(ut,"stop",Et=>{lw(Et.target)||Nt(!1),ve&&ve(Et)},!1),xi=Jf(Et=>{rt.current||(rt.current=Et.currentTarget),lw(Et.target)&&(Nt(!0),_e&&_e(Et)),se&&se(Et)}),or=()=>{const Et=rt.current;return A&&A!=="button"&&!(Et.tagName==="A"&&Et.href)},ao=Jf(Et=>{H&&!Et.repeat&&Lt&&Et.key===" "&&ut.stop(Et,()=>{ut.start(Et)}),Et.target===Et.currentTarget&&or()&&Et.key===" "&&Et.preventDefault(),De&&De(Et),Et.target===Et.currentTarget&&or()&&Et.key==="Enter"&&!j&&(Et.preventDefault(),Ae&&Ae(Et))}),lo=Jf(Et=>{H&&Et.key===" "&&Lt&&!Et.defaultPrevented&&ut.stop(Et,()=>{ut.pulsate(Et)}),Fe&&Fe(Et),Ae&&Et.target===Et.currentTarget&&or()&&Et.key===" "&&!Et.defaultPrevented&&Ae(Et)});let gn=A;gn==="button"&&(br.href||br.to)&&(gn=le);const Rn={};gn==="button"?(Rn.type=St===void 0?"button":St,Rn.disabled=j):(!br.href&&!br.to&&(Rn.role="button"),j&&(Rn["aria-disabled"]=j));const Vi=sw(a,rt),Gn={...p,centerRipple:b,component:A,disabled:j,disableRipple:Y,disableTouchRipple:Q,focusRipple:H,tabIndex:ht,focusVisible:Lt},qn=dD(Gn);return tt.jsxs(pD,{as:gn,className:Ai(qn.root,c),ownerState:Gn,onBlur:Cr,onClick:Ae,onContextMenu:fr,onFocus:xi,onKeyDown:ao,onKeyUp:lo,onMouseDown:wr,onMouseLeave:so,onMouseUp:zn,onDragLeave:ln,onTouchEnd:es,onTouchMove:Kr,onTouchStart:Pn,ref:Vi,tabIndex:j?-1:ht,type:St,...Rn,...br,children:[x,Xr?tt.jsx(cD,{ref:Tt,center:b,...Ct}):null]})});function Cs(t,n,a,p=!1){return Jf(m=>(a&&a(m),p||t[n](m),!0))}function mD(t){return typeof t.main=="string"}function gD(t,n=[]){if(!mD(t))return!1;for(const a of n)if(!t.hasOwnProperty(a)||typeof t[a]!="string")return!1;return!0}function oP(t=[]){return([,n])=>n&&gD(n,t)}function _D(t){return hg("MuiCircularProgress",t)}dg("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"]);const ga=44,z0=rp`
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
`,R0=rp`
  0% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: 0;
  }

  50% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -15px;
  }

  100% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: -126px;
  }
`,yD=typeof z0!="string"?tx`
        animation: ${z0} 1.4s linear infinite;
      `:null,vD=typeof R0!="string"?tx`
        animation: ${R0} 1.4s ease-in-out infinite;
      `:null,xD=t=>{const{classes:n,variant:a,color:p,disableShrink:m}=t,b={root:["root",a,`color${wn(p)}`],svg:["svg"],circle:["circle",`circle${wn(a)}`,m&&"circleDisableShrink"]};return Fv(b,_D,n)},bD=Mo("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:(t,n)=>{const{ownerState:a}=t;return[n.root,n[a.variant],n[`color${wn(a.color)}`]]}})(nx(({theme:t})=>({display:"inline-block",variants:[{props:{variant:"determinate"},style:{transition:t.transitions.create("transform")}},{props:{variant:"indeterminate"},style:yD||{animation:`${z0} 1.4s linear infinite`}},...Object.entries(t.palette).filter(oP()).map(([n])=>({props:{color:n},style:{color:(t.vars||t).palette[n].main}}))]}))),wD=Mo("svg",{name:"MuiCircularProgress",slot:"Svg",overridesResolver:(t,n)=>n.svg})({display:"block"}),SD=Mo("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:(t,n)=>{const{ownerState:a}=t;return[n.circle,n[`circle${wn(a.variant)}`],a.disableShrink&&n.circleDisableShrink]}})(nx(({theme:t})=>({stroke:"currentColor",variants:[{props:{variant:"determinate"},style:{transition:t.transitions.create("stroke-dashoffset")}},{props:{variant:"indeterminate"},style:{strokeDasharray:"80px, 200px",strokeDashoffset:0}},{props:({ownerState:n})=>n.variant==="indeterminate"&&!n.disableShrink,style:vD||{animation:`${R0} 1.4s ease-in-out infinite`}}]}))),TD=we.forwardRef(function(n,a){const p=Dg({props:n,name:"MuiCircularProgress"}),{className:m,color:b="primary",disableShrink:x=!1,size:c=40,style:A,thickness:j=3.6,value:Y=0,variant:Q="indeterminate",...H}=p,G={...p,color:b,disableShrink:x,size:c,thickness:j,value:Y,variant:Q},le=xD(G),ve={},Ae={},ee={};if(Q==="determinate"){const re=2*Math.PI*((ga-j)/2);ve.strokeDasharray=re.toFixed(3),ee["aria-valuenow"]=Math.round(Y),ve.strokeDashoffset=`${((100-Y)/100*re).toFixed(3)}px`,Ae.transform="rotate(-90deg)"}return tt.jsx(bD,{className:Ai(le.root,m),style:{width:c,height:c,...Ae,...A},ownerState:G,ref:a,role:"progressbar",...ee,...H,children:tt.jsx(wD,{className:le.svg,ownerState:G,viewBox:`${ga/2} ${ga/2} ${ga} ${ga}`,children:tt.jsx(SD,{className:le.circle,style:ve,ownerState:G,cx:ga,cy:ga,r:(ga-j)/2,fill:"none",strokeWidth:j})})})});function PD(t){return hg("MuiButton",t)}const dl=dg("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","colorPrimary","colorSecondary","colorSuccess","colorError","colorInfo","colorWarning","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","icon","iconSizeSmall","iconSizeMedium","iconSizeLarge","loading","loadingWrapper","loadingIconPlaceholder","loadingIndicator","loadingPositionCenter","loadingPositionStart","loadingPositionEnd"]),CD=we.createContext({}),ED=we.createContext(void 0),MD=t=>{const{color:n,disableElevation:a,fullWidth:p,size:m,variant:b,loading:x,loadingPosition:c,classes:A}=t,j={root:["root",x&&"loading",b,`${b}${wn(n)}`,`size${wn(m)}`,`${b}Size${wn(m)}`,`color${wn(n)}`,a&&"disableElevation",p&&"fullWidth",x&&`loadingPosition${wn(c)}`],startIcon:["icon","startIcon",`iconSize${wn(m)}`],endIcon:["icon","endIcon",`iconSize${wn(m)}`],loadingIndicator:["loadingIndicator"],loadingWrapper:["loadingWrapper"]},Y=Fv(j,PD,A);return{...A,...Y}},sP=[{props:{size:"small"},style:{"& > *:nth-of-type(1)":{fontSize:18}}},{props:{size:"medium"},style:{"& > *:nth-of-type(1)":{fontSize:20}}},{props:{size:"large"},style:{"& > *:nth-of-type(1)":{fontSize:22}}}],ID=Mo(fD,{shouldForwardProp:t=>iP(t)||t==="classes",name:"MuiButton",slot:"Root",overridesResolver:(t,n)=>{const{ownerState:a}=t;return[n.root,n[a.variant],n[`${a.variant}${wn(a.color)}`],n[`size${wn(a.size)}`],n[`${a.variant}Size${wn(a.size)}`],a.color==="inherit"&&n.colorInherit,a.disableElevation&&n.disableElevation,a.fullWidth&&n.fullWidth,a.loading&&n.loading]}})(nx(({theme:t})=>{const n=t.palette.mode==="light"?t.palette.grey[300]:t.palette.grey[800],a=t.palette.mode==="light"?t.palette.grey.A100:t.palette.grey[700];return{...t.typography.button,minWidth:64,padding:"6px 16px",border:0,borderRadius:(t.vars||t).shape.borderRadius,transition:t.transitions.create(["background-color","box-shadow","border-color","color"],{duration:t.transitions.duration.short}),"&:hover":{textDecoration:"none"},[`&.${dl.disabled}`]:{color:(t.vars||t).palette.action.disabled},variants:[{props:{variant:"contained"},style:{color:"var(--variant-containedColor)",backgroundColor:"var(--variant-containedBg)",boxShadow:(t.vars||t).shadows[2],"&:hover":{boxShadow:(t.vars||t).shadows[4],"@media (hover: none)":{boxShadow:(t.vars||t).shadows[2]}},"&:active":{boxShadow:(t.vars||t).shadows[8]},[`&.${dl.focusVisible}`]:{boxShadow:(t.vars||t).shadows[6]},[`&.${dl.disabled}`]:{color:(t.vars||t).palette.action.disabled,boxShadow:(t.vars||t).shadows[0],backgroundColor:(t.vars||t).palette.action.disabledBackground}}},{props:{variant:"outlined"},style:{padding:"5px 15px",border:"1px solid currentColor",borderColor:"var(--variant-outlinedBorder, currentColor)",backgroundColor:"var(--variant-outlinedBg)",color:"var(--variant-outlinedColor)",[`&.${dl.disabled}`]:{border:`1px solid ${(t.vars||t).palette.action.disabledBackground}`}}},{props:{variant:"text"},style:{padding:"6px 8px",color:"var(--variant-textColor)",backgroundColor:"var(--variant-textBg)"}},...Object.entries(t.palette).filter(oP()).map(([p])=>({props:{color:p},style:{"--variant-textColor":(t.vars||t).palette[p].main,"--variant-outlinedColor":(t.vars||t).palette[p].main,"--variant-outlinedBorder":t.vars?`rgba(${t.vars.palette[p].mainChannel} / 0.5)`:Zc(t.palette[p].main,.5),"--variant-containedColor":(t.vars||t).palette[p].contrastText,"--variant-containedBg":(t.vars||t).palette[p].main,"@media (hover: hover)":{"&:hover":{"--variant-containedBg":(t.vars||t).palette[p].dark,"--variant-textBg":t.vars?`rgba(${t.vars.palette[p].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:Zc(t.palette[p].main,t.palette.action.hoverOpacity),"--variant-outlinedBorder":(t.vars||t).palette[p].main,"--variant-outlinedBg":t.vars?`rgba(${t.vars.palette[p].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:Zc(t.palette[p].main,t.palette.action.hoverOpacity)}}}})),{props:{color:"inherit"},style:{color:"inherit",borderColor:"currentColor","--variant-containedBg":t.vars?t.vars.palette.Button.inheritContainedBg:n,"@media (hover: hover)":{"&:hover":{"--variant-containedBg":t.vars?t.vars.palette.Button.inheritContainedHoverBg:a,"--variant-textBg":t.vars?`rgba(${t.vars.palette.text.primaryChannel} / ${t.vars.palette.action.hoverOpacity})`:Zc(t.palette.text.primary,t.palette.action.hoverOpacity),"--variant-outlinedBg":t.vars?`rgba(${t.vars.palette.text.primaryChannel} / ${t.vars.palette.action.hoverOpacity})`:Zc(t.palette.text.primary,t.palette.action.hoverOpacity)}}}},{props:{size:"small",variant:"text"},style:{padding:"4px 5px",fontSize:t.typography.pxToRem(13)}},{props:{size:"large",variant:"text"},style:{padding:"8px 11px",fontSize:t.typography.pxToRem(15)}},{props:{size:"small",variant:"outlined"},style:{padding:"3px 9px",fontSize:t.typography.pxToRem(13)}},{props:{size:"large",variant:"outlined"},style:{padding:"7px 21px",fontSize:t.typography.pxToRem(15)}},{props:{size:"small",variant:"contained"},style:{padding:"4px 10px",fontSize:t.typography.pxToRem(13)}},{props:{size:"large",variant:"contained"},style:{padding:"8px 22px",fontSize:t.typography.pxToRem(15)}},{props:{disableElevation:!0},style:{boxShadow:"none","&:hover":{boxShadow:"none"},[`&.${dl.focusVisible}`]:{boxShadow:"none"},"&:active":{boxShadow:"none"},[`&.${dl.disabled}`]:{boxShadow:"none"}}},{props:{fullWidth:!0},style:{width:"100%"}},{props:{loadingPosition:"center"},style:{transition:t.transitions.create(["background-color","box-shadow","border-color"],{duration:t.transitions.duration.short}),[`&.${dl.loading}`]:{color:"transparent"}}}]}})),kD=Mo("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(t,n)=>{const{ownerState:a}=t;return[n.startIcon,a.loading&&n.startIconLoadingStart,n[`iconSize${wn(a.size)}`]]}})(({theme:t})=>({display:"inherit",marginRight:8,marginLeft:-4,variants:[{props:{size:"small"},style:{marginLeft:-2}},{props:{loadingPosition:"start",loading:!0},style:{transition:t.transitions.create(["opacity"],{duration:t.transitions.duration.short}),opacity:0}},{props:{loadingPosition:"start",loading:!0,fullWidth:!0},style:{marginRight:-8}},...sP]})),AD=Mo("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(t,n)=>{const{ownerState:a}=t;return[n.endIcon,a.loading&&n.endIconLoadingEnd,n[`iconSize${wn(a.size)}`]]}})(({theme:t})=>({display:"inherit",marginRight:-4,marginLeft:8,variants:[{props:{size:"small"},style:{marginRight:-2}},{props:{loadingPosition:"end",loading:!0},style:{transition:t.transitions.create(["opacity"],{duration:t.transitions.duration.short}),opacity:0}},{props:{loadingPosition:"end",loading:!0,fullWidth:!0},style:{marginLeft:-8}},...sP]})),zD=Mo("span",{name:"MuiButton",slot:"LoadingIndicator",overridesResolver:(t,n)=>n.loadingIndicator})(({theme:t})=>({display:"none",position:"absolute",visibility:"visible",variants:[{props:{loading:!0},style:{display:"flex"}},{props:{loadingPosition:"start"},style:{left:14}},{props:{loadingPosition:"start",size:"small"},style:{left:10}},{props:{variant:"text",loadingPosition:"start"},style:{left:6}},{props:{loadingPosition:"center"},style:{left:"50%",transform:"translate(-50%)",color:(t.vars||t).palette.action.disabled}},{props:{loadingPosition:"end"},style:{right:14}},{props:{loadingPosition:"end",size:"small"},style:{right:10}},{props:{variant:"text",loadingPosition:"end"},style:{right:6}},{props:{loadingPosition:"start",fullWidth:!0},style:{position:"relative",left:-10}},{props:{loadingPosition:"end",fullWidth:!0},style:{position:"relative",right:-10}}]})),zw=Mo("span",{name:"MuiButton",slot:"LoadingIconPlaceholder",overridesResolver:(t,n)=>n.loadingIconPlaceholder})({display:"inline-block",width:"1em",height:"1em"}),RD=we.forwardRef(function(n,a){const p=we.useContext(CD),m=we.useContext(ED),b=Am(p,n),x=Dg({props:b,name:"MuiButton"}),{children:c,color:A="primary",component:j="button",className:Y,disabled:Q=!1,disableElevation:H=!1,disableFocusRipple:G=!1,endIcon:le,focusVisibleClassName:ve,fullWidth:Ae=!1,id:ee,loading:re=null,loadingIndicator:se,loadingPosition:_e="center",size:De="medium",startIcon:Fe,type:ze,variant:We="text",...gt}=x,X=DA(ee),Ye=se??tt.jsx(TD,{"aria-labelledby":X,color:"inherit",size:16}),at={...x,color:A,component:j,disabled:Q,disableElevation:H,disableFocusRipple:G,fullWidth:Ae,loading:re,loadingIndicator:Ye,loadingPosition:_e,size:De,type:ze,variant:We},ht=MD(at),Ct=(Fe||re&&_e==="start")&&tt.jsx(kD,{className:ht.startIcon,ownerState:at,children:Fe||tt.jsx(zw,{className:ht.loadingIconPlaceholder,ownerState:at})}),tr=(le||re&&_e==="end")&&tt.jsx(AD,{className:ht.endIcon,ownerState:at,children:le||tt.jsx(zw,{className:ht.loadingIconPlaceholder,ownerState:at})}),St=m||"",br=typeof re=="boolean"?tt.jsx("span",{className:ht.loadingWrapper,style:{display:"contents"},children:re&&tt.jsx(zD,{className:ht.loadingIndicator,ownerState:at,children:Ye})}):null;return tt.jsxs(ID,{ownerState:at,className:Ai(p.className,ht.root,Y,St),component:j,disabled:Q||re,focusRipple:!G,focusVisibleClassName:Ai(ht.focusVisible,ve),ref:a,type:ze,id:re?X:ee,...gt,classes:ht,children:[Ct,_e!=="end"&&br,c,_e==="end"&&br,tr]})});function LD({label:t}){const n=()=>{console.log("Button clicked! and we like "+t)};return tt.jsx(RD,{variant:"contained",onClick:n,children:t})}const DD=["English","Spanish","French","German","Japanese","English","Spanish","French","German","Japanese","English","Spanish","French","German","Japanese"];function FD(){return tt.jsxs("div",{children:[tt.jsx("h2",{className:"selecth2",children:"Select a Language"}),tt.jsx("div",{className:"container",children:DD.map((t,n)=>tt.jsx(LD,{label:t},n))})]})}function BD(){return tt.jsxs(tt.Fragment,{children:[tt.jsx(SA,{}),tt.jsx(FD,{})]})}function OD(){return tt.jsx(tt.Fragment,{children:tt.jsxs("div",{className:"databasePage",children:[tt.jsx("h1",{className:"databasePageH1",children:"Database"}),tt.jsx("p",{className:"databasePageP",children:"Boop"})]})})}function jD(){return tt.jsx(tt.Fragment,{children:tt.jsxs("div",{className:"creditsPage",children:[tt.jsx("h1",{className:"creditsPageH1",children:"Credits"}),tt.jsx("p",{className:"creditsPageP",children:"This project was created by the following people:"})]})})}function ND(){return tt.jsxs($k,{children:[tt.jsx(Yk,{}),tt.jsxs(yk,{children:[tt.jsx(ud,{path:"/InteractiveLanguageMap2/",element:tt.jsx(Jk,{})}),tt.jsx(ud,{path:"/InteractiveLanguageMap2/world_map",element:tt.jsx(BD,{})}),tt.jsx(ud,{path:"/InteractiveLanguageMap2/database",element:tt.jsx(OD,{})}),tt.jsx(ud,{path:"/InteractiveLanguageMap2/credits",element:tt.jsx(jD,{})})]}),tt.jsx(Qk,{})]})}qS(document.getElementById("root")).render(tt.jsx(we.StrictMode,{children:tt.jsx(ND,{})}));
